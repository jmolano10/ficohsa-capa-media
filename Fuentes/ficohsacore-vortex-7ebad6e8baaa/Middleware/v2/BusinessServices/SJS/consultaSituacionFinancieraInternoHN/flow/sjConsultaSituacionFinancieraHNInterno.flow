<bpel:process name="sjConsultaSituacionFinancieraHNInterno" targetNamespace="http://www.example.com/flow/Middleware/v2/BusinessServices/SJS/consultaSituacionFinancieraInternoHN/flow/sjConsultaSituacionFinancieraHNInterno" bea:name="sjConsultaSituacionFinancieraHNInterno" xmlns:tns="http://www.example.com/flow/Middleware/v2/BusinessServices/SJS/consultaSituacionFinancieraInternoHN/flow/sjConsultaSituacionFinancieraHNInterno" xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable" xmlns:rescon="http://www.bea.com/alsb/flow/resources/config" xmlns:bea="http://www.bea.com/bpel/ui/extensions" xmlns:ext="http://www.bea.com/bpel/extensions" xmlns:expr="http://www.bea.com/wli/sb/stages/config" xmlns:trf="http://www.bea.com/wli/sb/stages/transform/config" xmlns:bind="http://www.ficohsa.com.hn/middleware.services/sjConsultaSituacionFinancieraHNInternoPS" xmlns:ns0="http://www.ficohsa.com.hn/middleware.services/sjConsultaSituacionFinancieraPS" xmlns:ns1="http://xmlns.oracle.com/pcbpel/adapter/db/ConsultaSituacionFinanciera/Project1/consultaSituacionFinanciera" xmlns:ns2="http://xmlns.oracle.com/pcbpel/adapter/db/ConsultaSituacionFinancieraFicopen/Project1/consultaSituacionFinanciera" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:ns3="T24WebServicesImpl" xmlns:ns4="http://www.ficohsa.com.hn/middleware.services/sjConsultaSituacionFinancieraInterno" xmlns:ns5="http://xmlns.oracle.com/pcbpel/adapter/db/Application1/Project1/consultaSituacionFinanciera" xmlns:ns6="http://xmlns.oracle.com/pcbpel/adapter/db/insertarSituacionFinanciera/Project1/insertarSituacionFinanciera" xmlns:aut="http://www.ficohsa.com.hn/middleware.services/autType" xmlns:ins="http://xmlns.oracle.com/pcbpel/adapter/db/sp/insertarSituacionFinanciera" xmlns:ns7="http://xmlns.oracle.com/pcbpel/adapter/db/ConnectionTarjetas/conConsultaSituacionFinanciera/conConsultaSituacionFinanciera" xmlns:ns8="https://www.ficohsa.com/honduras/pension" xmlns:ns9="https://www.ficohsa.com/regional/pension"
              xmlns:ns10="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xmlns:ns11="http://xmlns.oracle.com/Vortex/Middleware/CloudCodeRestBS">
    <bpel:partnerLinks>
        <bpel:partnerLink name="sjConsultaSituacionFinancieraHNInterno" partnerLinkType="tns:sjConsultaSituacionFinancieraHNInterno" myRole="sjConsultaSituacionFinancieraHNInterno">
	       </bpel:partnerLink>
	   <bpel:partnerLink name="consultaSituacionFinanciera_db" partnerLinkType="tns:consultaSituacionFinanciera_db_plnkType" partnerRole="consultaSituacionFinanciera_db_PartnerRole">
	   </bpel:partnerLink>
	   
	   
	   
	   <bpel:partnerLink name="consultaSituacionFinanciera_1" partnerLinkType="tns:consultaSituacionFinanciera_1_plnkType" partnerRole="consultaSituacionFinanciera_1_PartnerRole">
	   </bpel:partnerLink>
	   <bpel:partnerLink name="insertarSituacionFinanciera_db" partnerLinkType="tns:insertarSituacionFinanciera_db_plnkType" partnerRole="insertarSituacionFinanciera_db_PartnerRole">
	   </bpel:partnerLink>
	   
	<bpel:partnerLink name="sjConsultaClienteResiliencia" partnerLinkType="tns:sjConsultaClienteResiliencia_plnkType" partnerRole="sjConsultaClienteResiliencia_PartnerRole">
	</bpel:partnerLink>
	<bpel:partnerLink name="conConsultaSituacionFinanciera_db" partnerLinkType="tns:conConsultaSituacionFinanciera_db_plnkType" partnerRole="conConsultaSituacionFinanciera_db_PartnerRole">
	</bpel:partnerLink>
  <bpel:partnerLink name="CloudCodeRestBS" partnerLinkType="tns:CloudCodeRestBS" partnerRole="CloudCodeRestBS"/>
 </bpel:partnerLinks>

	   <bpel:variables>
        <bpel:variable name="request" messageType="bind:sjConsultaSituacionFinancieraHNInternoRequest">
	       </bpel:variable>
	       <bpel:variable name="response" messageType="bind:sjConsultaSituacionFinancieraHNInternoResponse">
	       </bpel:variable>
    <bpel:variable name="tempResponse" type="xsd:anyType"/>
    <bpel:variable name="core" type="xsd:anyType"/>
  <bpel:variable name="REQclientesFinacieros" messageType="ns11:clientesFinancieros_inputMessage"/>
  <bpel:variable name="RSPclientesFinacieros" messageType="ns11:clientesFinancieros_outputMessage"/>
 </bpel:variables>

    <bpel:sequence>
        <bpel:receive partnerLink="sjConsultaSituacionFinancieraHNInterno" operation="ConsultaSituacionFinancieraHNInterno" createInstance="yes" variable="request">
	           <rescon:receiveInfo>
                
            <rescon:wsdl ref="Middleware/v2/BusinessServices/SJS/consultaSituacionFinancieraInternoHN/wsdl/sjConsultaSituacionFinancieraHNInterno" binding="bind:sjConsultaSituacionFinancieraHNInternoPSSOAP"/></rescon:receiveInfo>
        </bpel:receive>
        
        
        
        <bpel:assign>
        	
        <bpel:extensionAssignOperation>
		<trf:assign varName="response.outputParameters">
			<trf:expr>
				<expr:xqueryText>&lt;sjConsultaSituacionFinancieraInternoTypes/></expr:xqueryText></trf:expr></trf:assign>
        </bpel:extensionAssignOperation></bpel:assign>
        <bpel:assign>
        	<bpel:extensionAssignOperation>
        		<trf:assign varName="tempResponse">
        			<trf:expr>
        				<expr:xqueryText>&lt;ResponseHeader>
	&lt;responses/>
&lt;/ResponseHeader></expr:xqueryText></trf:expr></trf:assign>
        	</bpel:extensionAssignOperation>
        </bpel:assign>
        <bpel:assign>
        	<bpel:extensionAssignOperation>
        		<trf:assign varName="core">
        			<trf:expr>
        				<expr:xqueryText><![CDATA[<CORES>
	<CORE>T24</CORE>
	<CORE>ABK</CORE>
	<CORE>VASA</CORE>
	<CORE>FPC</CORE>
</CORES>]]></expr:xqueryText></trf:expr></trf:assign>
        	</bpel:extensionAssignOperation>
        </bpel:assign>
        <bpel:forEach parallel="yes" counterName="counter">
        	<bpel:startCounterValue>number(1)</bpel:startCounterValue>
        	<bpel:finalCounterValue>count($request.inputParameters/GROUPS/GROUP)</bpel:finalCounterValue>
        	<bpel:scope>
        		<bpel:sequence>
        			<bpel:forEach parallel="yes" counterName="counterCore">
        				<bpel:startCounterValue>number(1)</bpel:startCounterValue>
        				<bpel:finalCounterValue>count($core/CORE)</bpel:finalCounterValue>
        				<bpel:scope>
        					<bpel:variables>
        						<bpel:variable name="currentCore" type="xsd:string">
        						</bpel:variable></bpel:variables>
        					
        					<bpel:faultHandlers>
        						<bpel:catchAll>
        							<bpel:sequence>
        								<bpel:empty/>
        							<bpel:assign>
		<bpel:extensionAssignOperation>
			<trf:insert varName="tempResponse">
				<trf:location>
					<expr:xpathText>./responses</expr:xpathText></trf:location>
				<trf:where>last-child</trf:where>
				<trf:expr>
					<expr:xqueryText><![CDATA[<response>
	<successIndicator>ERROR</successIndicator>
	<messages>{ concat('Error insertando registro en ', $currentCore, ' HN01') }</messages>
</response>]]></expr:xqueryText></trf:expr></trf:insert></bpel:extensionAssignOperation></bpel:assign></bpel:sequence>
        						</bpel:catchAll></bpel:faultHandlers>
        					<bpel:sequence>
        						<bpel:assign>
        							<bpel:extensionAssignOperation>
        								<trf:assign varName="currentCore">
        									<trf:expr>
        										<expr:xqueryText>$core/CORE[xs:integer($counterCore)]</expr:xqueryText></trf:expr></trf:assign>
        							</bpel:extensionAssignOperation>
        						</bpel:assign>
        						<bpel:if bea:branchLabel="T24">
        							<bpel:condition>$currentCore = "T24"</bpel:condition>
        							<bpel:sequence>
        								<bpel:empty/>
        							<bpel:scope>
		<bpel:variables>
			<bpel:variable name="group" type="ns4:GROUP"/>
			<bpel:variable messageType="ns3:ConsultaSituacionFinanciera" name="REQConsultaSituacionFinanciera"/>
			<bpel:variable messageType="ns3:ConsultaSituacionFinancieraResponse" name="RSPConsultaSituacionFinanciera"/>
			<bpel:variable messageType="ns6:args_in_msg" name="REQInsertarSituacionFinanciera"/>
			<bpel:variable messageType="ns6:args_out_msg" name="RSPInsertarSituacionFinanciera"/></bpel:variables>
		<bpel:faultHandlers>
			<bpel:catchAll>
				<bpel:sequence>
					<bpel:empty/>
					
					<bpel:rethrow/>
					<bpel:exit/></bpel:sequence></bpel:catchAll></bpel:faultHandlers>
		<bpel:sequence>
			<bpel:scope>
				<bpel:sequence>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="group">
							<trf:assign varName="group">
								<trf:expr>
									<expr:xqueryText>$request.inputParameters/GROUPS/GROUP[xs:integer($counter)]</expr:xqueryText></trf:expr></trf:assign></bpel:extensionAssignOperation></bpel:assign>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="REQConsultaSituacionFinancieraT24">
							<trf:assign varName="REQConsultaSituacionFinanciera.parameters">
								<trf:expr>
									<expr:xqueryTransform>
										<expr:resource ref="Middleware/v2/BusinessServices/SJS/consultaSituacionFinancieraInternoHN/xq/sjConsultaSituacionFinancieraT24In"/>
										<expr:param name="requestHeader">
											<expr:path>$request.RequestHeader</expr:path></expr:param>
										<expr:param name="group">
											<expr:path>$group</expr:path></expr:param></expr:xqueryTransform></trf:expr></trf:assign></bpel:extensionAssignOperation></bpel:assign>
					<bpel:invoke bea:name="ConsultaSituacionFinancieraT24" inputVariable="REQConsultaSituacionFinanciera" outputVariable="RSPConsultaSituacionFinanciera" partnerLink="consultaSituacionFinanciera_1" operation="ConsultaSituacionFinanciera">
						<rescon:invokeInfo><rescon:service ref="Middleware/v2/BusinessServices/T24/consultaSituacionFinanciera/biz/consultaSituacionFinanciera" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/></rescon:invokeInfo></bpel:invoke></bpel:sequence></bpel:scope>
			<bpel:scope>
				<bpel:sequence>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="REQInsertarSituacionFinanicera">
							<trf:assign varName="REQInsertarSituacionFinanciera.InputParameters">
								<trf:expr>
									<expr:xqueryTransform>
										<expr:resource ref="Middleware/v2/BusinessServices/SJS/consultaSituacionFinancieraInternoHN/xq/insertarSituacionFinancieraT24In"/>
										<expr:param name="consultaSituacionFinancieraResponse">
											<expr:path>$RSPConsultaSituacionFinanciera.parameters</expr:path></expr:param>
										<expr:param name="referenciaLlave">
											<expr:path>fn:string($request.inputParameters/UUID/text())</expr:path></expr:param>
										<expr:param name="usuario">
											<expr:path>fn:string($request.RequestHeader/Authentication/UserName/text())</expr:path></expr:param></expr:xqueryTransform></trf:expr></trf:assign></bpel:extensionAssignOperation></bpel:assign>
					<bpel:invoke bea:name="InsertarSituacionFinanicera" outputVariable="RSPInsertarSituacionFinanciera" inputVariable="REQInsertarSituacionFinanciera" partnerLink="insertarSituacionFinanciera_db" operation="insertarSituacionFinanciera">
						<rescon:invokeInfo><rescon:service ref="Middleware/v2/BusinessServices/INTFC/insertarSituacionFinanciera/biz/insertarSituacionFinanciera_db" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/></rescon:invokeInfo></bpel:invoke>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="InserccionSituacionFinancieraT24">
							<trf:insert varName="tempResponse">
								<trf:location>
									<expr:xpathText>./responses</expr:xpathText></trf:location>
								<trf:where>last-child</trf:where>
								<trf:expr>
									<expr:xqueryText><![CDATA[<response>
	<successIndicator>{ fn:string($RSPInsertarSituacionFinanciera.OutputParameters/ins:PV_SUCCESS_INDICADOR/text()) } </successIndicator>
	<messages>{ concat('HN01: ', fn:string($RSPInsertarSituacionFinanciera.OutputParameters/ins:PV_MENSAJE_ERROR/text())) } </messages>
</response>]]></expr:xqueryText></trf:expr></trf:insert></bpel:extensionAssignOperation></bpel:assign></bpel:sequence></bpel:scope></bpel:sequence></bpel:scope></bpel:sequence>
        							<bpel:elseif bea:name="ABK">
        								<bpel:condition>$currentCore = "ABK"</bpel:condition>
        								<bpel:sequence>
        									<bpel:empty/>
        								<bpel:scope>
		<bpel:variables>
			<bpel:variable messageType="ns1:args_in_msg" name="REQConsultaSituacionFinancieraAbanksHN"/>
			<bpel:variable messageType="ns1:args_out_msg" name="RSPConsultaSituacionFinancieraAbanksHN"/>
			<bpel:variable name="group" type="ns4:GROUP"/>
			<bpel:variable messageType="ns6:args_in_msg" name="REQInsertarSituacionFinanciera"/>
			<bpel:variable messageType="ns6:args_out_msg" name="RSPInsertarSituacionFinanciera"/></bpel:variables>
		<bpel:faultHandlers>
			<bpel:catchAll>
				<bpel:sequence>
					<bpel:empty/>
					
					<bpel:rethrow/>
					<bpel:exit/></bpel:sequence></bpel:catchAll></bpel:faultHandlers>
		<bpel:sequence>
			<bpel:scope>
				<bpel:sequence>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="group">
							<trf:assign varName="group">
								<trf:expr>
									<expr:xqueryText>$request.inputParameters/GROUPS/GROUP[xs:integer($counter)]</expr:xqueryText></trf:expr></trf:assign></bpel:extensionAssignOperation></bpel:assign>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="REQConsultaSituacionFinancieraAbanksHN">
							<trf:assign varName="REQConsultaSituacionFinancieraAbanksHN.InputParameters">
								<trf:expr>
									<expr:xqueryTransform>
										<expr:resource ref="Middleware/v2/BusinessServices/SJS/consultaSituacionFinancieraInternoHN/xq/sjConsultaSituacionFinancieraAbanksHNIn"/>
										<expr:param name="group">
											<expr:path>$group</expr:path></expr:param></expr:xqueryTransform></trf:expr></trf:assign></bpel:extensionAssignOperation></bpel:assign>
					<bpel:invoke bea:name="consultaSituacionFinancieraAbanksHN" outputVariable="RSPConsultaSituacionFinancieraAbanksHN" inputVariable="REQConsultaSituacionFinancieraAbanksHN" partnerLink="consultaSituacionFinanciera_db" operation="consultaSituacionFinanciera">
						<rescon:invokeInfo><rescon:service ref="Middleware/v2/BusinessServices/ABK/consultaSituacionFinanciera/biz/consultaSituacionFinanciera_db" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/></rescon:invokeInfo></bpel:invoke></bpel:sequence></bpel:scope>
			<bpel:scope>
				<bpel:sequence>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="REQInsertarSituacionFinanicera">
							<trf:assign varName="REQInsertarSituacionFinanciera.InputParameters">
								<trf:expr>
									<expr:xqueryTransform>
										<expr:resource ref="Middleware/v2/BusinessServices/SJS/consultaSituacionFinancieraInternoHN/xq/insertarSituacionFinancieraAbanksHNIn"/>
										<expr:param name="outputParameters">
											<expr:path>$RSPConsultaSituacionFinancieraAbanksHN.OutputParameters</expr:path></expr:param>
										<expr:param name="referenciaLlave">
											<expr:path>fn:string($request.inputParameters/UUID/text())</expr:path></expr:param>
										<expr:param name="usuario">
											<expr:path>fn:string($request.RequestHeader/Authentication/UserName/text())</expr:path></expr:param></expr:xqueryTransform></trf:expr></trf:assign></bpel:extensionAssignOperation></bpel:assign>
					<bpel:invoke bea:name="InsertarSituacionFinanciera" inputVariable="REQInsertarSituacionFinanciera" outputVariable="RSPInsertarSituacionFinanciera" partnerLink="insertarSituacionFinanciera_db" operation="insertarSituacionFinanciera">
						<rescon:invokeInfo><rescon:service ref="Middleware/v2/BusinessServices/INTFC/insertarSituacionFinanciera/biz/insertarSituacionFinanciera_db" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/></rescon:invokeInfo></bpel:invoke>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="InserccionSituacionFinancieraAbanksHN">
							<trf:insert varName="tempResponse">
								<trf:location>
									<expr:xpathText>./responses</expr:xpathText></trf:location>
								<trf:where>last-child</trf:where>
								<trf:expr>
									<expr:xqueryText><![CDATA[<response>
	<successIndicator>{ fn:string($RSPInsertarSituacionFinanciera.OutputParameters/ins:PV_SUCCESS_INDICADOR/text()) } </successIndicator>
	<messages>{ concat('HN01: ', fn:string($RSPInsertarSituacionFinanciera.OutputParameters/ins:PV_MENSAJE_ERROR/text())) } </messages>
</response>]]></expr:xqueryText></trf:expr></trf:insert></bpel:extensionAssignOperation></bpel:assign></bpel:sequence></bpel:scope></bpel:sequence></bpel:scope></bpel:sequence>
        							</bpel:elseif>
        							<bpel:elseif bea:name="VASA">
        								<bpel:condition>$currentCore = "VASA"</bpel:condition>
        								<bpel:sequence>
        									<bpel:empty/>
        								<bpel:scope>
		<bpel:variables>
			<bpel:variable name="group" type="ns4:GROUP"/>
			
			
			<bpel:variable messageType="ns6:args_in_msg" name="REQInsertarSituacionFinanciera"/>
			<bpel:variable messageType="ns6:args_out_msg" name="RSPInsertarSituacionFinanciera"/>
			<bpel:variable name="REQConsultaSituacionFinanciera" messageType="ns7:args_in_msg">
			</bpel:variable>
			<bpel:variable name="RSPConsultaSituacionFinanciera" messageType="ns7:args_out_msg">
			</bpel:variable></bpel:variables>
		<bpel:faultHandlers>
			<bpel:catchAll>
				<bpel:sequence>
					<bpel:empty/>
					
					
					
					<bpel:rethrow/>
					<bpel:exit/></bpel:sequence></bpel:catchAll></bpel:faultHandlers>
		<bpel:sequence>
			<bpel:scope>
				
				<bpel:sequence>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="group">
							<trf:assign varName="group">
								<trf:expr>
									<expr:xqueryText>$request.inputParameters/GROUPS/GROUP[xs:integer($counter)]</expr:xqueryText></trf:expr></trf:assign></bpel:extensionAssignOperation></bpel:assign>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="REQConsultaSituacionFinancieraVasa">
							<trf:assign varName="REQConsultaSituacionFinanciera.InputParameters">
								<trf:expr>
									<expr:xqueryTransform>
										<expr:resource ref="Middleware/v2/BusinessServices/SJS/consultaSituacionFinancieraInternoHN/xq/sjConsultaSituacionFinancieraMasterDataIn"/>
										<expr:param name="group">
											<expr:path>$group</expr:path></expr:param></expr:xqueryTransform></trf:expr></trf:assign></bpel:extensionAssignOperation></bpel:assign>
					<bpel:invoke bea:name="consultaSituacionFinancieraVasa" partnerLink="conConsultaSituacionFinanciera_db" operation="conConsultaSituacionFinanciera" inputVariable="REQConsultaSituacionFinanciera" outputVariable="RSPConsultaSituacionFinanciera">
						<rescon:invokeInfo><rescon:service ref="Middleware/v2/BusinessServices/MasterDataHN/conConsultaSituacionFinanciera/biz/conConsultaSituacionFinanciera_db" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/></rescon:invokeInfo></bpel:invoke></bpel:sequence></bpel:scope>
			<bpel:scope>
				<bpel:sequence>
					<bpel:assign>
						
						<bpel:extensionAssignOperation>
							<trf:assign varName="REQInsertarSituacionFinanciera.InputParameters">
								<trf:expr>
									<expr:xqueryTransform>
										<expr:resource ref="Middleware/v2/BusinessServices/SJS/consultaSituacionFinancieraInternoHN/xq/insertarSituacionFinancieraMasterDataIn"/>
										
										
										
										
										<expr:param name="usuario">
											<expr:path>fn:string($request.RequestHeader/Authentication/UserName/text())</expr:path></expr:param>
										<expr:param name="referenciaLlave">
											<expr:path>fn:string($request.inputParameters/UUID/text())</expr:path></expr:param>
										<expr:param name="outputParameters1">
											<expr:path>$RSPConsultaSituacionFinanciera.OutputParameters</expr:path></expr:param></expr:xqueryTransform></trf:expr></trf:assign>
						</bpel:extensionAssignOperation></bpel:assign>
					<bpel:invoke bea:name="InsertarSituacionFinanicera" outputVariable="RSPInsertarSituacionFinanciera" inputVariable="REQInsertarSituacionFinanciera" partnerLink="insertarSituacionFinanciera_db" operation="insertarSituacionFinanciera">
						<rescon:invokeInfo><rescon:service ref="Middleware/v2/BusinessServices/INTFC/insertarSituacionFinanciera/biz/insertarSituacionFinanciera_db" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/></rescon:invokeInfo></bpel:invoke>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="InserccionSituacionFinancieraProxyVasa">
							<trf:insert varName="tempResponse">
								<trf:location>
									<expr:xpathText>./responses</expr:xpathText></trf:location>
								<trf:where>last-child</trf:where>
								<trf:expr>
									<expr:xqueryText><![CDATA[<response>
	<successIndicator>{ fn:string($RSPInsertarSituacionFinanciera.OutputParameters/ins:PV_SUCCESS_INDICADOR/text()) } </successIndicator>
	<messages>{ concat('HN01: ', fn:string($RSPInsertarSituacionFinanciera.OutputParameters/ins:PV_MENSAJE_ERROR/text())) } </messages>
</response>]]></expr:xqueryText></trf:expr></trf:insert></bpel:extensionAssignOperation></bpel:assign></bpel:sequence></bpel:scope></bpel:sequence></bpel:scope></bpel:sequence>
        							</bpel:elseif>
        							<bpel:elseif bea:name="FPC">
        								<bpel:condition>$currentCore = "FPC"</bpel:condition>
        								<bpel:sequence>
        									<bpel:empty/>
        								<bpel:scope>
		<bpel:variables>
			<bpel:variable name="group" type="ns4:GROUP"/>
			
			
			<bpel:variable messageType="ns6:args_in_msg" name="REQInsertarSituacionFinanciera"/>
			<bpel:variable messageType="ns6:args_out_msg" name="RSPInsertarSituacionFinanciera"/>
			<bpel:variable name="REQsjConsultadecliente" messageType="ns3:sjConsultadecliente">
			</bpel:variable>
			<bpel:variable name="RSPsjConsultadecliente" messageType="ns3:sjConsultadeclienteResponse">
			</bpel:variable></bpel:variables>
		<bpel:faultHandlers>
			<bpel:catchAll>
				<bpel:sequence>
					<bpel:empty/>
					
					<bpel:rethrow/>
					<bpel:exit/></bpel:sequence></bpel:catchAll></bpel:faultHandlers>
		<bpel:sequence>
			
			<bpel:scope>
				
				
				<bpel:sequence>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="group">
							<trf:assign varName="group">
								<trf:expr>
									<expr:xqueryText>$request.inputParameters/GROUPS/GROUP[xs:integer($counter)]</expr:xqueryText></trf:expr></trf:assign></bpel:extensionAssignOperation></bpel:assign>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="REQConsultadecliente">
							<trf:assign varName="REQsjConsultadecliente.parameters">
								<trf:expr>
									<expr:xqueryTransform>
										<expr:resource ref="Middleware/v2/BusinessServices/SJS/consultaSituacionFinancieraInternoHN/xq/sjConsultaClienteIn"/>
										
										<expr:param name="requestHeader">
											<expr:path>$request.RequestHeader</expr:path></expr:param>
										<expr:param name="group">
											<expr:path>$group</expr:path></expr:param></expr:xqueryTransform></trf:expr></trf:assign>
						</bpel:extensionAssignOperation>
					</bpel:assign>
					
					
					<bpel:invoke outputVariable="RSPsjConsultadecliente" inputVariable="REQsjConsultadecliente" partnerLink="sjConsultaClienteResiliencia" operation="Consultadecliente">
						<rescon:invokeInfo><con:service ref="Middleware/v3/BusinessServices/ConsultasCliente/flow/sjConsultaClienteResiliencia" xsi:type="con:FlowRef" xmlns:con="http://www.bea.com/alsb/flow/resources/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/></rescon:invokeInfo></bpel:invoke>
					<bpel:assign>
                <bpel:extensionAssignOperation>
                 <trf:assign varName="REQclientesFinacieros.request">
                  <trf:expr>
                   <expr:xqueryTransform>
                    <expr:resource ref="Middleware/v2/BusinessServices/FPC/CloudCode/Transformation/clientesFinancierosIn"/>
                    <expr:param name="codigoTipoIdentificacion">
                     <expr:path>$RSPsjConsultadecliente.parameters/WSCUSTOMERType[1]/gWSCUSTOMERDetailType/mWSCUSTOMERDetailType[1]/LEGALDOCNAME</expr:path>
                    </expr:param>
                    <expr:param name="numeroIdentificacion">
                     <expr:path>$RSPsjConsultadecliente.parameters/WSCUSTOMERType[1]/gWSCUSTOMERDetailType/mWSCUSTOMERDetailType[1]/LEGALID</expr:path>
                    </expr:param>
                   </expr:xqueryTransform>
                  </trf:expr>
                 </trf:assign>
                </bpel:extensionAssignOperation></bpel:assign>
               <bpel:invoke partnerLink="CloudCodeRestBS" operation="clientesFinancieros"
                            inputVariable="REQclientesFinacieros" outputVariable="RSPclientesFinacieros">
                <rescon:invokeInfo>
                 <rescon:service ref="Middleware/v2/BusinessServices/FPC/CloudCode/BS/CloudCodeRestBS"
                                 xsi:type="ns10:BusinessServiceRef"/>
                </rescon:invokeInfo>
               </bpel:invoke></bpel:sequence></bpel:scope>
			<bpel:scope>
				<bpel:sequence>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="REQInsertarSituacionFinanicera">
							<trf:assign varName="REQInsertarSituacionFinanciera.InputParameters">
								<trf:expr>
									<expr:xqueryTransform>
										<expr:resource ref="Middleware/v2/BusinessServices/SJS/consultaSituacionFinancieraInternoHN/xq/insertarSituacionFinancieraFPCIn"/>
                    <expr:param name="usuario">
                     <expr:path>fn:string($request.RequestHeader/Authentication/UserName/text())</expr:path>
                    </expr:param>
                    <expr:param name="outputParameters">
                     <expr:path>$RSPclientesFinacieros.reply</expr:path>
                    </expr:param>
                    <expr:param name="referenciaLlave">
                     <expr:path>fn:string($request.inputParameters/UUID/text())</expr:path>
                    </expr:param>
                   </expr:xqueryTransform></trf:expr></trf:assign></bpel:extensionAssignOperation></bpel:assign>
					<bpel:invoke bea:name="InsertarSituacionFinanicera" outputVariable="RSPInsertarSituacionFinanciera" inputVariable="REQInsertarSituacionFinanciera" partnerLink="insertarSituacionFinanciera_db" operation="insertarSituacionFinanciera">
						<rescon:invokeInfo><rescon:service ref="Middleware/v2/BusinessServices/INTFC/insertarSituacionFinanciera/biz/insertarSituacionFinanciera_db" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/></rescon:invokeInfo></bpel:invoke>
					<bpel:assign>
						<bpel:extensionAssignOperation bea:name="InserccionSituacionFinancieraFicopen">
							<trf:insert varName="tempResponse">
								<trf:location>
									<expr:xpathText>./responses</expr:xpathText></trf:location>
								<trf:where>last-child</trf:where>
								<trf:expr>
									<expr:xqueryText><![CDATA[<response>
	<successIndicator>{ fn:string($RSPInsertarSituacionFinanciera.OutputParameters/ins:PV_SUCCESS_INDICADOR/text()) } </successIndicator>
	<messages>{ concat('HN01: ', fn:string($RSPInsertarSituacionFinanciera.OutputParameters/ins:PV_MENSAJE_ERROR/text())) } </messages>
</response>]]></expr:xqueryText></trf:expr></trf:insert></bpel:extensionAssignOperation></bpel:assign></bpel:sequence></bpel:scope></bpel:sequence></bpel:scope></bpel:sequence>
        							</bpel:elseif>
        							<bpel:else>
        								<bpel:sequence>
        									<bpel:empty/>
        								</bpel:sequence>
        							</bpel:else>
        						</bpel:if></bpel:sequence>
        				</bpel:scope>
        			</bpel:forEach>
        			</bpel:sequence>
        	</bpel:scope>
        </bpel:forEach>
        
        <bpel:assign>
        	
        <bpel:extensionAssignOperation>
		<trf:assign varName="response.ResponseHeader">
			<trf:expr>
				<expr:xqueryText><![CDATA[<aut:ResponseHeader>
	<successIndicator>
		{
			let $numberErrors := count($tempResponse/responses/response[fn:upper-case(successIndicator) != 'SUCCESS'])
			return
				if($numberErrors = 0) then(
					'SUCCESS'
				)else(
					'ERROR'
				)
    	}
	</successIndicator>
	<messages>{ fn:string-join($tempResponse/responses/response/messages, '. ') }</messages>
</aut:ResponseHeader>]]></expr:xqueryText></trf:expr></trf:assign>
        </bpel:extensionAssignOperation></bpel:assign>
        
        <bpel:reply partnerLink="sjConsultaSituacionFinancieraHNInterno" operation="ConsultaSituacionFinancieraHNInterno" variable="response"/>
    </bpel:sequence>
</bpel:process>