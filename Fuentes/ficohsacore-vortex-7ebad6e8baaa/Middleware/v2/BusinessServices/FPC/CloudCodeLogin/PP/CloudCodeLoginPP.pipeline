<?xml version="1.0" encoding="UTF-8"?>
<con:pipelineEntry xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:coreEntry>
        <con:binding type="SOAP" isSoap12="false" xsi:type="con:SoapBindingType">
            <con:wsdl ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/Resources/CloudCodeLogin"/>
            <con:binding>
                <con:name>cloudCodeLoginBind</con:name>
                <con:namespace>https://www.ficohsa.com/honduras/pension</con:namespace>
            </con:binding>
        </con:binding>
        <con:xqConfiguration>
            <con:snippetVersion>1.0</con:snippetVersion>
        </con:xqConfiguration>
    </con:coreEntry>
    <con:router errorHandler="error-a51ea02.66549388.0.18b1c041ad4.N73ae">
        <con:pipeline type="request" name="request-a51ea02.66549388.0.18b1c041ad4.N7f24">
            <con:stage id="_StageId-a51ea02.66549388.0.18b1c041ad4.N7f22" name="InputFlow">
                <con:context>
                    <con1:userNsDecl prefix="con" namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/GetCloudCodeSessionToken" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="get" namespace="https://www.ficohsa.com/honduras/pension/getEncryptCredentialsTypes" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="upt" namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/UpdateCloudCodeSessionToken" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7eec</con2:id>
                        <con1:case id="_BranchId-a51ea02.66549388.0.18b1c041ad4.N7eeb">
                            <con1:condition>
                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">data($body/get:cloudCodeLoginRequest/forceLogin) = 'true'</con2:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:wsCallout>
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7eb8</con2:id>
                                    <con1:service ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/BS/GetEncryptCredentials" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>encryptCredentialsFPCAPI</con1:operation>
                                    <con1:request>
                                        <con1:body wrapped="false">requestGetEncryptCredentials</con1:body>
                                    </con1:request>
                                    <con1:response>
                                        <con1:body wrapped="false">responseGetEncryptCredentials</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                        <con1:validate>
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea05.2bc45fab.0.18b63b2c0cd.N7ddc</con2:id>
                                            <con1:schema ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/Schemas/GetEncryptCredentialsTypes"/>
                                            <con1:schemaElement xmlns:get="https://www.ficohsa.com/honduras/pension/getEncryptCredentialsTypes">get:cloudCodeLoginRequest</con1:schemaElement>
                                            <con1:varName>body</con1:varName>
                                            <con1:location>
                                                <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">./get:cloudCodeLoginRequest</con2:xpathText>
                                            </con1:location>
                                        </con1:validate>
                                        <con1:assign varName="requestGetEncryptCredentials">
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7e85</con2:id>
                                            <con1:expr>
                                                <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                                    <con2:resource ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/Transformation/CloudCodeLoginToGetEncryptCredentials"/>
                                                    <con2:param name="request">
                                                        <con2:path>$body/get:cloudCodeLoginRequest</con2:path>
                                                    </con2:param>
                                                </con2:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform>
                                        <con1:assign varName="errorCode">
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7d59</con2:id>
                                            <con1:expr>
                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseGetEncryptCredentials/status/text())</con2:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="errorMessage">
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7d8c</con2:id>
                                            <con1:expr>
                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseGetEncryptCredentials/message/text())</con2:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="credentials">
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7dbf</con2:id>
                                            <con1:expr>
                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseGetEncryptCredentials/credentials/text())</con2:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:responseTransform>
                                </con1:wsCallout>
                                <con1:ifThenElse>
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7c8b</con2:id>
                                    <con1:case id="_BranchId-a51ea02.66549388.0.18b1c041ad4.N7c8a">
                                        <con1:condition>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">upper-case($errorCode) = 'SUCCESS'</con2:xqueryText>
                                        </con1:condition>
                                        <con1:actions>
                                            <con1:wsCallout>
                                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7c85</con2:id>
                                                <con1:service ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/BS/CloudCodeLoginRestBS" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con1:operation>login</con1:operation>
                                                <con1:request>
                                                    <con1:body wrapped="false">requestCloudCodeLoginRestBS</con1:body>
                                                </con1:request>
                                                <con1:response>
                                                    <con1:body wrapped="false">responseCloudCodeLoginRestBS</con1:body>
                                                </con1:response>
                                                <con1:requestTransform>
                                                    <con1:assign varName="requestCloudCodeLoginRestBS">
                                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7c52</con2:id>
                                                        <con1:expr>
                                                            <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                                                <con2:resource ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/Transformation/CloudCodeLoginToCloudCodeLoginRest"/>
                                                                <con2:param name="credentials">
                                                                    <con2:path>$credentials</con2:path>
                                                                </con2:param>
                                                            </con2:xqueryTransform>
                                                        </con1:expr>
                                                    </con1:assign>
                                                </con1:requestTransform>
                                                <con1:responseTransform>
                                                    <con1:assign varName="errorCode">
                                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7bb9</con2:id>
                                                        <con1:expr>
                                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">let $successIndicator := $responseCloudCodeLoginRestBS/error/text()
return
if($successIndicator = 'false') then (
  'SUCCESS'
) else $successIndicator</con2:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="errorMessage">
                                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7bec</con2:id>
                                                        <con1:expr>
                                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseCloudCodeLoginRestBS/mensaje/text())</con2:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="token">
                                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7c1f</con2:id>
                                                        <con1:expr>
                                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseCloudCodeLoginRestBS/datos/token/text())</con2:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                </con1:responseTransform>
                                            </con1:wsCallout>
                                        </con1:actions>
                                    </con1:case>
                                    <con1:default/>
                                </con1:ifThenElse>
                                <con1:ifThenElse>
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7baf</con2:id>
                                    <con1:case id="_BranchId-a51ea02.66549388.0.18b1c041ad4.N7bae">
                                        <con1:condition>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">upper-case($errorCode) = 'SUCCESS'</con2:xqueryText>
                                        </con1:condition>
                                        <con1:actions>
                                            <con1:wsCallout>
                                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7b7b</con2:id>
                                                <con1:service ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/BS/UpdateCloudCodeSessionToken" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con1:operation>UpdateCloudCodeSessionToken</con1:operation>
                                                <con1:request>
                                                    <con1:body wrapped="false">requestUpdateCloudCodeSessionToken</con1:body>
                                                </con1:request>
                                                <con1:response>
                                                    <con1:body wrapped="false">responseUpdateCloudCodeSessionToken</con1:body>
                                                </con1:response>
                                                <con1:requestTransform>
                                                    <con1:assign varName="requestUpdateCloudCodeSessionToken">
                                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7b48</con2:id>
                                                        <con1:expr>
                                                            <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                                                <con2:resource ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/Transformation/UpdateCloudCodeSessionTokenIn"/>
                                                                <con2:param name="userName">
                                                                    <con2:path>string($body/get:cloudCodeLoginRequest/userName/text())</con2:path>
                                                                </con2:param>
                                                                <con2:param name="timestamp">
                                                                    <con2:path>fn:current-dateTime()</con2:path>
                                                                </con2:param>
                                                                <con2:param name="token">
                                                                    <con2:path>$token</con2:path>
                                                                </con2:param>
                                                            </con2:xqueryTransform>
                                                        </con1:expr>
                                                    </con1:assign>
                                                </con1:requestTransform>
                                                <con1:responseTransform>
                                                    <con1:assign varName="errorCode">
                                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7ae2</con2:id>
                                                        <con1:expr>
                                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseUpdateCloudCodeSessionToken/upt:PV_CODIGO_ERROR/text())</con2:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="validationMessage">
                                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7b15</con2:id>
                                                        <con1:expr>
                                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseUpdateCloudCodeSessionToken/upt:PV_MENSAJE_ERROR/text())</con2:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                </con1:responseTransform>
                                            </con1:wsCallout>
                                        </con1:actions>
                                    </con1:case>
                                    <con1:default/>
                                </con1:ifThenElse>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con1:wsCallout>
                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7aaf</con2:id>
                                <con1:service ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/BS/GetCloudCodeSessionToken" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                <con1:operation>GetCloudCodeSessionToken</con1:operation>
                                <con1:request>
                                    <con1:body wrapped="false">requestGetCloudCodeSessionToken</con1:body>
                                </con1:request>
                                <con1:response>
                                    <con1:body wrapped="false">responseGetCloudCodeSessionToken</con1:body>
                                </con1:response>
                                <con1:requestTransform>
                                    <con1:assign varName="requestGetCloudCodeSessionToken">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7a4b</con2:id>
                                        <con1:expr>
                                            <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                                <con2:resource ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/Transformation/GetCloudCodeSessionTokenIn"/>
                                                <con2:param name="userName">
                                                    <con2:path>string($body/get:cloudCodeLoginRequest/userName/text())</con2:path>
                                                </con2:param>
                                            </con2:xqueryTransform>
                                        </con1:expr>
                                    </con1:assign>
                                </con1:requestTransform>
                                <con1:responseTransform>
                                    <con1:assign varName="errorCode">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N79b2</con2:id>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseGetCloudCodeSessionToken/con:PV_CODIGO_ERROR/text())</con2:xqueryText>
                                        </con1:expr>
                                    </con1:assign>
                                    <con1:assign varName="validationMessage">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N79e5</con2:id>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseGetCloudCodeSessionToken/con:PV_MENSAJE_ERROR/text())</con2:xqueryText>
                                        </con1:expr>
                                    </con1:assign>
                                    <con1:assign varName="token">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7a18</con2:id>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseGetCloudCodeSessionToken/con:PV_TOKEN/text())</con2:xqueryText>
                                        </con1:expr>
                                    </con1:assign>
                                </con1:responseTransform>
                            </con1:wsCallout>
                            <con1:ifThenElse>
                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7915</con2:id>
                                <con1:case id="_BranchId-a51ea02.66549388.0.18b1c041ad4.N7914">
                                    <con1:condition>
                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">upper-case($errorCode) != 'SUCCESS'</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                        <con1:wsCallout>
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N78df</con2:id>
                                            <con1:service ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/BS/GetEncryptCredentials" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                            <con1:operation>encryptCredentialsFPCAPI</con1:operation>
                                            <con1:request>
                                                <con1:body wrapped="false">requestGetEncryptCredentials</con1:body>
                                            </con1:request>
                                            <con1:response>
                                                <con1:body wrapped="false">responseGetEncryptCredentials</con1:body>
                                            </con1:response>
                                            <con1:requestTransform>
                                                <con1:validate>
                                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea05.2bc45fab.0.18b63b2c0cd.N7dd9</con2:id>
                                                    <con1:schema ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/Schemas/GetEncryptCredentialsTypes"/>
                                                    <con1:schemaElement xmlns:get="https://www.ficohsa.com/honduras/pension/getEncryptCredentialsTypes">get:cloudCodeLoginRequest</con1:schemaElement>
                                                    <con1:varName>body</con1:varName>
                                                    <con1:location>
                                                        <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">./get:cloudCodeLoginRequest</con2:xpathText>
                                                    </con1:location>
                                                </con1:validate>
                                                <con1:assign varName="requestGetEncryptCredentials">
                                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N78ab</con2:id>
                                                    <con1:expr>
                                                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                                            <con2:resource ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/Transformation/CloudCodeLoginToGetEncryptCredentials"/>
                                                            <con2:param name="request">
                                                                <con2:path>$body/get:cloudCodeLoginRequest</con2:path>
                                                            </con2:param>
                                                        </con2:xqueryTransform>
                                                    </con1:expr>
                                                </con1:assign>
                                            </con1:requestTransform>
                                            <con1:responseTransform>
                                                <con1:assign varName="errorCode">
                                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N780f</con2:id>
                                                    <con1:expr>
                                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseGetEncryptCredentials/status/text())</con2:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                                <con1:assign varName="errorMessage">
                                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7843</con2:id>
                                                    <con1:expr>
                                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseGetEncryptCredentials/message/text())</con2:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                                <con1:assign varName="credentials">
                                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea03.37436c18.0.18b261376ce.N7fbe</con2:id>
                                                    <con1:expr>
                                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseGetEncryptCredentials/credentials/text())</con2:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                            </con1:responseTransform>
                                        </con1:wsCallout>
                                        <con1:ifThenElse>
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7638</con2:id>
                                            <con1:case id="_BranchId-a51ea02.66549388.0.18b1c041ad4.N7637">
                                                <con1:condition>
                                                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">upper-case($errorCode) = 'SUCCESS'</con2:xqueryText>
                                                </con1:condition>
                                                <con1:actions>
                                                    <con1:wsCallout>
                                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7593</con2:id>
                                                        <con1:service ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/BS/CloudCodeLoginRestBS" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                        <con1:operation>login</con1:operation>
                                                        <con1:request>
                                                            <con1:body wrapped="false">requestCloudCodeLoginRestBS</con1:body>
                                                        </con1:request>
                                                        <con1:response>
                                                            <con1:body wrapped="false">responseCloudCodeLoginRestBS</con1:body>
                                                        </con1:response>
                                                        <con1:requestTransform>
                                                            <con1:assign varName="requestCloudCodeLoginRestBS">
                                                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7592</con2:id>
                                                                <con1:expr>
                                                                    <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                                                        <con2:resource ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/Transformation/CloudCodeLoginToCloudCodeLoginRest"/>
                                                                        <con2:param name="credentials">
                                                                            <con2:path>$credentials</con2:path>
                                                                        </con2:param>
                                                                    </con2:xqueryTransform>
                                                                </con1:expr>
                                                            </con1:assign>
                                                        </con1:requestTransform>
                                                        <con1:responseTransform>
                                                            <con1:assign varName="errorCode">
                                                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7591</con2:id>
                                                                <con1:expr>
                                                                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">let $successIndicator := $responseCloudCodeLoginRestBS/error/text()
return
if($successIndicator = 'false') then (
  'SUCCESS'
) else $successIndicator</con2:xqueryText>
                                                                </con1:expr>
                                                            </con1:assign>
                                                            <con1:assign varName="errorMessage">
                                                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7590</con2:id>
                                                                <con1:expr>
                                                                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseCloudCodeLoginRestBS/mensaje/text())</con2:xqueryText>
                                                                </con1:expr>
                                                            </con1:assign>
                                                            <con1:assign varName="newToken">
                                                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N758f</con2:id>
                                                                <con1:expr>
                                                                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseCloudCodeLoginRestBS/datos/token/text())</con2:xqueryText>
                                                                </con1:expr>
                                                            </con1:assign>
                                                        </con1:responseTransform>
                                                    </con1:wsCallout>
                                                    <con1:ifThenElse>
                                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N74f5</con2:id>
                                                        <con1:case id="_BranchId-a51ea02.66549388.0.18b1c041ad4.N74f4">
                                                            <con1:condition>
                                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">upper-case($errorCode) = 'SUCCESS'</con2:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                                <con1:wsCallout>
                                                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7484</con2:id>
                                                                    <con1:service ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/BS/UpdateCloudCodeSessionToken" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                    <con1:operation>UpdateCloudCodeSessionToken</con1:operation>
                                                                    <con1:request>
                                                                        <con1:body wrapped="false">requestUpdateCloudCodeSessionToken</con1:body>
                                                                    </con1:request>
                                                                    <con1:response>
                                                                        <con1:body wrapped="false">responseUpdateCloudCodeSessionToken</con1:body>
                                                                    </con1:response>
                                                                    <con1:requestTransform>
                                                                        <con1:assign varName="requestUpdateCloudCodeSessionToken">
                                                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7483</con2:id>
                                                                            <con1:expr>
                                                                                <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                                                                    <con2:resource ref="Middleware/v2/BusinessServices/FPC/CloudCodeLogin/Transformation/UpdateCloudCodeSessionTokenIn"/>
                                                                                    <con2:param name="userName">
                                                                                        <con2:path>string($body/get:cloudCodeLoginRequest/userName/text())</con2:path>
                                                                                    </con2:param>
                                                                                    <con2:param name="timestamp">
                                                                                        <con2:path>fn:current-dateTime()</con2:path>
                                                                                    </con2:param>
                                                                                    <con2:param name="token">
                                                                                        <con2:path>$newToken</con2:path>
                                                                                    </con2:param>
                                                                                </con2:xqueryTransform>
                                                                            </con1:expr>
                                                                        </con1:assign>
                                                                    </con1:requestTransform>
                                                                    <con1:responseTransform>
                                                                        <con1:assign varName="errorCode">
                                                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7482</con2:id>
                                                                            <con1:expr>
                                                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseUpdateCloudCodeSessionToken/upt:PV_CODIGO_ERROR/text())</con2:xqueryText>
                                                                            </con1:expr>
                                                                        </con1:assign>
                                                                        <con1:assign varName="validationMessage">
                                                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7481</con2:id>
                                                                            <con1:expr>
                                                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($responseUpdateCloudCodeSessionToken/upt:PV_MENSAJE_ERROR/text())</con2:xqueryText>
                                                                            </con1:expr>
                                                                        </con1:assign>
                                                                    </con1:responseTransform>
                                                                </con1:wsCallout>
                                                            </con1:actions>
                                                        </con1:case>
                                                        <con1:default/>
                                                    </con1:ifThenElse>
                                                </con1:actions>
                                            </con1:case>
                                            <con1:default/>
                                        </con1:ifThenElse>
                                    </con1:actions>
                                </con1:case>
                                <con1:default/>
                            </con1:ifThenElse>
                        </con1:default>
                    </con1:ifThenElse>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline type="response" name="response-a51ea02.66549388.0.18b1c041ad4.N7f23">
            <con:stage id="_StageId-a51ea02.66549388.0.18b1c041ad4.N7f21" name="OutputFLow">
                <con:context>
                    <con1:userNsDecl prefix="get" namespace="https://www.ficohsa.com/honduras/pension/getEncryptCredentialsTypes" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="clo" namespace="http://www.ficohsa.com.hn/honduras/cloudCodeLoginTypes" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7447</con2:id>
                        <con1:case id="_BranchId-a51ea02.66549388.0.18b1c041ad4.N7446">
                            <con1:condition>
                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage = ''</con2:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:replace contents-only="true" varName="body">
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N7413</con2:id>
                                    <con1:expr>
                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<get:cloudCodeLoginResponse>
  <get:successIndicator>Success</get:successIndicator>
  <get:message>Se obtuvo el token con exito</get:message>
    <get:response>
        <clo:datos>
            <clo:token>{$token}</clo:token>
        </clo:datos>
    </get:response>
</get:cloudCodeLoginResponse>]]></con2:xqueryText>
                                    </con1:expr>
                                </con1:replace>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con1:replace varName="body" contents-only="true">
                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N73e0</con2:id>
                                <con1:expr>
                                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<get:cloudCodeLoginResponse>
  <get:successIndicator>{$errorCode}</get:successIndicator>
  <get:message>{$validationMessage}</get:message>
</get:cloudCodeLoginResponse>]]></con2:xqueryText>
                                </con1:expr>
                            </con1:replace>
                        </con1:default>
                    </con1:ifThenElse>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline type="error" name="error-a51ea02.66549388.0.18b1c041ad4.N73ae">
            <con:stage id="_StageId-a51ea02.66549388.0.18b1c041ad4.N73ad" name="ErrorHandler">
                <con:context>
                    <con1:userNsDecl prefix="con1" namespace="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="get" namespace="https://www.ficohsa.com/honduras/pension/getEncryptCredentialsTypes" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:replace contents-only="true" varName="body" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-a51ea02.66549388.0.18b1c041ad4.N737a</con2:id>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<get:cloudCodeLoginResponse>
  <get:successIndicator>{concat("NO RECORDS ","HttpResponseCode: ",$fault/ctx:details/con1:ReceivedFaultDetail/con1:http-response-code)}</get:successIndicator>
  <get:message>{concat("No se encontró token de sesión registrado para el usuario: ",$body/get:cloudCodeLoginRequest/userName)}</get:message>
</get:cloudCodeLoginResponse>]]></con2:xqueryText>
                        </con1:expr>
                    </con1:replace>
                    <con1:reply xmlns:con1="http://www.bea.com/wli/sb/stages/config">
                        <con1:id>_ActionId-a51ea02.66549388.0.18b1c041ad4.N7347</con1:id>
                    </con1:reply>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:flow>
            <con:pipeline-node name="CloudCodeLoginPP">
                <con:request>request-a51ea02.66549388.0.18b1c041ad4.N7f24</con:request>
                <con:response>response-a51ea02.66549388.0.18b1c041ad4.N7f23</con:response>
            </con:pipeline-node>
        </con:flow>
        <con:shared-variables>
            <con:variable>requestGetEncryptCredentials</con:variable>
            <con:variable>responseGetEncryptCredentials</con:variable>
            <con:variable>errorCode</con:variable>
            <con:variable>errorMessage</con:variable>
            <con:variable>credentials</con:variable>
            <con:variable>requestCloudCodeLoginRestBS</con:variable>
            <con:variable>responseCloudCodeLoginRestBS</con:variable>
            <con:variable>token</con:variable>
            <con:variable>requestUpdateCloudCodeSessionToken</con:variable>
            <con:variable>responseUpdateCloudCodeSessionToken</con:variable>
            <con:variable>validationMessage</con:variable>
            <con:variable>requestGetCloudCodeSessionToken</con:variable>
            <con:variable>responseGetCloudCodeSessionToken</con:variable>
            <con:variable>newToken</con:variable>
        </con:shared-variables>
    </con:router>
</con:pipelineEntry>