<?xml version="1.0" encoding="UTF-8"?>
<con:pipelineEntry xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oper="http://xmlns.oracle.com/servicebus/pipeline/operations">
    <con:coreEntry>
        <con:binding type="SOAP" isSoap12="false" xsi:type="con:SoapBindingType">
            <con4:wsdl ref="Middleware/v2/Resources/RegistraPagoTC/wsdl/RegistraPagoPS" xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con="http://www.bea.com/wli/sb/services/bindings/config" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:env="http://www.bea.com/wli/config/env" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con3="http://www.bea.com/wli/sb/services/security/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config"/>
            <con:binding>
                <con:name>RegistraPagoPSSOAP</con:name>
                <con:namespace>http://www.ficohsa.com.hn/middleware.servicesRegistraPagoPS/</con:namespace>
            </con:binding>
        </con:binding>
        <oper:operations>
            <oper:monitoring enabled="false" aggregationInterval="10" level="pipeline"/>
            <oper:tracingEnabled>true</oper:tracingEnabled>
            <oper:reporting>true</oper:reporting>
            <oper:logging enabled="true" level="debug"/>
            <oper:sla-alerting enabled="true" level="normal"/>
            <oper:pipeline-alerting enabled="true" level="normal"/>
        </oper:operations>
    </con:coreEntry>
    <con:router errorHandler="_onErrorHandler-800248121596613693--793085b0.17a1be65112.-7289" xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
        <con:pipeline type="request" name="RegistraPagoTC_request">
            <con:stage name="ParametrizacionMiddleware">
                <con:context>
                    <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
                    <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/registraPagoTCxsd" prefix="reg"/>
                    <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                </con:context>
                <con:actions>
                    <con2:assign varName="userName">
                        <con1:id>_ActionId-3430351506787836732--5c5b1738.17acf4b69e6.-7f8a</con1:id>
                        <con2:expr>
                            <con1:xqueryText>fn:upper-case(fn:data($header/aut:RequestHeader/Authentication/UserName))</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="sourceBank">
                        <con1:id>_ActionId-3430351506787836732--5c5b1738.17acf4b69e6.-7f6d</con1:id>
                        <con2:expr>
                            <con1:xqueryText>fn:data($header/aut:RequestHeader/Region/SourceBank)</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="destinationBank">
                        <con1:id>_ActionId-1392065418217138932-b615805.17ad0f2032b.-7fe4</con1:id>
                        <con2:expr>
                            <con1:xqueryText>if(fn:data($header/aut:RequestHeader/Region/DestinationBank)!='')
then
(fn:data($header/aut:RequestHeader/Region/DestinationBank))
else
(fn:data($header/aut:RequestHeader/Region/SourceBank))</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="MERCHANTNUMBER">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7a61</con1:id>
                        <con2:expr>
                            <con1:xqueryText>if ($body/reg:registraPagoTCRequest/PAYMENT_TYPE = 'WITHDRAWAL') then 
	(fn:concat('FICBCO0067.',$userName,'.MERCHANTNUMBER.WITHDRAWAL')) 
else (fn:concat('FICBCO0067.',$userName,'.MERCHANTNUMBER'))</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="MERCHANTNUMBERDEFAULT">
                        <con1:id>_ActionId-3430351506787836732--5c5b1738.17acf4b69e6.-7fc8</con1:id>
                        <con2:expr>
                            <con1:xqueryText>if (fn:data($body/reg:registraPagoTCRequest/PAYMENT_TYPE)='SERVICE_PAYMENT')
then
('FICBCO0067.HN01.MERCHANTNUMBER.DEFAULT.PAYMENT.SERVICE')
else if (fn:data($body/reg:registraPagoTCRequest/PAYMENT_TYPE)='WITHDRAWAL')
then
('FICBCO0067.HN01.MERCHANTNUMBER.DEFAULT.WITHDRAWAL')
else
('FICBCO0067.HN01.MERCHANTNUMBER.DEFAULT.PAY.TAXES')</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="BUY">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7a0a</con1:id>
                        <con2:expr>
                            <con1:xqueryText>'FICBCO0067.HN01.BUY'</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="REVERSE">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7a27</con1:id>
                        <con2:expr>
                            <con1:xqueryText>'FICBCO0067.HN01.REVERSE'</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="RATE">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7a44</con1:id>
                        <con2:expr>
                            <con1:xqueryText>'FICBCO0067.HN01.RATE'</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="PAYMENTTYPE">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7ab6</con1:id>
                        <con2:expr>
                            <con1:xqueryText>if (fn:data($body/reg:registraPagoTCRequest/PAYMENT_TYPE)='SERVICE_PAYMENT')
then
('FICBCO0067.HN01.TS.PAYMENT.SERVICE')
else if (fn:data($body/reg:registraPagoTCRequest/PAYMENT_TYPE)='WITHDRAWAL')
then
('FICBCO0067.HN01.TS.CASH.WITHDRAWAL')
else
('FICBCO0067.HN01.TS.PAY.TAXES')</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="CHANNELDEFAULT">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7a99</con1:id>
                        <con2:expr>
                            <con1:xqueryText>'FICBCO0067.HN01.CHANNEL.DEFAULT'</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="CHANNEL">
                        <con1:id>_ActionId-3430351506787836732--5c5b1738.17acf4b69e6.-7f34</con1:id>
                        <con2:expr>
                            <con1:xqueryText>fn:concat('FICBCO0067.',$userName,'.CHANNEL')</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="POSUSERDATA">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7b0a</con1:id>
                        <con2:expr>
                            <con1:xqueryText>'FICBCO0067.HN01.POSUSERDATA'</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="NUMBEROFINSTALLMENTS">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7978</con1:id>
                        <con2:expr>
                            <con1:xqueryText>'FICBCO0067.HN01.NUMBEROFINSTALLMENTS'</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="MCCTYPE">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7995</con1:id>
                        <con2:expr>
                            <con1:xqueryText>if ($body/reg:registraPagoTCRequest/PAYMENT_TYPE = 'WITHDRAWAL')
then ('FICBCO0067.HN01.MCCTYPE.WITHDRAWAL') else 
('FICBCO0067.HN01.MCCTYPE')</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="TRACK2LENGTH">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-79b2</con1:id>
                        <con2:expr>
                            <con1:xqueryText>'FICBCO0067.HN01.TRACK2LENGTH'</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="TRACK2DATA">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-79cf</con1:id>
                        <con2:expr>
                            <con1:xqueryText>'FICBCO0067.HN01.TRACK2DATA'</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="CARDVALIDATIONVALUE">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-79ec</con1:id>
                        <con2:expr>
                            <con1:xqueryText>'FICBCO0067.HN01.CARDVALIDATIONVALUE'</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="APPLIED">
                        <con1:id>_ActionId-3430351506787836732--5c5b1738.17acf4b69e6.-7f17</con1:id>
                        <con2:expr>
                            <con1:xqueryText>'FICBCO0067.HN01.APPLIED'</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="APPLIEDONLINE">
                        <con1:id>_ActionId-3430351506787836732--5c5b1738.17acf4b69e6.-7efa</con1:id>
                        <con2:expr>
                            <con1:xqueryText>'FICBCO0067.HN01.APPLIED.ONLINE'</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="REVERSE">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7922</con1:id>
                        <con2:expr>
                            <con1:xqueryText>'FICBCO0067.HN01.REVERSE'</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="AUTHORIZATION">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-793f</con1:id>
                        <con2:expr>
                            <con1:xqueryText>'FICBCO0067.HN01.AUTHORIZATION'</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:wsCallout>
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-785c</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>obtenerParametrizacion</con2:operation>
                        <con2:request>
                            <con2:body>REQobtenerParametrizacion</con2:body>
                        </con2:request>
                        <con2:response>
                            <con2:body>RSPobtenerParametrizacion</con2:body>
                        </con2:response>
                        <con2:requestTransform>
                            <con2:assign varName="REQobtenerParametrizacion">
                                <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-785e</con1:id>
                                <con2:expr>
                                    <con1:xqueryTransform>
                                        <con1:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                                        <con1:param name="nombreParametros">
                                            <con1:path>fn:concat(
$MERCHANTNUMBER," || ",
$MERCHANTNUMBERDEFAULT," || ",
$BUY," || ",
$REVERSE," || ",
$RATE," || ",
$PAYMENTTYPE," || ",
$CHANNEL," || ",
$CHANNELDEFAULT," || ",
$POSUSERDATA," || ",
$NUMBEROFINSTALLMENTS," || ",
$MCCTYPE," || ", 
$TRACK2LENGTH," || ",
$TRACK2DATA," || ",
$CARDVALIDATIONVALUE," || ",
$APPLIED," || ",
$APPLIEDONLINE," || ",
$AUTHORIZATION)</con1:path>
                                        </con1:param>
                                    </con1:xqueryTransform>
                                </con2:expr>
                            </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform>
                            <con2:assign varName="validationMessage">
                                <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-785d</con1:id>
                                <con2:expr>
                                    <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb:ERROR_MESSAGE/text())</con1:xqueryText>
                                </con2:expr>
                            </con2:assign>
                        </con2:responseTransform>
                    </con2:wsCallout>
                </con:actions>
            </con:stage>
            <con:stage name="InvokeAServicios">
                <con:context>
                    <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/osbConOrgSequence" prefix="osb"/>
                    <con1:userNsDecl namespace="http://www.procesa.com/fdcs/ot" prefix="io"/>
                    <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/registraPagoTC" prefix="reg2"/>
                    <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/registraPagoTCxsd" prefix="reg"/>
                </con:context>
                <con:actions>
                    <con2:assign varName="transactionType">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7712</con1:id>
                        <con2:expr>
                            <con1:xqueryText>fn:data($body/reg:registraPagoTCRequest/TRANSACTION_TYPE)</con1:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:ifThenElse>
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7714</con1:id>
                        <con2:case>
                            <con2:condition>
                                <con1:xqueryText>$transactionType='AUTHORIZATION'</con1:xqueryText>
                            </con2:condition>
                            <con2:actions>
                                <con2:wsCallout>
                                    <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7e83</con1:id>
                                    <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/MasterDataHN/conOrgSequence/biz/osbConOrgSequence_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con2:operation>osbConOrgSequence</con2:operation>
                                    <con2:request>
                                        <con2:body>REQosbConOrgSequence_db</con2:body>
                                    </con2:request>
                                    <con2:response>
                                        <con2:body>RESosbConOrgSequence_db</con2:body>
                                    </con2:response>
                                    <con2:requestTransform>
                                        <con2:assign varName="REQosbConOrgSequence_db">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7e88</con1:id>
                                            <con2:expr>
                                                <con1:xqueryTransform>
                                                    <con1:resource ref="Middleware/v2/Resources/RegistraPagoTC/xq/Tx_RegistraPagoTC_To_osbConOrgSequence_db"/>
                                                    <con1:param name="registraPagoTCRequest1">
                                                        <con1:path>$body/reg:registraPagoTCRequest</con1:path>
                                                    </con1:param>
                                                </con1:xqueryTransform>
                                            </con2:expr>
                                        </con2:assign>
                                    </con2:requestTransform>
                                    <con2:responseTransform>
                                        <con2:assign varName="org">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7e87</con1:id>
                                            <con2:expr>
                                                <con1:xqueryText>fn:data($RESosbConOrgSequence_db/osb:ORG)</con1:xqueryText>
                                            </con2:expr>
                                        </con2:assign>
                                        <con2:assign varName="sequenceValue">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7e86</con1:id>
                                            <con2:expr>
                                                <con1:xqueryText>fn:data($RESosbConOrgSequence_db/osb:SequenceValue)</con1:xqueryText>
                                            </con2:expr>
                                        </con2:assign>
                                        <con2:assign varName="errorCode">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7e85</con1:id>
                                            <con2:expr>
                                                <con1:xqueryText>fn:upper-case(fn:string($RESosbConOrgSequence_db/osb:CodigoError/text()))</con1:xqueryText>
                                            </con2:expr>
                                        </con2:assign>
                                        <con4:assign varName="validationMessage" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                                            <con2:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7e84</con2:id>
                                            <con4:expr>
                                                <con2:xqueryText>if($errorCode = '0') then(
	''
)else(
	fn:string($RESosbConOrgSequence_db/osb:MensajeError/text())
)</con2:xqueryText>
                                            </con4:expr>
                                        </con4:assign>
                                    </con2:responseTransform>
                                </con2:wsCallout>
                                <con2:ifThenElse>
                                    <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7e93</con1:id>
                                    <con2:case>
                                        <con2:condition>
                                            <con1:xqueryText>$validationMessage =''</con1:xqueryText>
                                        </con2:condition>
                                        <con2:actions>
                                            <con2:wsCallout>
                                                <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7e8f</con1:id>
                                                <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/VisionPlusHN/onlineTransactions_v4/biz/onlineTransactions_v4" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con2:operation>OnlinePaymentV4</con2:operation>
                                                <con2:request>
                                                    <con2:body>REQonlineTransactions_v4</con2:body>
                                                </con2:request>
                                                <con2:response>
                                                    <con2:body>RSPonlineTransactions_v4</con2:body>
                                                </con2:response>
                                                <con2:requestTransform>
                                                    <con2:assign varName="REQonlineTransactions_v4">
                                                        <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7e90</con1:id>
                                                        <con2:expr>
                                                            <con1:xqueryTransform>
                                                                <con1:resource ref="Middleware/v2/Resources/RegistraPagoTC/xq/Tx_RegistraPagoTC_To_OnlineTransaction"/>
                                                                <con1:param name="merchant">
                                                                    <con1:path>$MERCHANTNUMBER</con1:path>
                                                                </con1:param>
                                                                <con1:param name="merchantDefault">
                                                                    <con1:path>$MERCHANTNUMBERDEFAULT</con1:path>
                                                                </con1:param>
                                                                <con1:param name="outputParameters2">
                                                                    <con1:path>$RESosbConOrgSequence_db</con1:path>
                                                                </con1:param>
                                                                <con1:param name="outputParameters1">
                                                                    <con1:path>$RSPobtenerParametrizacion</con1:path>
                                                                </con1:param>
                                                                <con1:param name="registraPagoTCRequest1">
                                                                    <con1:path>$body/reg:registraPagoTCRequest</con1:path>
                                                                </con1:param>
                                                            </con1:xqueryTransform>
                                                        </con2:expr>
                                                    </con2:assign>
                                                </con2:requestTransform>
                                                <con2:responseTransform>
                                                    <con2:assign varName="errorCodeOnline">
                                                        <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7d82</con1:id>
                                                        <con2:expr>
                                                            <con1:xqueryText>fn:data($RSPonlineTransactions_v4/SystemAction)</con1:xqueryText>
                                                        </con2:expr>
                                                    </con2:assign>
                                                    <con2:assign varName="vPrespCode">
                                                        <con1:id>_ActionId-3320074799623921948--25185a07.17b1831eb0b.-7b35</con1:id>
                                                        <con2:expr>
                                                            <con1:xqueryText>fn:normalize-space(fn:data($RSPonlineTransactions_v4/VPrespCode))</con1:xqueryText>
                                                        </con2:expr>
                                                    </con2:assign>
                                                    <con4:assign varName="validationMessage" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                                                        <con2:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7d49</con2:id>
                                                        <con4:expr>
                                                            <con2:xqueryText>if($errorCodeOnline= 'A') then
('')
else(fn:data($RSPonlineTransactions_v4/ActionDescription))</con2:xqueryText>
                                                        </con4:expr>
                                                    </con4:assign>
                                                </con2:responseTransform>
                                            </con2:wsCallout>
                                        </con2:actions>
                                    </con2:case>
                                    <con2:default/>
                                </con2:ifThenElse>
                                <con2:ifThenElse>
                                    <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7dda</con1:id>
                                    <con2:case>
                                        <con2:condition>
                                            <con1:xqueryText>$validationMessage =''</con1:xqueryText>
                                        </con2:condition>
                                        <con2:actions>
                                            <con2:wsCallout>
                                                <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7dd6</con1:id>
                                                <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v3/BusinessServices/PAGOSWSTC/registraPagoTC/biz/registraPagoTC_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con2:operation>registraPagoTC</con2:operation>
                                                <con2:request>
                                                    <con2:body>REQRegistraPagoTC_db</con2:body>
                                                </con2:request>
                                                <con2:response>
                                                    <con2:body>RSPRegistraPagoTC_db</con2:body>
                                                </con2:response>
                                                <con2:requestTransform>
                                                    <con2:assign varName="authorizationCode">
                                                        <con1:id>_ActionId-5265594587696956244--77b06e4c.17fd7ed9a5b.-7c55</con1:id>
                                                        <con2:expr>
                                                            <con1:xqueryText>fn:data($RSPonlineTransactions_v4/AuthorizationCode)</con1:xqueryText>
                                                        </con2:expr>
                                                    </con2:assign>
                                                    <con2:assign varName="REQRegistraPagoTC_db">
                                                        <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7dd7</con1:id>
                                                        <con2:expr>
                                                            <con1:xqueryTransform>
                                                                <con1:resource ref="Middleware/v2/Resources/RegistraPagoTC/xq/Tx_RegistraPagoTC_To_RegistraPagoDB"/>
                                                                <con1:param name="merchantDefault">
                                                                    <con1:path>$MERCHANTNUMBERDEFAULT</con1:path>
                                                                </con1:param>
                                                                <con1:param name="sourceBank">
                                                                    <con1:path>$sourceBank</con1:path>
                                                                </con1:param>
                                                                <con1:param name="merchant">
                                                                    <con1:path>$MERCHANTNUMBER</con1:path>
                                                                </con1:param>
                                                                <con1:param name="destinationBank">
                                                                    <con1:path>$destinationBank</con1:path>
                                                                </con1:param>
                                                                <con1:param name="userName">
                                                                    <con1:path>$userName</con1:path>
                                                                </con1:param>
                                                                <con1:param name="authorizationCode">
                                                                    <con1:path>$authorizationCode</con1:path>
                                                                </con1:param>
                                                                <con1:param name="channelDefault">
                                                                    <con1:path>$CHANNELDEFAULT</con1:path>
                                                                </con1:param>
                                                                <con1:param name="registraPagoTCRequest1">
                                                                    <con1:path>$body/reg:registraPagoTCRequest</con1:path>
                                                                </con1:param>
                                                                <con1:param name="outputParameters1">
                                                                    <con1:path>$RESosbConOrgSequence_db</con1:path>
                                                                </con1:param>
                                                                <con1:param name="channel">
                                                                    <con1:path>$CHANNEL</con1:path>
                                                                </con1:param>
                                                                <con1:param name="outputParameters2">
                                                                    <con1:path>$RSPobtenerParametrizacion</con1:path>
                                                                </con1:param>
                                                                <con1:param name="paymentType">
                                                                    <con1:path>$PAYMENTTYPE</con1:path>
                                                                </con1:param>
                                                            </con1:xqueryTransform>
                                                        </con2:expr>
                                                    </con2:assign>
                                                </con2:requestTransform>
                                                <con2:responseTransform>
                                                    <con2:assign varName="errorCode">
                                                        <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7cf5</con1:id>
                                                        <con2:expr>
                                                            <con1:xqueryText>fn:upper-case(fn:string($RSPRegistraPagoTC_db/reg2:PV_ERRORCODE/text()))</con1:xqueryText>
                                                        </con2:expr>
                                                    </con2:assign>
                                                    <con4:assign varName="validationMessage" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                                                        <con2:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7cbc</con2:id>
                                                        <con4:expr>
                                                            <con2:xqueryText>if($errorCode != 'ERROR')
then('')
else(fn:upper-case(fn:string($RSPRegistraPagoTC_db/reg2:PV_ERRORMESSAGE/text())))</con2:xqueryText>
                                                        </con4:expr>
                                                    </con4:assign>
                                                </con2:responseTransform>
                                            </con2:wsCallout>
                                            <con2:ifThenElse xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config">
                                                <con1:id>_ActionId-6061600214708263107-7beb0c03.18b9239fd7b.-7bb4</con1:id>
                                                <con2:case>
                                                    <con2:condition>
                                                        <con1:xqueryText>$errorCode != 'ERROR'</con1:xqueryText>
                                                    </con2:condition>
                                                    <con2:actions>
                                                        <con5:route>
                                                            <con1:id>_ActionId-6061600214708263107-7beb0c03.18b9239fd7b.-7bb3</con1:id>
                                                            <con5:service ref="Middleware/v3/BusinessServices/MasterData/HN/conRegistraPagoTCRG/biz/conRegistraPagoTCRG_db" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con5:operation>conRegistraPagoTCRG</con5:operation>
                                                            <con5:outboundTransform>
                                                                <con2:assign varName="BodyRegistraPagoTCMD">
                                                                    <con1:id>_ActionId-2812998837969348296-28d37a00.18e6876597f.-3a82</con1:id>
                                                                    <con2:expr>
                                                                        <con1:xqueryTransform>
                                                                            <con1:resource ref="Middleware/v2/Resources/RegistraPagoTC/xq/Tx_RegistraPagoTC_To_RegistraPagoDBMD"/>
                                                                            <con1:param name="merchantDefault">
                                                                                <con1:path>$MERCHANTNUMBERDEFAULT</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="sourceBank">
                                                                                <con1:path>$sourceBank</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="merchant">
                                                                                <con1:path>$MERCHANTNUMBER</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="destinationBank">
                                                                                <con1:path>$destinationBank</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="userName">
                                                                                <con1:path>$userName</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="authorizationCode">
                                                                                <con1:path>$authorizationCode</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="channelDefault">
                                                                                <con1:path>$CHANNELDEFAULT</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="registraPagoTCRequest1">
                                                                                <con1:path>$body/reg:registraPagoTCRequest</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="outputParameters1">
                                                                                <con1:path>$RESosbConOrgSequence_db</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="channel">
                                                                                <con1:path>$CHANNEL</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="outputParameters2">
                                                                                <con1:path>$RSPobtenerParametrizacion</con1:path>
                                                                            </con1:param>
                                                                            <con1:param name="paymentType">
                                                                                <con1:path>$PAYMENTTYPE</con1:path>
                                                                            </con1:param>
                                                                        </con1:xqueryTransform>
                                                                    </con2:expr>
                                                                </con2:assign>
                                                                <con2:replace contents-only="true" varName="body">
                                                                    <con1:id>_ActionId-6061600214708263107-7beb0c03.18b9239fd7b.-7bb2</con1:id>
                                                                    <con2:location>
                                                                        <con1:xpathText>.</con1:xpathText>
                                                                    </con2:location>
                                                                    <con2:expr>
                                                                        <con1:xqueryText>$BodyRegistraPagoTCMD</con1:xqueryText>
                                                                    </con2:expr>
                                                                </con2:replace>
                                                            </con5:outboundTransform>
                                                        </con5:route>
                                                    </con2:actions>
                                                </con2:case>
                                                <con2:default/>
                                            </con2:ifThenElse>
                                        </con2:actions>
                                    </con2:case>
                                    <con2:default/>
                                </con2:ifThenElse>
                            </con2:actions>
                        </con2:case>
                        <con2:default>
                            <con2:assign varName="org">
                                <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-7f9c</con1:id>
                                <con2:expr>
                                    <con1:xqueryText>fn:data($body/reg:registraPagoTCRequest/ORG)</con1:xqueryText>
                                </con2:expr>
                            </con2:assign>
                            <con2:assign varName="SEQ">
                                <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-6332</con1:id>
                                <con2:expr>
                                    <con1:xqueryText>fn:data($body/reg:registraPagoTCRequest/SECUENCIAL_NUMBER)</con1:xqueryText>
                                </con2:expr>
                            </con2:assign>
                            <con2:wsCallout>
                                <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-74f2</con1:id>
                                <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/VisionPlusHN/onlineTransactions_v4/biz/onlineTransactions_v4" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                <con2:operation>OnlinePaymentV4</con2:operation>
                                <con2:request>
                                    <con2:body>REQonlineTransactions_v4</con2:body>
                                </con2:request>
                                <con2:response>
                                    <con2:body>RSPonlineTransactions_v4</con2:body>
                                </con2:response>
                                <con2:requestTransform>
                                    <con2:assign varName="REQonlineTransactions_v4">
                                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-74f3</con1:id>
                                        <con2:expr>
                                            <con1:xqueryTransform>
                                                <con1:resource ref="Middleware/v2/Resources/RegistraPagoTC/xq/Tx_RegistraPagoTC_To_OnlineTransactionReversion"/>
                                                <con1:param name="merchant">
                                                    <con1:path>$MERCHANTNUMBER</con1:path>
                                                </con1:param>
                                                <con1:param name="SEQ">
                                                    <con1:path>$SEQ</con1:path>
                                                </con1:param>
                                                <con1:param name="merchantDefault">
                                                    <con1:path>$MERCHANTNUMBERDEFAULT</con1:path>
                                                </con1:param>
                                                <con1:param name="outputParameters1">
                                                    <con1:path>$RSPobtenerParametrizacion</con1:path>
                                                </con1:param>
                                                <con1:param name="registraPagoTCRequest1">
                                                    <con1:path>$body/reg:registraPagoTCRequest</con1:path>
                                                </con1:param>
                                                <con1:param name="ORG">
                                                    <con1:path>$org</con1:path>
                                                </con1:param>
                                            </con1:xqueryTransform>
                                        </con2:expr>
                                    </con2:assign>
                                </con2:requestTransform>
                                <con2:responseTransform>
                                    <con2:assign varName="errorCode">
                                        <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7c68</con1:id>
                                        <con2:expr>
                                            <con1:xqueryText>fn:data($RSPonlineTransactions_v4/SystemAction)</con1:xqueryText>
                                        </con2:expr>
                                    </con2:assign>
                                    <con4:assign varName="validationMessage" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                                        <con2:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7c2f</con2:id>
                                        <con4:expr>
                                            <con2:xqueryText>if($errorCode= 'A') then
('')
else(fn:data($RSPonlineTransactions_v4/ActionDescription))</con2:xqueryText>
                                        </con4:expr>
                                    </con4:assign>
                                </con2:responseTransform>
                            </con2:wsCallout>
                            <con2:ifThenElse>
                                <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7bf5</con1:id>
                                <con2:case>
                                    <con2:condition>
                                        <con1:xqueryText>$validationMessage =''</con1:xqueryText>
                                    </con2:condition>
                                    <con2:actions>
                                        <con2:wsCallout>
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7bf1</con1:id>
                                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v3/BusinessServices/PAGOSWSTC/registraPagoTC/biz/registraPagoTC_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                            <con2:operation>registraPagoTC</con2:operation>
                                            <con2:request>
                                                <con2:body>REQRegistraPagoTC_db</con2:body>
                                            </con2:request>
                                            <con2:response>
                                                <con2:body>RSPRegistraPagoTC_db</con2:body>
                                            </con2:response>
                                            <con2:requestTransform>
                                                <con2:assign varName="REQRegistraPagoTC_db">
                                                    <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7bf2</con1:id>
                                                    <con2:expr>
                                                        <con1:xqueryTransform>
                                                            <con1:resource ref="Middleware/v2/Resources/RegistraPagoTC/xq/Tx_RegistraPagoTC_To_RegistraPagoDBReversion"/>
                                                            <con1:param name="merchant">
                                                                <con1:path>$MERCHANTNUMBER</con1:path>
                                                            </con1:param>
                                                            <con1:param name="destinationBank">
                                                                <con1:path>$destinationBank</con1:path>
                                                            </con1:param>
                                                            <con1:param name="merchantDefault">
                                                                <con1:path>$MERCHANTNUMBERDEFAULT</con1:path>
                                                            </con1:param>
                                                            <con1:param name="paymentType">
                                                                <con1:path>$PAYMENTTYPE</con1:path>
                                                            </con1:param>
                                                            <con1:param name="channel">
                                                                <con1:path>$CHANNEL</con1:path>
                                                            </con1:param>
                                                            <con1:param name="outputParameters2">
                                                                <con1:path>$RSPobtenerParametrizacion</con1:path>
                                                            </con1:param>
                                                            <con1:param name="sourceBank">
                                                                <con1:path>$sourceBank</con1:path>
                                                            </con1:param>
                                                            <con1:param name="channelDefault">
                                                                <con1:path>$CHANNELDEFAULT</con1:path>
                                                            </con1:param>
                                                            <con1:param name="userName">
                                                                <con1:path>$userName</con1:path>
                                                            </con1:param>
                                                            <con1:param name="registraPagoTCRequest1">
                                                                <con1:path>$body/reg:registraPagoTCRequest</con1:path>
                                                            </con1:param>
                                                            <con1:param name="ORG">
                                                                <con1:path>$org</con1:path>
                                                            </con1:param>
                                                        </con1:xqueryTransform>
                                                    </con2:expr>
                                                </con2:assign>
                                            </con2:requestTransform>
                                            <con2:responseTransform>
                                                <con2:assign varName="errorCode">
                                                    <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7b9d</con1:id>
                                                    <con2:expr>
                                                        <con1:xqueryText>fn:upper-case(fn:string($RSPRegistraPagoTC_db/reg2:PV_ERRORCODE/text()))</con1:xqueryText>
                                                    </con2:expr>
                                                </con2:assign>
                                                <con4:assign varName="validationMessage" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                                                    <con2:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7b64</con2:id>
                                                    <con4:expr>
                                                        <con2:xqueryText>if($errorCode != 'ERROR')
then('')
else(fn:upper-case(fn:string($RSPRegistraPagoTC_db/reg2:PV_ERRORMESSAGE/text())))</con2:xqueryText>
                                                    </con4:expr>
                                                </con4:assign>
                                            </con2:responseTransform>
                                        </con2:wsCallout>
                                    </con2:actions>
                                </con2:case>
                                <con2:default/>
                            </con2:ifThenElse>
                            <con2:ifThenElse xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/routing/config">
                                <con1:id>_ActionId-6061600214708263107-7beb0c03.18b9239fd7b.-7b3e</con1:id>
                                <con2:case>
                                    <con2:condition>
                                        <con1:xqueryText>$errorCode != 'ERROR'</con1:xqueryText>
                                    </con2:condition>
                                    <con2:actions>
                                        <con5:route>
                                            <con1:id>_ActionId-6061600214708263107-7beb0c03.18b9239fd7b.-7b3d</con1:id>
                                            <con5:service ref="Middleware/v3/BusinessServices/MasterData/conRegistraPagoTCRG/biz/conRegistraPagoTCRG_db" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                            <con5:operation>conRegistraPagoTCRG</con5:operation>
                                            <con5:outboundTransform>
                                                <con2:assign varName="BodyRegistraReversionTCMD">
                                                    <con1:id>_ActionId-2812998837969348296-28d37a00.18e6876597f.-3a6f</con1:id>
                                                    <con2:expr>
                                                        <con1:xqueryTransform>
                                                            <con1:resource ref="Middleware/v2/Resources/RegistraPagoTC/xq/Tx_RegistraPagoTC_To_RegistraPagoDBMDReversion"/>
                                                            <con1:param name="merchantDefault">
                                                                <con1:path>$MERCHANTNUMBERDEFAULT</con1:path>
                                                            </con1:param>
                                                            <con1:param name="sourceBank">
                                                                <con1:path>$sourceBank</con1:path>
                                                            </con1:param>
                                                            <con1:param name="merchant">
                                                                <con1:path>$MERCHANTNUMBER</con1:path>
                                                            </con1:param>
                                                            <con1:param name="destinationBank">
                                                                <con1:path>$destinationBank</con1:path>
                                                            </con1:param>
                                                            <con1:param name="userName">
                                                                <con1:path>$userName</con1:path>
                                                            </con1:param>
                                                            <con1:param name="channelDefault">
                                                                <con1:path>$CHANNELDEFAULT</con1:path>
                                                            </con1:param>
                                                            <con1:param name="registraPagoTCRequest1">
                                                                <con1:path>$body/reg:registraPagoTCRequest</con1:path>
                                                            </con1:param>
                                                            <con1:param name="ORG">
                                                                <con1:path>$org</con1:path>
                                                            </con1:param>
                                                            <con1:param name="channel">
                                                                <con1:path>$CHANNEL</con1:path>
                                                            </con1:param>
                                                            <con1:param name="outputParameters2">
                                                                <con1:path>$RSPobtenerParametrizacion</con1:path>
                                                            </con1:param>
                                                            <con1:param name="paymentType">
                                                                <con1:path>$PAYMENTTYPE</con1:path>
                                                            </con1:param>
                                                        </con1:xqueryTransform>
                                                    </con2:expr>
                                                </con2:assign>
                                                <con2:replace contents-only="true" varName="body">
                                                    <con1:id>_ActionId-6061600214708263107-7beb0c03.18b9239fd7b.-7b3c</con1:id>
                                                    <con2:location>
                                                        <con1:xpathText>.</con1:xpathText>
                                                    </con2:location>
                                                    <con2:expr>
                                                        <con1:xqueryText>$BodyRegistraReversionTCMD</con1:xqueryText>
                                                    </con2:expr>
                                                </con2:replace>
                                            </con5:outboundTransform>
                                        </con5:route>
                                    </con2:actions>
                                </con2:case>
                                <con2:default/>
                            </con2:ifThenElse>
                        </con2:default>
                    </con2:ifThenElse>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline type="response" name="RegistraPagoTC_response">
            <con:stage name="TxResponse">
                <con:context>
                    <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/registraPagoTCxsd" prefix="reg"/>
                </con:context>
                <con:actions>
                    <con2:ifThenElse>
                        <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7af2</con1:id>
                        <con2:case>
                            <con2:condition>
                                <con1:xqueryText>$validationMessage =''</con1:xqueryText>
                            </con2:condition>
                            <con2:actions>
                                <con2:ifThenElse>
                                    <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7ab6</con1:id>
                                    <con2:case>
                                        <con2:condition>
                                            <con1:xqueryText>$transactionType='AUTHORIZATION'</con1:xqueryText>
                                        </con2:condition>
                                        <con2:actions>
                                            <con2:replace varName="header" contents-only="true">
                                                <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7ab4</con1:id>
                                                <con2:expr>
                                                    <con1:xqueryText>&lt;aut:ResponseHeader>
      &lt;successIndicator>SUCCESS&lt;/successIndicator>
&lt;/aut:ResponseHeader></con1:xqueryText>
                                                </con2:expr>
                                            </con2:replace>
                                            <con2:replace varName="body" contents-only="true">
                                                <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7ab2</con1:id>
                                                <con2:expr>
                                                    <con1:xqueryTransform>
                                                        <con1:resource ref="Middleware/v2/Resources/RegistraPagoTC/xq/Tx_RegistraPagoTC_Response"/>
                                                        <con1:param name="onlinePaymentV4Response1">
                                                            <con1:path>$RSPonlineTransactions_v4</con1:path>
                                                        </con1:param>
                                                        <con1:param name="sequenceValue">
                                                            <con1:path>$sequenceValue</con1:path>
                                                        </con1:param>
                                                        <con1:param name="ORG">
                                                            <con1:path>$org</con1:path>
                                                        </con1:param>
                                                    </con1:xqueryTransform>
                                                </con2:expr>
                                            </con2:replace>
                                        </con2:actions>
                                    </con2:case>
                                    <con2:default>
                                        <con2:replace varName="header" contents-only="true">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7ab0</con1:id>
                                            <con2:expr>
                                                <con1:xqueryText>&lt;aut:ResponseHeader>
      &lt;successIndicator>SUCCESS&lt;/successIndicator>
&lt;/aut:ResponseHeader></con1:xqueryText>
                                            </con2:expr>
                                        </con2:replace>
                                        <con2:replace varName="body" contents-only="true">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7aae</con1:id>
                                            <con2:expr>
                                                <con1:xqueryTransform>
                                                    <con1:resource ref="Middleware/v2/Resources/RegistraPagoTC/xq/Tx_RegistraPagoTC_Response"/>
                                                    <con1:param name="onlinePaymentV4Response1">
                                                        <con1:path>$RSPonlineTransactions_v4</con1:path>
                                                    </con1:param>
                                                    <con1:param name="sequenceValue">
                                                        <con1:path>$SEQ</con1:path>
                                                    </con1:param>
                                                    <con1:param name="ORG">
                                                        <con1:path>$org</con1:path>
                                                    </con1:param>
                                                </con1:xqueryTransform>
                                            </con2:expr>
                                        </con2:replace>
                                    </con2:default>
                                </con2:ifThenElse>
                            </con2:actions>
                        </con2:case>
                        <con2:default>
                            <con4:replace contents-only="true" varName="header" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                                <con2:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7a24</con2:id>
                                <con4:expr>
                                    <con2:xqueryText><![CDATA[if ($errorCodeOnline='D')
then
<aut:ResponseHeader>
	<messageId>{'-1'}</messageId>
	{
	if ($vPrespCode='')	
	then
	<successIndicator>{'-1'}</successIndicator>
	else
    <successIndicator>{$vPrespCode}</successIndicator>
    }
    <messages>{ $validationMessage }</messages>
</aut:ResponseHeader>
else
<aut:ResponseHeader>
	<messageId>{'-1'}</messageId>
    <successIndicator>{ 'ERROR' }</successIndicator>
    <messages>{ $validationMessage }</messages>
</aut:ResponseHeader>]]></con2:xqueryText>
                                </con4:expr>
                            </con4:replace>
                            <con4:replace contents-only="true" varName="body" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                                <con2:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-79eb</con2:id>
                                <con4:expr>
                                    <con2:xqueryText>&lt;reg:registraPagoTCResponse/></con2:xqueryText>
                                </con4:expr>
                            </con4:replace>
                        </con2:default>
                    </con2:ifThenElse>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline type="error" name="_onErrorHandler-800248121596613693--793085b0.17a1be65112.-7289">
            <con:stage name="ErrorProxy">
                <con:context xmlns:con6="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con5="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/stages/logging/config">
                    <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/registraPagoTCxsd" prefix="cons"/>
                    <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
                </con:context>
                <con:actions xmlns:con6="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con5="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/stages/logging/config">
                    <con2:replace contents-only="true" varName="header">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7206</con1:id>
                        <con2:expr>
                            <con1:xqueryText><![CDATA[<aut:ResponseHeader>
<successIndicator>ERROR</successIndicator>
<messages>{ concat(fn:string($fault/ctx:errorCode/text()), ": ", fn:string($fault/ctx:reason/text())) }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                        </con2:expr>
                    </con2:replace>
                    <con2:replace contents-only="true" varName="body">
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7205</con1:id>
                        <con2:expr>
                            <con1:xqueryText>&lt;cons:registraPagoTCResponse/></con1:xqueryText>
                        </con2:expr>
                    </con2:replace>
                    <con1:assign varName="uuidBitacoraError" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con7:id xmlns:con7="http://www.bea.com/wli/sb/stages/config">_ActionId-800248121596613693--793085b0.17a1be65112.-7204</con7:id>
                        <con1:expr>
                            <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                <con4:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                            </con4:xqueryTransform>
                        </con1:expr>
                    </con1:assign>
                    <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con7:id xmlns:con7="http://www.bea.com/wli/sb/stages/config">_ActionId-800248121596613693--793085b0.17a1be65112.-7203</con7:id>
                        <con2:service ref="Middleware/v2/BusinessServices/registroBitacoraConvenios/biz/registroBitacoraConvenios" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:outboundTransform>
                            <con1:assign varName="timestampBitacoraError">
                                <con7:id xmlns:con7="http://www.bea.com/wli/sb/stages/config">_ActionId-800248121596613693--793085b0.17a1be65112.-7202</con7:id>
                                <con1:expr>
                                    <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                        <con4:resource ref="Middleware/Business_Resources/general/TimeStamp/obtenerTimestamp"/>
                                    </con4:xqueryTransform>
                                </con1:expr>
                            </con1:assign>
                            <con1:replace contents-only="true" varName="body">
                                <con7:id xmlns:con7="http://www.bea.com/wli/sb/stages/config">_ActionId-800248121596613693--793085b0.17a1be65112.-7201</con7:id>
                                <con1:expr>
                                    <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                        <con4:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/registrarBitacoraResponseIn"/>
                                        <con4:param name="uuidBitacoraRequest">
                                            <con4:path>$uuidBitacoraRequest</con4:path>
                                        </con4:param>
                                        <con4:param name="requestHeader">
                                            <con4:path>$originalRequestHeader/aut:RequestHeader</con4:path>
                                        </con4:param>
                                        <con4:param name="pagoRecaudoResponse">
                                            <con4:path>$body/pag:pagoRecaudoResponse</con4:path>
                                        </con4:param>
                                        <con4:param name="dateTimeBitacora">
                                            <con4:path>$timestampBitacoraError</con4:path>
                                        </con4:param>
                                        <con4:param name="pagoRecaudo">
                                            <con4:path>$originalRequestBody/pag:pagoRecaudo</con4:path>
                                        </con4:param>
                                        <con4:param name="uuidBitacora">
                                            <con4:path>$uuidBitacoraError</con4:path>
                                        </con4:param>
                                        <con4:param name="traceProxy">
                                            <con4:path>fn:string($traceProxy)</con4:path>
                                        </con4:param>
                                        <con4:param name="responseHeader">
                                            <con4:path>$header/aut:ResponseHeader</con4:path>
                                        </con4:param>
                                    </con4:xqueryTransform>
                                </con1:expr>
                            </con1:replace>
                        </con2:outboundTransform>
                    </con2:route>
                    <con6:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/pipeline/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
                        <con:id>_ActionId-800248121596613693--793085b0.17a1be65112.-7200</con:id>
                        <con6:case>
                            <con6:condition>
                                <con:xqueryText>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) != "SUCCESS"</con:xqueryText>
                            </con6:condition>
                            <con6:actions>
                                <con6:wsCallout>
                                    <con:id>_ActionId-800248121596613693--793085b0.17a1be65112.-71fd</con:id>
                                    <con6:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con6:operation>mapeoErrores</con6:operation>
                                    <con6:request>
                                        <con6:body>REQMapeoErrores</con6:body>
                                    </con6:request>
                                    <con6:response>
                                        <con6:body>RSPMapeoErrores</con6:body>
                                    </con6:response>
                                    <con6:requestTransform>
                                        <con6:assign varName="REQMapeoErrores">
                                            <con:id>_ActionId-800248121596613693--793085b0.17a1be65112.-71ff</con:id>
                                            <con6:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                                                    <con:param name="CODIGO_ERROR">
                                                        <con:path>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text()))</con:path>
                                                    </con:param>
                                                    <con:param name="MENSAJE_ERROR">
                                                        <con:path>fn:concat("FICBCO0067","$#$",fn:string-join($header/aut:ResponseHeader/messages, '||'))</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con6:expr>
                                        </con6:assign>
                                    </con6:requestTransform>
                                    <con6:responseTransform>
                                        <con6:replace varName="header" contents-only="true">
                                            <con:id>_ActionId-800248121596613693--793085b0.17a1be65112.-71fe</con:id>
                                            <con6:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                                                    <con:param name="mapeoErroresResponse1">
                                                        <con:path>$RSPMapeoErrores</con:path>
                                                    </con:param>
                                                    <con:param name="successIndicator">
                                                        <con:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con6:expr>
                                        </con6:replace>
                                    </con6:responseTransform>
                                </con6:wsCallout>
                            </con6:actions>
                        </con6:case>
                        <con6:default/>
                    </con6:ifThenElse>
                    <con1:reply>
                        <con1:id>_ActionId-800248121596613693--793085b0.17a1be65112.-71fc</con1:id>
                    </con1:reply>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:flow>
            <con:pipeline-node name="RegistraPagoTC">
                <con:request>RegistraPagoTC_request</con:request>
                <con:response>RegistraPagoTC_response</con:response>
            </con:pipeline-node>
        </con:flow>
    </con:router>
</con:pipelineEntry>