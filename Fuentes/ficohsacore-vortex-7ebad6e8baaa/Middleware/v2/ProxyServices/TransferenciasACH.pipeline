<?xml version="1.0" encoding="UTF-8"?>
<con:pipelineEntry xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:oper="http://xmlns.oracle.com/servicebus/pipeline/operations">
    <con:coreEntry>
        <con:binding type="SOAP" isSoap12="false" xsi:type="con:SoapBindingType">
            <con:wsdl ref="Middleware/v2/Resources/TransferenciasACH/wsdl/transferenciasACHPS"/>
            <con:binding>
                <con:name>transferenciasACHPSSOAP</con:name>
                <con:namespace>http://www.ficohsa.com.hn/middleware.services/transferenciasACHPS/</con:namespace>
            </con:binding>
        </con:binding>
        <oper:operations>
            <oper:monitoring enabled="true" aggregationInterval="720" level="action"/>
            <oper:tracingEnabled>false</oper:tracingEnabled>
            <oper:reporting>true</oper:reporting>
            <oper:logging enabled="true" level="debug"/>
            <oper:sla-alerting enabled="true" level="normal"/>
            <oper:pipeline-alerting enabled="true" level="normal"/>
        </oper:operations>
    </con:coreEntry>
    <con3:router errorHandler="_onErrorHandler-8848777042473091319--23eafd38.13c2a05c9f3.-6d24" xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:con="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/pipeline/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con5="http://www.bea.com/wli/sb/stages/logging/config">
        <con3:pipeline type="error" name="_onErrorHandler-8848777042473091319--23eafd38.13c2a05c9f3.-6d24">
            <con3:stage name="EliminarTransferencia">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse xmlns:con4="http://www.bea.com/wli/sb/pipeline/config" xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
                        <con:id>_ActionId-1789930570681492119--6a3ab08.15cc63d7c50.-7cfd</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>fn:string($tranFT) != ""</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:wsCallout xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con3="http://www.bea.com/wli/sb/pipeline/config">
                                    <con:id>_ActionId-1789930570681492119--6a3ab08.15cc63d7c50.-7cfb</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/ReversarTransaccion/Resources/ReverseTransaccionBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>EliminaciondetransaccionFTihld</con1:operation>
                                    <con1:request>
                                        <con1:body>REQelimTransferencia</con1:body>
                                    </con1:request>
                                    <con1:response>
                                        <con1:body>RSPelimTransferencia</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                        <con1:assign varName="REQelimTransferencia">
                                            <con:id>_ActionId-1789930570681492119--6a3ab08.15cc63d7c50.-7cfc</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/eliminaFtACHIn"/>
                                                    <con:param name="FT">
                                                        <con:path>$tranFT</con:path>
                                                    </con:param>
                                                    <con:param name="requestHeader1">
                                                        <con:path>$header/aut:RequestHeader</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform/>
                                </con1:wsCallout>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
            <con3:stage name="ManejoError">
                <con4:context xmlns:con3="http://www.bea.com/wli/sb/services/security/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
                    <con:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/ValidaServicioRegional" prefix="val"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaFICOPENTypes" prefix="con"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                </con4:context>
                <con4:actions xmlns:con3="http://www.bea.com/wli/sb/services/security/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
                    <con2:assign varName="errorCode" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config">
                        <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7d05</con6:id>
                        <con2:expr>
                            <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">fn:string($fault/ctx:errorCode/text())</con6:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con2:assign varName="errorMessage" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config">
                        <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7ccc</con6:id>
                        <con2:expr>
                            <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">fn:string($fault/ctx:reason/text())</con6:xqueryText>
                        </con2:expr>
                    </con2:assign>
                    <con1:replace contents-only="true" varName="header">
                        <con:id>_ActionId-8848777042473091319--23eafd38.13c2a05c9f3.-6cea</con:id>
                        <con1:expr>
                            <con:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{ concat(fn:string($fault/ctx:errorCode/text()), ": ", fn:string($fault/ctx:reason/text())) }</messages>
</aut:ResponseHeader>]]></con:xqueryText>
                        </con1:expr>
                    </con1:replace>
                    <con1:replace contents-only="true" varName="body">
                        <con:id>_ActionId-8848777042473091319--23eafd38.13c2a05c9f3.-6ce9</con:id>
                        <con1:expr>
                            <con:xqueryText>&lt;tran:transferenciasACHResponse/></con:xqueryText>
                        </con1:expr>
                    </con1:replace>
                    <con1:ifThenElse>
                        <con:id>_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7db5</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>upper-case(fn:string($reqValidaServicioRegional/val:PV_ORIGEN/text())) != 'NI01'</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:replace varName="header" contents-only="true" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con3="http://www.bea.com/wli/sb/pipeline/config">
                                    <con:id>_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7db3</con:id>
                                    <con1:expr>
                                        <con:xqueryText><![CDATA[<aut:ResponseHeader>
    <messageId>
    {  
    	if(fn:matches($reasonCode,'^([R|F][0-9]{2}|[0-9]{4})$')) then
    		$reasonCode
    	else
    		'R31'
    }
    </messageId>
    <successIndicator>{ fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) }</successIndicator>
	<messages>
	{
		if(fn:matches($header/aut:ResponseHeader/messages,'^[R|F][0-9]{2}[\-]{1}[0-9a-zA-Z]')) then
			xs:string($header/aut:ResponseHeader/messages/text())
		else
			if(fn:matches($header/aut:ResponseHeader/messages,'^[0-9]{4}[\-]{1}[0-9a-zA-Z]')) then
				xs:string($header/aut:ResponseHeader/messages/text())
			else
				fn:concat('R31-',xs:string($header/aut:ResponseHeader/messages/text()))  
	}
	</messages>
</aut:ResponseHeader>]]></con:xqueryText>
                                    </con1:expr>
                                </con1:replace>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con2:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config">
                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7c57</con6:id>
                                <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                <con2:operation>mapeoErrores</con2:operation>
                                <con2:request>
                                    <con2:body>reqMapeoErrores</con2:body>
                                </con2:request>
                                <con2:response>
                                    <con2:body>respMapeoErrores</con2:body>
                                </con2:response>
                                <con2:requestTransform>
                                    <con2:assign varName="reqMapeoErrores">
                                        <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7c59</con6:id>
                                        <con2:expr>
                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                <con6:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                                                <con6:param name="CODIGO_ERROR">
                                                    <con6:path>$errorCode</con6:path>
                                                </con6:param>
                                                <con6:param name="MENSAJE_ERROR">
                                                    <con6:path>fn:concat("FICBCO0257", "$#$", $errorMessage)</con6:path>
                                                </con6:param>
                                            </con6:xqueryTransform>
                                        </con2:expr>
                                    </con2:assign>
                                </con2:requestTransform>
                                <con2:responseTransform>
                                    <con2:replace contents-only="true" varName="header">
                                        <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7c58</con6:id>
                                        <con2:expr>
                                            <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                <con6:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                                                <con6:param name="mapeoErroresResponse1">
                                                    <con6:path>$respMapeoErrores</con6:path>
                                                </con6:param>
                                                <con6:param name="successIndicator">
                                                    <con6:path>$errorCode</con6:path>
                                                </con6:param>
                                            </con6:xqueryTransform>
                                        </con2:expr>
                                    </con2:replace>
                                </con2:responseTransform>
                            </con2:wsCallout>
                        </con1:default>
                    </con1:ifThenElse>
                </con4:actions>
            </con3:stage>
            <con3:stage name="BitacoraResponseError">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-2610459578228753383-1aa70613.16ae5802f12.-7d0e</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>fn:string($uuidBitacoraRequest) !=''</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:assign varName="uuidBitacoraError">
                                    <con:id>_ActionId-2610459578228753383-1aa70613.16ae5802f12.-7ce9</con:id>
                                    <con1:expr>
                                        <con:xqueryTransform>
                                            <con:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                                        </con:xqueryTransform>
                                    </con1:expr>
                                </con1:assign>
                                <con4:route>
                                    <con:id>_ActionId-2610459578228753383-1aa70613.16ae5802f12.-7cd1</con:id>
                                    <con4:service ref="Middleware/v2/BusinessServices/OSB/RegistrarBitacoraOSB_v2/biz/RegistrarBitacoraOSB_v2" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con4:operation>registrarBitacoraOSB</con4:operation>
                                    <con4:outboundTransform>
                                        <con1:replace varName="body" contents-only="true">
                                            <con:id>_ActionId-2610459578228753383-1aa70613.16ae5802f12.-7cc4</con:id>
                                            <con1:location>
                                                <con:xpathText>.</con:xpathText>
                                            </con1:location>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/Generales/xq/registrarBitacoraOSBIn"/>
                                                    <con:param name="Uuid">
                                                        <con:path>$uuidBitacoraError</con:path>
                                                    </con:param>
                                                    <con:param name="IdOperacion">
                                                        <con:path>fn:string($operation)</con:path>
                                                    </con:param>
                                                    <con:param name="IdOsb">
                                                        <con:path>fn:string($inbound/ctx:transport/ctx:request/tp:headers/http:Host/text())</con:path>
                                                    </con:param>
                                                    <con:param name="IdServicio">
                                                        <con:path>"FICBCO0057"</con:path>
                                                    </con:param>
                                                    <con:param name="MensajeError">
                                                        <con:path>string($header/aut:ResponseHeader/messages/text())</con:path>
                                                    </con:param>
                                                    <con:param name="IdTxn">
                                                        <con:path>fn:string($header/aut:ResponseHeader/transactionId/text())</con:path>
                                                    </con:param>
                                                    <con:param name="UuidReq">
                                                        <con:path>$uuidBitacoraRequest</con:path>
                                                    </con:param>
                                                    <con:param name="Resultado">
                                                        <con:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con:path>
                                                    </con:param>
                                                    <con:param name="Usuario">
                                                        <con:path>string($originalHeader/aut:RequestHeader/Authentication/UserName/text())</con:path>
                                                    </con:param>
                                                    <con:param name="BancoOrigen">
                                                        <con:path>string($originalHeader/aut:RequestHeader/Region/SourceBank/text())</con:path>
                                                    </con:param>
                                                    <con:param name="BancoDestino">
                                                        <con:path>fn:string($header/aut:RequestHeader/Region/DestinationBank/text())</con:path>
                                                    </con:param>
                                                    <con:param name="Contenido">
                                                        <con:path>$body</con:path>
                                                    </con:param>
                                                    <con:param name="TipoMensaje">
                                                        <con:path>"RSP"</con:path>
                                                    </con:param>
                                                    <con:param name="FechaTxn">
                                                        <con:path>fn:adjust-date-to-timezone(current-date(), ())</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:replace>
                                    </con4:outboundTransform>
                                </con4:route>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                    <con:reply xmlns:con4="http://www.bea.com/wli/sb/pipeline/config" xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
                        <con:id>_ActionId-2610459578228753383-1aa70613.16ae5802f12.-7cc0</con:id>
                    </con:reply>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="request" name="ValidacionesGenerales_request">
            <con3:stage name="ValidacionXSD">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                </con3:context>
                <con3:actions>
                    <con1:validate>
                        <con:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7f06</con:id>
                        <con1:schema ref="Middleware/v2/Resources/TransferenciasACH/xsd/transferenciasACHType"/>
                        <con1:schemaElement xmlns:tran1="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType">tran1:transferenciasACHRequest</con1:schemaElement>
                        <con1:varName>body</con1:varName>
                        <con1:location>
                            <con:xpathText>./tran:transferenciasACHRequest</con:xpathText>
                        </con1:location>
                    </con1:validate>
                </con3:actions>
            </con3:stage>
            <con3:stage name="ValidacionServicioRegional">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                    <con:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/ValidaServicioRegional" prefix="val"/>
                </con3:context>
                <con3:actions>
                    <con1:wsCallout>
                        <con:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7ece</con:id>
                        <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ValidaServicioRegional/biz/ValidaServicioRegional_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>ValidaServicioRegional</con1:operation>
                        <con1:request>
                            <con1:body>reqValidaServicioRegional</con1:body>
                        </con1:request>
                        <con1:response>
                            <con1:body>respValidaServicioRegional</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                            <con1:assign varName="reqValidaServicioRegional">
                                <con:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7e2a</con:id>
                                <con1:expr>
                                    <con:xqueryTransform>
                                        <con:resource ref="Middleware/v2/Resources/Generales/xq/validaServicioRegionalIn"/>
                                        <con:param name="requestHeader1">
                                            <con:path>$header/aut:RequestHeader</con:path>
                                        </con:param>
                                        <con:param name="serviceId">
                                            <con:path>"FICBCO0057"</con:path>
                                        </con:param>
                                    </con:xqueryTransform>
                                </con1:expr>
                            </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                            <con1:ifThenElse>
                                <con:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7df2</con:id>
                                <con1:case>
                                    <con1:condition>
                                        <con:xqueryText>fn:string($respValidaServicioRegional/val:PV_CODIGO_ERROR/text()) != 'SUCCESS'</con:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                        <con1:replace contents-only="true" varName="header">
                                            <con:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7dba</con:id>
                                            <con1:expr>
                                                <con:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{fn:string($respValidaServicioRegional/val:PV_MENSAJE_ERROR/text())}</messages>
</aut:ResponseHeader>]]></con:xqueryText>
                                            </con1:expr>
                                        </con1:replace>
                                        <con1:replace contents-only="true" varName="body">
                                            <con:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7d9d</con:id>
                                            <con1:expr>
                                                <con:xqueryText>&lt;tran:transferenciasACHResponse/></con:xqueryText>
                                            </con1:expr>
                                        </con1:replace>
                                        <con:reply>
                                            <con:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7d48</con:id>
                                        </con:reply>
                                    </con1:actions>
                                </con1:case>
                                <con1:default>
                                    <con1:replace contents-only="true" varName="header">
                                        <con:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7d10</con:id>
                                        <con1:expr>
                                            <con:xqueryTransform>
                                                <con:resource ref="Middleware/v2/Resources/Generales/xq/aplicarValoresPorDefectoRegion"/>
                                                <con:param name="requestHeader">
                                                    <con:path>$header/aut:RequestHeader</con:path>
                                                </con:param>
                                            </con:xqueryTransform>
                                        </con1:expr>
                                    </con1:replace>
                                    <con1:assign varName="areSameSourceAndDestination">
                                        <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-6171</con:id>
                                        <con1:expr>
                                            <con:xqueryTransform>
                                                <con:resource ref="Middleware/v2/Resources/Generales/xq/validarCrucePaisEmpresa"/>
                                                <con:param name="requestHeader">
                                                    <con:path>$header/aut:RequestHeader</con:path>
                                                </con:param>
                                            </con:xqueryTransform>
                                        </con1:expr>
                                    </con1:assign>
                                </con1:default>
                            </con1:ifThenElse>
                        </con1:responseTransform>
                    </con1:wsCallout>
                </con3:actions>
            </con3:stage>
            <con3:stage name="BitacoraRequest">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="uuidBitacoraRequest">
                        <con:id>_ActionId-2610459578228753383-1aa70613.16ae5802f12.-7dfa</con:id>
                        <con1:expr>
                            <con:xqueryTransform>
                                <con:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                            </con:xqueryTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="originalBody">
                        <con:id>_ActionId-2610459578228753383-1aa70613.16ae5802f12.-7dc4</con:id>
                        <con1:expr>
                            <con:xqueryText>$body</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="originalHeader">
                        <con:id>_ActionId-2610459578228753383-1aa70613.16ae5802f12.-7dd7</con:id>
                        <con1:expr>
                            <con:xqueryText>$header</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con4:route>
                        <con:id>_ActionId-2610459578228753383-1aa70613.16ae5802f12.-7db7</con:id>
                        <con4:service ref="Middleware/v2/BusinessServices/OSB/RegistrarBitacoraOSB_v2/biz/RegistrarBitacoraOSB_v2" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con4:operation>registrarBitacoraOSB</con4:operation>
                        <con4:outboundTransform>
                            <con1:replace varName="body" contents-only="true">
                                <con:id>_ActionId-2610459578228753383-1aa70613.16ae5802f12.-7d9a</con:id>
                                <con1:location>
                                    <con:xpathText>.</con:xpathText>
                                </con1:location>
                                <con1:expr>
                                    <con:xqueryTransform>
                                        <con:resource ref="Middleware/v2/Resources/Generales/xq/registrarBitacoraOSBIn"/>
                                        <con:param name="Uuid">
                                            <con:path>$uuidBitacoraRequest</con:path>
                                        </con:param>
                                        <con:param name="IdOperacion">
                                            <con:path>fn:string($operation)</con:path>
                                        </con:param>
                                        <con:param name="IdOsb">
                                            <con:path>fn:string($inbound/ctx:transport/ctx:request/tp:headers/http:Host/text())</con:path>
                                        </con:param>
                                        <con:param name="IdServicio">
                                            <con:path>"FICBCO0057"</con:path>
                                        </con:param>
                                        <con:param name="MensajeError">
                                            <con:path>""</con:path>
                                        </con:param>
                                        <con:param name="IdTxn">
                                            <con:path>""</con:path>
                                        </con:param>
                                        <con:param name="UuidReq">
                                            <con:path>""</con:path>
                                        </con:param>
                                        <con:param name="Resultado">
                                            <con:path>""</con:path>
                                        </con:param>
                                        <con:param name="Usuario">
                                            <con:path>fn:string($header/aut:RequestHeader/Authentication/UserName/text())</con:path>
                                        </con:param>
                                        <con:param name="BancoOrigen">
                                            <con:path>fn:string($header/aut:RequestHeader/Region/DestinationBank/text())</con:path>
                                        </con:param>
                                        <con:param name="BancoDestino">
                                            <con:path>fn:string($header/aut:RequestHeader/Region/SourceBank/text())</con:path>
                                        </con:param>
                                        <con:param name="Contenido">
                                            <con:path>$body</con:path>
                                        </con:param>
                                        <con:param name="TipoMensaje">
                                            <con:path>"REQ"</con:path>
                                        </con:param>
                                        <con:param name="FechaTxn">
                                            <con:path>fn:adjust-date-to-timezone(current-date(), ())</con:path>
                                        </con:param>
                                    </con:xqueryTransform>
                                </con1:expr>
                            </con1:replace>
                        </con4:outboundTransform>
                    </con4:route>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="response" name="ValidacionesGenerales_response">
            <con3:stage name="MapeoErrores">
                <con3:context>
                    <con:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/ValidaServicioRegional" prefix="val"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-5165187676452498133--660a4447.157dcfdc56d.-57cf</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) != "SUCCESS"</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:ifThenElse>
                                    <con:id>_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7e9a</con:id>
                                    <con1:case>
                                        <con1:condition>
                                            <con:xqueryText>not(upper-case(fn:string($reqValidaServicioRegional/val:PV_ORIGEN/text())) = ('NI01','HN01','GT01'))</con:xqueryText>
                                        </con1:condition>
                                        <con1:actions>
                                            <con1:replace varName="header" contents-only="true">
                                                <con:id>_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7e98</con:id>
                                                <con1:expr>
                                                    <con:xqueryText><![CDATA[<aut:ResponseHeader>
    <messageId>
    {  
    	if(fn:matches($reasonCode,'^([R|F][0-9]{2}|[0-9]{4})$')) then
    		$reasonCode
    	else
    		'R31'
    }
    </messageId>
    <successIndicator>{ fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) }</successIndicator>
	<messages>
	{
		if(fn:matches($header/aut:ResponseHeader/messages,'^[R|F][0-9]{2}[\-]{1}[0-9a-zA-Z]')) then
			xs:string($header/aut:ResponseHeader/messages/text())
		else
			if(fn:matches($header/aut:ResponseHeader/messages,'^[0-9]{4}[\-]{1}[0-9a-zA-Z]')) then
				xs:string($header/aut:ResponseHeader/messages/text())
			else
				fn:concat('R31-',xs:string($header/aut:ResponseHeader/messages/text()))  
	}
	</messages>
</aut:ResponseHeader>]]></con:xqueryText>
                                                </con1:expr>
                                            </con1:replace>
                                        </con1:actions>
                                    </con1:case>
                                    <con1:default>
                                        <con2:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
                                            <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7e23</con6:id>
                                            <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                            <con2:operation>mapeoErrores</con2:operation>
                                            <con2:request>
                                                <con2:body>REQMapeoErrores</con2:body>
                                            </con2:request>
                                            <con2:response>
                                                <con2:body>RSPMapeoErrores</con2:body>
                                            </con2:response>
                                            <con2:requestTransform>
                                                <con2:assign varName="REQMapeoErrores">
                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7e25</con6:id>
                                                    <con2:expr>
                                                        <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                            <con6:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                                                            <con6:param name="MENSAJE_ERROR">
                                                                <con6:path>fn:concat("FICBCO0057","$#$",fn:string-join($header/aut:ResponseHeader/messages, '||'))</con6:path>
                                                            </con6:param>
                                                            <con6:param name="CODIGO_ERROR">
                                                                <con6:path>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text()))</con6:path>
                                                            </con6:param>
                                                        </con6:xqueryTransform>
                                                    </con2:expr>
                                                </con2:assign>
                                            </con2:requestTransform>
                                            <con2:responseTransform>
                                                <con2:replace varName="header" contents-only="true">
                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7e24</con6:id>
                                                    <con2:expr>
                                                        <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                                                            <con6:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                                                            <con6:param name="mapeoErroresResponse1">
                                                                <con6:path>$RSPMapeoErrores</con6:path>
                                                            </con6:param>
                                                            <con6:param name="successIndicator">
                                                                <con6:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con6:path>
                                                            </con6:param>
                                                        </con6:xqueryTransform>
                                                    </con2:expr>
                                                </con2:replace>
                                                <con2:ifThenElse>
                                                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-7694373498477416483--6b7d132b.16f901bc1d9.-6d03</con6:id>
                                                    <con2:case>
                                                        <con2:condition>
                                                            <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">upper-case($header/aut:ResponseHeader/successIndicator/text()) = "PENDING"</con6:xqueryText>
                                                        </con2:condition>
                                                        <con2:actions>
                                                            <con2:insert varName="header">
                                                                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-7694373498477416483--6b7d132b.16f901bc1d9.-6cda</con6:id>
                                                                <con2:location>
                                                                    <con6:xpathText xmlns:con6="http://www.bea.com/wli/sb/stages/config">./aut:ResponseHeader</con6:xpathText>
                                                                </con2:location>
                                                                <con2:where>last-child</con2:where>
                                                                <con2:expr>
                                                                    <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">&lt;valueDate>{ fn-bea:date-to-string-with-format("yyyyMMdd", current-date()) }&lt;/valueDate></con6:xqueryText>
                                                                </con2:expr>
                                                            </con2:insert>
                                                        </con2:actions>
                                                    </con2:case>
                                                    <con2:default/>
                                                </con2:ifThenElse>
                                            </con2:responseTransform>
                                        </con2:wsCallout>
                                    </con1:default>
                                </con1:ifThenElse>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
            <con3:stage name="BitacoraResponse">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-2610459578228753383-1aa70613.16ae5802f12.-7d81</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>fn:string($uuidBitacoraRequest) !=''</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:assign varName="uuidBitacoraResponse">
                                    <con:id>_ActionId-2610459578228753383-1aa70613.16ae5802f12.-7d61</con:id>
                                    <con1:expr>
                                        <con:xqueryTransform>
                                            <con:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                                        </con:xqueryTransform>
                                    </con1:expr>
                                </con1:assign>
                                <con4:route>
                                    <con:id>_ActionId-2610459578228753383-1aa70613.16ae5802f12.-7d40</con:id>
                                    <con4:service ref="Middleware/v2/BusinessServices/OSB/RegistrarBitacoraOSB_v2/biz/RegistrarBitacoraOSB_v2" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con4:operation>registrarBitacoraOSB</con4:operation>
                                    <con4:outboundTransform>
                                        <con1:replace contents-only="true" varName="body">
                                            <con:id>_ActionId-2610459578228753383-1aa70613.16ae5802f12.-7d26</con:id>
                                            <con1:location>
                                                <con:xpathText>.</con:xpathText>
                                            </con1:location>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/Generales/xq/registrarBitacoraOSBIn"/>
                                                    <con:param name="Uuid">
                                                        <con:path>$uuidBitacoraResponse</con:path>
                                                    </con:param>
                                                    <con:param name="IdOperacion">
                                                        <con:path>fn:string($operation)</con:path>
                                                    </con:param>
                                                    <con:param name="IdOsb">
                                                        <con:path>fn:string($inbound/ctx:transport/ctx:request/tp:headers/http:Host/text())</con:path>
                                                    </con:param>
                                                    <con:param name="IdServicio">
                                                        <con:path>"FICBCO0057"</con:path>
                                                    </con:param>
                                                    <con:param name="MensajeError">
                                                        <con:path>fn:string($header/aut:ResponseHeader/messages/text())</con:path>
                                                    </con:param>
                                                    <con:param name="IdTxn">
                                                        <con:path>fn:string($header/aut:ResponseHeader/transactionId/text())</con:path>
                                                    </con:param>
                                                    <con:param name="UuidReq">
                                                        <con:path>$uuidBitacoraRequest</con:path>
                                                    </con:param>
                                                    <con:param name="Resultado">
                                                        <con:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con:path>
                                                    </con:param>
                                                    <con:param name="Usuario">
                                                        <con:path>string($originalHeader/aut:RequestHeader/Authentication/UserName/text())</con:path>
                                                    </con:param>
                                                    <con:param name="BancoOrigen">
                                                        <con:path>fn:string($originalHeader/aut:RequestHeader/Region/SourceBank/text())</con:path>
                                                    </con:param>
                                                    <con:param name="BancoDestino">
                                                        <con:path>string($originalHeader/aut:RequestHeader/Region/DestinationBank/text())</con:path>
                                                    </con:param>
                                                    <con:param name="Contenido">
                                                        <con:path>$body</con:path>
                                                    </con:param>
                                                    <con:param name="TipoMensaje">
                                                        <con:path>"RSP"</con:path>
                                                    </con:param>
                                                    <con:param name="FechaTxn">
                                                        <con:path>fn:adjust-date-to-timezone(current-date(), ())</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:replace>
                                    </con4:outboundTransform>
                                </con4:route>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="request" name="RegionalizacionPaisEmpresa_ConCruce_request">
            <con3:stage name="OperacionEnOrigen">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                </con3:context>
                <con3:actions>
                    <con1:Error>
                        <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ef2</con:id>
                        <con1:errCode>MW-0008</con1:errCode>
                        <con1:message>SERVICE NOT IMPLEMENTED YET FOR THIS COUNTRY/COMPANY</con1:message>
                    </con1:Error>
                    <con1:ifThenElse>
                        <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ef1</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>(:HNBanco:)
fn:string($header/aut:RequestHeader/Region/SourceBank/text()) = 'HN01'</con:xqueryText>
                            </con1:condition>
                            <con1:actions/>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
            <con3:stage name="OperacionEnDestino">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5e82</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>(:HNBanco:)
fn:string($header/aut:RequestHeader/Region/DestinationBank/text()) = 'HN01'</con:xqueryText>
                            </con1:condition>
                            <con1:actions/>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="response" name="RegionalizacionPaisEmpresa_ConCruce_response"/>
        <con3:pipeline type="request" name="Default_TransferenciasACH_request">
            <con3:stage name="FlujoEntrada">
                <con3:context/>
                <con3:actions/>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="response" name="Default_TransferenciasACH_response">
            <con3:stage name="FlujoSalida">
                <con3:context/>
                <con3:actions>
                    <con2:Error xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
                        <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5f63</con4:id>
                        <con2:errCode>MW-0008</con2:errCode>
                        <con2:message>SERVICE NOT IMPLEMENTED YET FOR THIS COUNTRY/COMPANY</con2:message>
                    </con2:Error>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="request" name="GT01_TransferenciasACH_request">
            <con3:stage name="ValidacionCuentas">
                <con3:context>
                    <con:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/validacionCuentaExternaTypes" prefix="val"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="tipoCuenta">
                        <con:id>_ActionId-1036288106309300713--49cce077.18ae2a9eafb.-7fa7</con:id>
                        <con1:expr>
                            <con:xqueryText>let $tipo:=$body/tran:transferenciasACHRequest/ACCOUNT_TYPE/text()
return
if($tipo="Savings")then
	("AHO")
else if($tipo="Checking") then
	("CHQ")
else if($tipo = "Loanpayment")then
	("PTM")
else if($tipo = "Creditca")then
	("TRC")
else ("")</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:wsCallout>
                        <con:id>_ActionId-1036288106309300713--49cce077.18ae2a9eafb.-7fdd</con:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/ValidacionCuentaExterna" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>validacionCuentaExterna</con1:operation>
                        <con1:request>
                            <con1:body>REQvalidacionCuenta</con1:body>
                            <con1:header>REQheader</con1:header>
                        </con1:request>
                        <con1:response>
                            <con1:body>RSPvalidacionCuenta</con1:body>
                            <con1:header>RSPheader</con1:header>
                        </con1:response>
                        <con1:requestTransform>
                            <con1:assign varName="REQheader">
                                <con:id>_ActionId-1036288106309300713--49cce077.18ae2a9eafb.-7f28</con:id>
                                <con1:expr>
                                    <con:xqueryText>$header</con:xqueryText>
                                </con1:expr>
                            </con1:assign>
                            <con1:assign varName="REQvalidacionCuenta">
                                <con:id>_ActionId-1036288106309300713--49cce077.18ae2a9eafb.-7ede</con:id>
                                <con1:expr>
                                    <con:xqueryTransform>
                                        <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/validacionCuentaIn"/>
                                        <con:param name="tipo">
                                            <con:path>$tipoCuenta</con:path>
                                        </con:param>
                                        <con:param name="transferenciasACHRequest1">
                                            <con:path>$body/tran:transferenciasACHRequest</con:path>
                                        </con:param>
                                    </con:xqueryTransform>
                                </con1:expr>
                            </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                            <con1:assign varName="ErrorCode">
                                <con:id>_ActionId-1036288106309300713--49cce077.18ae2a9eafb.-7e98</con:id>
                                <con1:expr>
                                    <con:xqueryText>data($RSPheader/aut:ResponseHeader/successIndicator)</con:xqueryText>
                                </con1:expr>
                            </con1:assign>
                        </con1:responseTransform>
                    </con1:wsCallout>
                </con3:actions>
            </con3:stage>
            <con3:stage name="FlujoEntrada">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="validationMessage">
                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6a05</con:id>
                        <con1:expr>
                            <con:xqueryTransform>
                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/transferenciasACHGTValidate"/>
                                <con:param name="transferenciasACHRequest1">
                                    <con:path>$body/tran:transferenciasACHRequest</con:path>
                                </con:param>
                            </con:xqueryTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:ifThenElse>
                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6a04</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$validationMessage != "" 
or
fn:upper-case($ErrorCode) != "SUCCESS"</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:assign varName="validationMessage">
                                    <con:id>_ActionId-1036288106309300713--49cce077.18ae2a9eafb.-7de2</con:id>
                                    <con1:expr>
                                        <con:xqueryText>data($RSPheader/aut:ResponseHeader/messages)</con:xqueryText>
                                    </con1:expr>
                                </con1:assign>
                                <con:skip>
                                    <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6a03</con:id>
                                </con:skip>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con1:wsCallout>
                                <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6a01</con:id>
                                <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABKGT/transferenciasACH/biz/TransferenciasACH_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                <con1:operation>TransferenciasACH</con1:operation>
                                <con1:request>
                                    <con1:body>rq</con1:body>
                                </con1:request>
                                <con1:response>
                                    <con1:body>rp</con1:body>
                                </con1:response>
                                <con1:requestTransform>
                                    <con1:assign varName="rq">
                                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6a02</con:id>
                                        <con1:expr>
                                            <con:xqueryTransform>
                                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/transferenciasACHGTIn"/>
                                                <con:param name="usuarioCanal">
                                                    <con:path>fn:string($header/aut:RequestHeader/Authentication/UserName/text())</con:path>
                                                </con:param>
                                                <con:param name="transferenciasACHRequest1">
                                                    <con:path>$body/tran:transferenciasACHRequest</con:path>
                                                </con:param>
                                            </con:xqueryTransform>
                                        </con1:expr>
                                    </con1:assign>
                                </con1:requestTransform>
                                <con1:responseTransform/>
                            </con1:wsCallout>
                        </con1:default>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="response" name="GT01_TransferenciasACH_response">
            <con3:stage name="FlujoSalida">
                <con3:context>
                    <con:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/TransferenciasACH" prefix="trans1"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6a00</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$validationMessage != "" 
or
fn:upper-case($ErrorCode) != "SUCCESS"</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:replace contents-only="true" varName="header">
                                    <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-69ff</con:id>
                                    <con1:expr>
                                        <con:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{ fn:string($validationMessage) }</messages>
</aut:ResponseHeader>]]></con:xqueryText>
                                    </con1:expr>
                                </con1:replace>
                                <con1:replace contents-only="true" varName="body">
                                    <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-69fe</con:id>
                                    <con1:expr>
                                        <con:xqueryText>&lt;tran:transferenciasACHResponse/></con:xqueryText>
                                    </con1:expr>
                                </con1:replace>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con1:replace contents-only="true" varName="body">
                                <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-69fd</con:id>
                                <con1:expr>
                                    <con:xqueryText>&lt;tran:transferenciasACHResponse/></con:xqueryText>
                                </con1:expr>
                            </con1:replace>
                            <con1:replace contents-only="true" varName="header">
                                <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-69fc</con:id>
                                <con1:expr>
                                    <con:xqueryTransform>
                                        <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/transferenciasACHGTHeaderOut"/>
                                        <con:param name="outputParameters1">
                                            <con:path>$rp</con:path>
                                        </con:param>
                                    </con:xqueryTransform>
                                </con1:expr>
                            </con1:replace>
                        </con1:default>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="request" name="PA01_TransferenciasACH_request">
            <con3:stage name="FlujoEntrada">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="validationMessage">
                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-697b</con:id>
                        <con1:expr>
                            <con:xqueryTransform>
                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/transferenciasACHGTValidate"/>
                                <con:param name="transferenciasACHRequest1">
                                    <con:path>$body/tran:transferenciasACHRequest</con:path>
                                </con:param>
                            </con:xqueryTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:ifThenElse>
                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-697a</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$validationMessage != ""</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con:skip>
                                    <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6979</con:id>
                                </con:skip>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con1:wsCallout>
                                <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6977</con:id>
                                <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABKPA/transferenciasACH/biz/transferenciasACH_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                <con1:operation>transferenciasACH</con1:operation>
                                <con1:request>
                                    <con1:body>rq</con1:body>
                                </con1:request>
                                <con1:response>
                                    <con1:body>rp</con1:body>
                                </con1:response>
                                <con1:requestTransform>
                                    <con1:assign varName="rq">
                                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6978</con:id>
                                        <con1:expr>
                                            <con:xqueryTransform>
                                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/transferenciasACHPAIn"/>
                                                <con:param name="transferenciasACHRequest1">
                                                    <con:path>$body/tran:transferenciasACHRequest</con:path>
                                                </con:param>
                                            </con:xqueryTransform>
                                        </con1:expr>
                                    </con1:assign>
                                </con1:requestTransform>
                                <con1:responseTransform/>
                            </con1:wsCallout>
                        </con1:default>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="response" name="PA01_TransferenciasACH_response">
            <con3:stage name="FlujoSalida">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6976</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$validationMessage != ""</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:replace varName="header" contents-only="true">
                                    <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6975</con:id>
                                    <con1:expr>
                                        <con:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{ fn:string($validationMessage) }</messages>
</aut:ResponseHeader>]]></con:xqueryText>
                                    </con1:expr>
                                </con1:replace>
                                <con1:replace contents-only="true" varName="body">
                                    <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6974</con:id>
                                    <con1:expr>
                                        <con:xqueryText>&lt;tran:transferenciasACHResponse/></con:xqueryText>
                                    </con1:expr>
                                </con1:replace>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con1:replace contents-only="true" varName="body">
                                <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6973</con:id>
                                <con1:expr>
                                    <con:xqueryText>&lt;tran:transferenciasACHResponse/></con:xqueryText>
                                </con1:expr>
                            </con1:replace>
                            <con1:replace contents-only="true" varName="header">
                                <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6972</con:id>
                                <con1:expr>
                                    <con:xqueryTransform>
                                        <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/transferenciasACHPAHeaderOut"/>
                                        <con:param name="outputParameters1">
                                            <con:path>$rp</con:path>
                                        </con:param>
                                    </con:xqueryTransform>
                                </con1:expr>
                            </con1:replace>
                        </con1:default>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="request" name="HN01_TransferenciasACH_BATCH_request">
            <con3:stage name="HN01batch_proxyRequest">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                </con3:context>
                <con3:actions>
                    <con1:wsCallout>
                        <con:id>_ActionId-1022916253069350504-336b5f97.156b8ed0bf3.-7c15</con:id>
                        <con1:service xsi:type="ref:ProxyRef" ref="Middleware/OperationsAndExecution/CustomerDeposits/TransferenciasACH" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>transferenciasACH</con1:operation>
                        <con1:request>
                            <con1:body wrapped="true">REQTransfACHBatch</con1:body>
                            <con1:header>REQHdrTransfACHBatch</con1:header>
                        </con1:request>
                        <con1:response>
                            <con1:body wrapped="true">RSPTransfACHBatch</con1:body>
                            <con1:header>RSPHdrTransfACHBatch</con1:header>
                        </con1:response>
                        <con1:requestTransform>
                            <con1:assign varName="REQHdrTransfACHBatch">
                                <con:id>_ActionId-1022916253069350504-336b5f97.156b8ed0bf3.-7bfa</con:id>
                                <con1:expr>
                                    <con:xqueryText>$header</con:xqueryText>
                                </con1:expr>
                            </con1:assign>
                            <con1:replace varName="REQHdrTransfACHBatch" contents-only="true">
                                <con:id>_ActionId-1022916253069350504-336b5f97.156b8ed0bf3.-7be7</con:id>
                                <con1:expr>
                                    <con:xqueryTransform>
                                        <con:resource ref="Middleware/v2/Resources/Genericos/regionalHeaderToLocalHeader"/>
                                        <con:param name="requestHeader1">
                                            <con:path>$header/aut:RequestHeader</con:path>
                                        </con:param>
                                    </con:xqueryTransform>
                                </con1:expr>
                            </con1:replace>
                            <con1:assign varName="REQTransfACHBatch">
                                <con:id>_ActionId-1022916253069350504-336b5f97.156b8ed0bf3.-7bc6</con:id>
                                <con1:expr>
                                    <con:xqueryText>$body</con:xqueryText>
                                </con1:expr>
                            </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform/>
                    </con1:wsCallout>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="response" name="HN01_TransferenciasACH_BATCH_response">
            <con3:stage name="HN01batch_proxyResponse">
                <con3:context/>
                <con3:actions>
                    <con1:replace varName="header">
                        <con:id>_ActionId-1022916253069350504-336b5f97.156b8ed0bf3.-7baf</con:id>
                        <con1:expr>
                            <con:xqueryText>$RSPHdrTransfACHBatch</con:xqueryText>
                        </con1:expr>
                    </con1:replace>
                    <con1:replace varName="body">
                        <con:id>_ActionId-1022916253069350504-336b5f97.156b8ed0bf3.-7b90</con:id>
                        <con1:expr>
                            <con:xqueryText>$RSPTransfACHBatch</con:xqueryText>
                        </con1:expr>
                    </con1:replace>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="request" name="HN01_TransferenciasACH_request">
            <con3:stage name="Parametrizacion">
                <con3:context>
                    <con:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="transportTypeParam">
                        <con:id>_ActionId-1022916253069350504-336b5f97.156b8ed0bf3.-7b40</con:id>
                        <con1:expr>
                            <con:xqueryText>"T24T001.TRANSPORTTYPE"</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="correoParam">
                        <con:id>_ActionId-1789930570681492119--6a3ab08.15cc63d7c50.-7e2d</con:id>
                        <con1:expr>
                            <con:xqueryText>"FICBCO0057.EMAIL"</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="cuentaProgramadaHNLParam">
                        <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-54de</con:id>
                        <con1:expr>
                            <con:xqueryText>'FICBCO0057.ACCOUNT.SCHEDULED.HNL'</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="cuentaProgramadaUSDParam">
                        <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-54c1</con:id>
                        <con1:expr>
                            <con:xqueryText>'FICBCO0057.ACCOUNT.SCHEDULED.USD'</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="cuentaComisionParam">
                        <con:id>_ActionId-7311992800880199806-24e5488c.16efa90a2f0.-7f72</con:id>
                        <con1:expr>
                            <con:xqueryText>'FICBCO0057.COMMISSION.CREDIT.ACCOUNT'</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="montoComisionHNLParam">
                        <con:id>_ActionId-7311992800880199806-24e5488c.16efa90a2f0.-7db6</con:id>
                        <con1:expr>
                            <con:xqueryText>'FICBCO0057.COMMISSION.HNL'</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="montoComisionUSDParam">
                        <con:id>_ActionId-7311992800880199806-24e5488c.16efa90a2f0.-7d99</con:id>
                        <con1:expr>
                            <con:xqueryText>"FICBCO0057.COMMISSION.USD"</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="pystBeginClosedTimePName">
                        <con:id>_ActionId-1222935265832882193-1c490cfa.172d25d5b3d.-7e1c</con:id>
                        <con1:expr>
                            <con:xqueryText>fn:concat(
	'FICBCO0057.',
	fn:string($header/aut:RequestHeader/Region/SourceBank/text()),
	'.PYST.BEGIN_CLOSED_TIME'
)</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="pystEndClosedTimePName">
                        <con:id>_ActionId-1222935265832882193-1c490cfa.172d25d5b3d.-7dff</con:id>
                        <con1:expr>
                            <con:xqueryText>fn:concat(
	'FICBCO0057.',
	fn:string($header/aut:RequestHeader/Region/SourceBank/text()),
	'.PYST.END_CLOSED_TIME'
)</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:wsCallout>
                        <con:id>_ActionId-1022916253069350504-336b5f97.156b8ed0bf3.-7b58</con:id>
                        <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>obtenerParametrizacion</con1:operation>
                        <con1:request>
                            <con1:body>REQObtenerParams</con1:body>
                        </con1:request>
                        <con1:response>
                            <con1:body>RSPObtenerParams</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                            <con1:assign varName="REQObtenerParams">
                                <con:id>_ActionId-1022916253069350504-336b5f97.156b8ed0bf3.-7b36</con:id>
                                <con1:expr>
                                    <con:xqueryTransform>
                                        <con:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                                        <con:param name="nombreParametros">
                                            <con:path>fn:concat($transportTypeParam,"||",
		  $correoParam,"||",
		  $cuentaProgramadaHNLParam,"||",
		  $cuentaProgramadaUSDParam,"||",
		  $cuentaComisionParam,"||",
		  $montoComisionHNLParam,"||",
		  $montoComisionUSDParam, "||",
		  $pystBeginClosedTimePName, "||",
		  $pystEndClosedTimePName)</con:path>
                                        </con:param>
                                    </con:xqueryTransform>
                                </con1:expr>
                            </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                            <con1:assign varName="errorCode">
                                <con:id>_ActionId-6809855940837178741--20441cc8.16bdc572230.-7ceb</con:id>
                                <con1:expr>
                                    <con:xqueryText>fn:upper-case(fn:string($RSPObtenerParams/osb:ERROR_CODE/text()))</con:xqueryText>
                                </con1:expr>
                            </con1:assign>
                            <con1:assign varName="transportType">
                                <con:id>_ActionId-1022916253069350504-336b5f97.156b8ed0bf3.-7b1e</con:id>
                                <con1:expr>
                                    <con:xqueryText>let $transportType := fn:string($RSPObtenerParams/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$transportTypeParam]/osb:VALUE/text())
return
	if ($transportType != "") then (
		$transportType
	) else (
		"ONLINE"
	)</con:xqueryText>
                                </con1:expr>
                            </con1:assign>
                            <con1:assign varName="correo">
                                <con:id>_ActionId-1198664836547443832--209b81e8.16b27de23a4.-763d</con:id>
                                <con1:expr>
                                    <con:xqueryText>fn:string($RSPObtenerParams/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$correoParam]/osb:VALUE/text())</con:xqueryText>
                                </con1:expr>
                            </con1:assign>
                            <con1:assign varName="validationMessage">
                                <con:id>_ActionId-4648383019334417583-25cf5d57.16ad6c407de.-7fe4</con:id>
                                <con1:expr>
                                    <con:xqueryText>if($errorCode = 'SUCCESS') then(
	''
)else(
	fn:string($RSPObtenerParametrizacion/osb:ERROR_MESSAGE/text())
)</con:xqueryText>
                                </con1:expr>
                            </con1:assign>
                            <con1:assign varName="validationMessageService">
                                <con:id>_ActionId-6809855940837178741--20441cc8.16bdc572230.-7c98</con:id>
                                <con1:expr>
                                    <con:xqueryText>$validationMessage</con:xqueryText>
                                </con1:expr>
                            </con1:assign>
                            <con1:assign varName="pystBeginClosedTimeParam">
                                <con:id>_ActionId-1222935265832882193-1c490cfa.172d25d5b3d.-7de2</con:id>
                                <con1:expr>
                                    <con:xqueryText>fn:string($RSPObtenerParams/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$pystBeginClosedTimePName]/osb:VALUE/text())</con:xqueryText>
                                </con1:expr>
                            </con1:assign>
                            <con1:assign varName="pystEndClosedTimeParam">
                                <con:id>_ActionId-1222935265832882193-1c490cfa.172d25d5b3d.-7dc5</con:id>
                                <con1:expr>
                                    <con:xqueryText>fn:string($RSPObtenerParams/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$pystEndClosedTimePName]/osb:VALUE/text())</con:xqueryText>
                                </con1:expr>
                            </con1:assign>
                        </con1:responseTransform>
                    </con1:wsCallout>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="response" name="HN01_TransferenciasACH_response"/>
        <con3:pipeline type="request" name="NI01_TransferenciasACH_request">
            <con3:stage name="FlujoEntrada">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="validationMessage">
                        <con:id>_ActionId-2436211221843050862--6d207f6f.15e0f9168c3.-7f9e</con:id>
                        <con1:expr>
                            <con:xqueryTransform>
                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/transferenciasACHNIValidate"/>
                                <con:param name="transferenciasACHRequest">
                                    <con:path>$body/tran:transferenciasACHRequest</con:path>
                                </con:param>
                            </con:xqueryTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:ifThenElse>
                        <con:id>_ActionId-2436211221843050862--6d207f6f.15e0f9168c3.-7f9d</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$validationMessage != ""</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con:skip>
                                    <con:id>_ActionId-2436211221843050862--6d207f6f.15e0f9168c3.-7f9c</con:id>
                                </con:skip>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con1:wsCallout>
                                <con:id>_ActionId-2436211221843050862--6d207f6f.15e0f9168c3.-7f9a</con:id>
                                <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/CTS/transferencia/biz/transferencia" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                <con1:operation>OpTransferenciaIndividualACH</con1:operation>
                                <con1:request>
                                    <con1:body>REQOpTransferenciaIndividualACH</con1:body>
                                </con1:request>
                                <con1:response>
                                    <con1:body>RSPOpTransferenciaIndividualACH</con1:body>
                                </con1:response>
                                <con1:requestTransform>
                                    <con1:assign varName="REQOpTransferenciaIndividualACH">
                                        <con:id>_ActionId-2436211221843050862--6d207f6f.15e0f9168c3.-7f9b</con:id>
                                        <con1:expr>
                                            <con:xqueryTransform>
                                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/transferenciasACHNIIn"/>
                                                <con:param name="transferenciasACHRequest">
                                                    <con:path>$body/tran:transferenciasACHRequest</con:path>
                                                </con:param>
                                            </con:xqueryTransform>
                                        </con1:expr>
                                    </con1:assign>
                                    <con1:validate xmlns:con5="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/stages/logging/config">
                                        <con:id>_ActionId-2436211221843050862--6d207f6f.15e0f9168c3.-7eb0</con:id>
                                        <con1:schema ref="Middleware/v2/BusinessServices/CTS/transferencia/xsd/services"/>
                                        <con1:schemaElement xmlns:ser1="http://service.srvaplcobisactivos.ecobis.cobiscorp" xmlns:ser2="http://service.srvaplcobistransferencia.ecobis.cobiscorp">ser2:opTransferenciaIndividualACHSolicitud</con1:schemaElement>
                                        <con1:varName>REQOpTransferenciaIndividualACH</con1:varName>
                                        <con1:location>
                                            <con:xpathText>.</con:xpathText>
                                        </con1:location>
                                    </con1:validate>
                                </con1:requestTransform>
                                <con1:responseTransform/>
                            </con1:wsCallout>
                        </con1:default>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="response" name="NI01_TransferenciasACH_response">
            <con3:stage name="FlujoSalida">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-2436211221843050862--6d207f6f.15e0f9168c3.-7f99</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$validationMessage != ""</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:replace varName="header" contents-only="true">
                                    <con:id>_ActionId-2436211221843050862--6d207f6f.15e0f9168c3.-7f98</con:id>
                                    <con1:expr>
                                        <con:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{ fn:string($validationMessage) }</messages>
</aut:ResponseHeader>]]></con:xqueryText>
                                    </con1:expr>
                                </con1:replace>
                                <con1:replace contents-only="true" varName="body">
                                    <con:id>_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7fed</con:id>
                                    <con1:expr>
                                        <con:xqueryText>&lt;tran:transferenciasACHResponse/></con:xqueryText>
                                    </con1:expr>
                                </con1:replace>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con1:replace contents-only="true" varName="header">
                                <con:id>_ActionId-2436211221843050862--6d207f6f.15e0f9168c3.-7f95</con:id>
                                <con1:expr>
                                    <con:xqueryTransform>
                                        <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/transferenciasACHNIHeaderOut"/>
                                        <con:param name="opTransferenciaIndividualACHRespuesta">
                                            <con:path>$RSPOpTransferenciaIndividualACH</con:path>
                                        </con:param>
                                    </con:xqueryTransform>
                                </con1:expr>
                            </con1:replace>
                            <con1:ifThenElse>
                                <con:id>_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7f28</con:id>
                                <con1:case>
                                    <con1:condition>
                                        <con:xqueryText>fn:string($header/aut:ResponseHeader/successIndicator/text()) = 'Success'</con:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                        <con1:replace contents-only="true" varName="body">
                                            <con:id>_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7f26</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/transferenciasACHNIOut"/>
                                                    <con:param name="opTransferenciaIndividualACHRespuesta">
                                                        <con:path>$RSPOpTransferenciaIndividualACH</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:replace>
                                    </con1:actions>
                                </con1:case>
                                <con1:default>
                                    <con1:replace contents-only="true" varName="body">
                                        <con:id>_ActionId-5005125853568809287--53343af6.15f9691d9d8.-7ed2</con:id>
                                        <con1:expr>
                                            <con:xqueryText>&lt;tran:transferenciasACHResponse/></con:xqueryText>
                                        </con1:expr>
                                    </con1:replace>
                                </con1:default>
                            </con1:ifThenElse>
                        </con1:default>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="request" name="HN01_TransferenciasACH_ONLINE_request">
            <con3:stage name="Validacion_LocalOriginalAccount">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-6809855940837178741--20441cc8.16bdc572230.-7c43</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$validationMessage =''</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:replace varName="body" contents-only="true">
                                    <con:id>_ActionId-5512939926709431582-5a6587d2.16c2ebe84a9.-7fff</con:id>
                                    <con1:location>
                                        <con:xpathText>./tran:transferenciasACHRequest/LOCAL_ORIGINAL_ACCOUNT</con:xpathText>
                                    </con1:location>
                                    <con1:expr>
                                        <con:xqueryText>let $localOriginalAccount := fn:string($body/tran:transferenciasACHRequest/LOCAL_ORIGINAL_ACCOUNT/text())
let $debitAccount := fn:string($body/tran:transferenciasACHRequest/DEBIT_ACCOUNT/text())

return
	if ($localOriginalAccount = '') then (
		$debitAccount
	) else (
		$localOriginalAccount
	)</con:xqueryText>
                                    </con1:expr>
                                </con1:replace>
                                <con1:assign varName="creditCurrency">
                                    <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-51a7</con:id>
                                    <con1:expr>
                                        <con:xqueryText>fn:string($body/tran:transferenciasACHRequest/CREDIT_CURRENCY/text())</con:xqueryText>
                                    </con1:expr>
                                </con1:assign>
                                <con1:assign varName="validationMessage">
                                    <con:id>_ActionId-6809855940837178741--20441cc8.16bdc572230.-7c3d</con:id>
                                    <con1:expr>
                                        <con:xqueryText>if($creditCurrency = 'USD' or $creditCurrency = 'HNL') then(
	''
)else(
	'Moneda no valida'
)</con:xqueryText>
                                    </con1:expr>
                                </con1:assign>
                                <con1:assign varName="errorCode">
                                    <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-7892</con:id>
                                    <con1:expr>
                                        <con:xqueryText>if($validationMessage = '') then(
	'SUCCESS'
)else(
	'ERROR'
)</con:xqueryText>
                                    </con1:expr>
                                </con1:assign>
                                <con1:assign varName="validationMessageService">
                                    <con:id>_ActionId-6809855940837178741--20441cc8.16bdc572230.-7b74</con:id>
                                    <con1:expr>
                                        <con:xqueryText>$validationMessage</con:xqueryText>
                                    </con1:expr>
                                </con1:assign>
                                <con1:assign varName="accountType">
                                    <con:id>_ActionId-8512695519115535170-126b2407.17314babdf1.-792a</con:id>
                                    <con1:expr>
                                        <con:xqueryText>fn:upper-case(fn-bea:trim($body/tran:transferenciasACHRequest/ACCOUNT_TYPE/text()))</con:xqueryText>
                                    </con1:expr>
                                </con1:assign>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
            <con3:stage name="RegistroNuevoACHEnviado" errorHandler="_onErrorHandler-3737078030707750162-72ba21fd.16c861355b1.-7909">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/registroNuevoACHEnviado" prefix="reg"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="localAccountType">
                        <con:id>_ActionId-1941418778872710038--300f20f0.17f2c6d81d3.-7f5a</con:id>
                        <con1:expr>
                            <con:xqueryText>string($body/tran:transferenciasACHRequest/LOCAL_ACCOUNT_TYPE/text())</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:ifThenElse>
                        <con:id>_ActionId-8954991653965782188--7007a373.16ada7dd515.-760c</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$validationMessage =''</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:wsCallout>
                                    <con:id>_ActionId-6809855940837178741--20441cc8.16bdc572230.-7ebc</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ACH/Enviado/RegistroNuevoACHEnviado/biz/registroNuevoACHEnviado_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>registroNuevoACHEnviado</con1:operation>
                                    <con1:request>
                                        <con1:body>REQRegistroNuevoACHEnviado</con1:body>
                                    </con1:request>
                                    <con1:response>
                                        <con1:body>RSPRegistroNuevoACHEnviado</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                        <con1:assign varName="REQRegistroNuevoACHEnviado">
                                            <con:id>_ActionId-6809855940837178741--20441cc8.16bdc572230.-7e84</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/registroNuevoACHEnviadoIn"/>
                                                    <con:param name="transferenciasACHRequest">
                                                        <con:path>$body/tran:transferenciasACHRequest</con:path>
                                                    </con:param>
                                                    <con:param name="username">
                                                        <con:path>fn:string($header/aut:RequestHeader/Authentication/UserName/text())</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform>
                                        <con1:assign varName="errorCode">
                                            <con:id>_ActionId-6809855940837178741--20441cc8.16bdc572230.-7e4c</con:id>
                                            <con1:expr>
                                                <con:xqueryText>fn:upper-case(fn:string($RSPRegistroNuevoACHEnviado/reg:PV_SUCCESINDICATOR/text()))</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="validationMessage">
                                            <con:id>_ActionId-6809855940837178741--20441cc8.16bdc572230.-7e2f</con:id>
                                            <con1:expr>
                                                <con:xqueryText>if($errorCode = 'SUCCESS') then(
	''
)else(
	'R31-Error del sistema'
)</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="validationMessageService">
                                            <con:id>_ActionId-6809855940837178741--20441cc8.16bdc572230.-7bae</con:id>
                                            <con1:expr>
                                                <con:xqueryText>$validationMessage</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="sequenceId">
                                            <con:id>_ActionId-7875615858499647522-3966a751.17f2252b0eb.-7e67</con:id>
                                            <con1:expr>
                                                <con:xqueryText>string($RSPRegistroNuevoACHEnviado/reg:PN_ACHSECUENCIA/text())</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="aplicaDevolucion">
                                            <con:id>_ActionId-1941418778872710038--300f20f0.17f2c6d81d3.-7fe4</con:id>
                                            <con1:expr>
                                                <con:xqueryText>if($localAccountType='INDIRECT' and upper-case($errorCode) !='SUCCESS')then(
 'S'
)else(
	'N'
)</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:responseTransform>
                                </con1:wsCallout>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
            <con3:stage name="RegistrarACHEnviado" errorHandler="_onErrorHandler-8954991653965782188--7007a373.16ada7dd515.-7609">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con:varNsDecl namespace="T24WebServicesImpl" prefix="t24"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-8954991653965782188--7007a373.16ada7dd515.-760b</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$errorCode = 'SUCCESS'</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:wsCallout>
                                    <con:id>_ActionId-8954991653965782188--7007a373.16ada7dd515.-760a</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ACH/Enviado/SvcACHEnviado/biz/svcACHEnviados" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>RegistrarACHEnviados</con1:operation>
                                    <con1:request>
                                        <con1:body>REQRegistrarACHEnviados</con1:body>
                                    </con1:request>
                                    <con1:response>
                                        <con1:body>RSPRegistrarACHEnviados</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                        <con1:assign varName="REQRegistrarACHEnviados">
                                            <con:id>_ActionId-2168874549195223618--480c5eee.16ae62a5a1f.-7d83</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/registrarACHEnviadosIn"/>
                                                    <con:param name="transferenciasACHRequest">
                                                        <con:path>$body/tran:transferenciasACHRequest</con:path>
                                                    </con:param>
                                                    <con:param name="requestHeader1">
                                                        <con:path>$header/aut:RequestHeader</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform>
                                        <con1:assign varName="validacionServicio">
                                            <con:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7f92</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoRegistrarACHEnviados"/>
                                                    <con:param name="messages">
                                                        <con:path>if(fn:string-join($RSPRegistrarACHEnviados/Status/messages, ' ') = '') then(
	''
)else(
	fn:string-join($RSPRegistrarACHEnviados/Status/messages, '. ')
)</con:path>
                                                    </con:param>
                                                    <con:param name="successIndicator">
                                                        <con:path>fn:upper-case(fn:string($RSPRegistrarACHEnviados/Status/successIndicator/text()))</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="errorCode">
                                            <con:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7f75</con:id>
                                            <con1:expr>
                                                <con:xqueryText>fn:string($validacionServicio/ESTADO_PROCESO/text())</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="validationMessage">
                                            <con:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7f58</con:id>
                                            <con1:expr>
                                                <con:xqueryText>fn:string($validacionServicio/VALIDACION_MENSAJE/text())</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="validationMessageTransfACH">
                                            <con:id>_ActionId-2266305818621866675-32fe6d53.16cbf05230d.-7f91</con:id>
                                            <con1:expr>
                                                <con:xqueryText>$validationMessage</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="aplicaDevolucion">
                                            <con:id>_ActionId-1941418778872710038--300f20f0.17f2c6d81d3.-7fc3</con:id>
                                            <con1:expr>
                                                <con:xqueryText>let $successIndicator := string($RSPRegistrarACHEnviados/Status/successIndicator/text())
return
if($localAccountType='INDIRECT' and upper-case($successIndicator) ='T24ERROR')then(
 'S'
)else(
	'N'
)</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:responseTransform>
                                </con1:wsCallout>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
            <con3:stage name="ConsultaRegistroT24" errorHandler="_onErrorHandler-8954991653965782188--7007a373.16ada7dd515.-7602">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con:varNsDecl namespace="T24WebServicesImpl" prefix="t24"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-8954991653965782188--7007a373.16ada7dd515.-7603</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$errorCode = 'SUCCESS'</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:wsCallout>
                                    <con:id>_ActionId-1606556949135673108-b0b5017.16c1f735419.-786b</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ACH/Enviado/SvcACHEnviado/biz/svcACHEnviados" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>ConsultaDatosACHEnviado</con1:operation>
                                    <con1:request>
                                        <con1:body>REQConsultaDatosACHEnviado</con1:body>
                                    </con1:request>
                                    <con1:response>
                                        <con1:body>RSPConsultaDatosACHEnviado</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                        <con1:assign varName="REQConsultaDatosACHEnviado">
                                            <con:id>_ActionId-8966469340026468143--bdb7b12.16c246b0a4e.-7fe3</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/consultaDatosACHEnviadoIn"/>
                                                    <con:param name="transactionId">
                                                        <con:path>fn:string($RSPRegistrarACHEnviados/Status/transactionId/text())</con:path>
                                                    </con:param>
                                                    <con:param name="requestHeader1">
                                                        <con:path>$header/aut:RequestHeader</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform>
                                        <con1:assign varName="validacionServicio">
                                            <con:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7db4</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoConsultaDatosACHEnviado"/>
                                                    <con:param name="txnStatus">
                                                        <con:path>fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/TXNSTATUS/text())</con:path>
                                                    </con:param>
                                                    <con:param name="messages">
                                                        <con:path>if(fn:string-join($RSPConsultaDatosACHEnviado/Status/messages, ' ') = '') then(
	''
)else(
	fn:string-join($RSPConsultaDatosACHEnviado/Status/messages, '. ')
)</con:path>
                                                    </con:param>
                                                    <con:param name="successIndicator">
                                                        <con:path>fn:upper-case(fn:string($RSPConsultaDatosACHEnviado/Status/successIndicator/text()))</con:path>
                                                    </con:param>
                                                    <con:param name="zeroRecords">
                                                        <con:path>if(fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/ZERORECORDS/text()) = '') then(
	''
)else(
	fn:upper-case(fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/ZERORECORDS/text()))
)</con:path>
                                                    </con:param>
                                                    <con:param name="idRejection">
                                                        <con:path>fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/IDREJECTION/text())</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="errorCode">
                                            <con:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7d7a</con:id>
                                            <con1:expr>
                                                <con:xqueryText>let $codigoErrorProceso := fn:string($validacionServicio/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionServicio/ESTADO_PROCESO/text())

return
	if($codigoErrorProceso ='' or $estadoProceso = 'PENDING')then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="validationMessage">
                                            <con:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7d97</con:id>
                                            <con1:expr>
                                                <con:xqueryText>fn:string($validacionServicio/VALIDACION_MENSAJE/text())</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="isLbtr">
                                            <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7f78</con:id>
                                            <con1:expr>
                                                <con:xqueryText>fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/ISLBTR/text())</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="validationMessageTransfACH">
                                            <con:id>_ActionId-2266305818621866675-32fe6d53.16cbf05230d.-7f1f</con:id>
                                            <con1:expr>
                                                <con:xqueryText>$validationMessage</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="aplicaDevolucion">
                                            <con:id>_ActionId-1941418778872710038--300f20f0.17f2c6d81d3.-7fa6</con:id>
                                            <con1:expr>
                                                <con:xqueryText>let $successIndicator := string($RSPConsultaDatosACHEnviado/Status/successIndicator/text())
let $txnStatus := string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/TXNSTATUS/text())
return
if($localAccountType='INDIRECT' and upper-case($successIndicator)='SUCCESS' and upper-case($txnStatus) = 'REJECTED')then(
	'S'
)else(
	'N'
)</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:responseTransform>
                                </con1:wsCallout>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
            <con3:stage name="TransferenciaACH_OtroBanco" errorHandler="_onErrorHandler-8954991653965782188--7007a373.16ada7dd515.-75f2">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                    <con:varNsDecl namespace="http://tempuri.org/" prefix="tem"/>
                    <con:varNsDecl namespace="http://schemas.datacontract.org/2004/07/WcfACHOnline" prefix="wcf"/>
                    <con:varNsDecl namespace="T24WebServicesImpl" prefix="t24"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-3193859396475235595-d8155bc.16b2d4a82ae.-7838</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$errorCode = 'SUCCESS' and $isLbtr != 'YES' and current-time() >= fn-bea:time-from-string-with-format("HH:mm", $pystEndClosedTimeParam) and current-time() &lt;= fn-bea:time-from-string-with-format("HH:mm", $pystBeginClosedTimeParam)</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:ifThenElse>
                                    <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7e64</con:id>
                                    <con1:case>
                                        <con1:condition>
                                            <con:xqueryText>fn:string($body/tran:transferenciasACHRequest/CREDIT_CURRENCY/text()) = 'HNL'</con:xqueryText>
                                        </con1:condition>
                                        <con1:actions>
                                            <con1:wsCallout>
                                                <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7e5f</con:id>
                                                <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/PYST/envioTransfACH/biz/envioTransfACH" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con1:operation>SendCreditHNL</con1:operation>
                                                <con1:request>
                                                    <con1:body>REQSendCreditHNL</con1:body>
                                                </con1:request>
                                                <con1:response>
                                                    <con1:body>RSPSendCreditHNL</con1:body>
                                                </con1:response>
                                                <con1:requestTransform>
                                                    <con1:assign varName="REQSendCreditHNL">
                                                        <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7e63</con:id>
                                                        <con1:expr>
                                                            <con:xqueryTransform>
                                                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/envioACHHNL"/>
                                                                <con:param name="FtTt">
                                                                    <con:path>fn:string($RSPRegistrarACHEnviados/Status/transactionId/text())</con:path>
                                                                </con:param>
                                                                <con:param name="receivingId">
                                                                    <con:path>fn:string($body/tran:transferenciasACHRequest/BENEFICIARY_ID/text())</con:path>
                                                                </con:param>
                                                                <con:param name="transferenciasACHRequest1">
                                                                    <con:path>$body/tran:transferenciasACHRequest</con:path>
                                                                </con:param>
                                                                <con:param name="receivingBankId">
                                                                    <con:path>fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/ACHROUTINGNUM/text())</con:path>
                                                                </con:param>
                                                                <con:param name="originatorName">
                                                                    <con:path>fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/ACCTSHORTTITLE/text())</con:path>
                                                                </con:param>
                                                                <con:param name="origAccountType">
                                                                    <con:path>xs:int(fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/DEBITACCOUNTTYPE/text()))</con:path>
                                                                </con:param>
                                                                <con:param name="originatorId">
                                                                    <con:path>fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/LEGALID/text())</con:path>
                                                                </con:param>
                                                            </con:xqueryTransform>
                                                        </con1:expr>
                                                    </con1:assign>
                                                </con1:requestTransform>
                                                <con1:responseTransform>
                                                    <con1:assign varName="validacionServicio">
                                                        <con:id>_ActionId-2927016048225087839-10a9aba.16c6cb8beb1.-7fc9</con:id>
                                                        <con1:expr>
                                                            <con:xqueryTransform>
                                                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoPayExpedite"/>
                                                                <con:param name="messages">
                                                                    <con:path>fn:string($RSPSendCreditHNL/tem:SendCreditHNLResult/wcf:Message/text())</con:path>
                                                                </con:param>
                                                                <con:param name="reasonCode">
                                                                    <con:path>fn:string($RSPSendCreditHNL/tem:SendCreditHNLResult/wcf:ReasonCode/text())</con:path>
                                                                </con:param>
                                                                <con:param name="successIndicator">
                                                                    <con:path>fn:upper-case(fn:string($RSPSendCreditHNL/tem:SendCreditHNLResult/wcf:SuccessIndicator/text()))</con:path>
                                                                </con:param>
                                                            </con:xqueryTransform>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="respTransACH">
                                                        <con:id>_ActionId-2927016048225087839-10a9aba.16c6cb8beb1.-7ead</con:id>
                                                        <con1:expr>
                                                            <con:xqueryText>fn:string($validacionServicio/ESTADO_PROCESO/text())</con:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="messageTransACH">
                                                        <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7e1e</con:id>
                                                        <con1:expr>
                                                            <con:xqueryText>fn:string($validacionServicio/VALIDACION_MENSAJE/text())</con:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="reasonCode">
                                                        <con:id>_ActionId-2624000914225635068--20adf78.16cb5bf304b.-7e65</con:id>
                                                        <con1:expr>
                                                            <con:xqueryText>fn:string($RSPSendCreditHNL/tem:SendCreditHNLResult/wcf:ReasonCode/text())</con:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="messages">
                                                        <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7faa</con:id>
                                                        <con1:expr>
                                                            <con:xqueryText>fn:string($RSPSendCreditHNL/tem:SendCreditHNLResult/wcf:Message/text())</con:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="successIndicator">
                                                        <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7f55</con:id>
                                                        <con1:expr>
                                                            <con:xqueryText>fn:upper-case(fn:string($RSPSendCreditHNL/tem:SendCreditHNLResult/wcf:SuccessIndicator/text()))</con:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="messageId">
                                                        <con:id>_ActionId-5512939926709431582-5a6587d2.16c2ebe84a9.-57f8</con:id>
                                                        <con1:expr>
                                                            <con:xqueryText>fn:string($RSPSendCreditHNL/tem:SendCreditHNLResult/wcf:MessageID/text())</con:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                </con1:responseTransform>
                                            </con1:wsCallout>
                                        </con1:actions>
                                    </con1:case>
                                    <con1:default>
                                        <con1:wsCallout>
                                            <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7e5a</con:id>
                                            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/PYST/envioTransfACH/biz/envioTransfACH" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                            <con1:operation>SendCreditUSD</con1:operation>
                                            <con1:request>
                                                <con1:body>REQSendCreditUSD</con1:body>
                                            </con1:request>
                                            <con1:response>
                                                <con1:body>RSPSendCreditUSD</con1:body>
                                            </con1:response>
                                            <con1:requestTransform>
                                                <con1:assign varName="REQSendCreditUSD">
                                                    <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7e5e</con:id>
                                                    <con1:expr>
                                                        <con:xqueryTransform>
                                                            <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/envioACHUSDIN"/>
                                                            <con:param name="FtTt">
                                                                <con:path>fn:string($RSPRegistrarACHEnviados/Status/transactionId/text())</con:path>
                                                            </con:param>
                                                            <con:param name="receivingId">
                                                                <con:path>fn:string($body/tran:transferenciasACHRequest/BENEFICIARY_ID/text())</con:path>
                                                            </con:param>
                                                            <con:param name="transferenciasACHRequest1">
                                                                <con:path>$body/tran:transferenciasACHRequest</con:path>
                                                            </con:param>
                                                            <con:param name="receivingBankId">
                                                                <con:path>fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/ACHROUTINGNUM/text())</con:path>
                                                            </con:param>
                                                            <con:param name="origAccountType">
                                                                <con:path>xs:int(fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/DEBITACCOUNTTYPE/text()))</con:path>
                                                            </con:param>
                                                            <con:param name="originatorName">
                                                                <con:path>fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/ACCTSHORTTITLE/text())</con:path>
                                                            </con:param>
                                                            <con:param name="originatorId">
                                                                <con:path>fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/LEGALID/text())</con:path>
                                                            </con:param>
                                                        </con:xqueryTransform>
                                                    </con1:expr>
                                                </con1:assign>
                                            </con1:requestTransform>
                                            <con1:responseTransform>
                                                <con1:assign varName="validacionServicio">
                                                    <con:id>_ActionId-2927016048225087839-10a9aba.16c6cb8beb1.-7f91</con:id>
                                                    <con1:expr>
                                                        <con:xqueryTransform>
                                                            <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoPayExpedite"/>
                                                            <con:param name="messages">
                                                                <con:path>fn:string($RSPSendCreditUSD/tem:SendCreditUSDResult/wcf:Message/text())</con:path>
                                                            </con:param>
                                                            <con:param name="reasonCode">
                                                                <con:path>fn:string($RSPSendCreditUSD/tem:SendCreditUSDResult/wcf:ReasonCode/text())</con:path>
                                                            </con:param>
                                                            <con:param name="successIndicator">
                                                                <con:path>fn:upper-case(fn:string($RSPSendCreditUSD/tem:SendCreditUSDResult/wcf:SuccessIndicator/text()))</con:path>
                                                            </con:param>
                                                        </con:xqueryTransform>
                                                    </con1:expr>
                                                </con1:assign>
                                                <con1:assign varName="respTransACH">
                                                    <con:id>_ActionId-2927016048225087839-10a9aba.16c6cb8beb1.-7eab</con:id>
                                                    <con1:expr>
                                                        <con:xqueryText>fn:string($validacionServicio/ESTADO_PROCESO/text())</con:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                                <con1:assign varName="messageTransACH">
                                                    <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7e1c</con:id>
                                                    <con1:expr>
                                                        <con:xqueryText>fn:string($validacionServicio/VALIDACION_MENSAJE/text())</con:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                                <con1:assign varName="reasonCode">
                                                    <con:id>_ActionId-2624000914225635068--20adf78.16cb5bf304b.-7e48</con:id>
                                                    <con1:expr>
                                                        <con:xqueryText>fn:string($RSPSendCreditUSD/tem:SendCreditUSDResult/wcf:ReasonCode/text())</con:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                                <con1:assign varName="messages">
                                                    <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7f8d</con:id>
                                                    <con1:expr>
                                                        <con:xqueryText>fn:string($RSPSendCreditUSD/tem:SendCreditUSDResult/wcf:Message/text())</con:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                                <con1:assign varName="successIndicator">
                                                    <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7f38</con:id>
                                                    <con1:expr>
                                                        <con:xqueryText>fn:upper-case(fn:string($RSPSendCreditUSD/tem:SendCreditUSDResult/wcf:SuccessIndicator/text()))</con:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                                <con1:assign varName="messageId">
                                                    <con:id>_ActionId-5512939926709431582-5a6587d2.16c2ebe84a9.-57db</con:id>
                                                    <con1:expr>
                                                        <con:xqueryText>fn:string($RSPSendCreditUSD/tem:SendCreditUSDResult/wcf:MessageID/text())</con:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                            </con1:responseTransform>
                                        </con1:wsCallout>
                                    </con1:default>
                                </con1:ifThenElse>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con1:assign varName="proceso">
                                <con:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7e8f</con:id>
                                <con1:expr>
                                    <con:xqueryText>if($validationMessage !='' and $validationMessageService = '') then(
	'1'
)else(
	''
)</con:xqueryText>
                                </con1:expr>
                            </con1:assign>
                            <con1:ifThenElse>
                                <con:id>_ActionId-1781825777851371455--13bc3e9b.172d4c74e3a.-7efe</con:id>
                                <con1:case>
                                    <con1:condition>
                                        <con:xqueryText>not(current-time() >= fn-bea:time-from-string-with-format("HH:mm", $pystEndClosedTimeParam) and current-time() &lt;= fn-bea:time-from-string-with-format("HH:mm", $pystBeginClosedTimeParam))</con:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                        <con1:assign varName="reasonCode">
                                            <con:id>_ActionId-1781825777851371455--13bc3e9b.172d4c74e3a.-7efc</con:id>
                                            <con1:expr>
                                                <con:xqueryText>'1005'</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="messages">
                                            <con:id>_ActionId-1781825777851371455--13bc3e9b.172d4c74e3a.-7efa</con:id>
                                            <con1:expr>
                                                <con:xqueryText>'Servicio fuera de linea'</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="successIndicator">
                                            <con:id>_ActionId-1781825777851371455--13bc3e9b.172d4c74e3a.-7ef8</con:id>
                                            <con1:expr>
                                                <con:xqueryText>'ERROR'</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="messageId">
                                            <con:id>_ActionId-1781825777851371455--13bc3e9b.172d4c74e3a.-7ef6</con:id>
                                            <con1:expr>
                                                <con:xqueryText>''</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="respTransACH">
                                            <con:id>_ActionId-1781825777851371455--13bc3e9b.172d4c74e3a.-7e6d</con:id>
                                            <con1:expr>
                                                <con:xqueryText>'ERROR'</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:actions>
                                </con1:case>
                                <con1:default/>
                            </con1:ifThenElse>
                        </con1:default>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
            <con3:stage name="ProcesamientoLBTR" errorHandler="_onErrorHandler-7777841812315021260-2a2c7ff3.16c299bf509.-7dfc">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                    <con:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/ProcesamientoLBTR" prefix="proc"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7e78</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$errorCode = 'SUCCESS' and $isLbtr = 'YES' and not($accountType = 'CREDITCA')</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:wsCallout>
                                    <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7e70</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/LBTR/ProcesamientoLBTR/biz/ProcesamientoLBTR_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>ProcesamientoLBTR</con1:operation>
                                    <con1:request>
                                        <con1:body>REQProcesamientoLBTR</con1:body>
                                    </con1:request>
                                    <con1:response>
                                        <con1:body>RSPProcesamientoLBTR</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                        <con1:assign varName="REQProcesamientoLBTR">
                                            <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7e73</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/procesamientoLBTRIn"/>
                                                    <con:param name="consultaDatosACHEnviadoResponse">
                                                        <con:path>$RSPConsultaDatosACHEnviado</con:path>
                                                    </con:param>
                                                    <con:param name="transferenciasACHRequest">
                                                        <con:path>$body/tran:transferenciasACHRequest</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform>
                                        <con1:assign varName="validacionServicio">
                                            <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-7fc8</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoProcesamientoLBTR"/>
                                                    <con:param name="messages">
                                                        <con:path>fn:string($RSPProcesamientoLBTR/proc:PV_MENSAJE_ERROR/text())</con:path>
                                                    </con:param>
                                                    <con:param name="successIndicator">
                                                        <con:path>fn:upper-case(fn:string($RSPProcesamientoLBTR/proc:PV_CODIGO_ERROR/text()))</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="respTransACH">
                                            <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-7fab</con:id>
                                            <con1:expr>
                                                <con:xqueryText>let $successIndicator := fn:string($RSPProcesamientoLBTR/proc:PV_CODIGO_ERROR/text())

return
	if($successIndicator = 'REJECTED') then(
		'REJECTED'
	)else(
		fn:string($validacionServicio/ESTADO_PROCESO/text())
	)</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="messageTransACH">
                                            <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-7f8e</con:id>
                                            <con1:expr>
                                                <con:xqueryText>fn:string($validacionServicio/VALIDACION_MENSAJE/text())</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="reasonCode">
                                            <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7efe</con:id>
                                            <con1:expr>
                                                <con:xqueryText>fn:string($RSPProcesamientoLBTR/proc:PV_CODIGO_ERROR/text())</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="successIndicator">
                                            <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7e31</con:id>
                                            <con1:expr>
                                                <con:xqueryText>$reasonCode</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="messages">
                                            <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7ee1</con:id>
                                            <con1:expr>
                                                <con:xqueryText>fn:string($RSPProcesamientoLBTR/proc:PV_MENSAJE_ERROR/text())</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:responseTransform>
                                </con1:wsCallout>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con1:ifThenElse>
                                <con:id>_ActionId-8512695519115535170-126b2407.17314babdf1.-7a48</con:id>
                                <con1:case>
                                    <con1:condition>
                                        <con:xqueryText>$errorCode = 'SUCCESS' and $isLbtr = 'YES' and $accountType = 'CREDITCA'</con:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                        <con1:assign varName="validacionServicio">
                                            <con:id>_ActionId-8512695519115535170-126b2407.17314babdf1.-7a46</con:id>
                                            <con1:expr>
                                                <con:xqueryText><![CDATA[<VALIDACION_PROCESO>
	<ESTADO_PROCESO>ERROR</ESTADO_PROCESO>, 
	<VALIDACION_MENSAJE>{ fn:concat('LBT-001 ', 'No se puede realizar pagos de TC con LBTR') }</VALIDACION_MENSAJE>, 
	<CODIGO_ERROR_PROCESO>LBT-001</CODIGO_ERROR_PROCESO>, 
	<MENSAJE_ERROR_PROCESO>No se puede realizar pagos de TC con LBTR</MENSAJE_ERROR_PROCESO>
</VALIDACION_PROCESO>]]></con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="respTransACH">
                                            <con:id>_ActionId-8512695519115535170-126b2407.17314babdf1.-7a29</con:id>
                                            <con1:expr>
                                                <con:xqueryText>fn:string($validacionServicio/ESTADO_PROCESO/text())</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="messageTransACH">
                                            <con:id>_ActionId-8512695519115535170-126b2407.17314babdf1.-7a0c</con:id>
                                            <con1:expr>
                                                <con:xqueryText>fn:string($validacionServicio/VALIDACION_MENSAJE/text())</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="reasonCode">
                                            <con:id>_ActionId-8512695519115535170-126b2407.17314babdf1.-79ef</con:id>
                                            <con1:expr>
                                                <con:xqueryText>$respTransACH</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="successIndicator">
                                            <con:id>_ActionId-8512695519115535170-126b2407.17314babdf1.-79d2</con:id>
                                            <con1:expr>
                                                <con:xqueryText>$respTransACH</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="messages">
                                            <con:id>_ActionId-8512695519115535170-126b2407.17314babdf1.-79b5</con:id>
                                            <con1:expr>
                                                <con:xqueryText>$messageTransACH</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:actions>
                                </con1:case>
                                <con1:default/>
                            </con1:ifThenElse>
                        </con1:default>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
            <con3:stage name="ConfirmacionACHEnviado" errorHandler="_onErrorHandler-8966469340026468143--bdb7b12.16c246b0a4e.-7d60">
                <con3:context>
                    <con:varNsDecl namespace="T24WebServicesImpl" prefix="t24"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/ProcesamientoLBTR" prefix="proc"/>
                    <con:varNsDecl namespace="http://tempuri.org/" prefix="tem"/>
                    <con:varNsDecl namespace="http://schemas.datacontract.org/2004/07/WcfACHOnline" prefix="wcf"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-8966469340026468143--bdb7b12.16c246b0a4e.-7ecc</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$validationMessageService ='' and fn:string($respTransACH) != 'PENDING' and $validationMessageTransfACH = ''</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:wsCallout>
                                    <con:id>_ActionId-8966469340026468143--bdb7b12.16c246b0a4e.-7e07</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ACH/Enviado/SvcACHEnviado/biz/svcACHEnviados" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>ConfirmacionACHEnviados</con1:operation>
                                    <con1:request>
                                        <con1:body>REQConfirmacionACHEnviados</con1:body>
                                    </con1:request>
                                    <con1:response>
                                        <con1:body>RSPConfirmacionACHEnviados</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                        <con1:assign varName="REQConfirmacionACHEnviados">
                                            <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7dc4</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/confirmacionACHEnviadoIn"/>
                                                    <con:param name="pxpErrorCode">
                                                        <con:path>fn:replace(fn:substring(fn:concat($reasonCode, '-', $messages), 1, 150), '(\:|\[|\]|\\|\||\"|\^|\,|\$|\?|\*|\_|\-|\+|\{|\}|\(|\))', '.')</con:path>
                                                    </con:param>
                                                    <con:param name="id">
                                                        <con:path>fn:string($RSPRegistrarACHEnviados/Status/transactionId/text())</con:path>
                                                    </con:param>
                                                    <con:param name="pxpResult">
                                                        <con:path>$successIndicator</con:path>
                                                    </con:param>
                                                    <con:param name="legendBankUser">
                                                        <con:path>fn:string($messageId)</con:path>
                                                    </con:param>
                                                    <con:param name="requestHeader1">
                                                        <con:path>$header/aut:RequestHeader</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform>
                                        <con1:assign varName="validacionServicio">
                                            <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-7d0a</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoConfirmacionACHEnviado"/>
                                                    <con:param name="messages">
                                                        <con:path>if(fn:string-join($RSPConfirmacionACHEnviados/Status/messages, ' ') = '') then(
	''
)else(
	fn:string-join($RSPConfirmacionACHEnviados/Status/messages, '. ')
)</con:path>
                                                    </con:param>
                                                    <con:param name="successIndicator">
                                                        <con:path>fn:upper-case(fn:string($RSPConfirmacionACHEnviados/Status/successIndicator/text()))</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="errorCodeT24">
                                            <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7d6f</con:id>
                                            <con1:expr>
                                                <con:xqueryText>fn:string($validacionServicio/ESTADO_PROCESO/text())</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="proceso">
                                            <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7dbb</con:id>
                                            <con1:expr>
                                                <con:xqueryText>if(fn:string($validacionServicio/ESTADO_PROCESO/text()) != 'SUCCESS' and fn:string($respTransACH) = 'SUCCESS') then(
	'2'
)else if(fn:string($validacionServicio/ESTADO_PROCESO/text()) != 'SUCCESS' and fn:string($respTransACH) != 'SUCCESS') then(
	'4'
)else(
	if(fn:string($respTransACH) != 'SUCCESS') then(
		'4'
	)else(
		''
	)
	
)</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:responseTransform>
                                </con1:wsCallout>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
            <con3:stage name="ConsultaDatosACHEnviado" errorHandler="_onErrorHandler-8966469340026468143--bdb7b12.16c246b0a4e.-7d5f">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con:varNsDecl namespace="T24WebServicesImpl" prefix="t24"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-8966469340026468143--bdb7b12.16c246b0a4e.-7d99</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$validationMessageService ='' and fn:string($respTransACH) != 'PENDING' and $errorCodeT24 = 'SUCCESS' and $validationMessageTransfACH = ''</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:wsCallout>
                                    <con:id>_ActionId-8966469340026468143--bdb7b12.16c246b0a4e.-7d61</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ACH/Enviado/SvcACHEnviado/biz/svcACHEnviados" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>ConsultaDatosACHEnviado</con1:operation>
                                    <con1:request>
                                        <con1:body>REQConsultaDatosACHEnviado</con1:body>
                                    </con1:request>
                                    <con1:response>
                                        <con1:body>RSPConsultaDatosACHEnviado</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                        <con1:assign varName="REQConsultaDatosACHEnviado">
                                            <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7d01</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/consultaDatosACHEnviadoIn"/>
                                                    <con:param name="requestHeader1">
                                                        <con:path>$header/aut:RequestHeader</con:path>
                                                    </con:param>
                                                    <con:param name="transactionId">
                                                        <con:path>fn:string($RSPConfirmacionACHEnviados/Status/transactionId/text())</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform>
                                        <con1:assign varName="validacionServicio">
                                            <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-7c08</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoConsultaConfirmacionACHEnviado"/>
                                                    <con:param name="txnStatus">
                                                        <con:path>fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/TXNSTATUS/text())</con:path>
                                                    </con:param>
                                                    <con:param name="idTxnT24">
                                                        <con:path>if(fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/IDTXNT24/text()) = '') then(
	''
)else(
    fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/IDTXNT24/text())
)</con:path>
                                                    </con:param>
                                                    <con:param name="messages">
                                                        <con:path>if(fn:string-join($RSPConsultaDatosACHEnviado/Status/messages, ' ') = '') then(
	''
)else(
	fn:string-join($RSPConsultaDatosACHEnviado/Status/messages, '. ')
)</con:path>
                                                    </con:param>
                                                    <con:param name="respTransACH">
                                                        <con:path>$respTransACH</con:path>
                                                    </con:param>
                                                    <con:param name="successIndicator">
                                                        <con:path>fn:upper-case(fn:string($RSPConsultaDatosACHEnviado/Status/successIndicator/text()))</con:path>
                                                    </con:param>
                                                    <con:param name="idRejection">
                                                        <con:path>if(fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/IDREJECTION/text()) = '') then(
	''
)else(
	fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/IDREJECTION/text())
)</con:path>
                                                    </con:param>
                                                    <con:param name="zeroRecords">
                                                        <con:path>if(fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/ZERORECORDS/text()) = '') then(
	''
)else(
	fn:upper-case(fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/ZERORECORDS/text()))
)</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="proceso">
                                            <con:id>_ActionId-2266305818621866675-32fe6d53.16cbf05230d.-7f00</con:id>
                                            <con1:expr>
                                                <con:xqueryText>if(fn:string($validacionServicio/ESTADO_PROCESO/text()) != 'SUCCESS' and fn:string($respTransACH) = 'SUCCESS') then(
	if(fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/TXNSTATUS/text()) = 'PENDING') then(
		'2'
	)else(
		'6'
	)
)else if(fn:string($respTransACH) != 'SUCCESS') then(
	if(fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/TXNSTATUS/text()) = ('PENDING','REJECTED')) then(
		'4'
	)else(
		'6'
	)
)else(
	''
)</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:responseTransform>
                                </con1:wsCallout>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
            <con3:stage name="programadasACH">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                    <con:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/registroNuevoACHEnviado" prefix="reg"/>
                    <con:varNsDecl namespace="T24WebServicesImpl" prefix="t24"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-56a6</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>$validationMessageService ='' and fn:string($respTransACH) = 'ERROR' and $errorCodeT24 = 'SUCCESS' and $validationMessageTransfACH = '' and $reasonCode = '1005'</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:ifThenElse>
                                    <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-566e</con:id>
                                    <con1:case>
                                        <con1:condition>
                                            <con:xqueryText>fn:string($body/tran:transferenciasACHRequest/LOCAL_ACCOUNT_TYPE/text()) = 'SCHEDULED'</con:xqueryText>
                                        </con1:condition>
                                        <con1:actions>
                                            <con1:assign varName="messageTransACH">
                                                <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-55dd</con:id>
                                                <con1:expr>
                                                    <con:xqueryText>'No se pudo procesar su ACH'</con:xqueryText>
                                                </con1:expr>
                                            </con1:assign>
                                            <con1:assign varName="indicatorAutorization">
                                                <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-5636</con:id>
                                                <con1:expr>
                                                    <con:xqueryText>''</con:xqueryText>
                                                </con1:expr>
                                            </con1:assign>
                                            <con1:assign varName="respTransACH">
                                                <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-5619</con:id>
                                                <con1:expr>
                                                    <con:xqueryText>'ERROR'</con:xqueryText>
                                                </con1:expr>
                                            </con1:assign>
                                            <con1:assign varName="msgTransferencia">
                                                <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-55df</con:id>
                                                <con1:expr>
                                                    <con:xqueryText>''</con:xqueryText>
                                                </con1:expr>
                                            </con1:assign>
                                        </con1:actions>
                                    </con1:case>
                                    <con1:default>
                                        <con1:assign varName="achCuentaOffline">
                                            <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-55a5</con:id>
                                            <con1:expr>
                                                <con:xqueryText>if ($creditCurrency = 'HNL') then (
	fn:string($RSPObtenerParams/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$cuentaProgramadaHNLParam]/osb:VALUE/text())
) else (
	fn:string($RSPObtenerParams/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$cuentaProgramadaUSDParam]/osb:VALUE/text())
)</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="uuid">
                                            <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-5588</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:wsCallout>
                                            <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-556b</con:id>
                                            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/Transferencias/Resources/transferenciasBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                            <con1:operation>Transfmodelbankentrecuentas</con1:operation>
                                            <con1:request>
                                                <con1:body>REQTxnAch</con1:body>
                                            </con1:request>
                                            <con1:response>
                                                <con1:body>RSPTxnAch</con1:body>
                                            </con1:response>
                                            <con1:requestTransform>
                                                <con1:assign varName="REQTxnAch">
                                                    <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-5489</con:id>
                                                    <con1:expr>
                                                        <con:xqueryTransform>
                                                            <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/ProgramadasACHInModelBankFT"/>
                                                            <con:param name="UUID">
                                                                <con:path>fn:string($uuid)</con:path>
                                                            </con:param>
                                                            <con:param name="CreditAccount">
                                                                <con:path>$achCuentaOffline</con:path>
                                                            </con:param>
                                                            <con:param name="Header">
                                                                <con:path>$header/aut:RequestHeader</con:path>
                                                            </con:param>
                                                            <con:param name="ACHRequest">
                                                                <con:path>$body/tran:transferenciasACHRequest</con:path>
                                                            </con:param>
                                                        </con:xqueryTransform>
                                                    </con1:expr>
                                                </con1:assign>
                                            </con1:requestTransform>
                                            <con1:responseTransform>
                                                <con1:assign varName="tranFT">
                                                    <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-5451</con:id>
                                                    <con1:expr>
                                                        <con:xqueryText>fn:string($RSPTxnAch/Status/transactionId/text())</con:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                                <con1:assign varName="programadaSuccessIndicator">
                                                    <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-5434</con:id>
                                                    <con1:expr>
                                                        <con:xqueryText>fn:string($RSPTxnAch/Status/successIndicator/text())</con:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                            </con1:responseTransform>
                                        </con1:wsCallout>
                                        <con1:ifThenElse>
                                            <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-53fc</con:id>
                                            <con1:case>
                                                <con1:condition>
                                                    <con:xqueryText>fn:upper-case($programadaSuccessIndicator) = 'SUCCESS'</con:xqueryText>
                                                </con1:condition>
                                                <con1:actions>
                                                    <con1:wsCallout>
                                                        <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-5318</con:id>
                                                        <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/TransferenciasACH/svcACHProgramadas/biz/svnACHProgramadas_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                        <con1:operation>svnACHProgramadas</con1:operation>
                                                        <con1:request>
                                                            <con1:body>REQACHProgramadas</con1:body>
                                                        </con1:request>
                                                        <con1:response>
                                                            <con1:body>RSPACHProgramadas</con1:body>
                                                        </con1:response>
                                                        <con1:requestTransform>
                                                            <con1:assign varName="REQACHProgramadas">
                                                                <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-52e0</con:id>
                                                                <con1:expr>
                                                                    <con:xqueryTransform>
                                                                        <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/ProgramadasACHIn"/>
                                                                        <con:param name="transferenciasACHRequest1">
                                                                            <con:path>$body/tran:transferenciasACHRequest</con:path>
                                                                        </con:param>
                                                                        <con:param name="TransaccionFT">
                                                                            <con:path>$tranFT</con:path>
                                                                        </con:param>
                                                                    </con:xqueryTransform>
                                                                </con1:expr>
                                                            </con1:assign>
                                                        </con1:requestTransform>
                                                        <con1:responseTransform/>
                                                    </con1:wsCallout>
                                                    <con1:assign varName="respTransACH">
                                                        <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-52a8</con:id>
                                                        <con1:expr>
                                                            <con:xqueryText>'SUCCESS'</con:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="indicatorAutorization">
                                                        <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-528b</con:id>
                                                        <con1:expr>
                                                            <con:xqueryText>'SUCCESS'</con:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="msgTransferencia">
                                                        <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-526e</con:id>
                                                        <con1:expr>
                                                            <con:xqueryText>'Transferencia Exitosa'</con:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                </con1:actions>
                                            </con1:case>
                                            <con1:default>
                                                <con1:assign varName="reasonCode">
                                                    <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-53c4</con:id>
                                                    <con1:expr>
                                                        <con:xqueryText>'F01'</con:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                                <con1:assign varName="messageTransACH">
                                                    <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-53a7</con:id>
                                                    <con1:expr>
                                                        <con:xqueryText>'No se pudo procesar su ACH'</con:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                                <con1:assign varName="indicatorAutorization">
                                                    <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-538a</con:id>
                                                    <con1:expr>
                                                        <con:xqueryText>''</con:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                                <con1:assign varName="respTransACH">
                                                    <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-536d</con:id>
                                                    <con1:expr>
                                                        <con:xqueryText>'ERROR'</con:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                                <con1:assign varName="msgTransferencia">
                                                    <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-5350</con:id>
                                                    <con1:expr>
                                                        <con:xqueryText>''</con:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                            </con1:default>
                                        </con1:ifThenElse>
                                        <con1:ifThenElse>
                                            <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-5236</con:id>
                                            <con1:case>
                                                <con1:condition>
                                                    <con:xqueryText>fn:matches($body/tran:transferenciasACHRequest/DEBIT_ACCOUNT/text(), "^[0-9]{3}")</con:xqueryText>
                                                </con1:condition>
                                                <con1:actions>
                                                    <con1:assign varName="achMontoComision">
                                                        <con:id>_ActionId-7311992800880199806-24e5488c.16efa90a2f0.-7fc9</con:id>
                                                        <con1:expr>
                                                            <con:xqueryText>if ($creditCurrency = 'HNL') then (
	fn:string($RSPObtenerParams/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$montoComisionHNLParam]/osb:VALUE/text())
) else (
	fn:string($RSPObtenerParams/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$montoComisionUSDParam]/osb:VALUE/text())
)</con:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="achCuentaComision">
                                                        <con:id>_ActionId-7311992800880199806-24e5488c.16efa90a2f0.-7fac</con:id>
                                                        <con1:expr>
                                                            <con:xqueryText>fn:string($RSPObtenerParams/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$cuentaComisionParam]/osb:VALUE/text())</con:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="uuid">
                                                        <con:id>_ActionId-7311992800880199806-24e5488c.16efa90a2f0.-7f8f</con:id>
                                                        <con1:expr>
                                                            <con:xqueryTransform>
                                                                <con:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                                                            </con:xqueryTransform>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:wsCallout>
                                                        <con:id>_ActionId-7311992800880199806-24e5488c.16efa90a2f0.-7f55</con:id>
                                                        <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/Transferencias/Resources/transferenciasBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                        <con1:operation>Transfmodelbankentrecuentas</con1:operation>
                                                        <con1:request>
                                                            <con1:body>REQComisionTxnAch</con1:body>
                                                        </con1:request>
                                                        <con1:response>
                                                            <con1:body>RSPComisionTxnAch</con1:body>
                                                        </con1:response>
                                                        <con1:requestTransform>
                                                            <con1:assign varName="REQComisionTxnAch">
                                                                <con:id>_ActionId-7311992800880199806-24e5488c.16efa90a2f0.-7f1d</con:id>
                                                                <con1:expr>
                                                                    <con:xqueryTransform>
                                                                        <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/ProgramadasACHInModelBankFTComision"/>
                                                                        <con:param name="UUID">
                                                                            <con:path>fn:string($uuid)</con:path>
                                                                        </con:param>
                                                                        <con:param name="CreditAccount">
                                                                            <con:path>$achCuentaComision</con:path>
                                                                        </con:param>
                                                                        <con:param name="Header">
                                                                            <con:path>$header/aut:RequestHeader</con:path>
                                                                        </con:param>
                                                                        <con:param name="ACHRequest">
                                                                            <con:path>$body/tran:transferenciasACHRequest</con:path>
                                                                        </con:param>
                                                                        <con:param name="BankCharge">
                                                                            <con:path>$achMontoComision</con:path>
                                                                        </con:param>
                                                                    </con:xqueryTransform>
                                                                </con1:expr>
                                                            </con1:assign>
                                                        </con1:requestTransform>
                                                        <con1:responseTransform/>
                                                    </con1:wsCallout>
                                                </con1:actions>
                                            </con1:case>
                                            <con1:default/>
                                        </con1:ifThenElse>
                                        <con1:wsCallout>
                                            <con:id>_ActionId-5957003397231250930-d380655.16f00be64d4.-7ffd</con:id>
                                            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ACH/Enviado/ActualizaRegistroACHEnviado/biz/actualizaRegistroACHEnviado_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                            <con1:operation>actualizaRegistroACHEnviado</con1:operation>
                                            <con1:request>
                                                <con1:body>REQActualizaRegistroACHEnviado</con1:body>
                                            </con1:request>
                                            <con1:response>
                                                <con1:body>RSPActualizaRegistroACHEnviado</con1:body>
                                            </con1:response>
                                            <con1:requestTransform>
                                                <con1:assign varName="REQActualizaRegistroACHEnviado">
                                                    <con:id>_ActionId-5957003397231250930-d380655.16f00be64d4.-7ffe</con:id>
                                                    <con1:expr>
                                                        <con:xqueryTransform>
                                                            <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/actualizaRegistroACHEnviadoIn"/>
                                                            <con:param name="achSecuencia">
                                                                <con:path>xs:decimal($RSPRegistroNuevoACHEnviado/reg:PN_ACHSECUENCIA)</con:path>
                                                            </con:param>
                                                            <con:param name="pxpErrorCode">
                                                                <con:path>''</con:path>
                                                            </con:param>
                                                            <con:param name="pxpResult">
                                                                <con:path>'1005'</con:path>
                                                            </con:param>
                                                            <con:param name="consultaDatosACHEnviadoResponse">
                                                                <con:path>if(empty($RSPConsultaDatosACHEnviado)) then(
	&lt;ns0:ConsultaDatosACHEnviadoResponse xmlns:ns0="T24WebServicesImpl"/> 
)else(
	$RSPConsultaDatosACHEnviado
)</con:path>
                                                            </con:param>
                                                            <con:param name="mensajeErrorProceso">
                                                                <con:path>''</con:path>
                                                            </con:param>
                                                            <con:param name="estadoProceso">
                                                                <con:path>fn:upper-case($programadaSuccessIndicator)</con:path>
                                                            </con:param>
                                                            <con:param name="refControlT24">
                                                                <con:path>fn:string($RSPRegistrarACHEnviados/Status/transactionId/text())</con:path>
                                                            </con:param>
                                                            <con:param name="codigoProceso">
                                                                <con:path>''</con:path>
                                                            </con:param>
                                                            <con:param name="pxpIdRef">
                                                                <con:path>''</con:path>
                                                            </con:param>
                                                            <con:param name="codigoErrorProceso">
                                                                <con:path>''</con:path>
                                                            </con:param>
                                                        </con:xqueryTransform>
                                                    </con1:expr>
                                                </con1:assign>
                                            </con1:requestTransform>
                                            <con1:responseTransform/>
                                        </con1:wsCallout>
                                    </con1:default>
                                </con1:ifThenElse>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
            <con3:stage name="EstadoOperacionACH_Pending">
                <con3:context/>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7c20</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>fn:string($respTransACH) = 'PENDING' and $validationMessageService ='' and $validationMessageTransfACH = ''</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:assign varName="proceso">
                                    <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7be8</con:id>
                                    <con1:expr>
                                        <con:xqueryText>'3'</con:xqueryText>
                                    </con1:expr>
                                </con1:assign>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
            <con3:stage name="EstadoOperacionACHError_Devoluciones" errorHandler="_onErrorHandler-7777841812315021260-2a2c7ff3.16c299bf509.-7565">
                <con3:context>
                    <con:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/svcACHDevoluciones" prefix="svc"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-798b</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>not(fn:string($respTransACH) = ('SUCCESS', 'PENDING')) and fn:string($body/tran:transferenciasACHRequest/LOCAL_ACCOUNT_TYPE/text()) = 'INDIRECT' and $validationMessageTransfACH = '' or $aplicaDevolucion = 'S'</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:wsCallout>
                                    <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-791d</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/TransferenciasACH/svcACHDevoluciones/biz/svcACHDevoluciones_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>svcACHDevoluciones</con1:operation>
                                    <con1:request>
                                        <con1:body>REQSvcACHDevoluciones</con1:body>
                                    </con1:request>
                                    <con1:response>
                                        <con1:body>RSPSvcACHDevoluciones</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                        <con1:assign varName="REQSvcACHDevoluciones">
                                            <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7725</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/ProgramadasACHDevolucionesIn"/>
                                                    <con:param name="transferenciasACHRequest1">
                                                        <con:path>$body/tran:transferenciasACHRequest</con:path>
                                                    </con:param>
                                                    <con:param name="FTTransaccion">
                                                        <con:path>fn:string($body/tran:transferenciasACHRequest/INTERFACE_REFERENCE_NO/text())</con:path>
                                                    </con:param>
                                                    <con:param name="MensajeDevolucion">
                                                        <con:path>fn:concat($reasonCode, '-', $messages)</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform>
                                        <con1:assign varName="validacionSvcACHDevoluciones">
                                            <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-7b62</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoSvcACHDevoluciones"/>
                                                    <con:param name="messages">
                                                        <con:path>fn:string($RSPSvcACHDevoluciones/svc:PV_PARAM13/text())</con:path>
                                                    </con:param>
                                                    <con:param name="successIndicator">
                                                        <con:path>fn:string($RSPSvcACHDevoluciones/svc:PV_PARAM12/text())</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="proceso">
                                            <con:id>_ActionId-2266305818621866675-32fe6d53.16cbf05230d.-7ec4</con:id>
                                            <con1:expr>
                                                <con:xqueryText>if(fn:string($validacionSvcACHDevoluciones/ESTADO_PROCESO/text()) != 'SUCCESS') then(
	'5'
)else(
	$proceso
)</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:responseTransform>
                                </con1:wsCallout>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
            <con3:stage name="ActualizaRegistroACHEnviado" errorHandler="_onErrorHandler-7777841812315021260-2a2c7ff3.16c299bf509.-7566">
                <con3:context>
                    <con:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/actualizaRegistroACHEnviado" prefix="act"/>
                    <con:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/registroNuevoACHEnviado" prefix="reg"/>
                    <con:varNsDecl namespace="T24WebServicesImpl" prefix="t24"/>
                    <con:varNsDecl namespace="http://tempuri.org/" prefix="tem"/>
                    <con:varNsDecl namespace="http://schemas.datacontract.org/2004/07/WcfACHOnline" prefix="wcf"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-78af</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>($validationMessageService ='' or $validationMessage ='') and fn:string($reasonCode) != '1005'</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:wsCallout>
                                    <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7877</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ACH/Enviado/ActualizaRegistroACHEnviado/biz/actualizaRegistroACHEnviado_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>actualizaRegistroACHEnviado</con1:operation>
                                    <con1:request>
                                        <con1:body>REQActualizaRegistroACHEnviado</con1:body>
                                    </con1:request>
                                    <con1:response>
                                        <con1:body>RSPActualizaRegistroACHEnviado</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                        <con1:assign varName="scenariosTest">
                                            <con:id>_ActionId-1320794007459757984-38e69499.16e843b1875.-7e34</con:id>
                                            <con1:expr>
                                                <con:xqueryText><![CDATA[<SCENARIOS>
    <PXPIDREF>
		{
			if(fn:string($RSPSendCreditHNL/tem:SendCreditHNLResult/wcf:MessageID/text()) = '') then(
				if(fn:string($RSPSendCreditUSD/tem:SendCreditUSDResult/wcf:MessageID/text()) = '') then(
        			''
			    )else(
        			fn:string($RSPSendCreditUSD/tem:SendCreditUSDResult/wcf:MessageID/text())
    			)
			)else(
				fn:string($RSPSendCreditHNL/tem:SendCreditHNLResult/wcf:MessageID/text())
			)
		}
    </PXPIDREF>,
    {
    	if(fn:string($validacionSvcACHDevoluciones/ESTADO_PROCESO/text()) = ('','SUCCESS')) then(
    		<ESTADO_PROCESO>{ fn:string($validacionServicio/ESTADO_PROCESO/text()) }</ESTADO_PROCESO>,
    		<CODIGO_ERROR_PROCESO>{ fn:string($validacionServicio/CODIGO_ERROR_PROCESO/text()) }</CODIGO_ERROR_PROCESO>,
    		<MENSAJE_ERROR_PROCESO>{ fn:string($validacionServicio/MENSAJE_ERROR_PROCESO/text()) }</MENSAJE_ERROR_PROCESO>
    		
    	) else(
    		<ESTADO_PROCESO>{ fn:string($validacionSvcACHDevoluciones/ESTADO_PROCESO/text()) }</ESTADO_PROCESO>,
    		<CODIGO_ERROR_PROCESO>{ fn:string($validacionSvcACHDevoluciones/CODIGO_ERROR_PROCESO/text()) }</CODIGO_ERROR_PROCESO>,
    		<MENSAJE_ERROR_PROCESO>{ fn:string($validacionSvcACHDevoluciones/MENSAJE_ERROR_PROCESO/text()) }</MENSAJE_ERROR_PROCESO>
    	)
    }
</SCENARIOS>]]></con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="REQActualizaRegistroACHEnviado">
                                            <con:id>_ActionId-7777841812315021260-2a2c7ff3.16c299bf509.-7698</con:id>
                                            <con1:expr>
                                                <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/actualizaRegistroACHEnviadoIn"/>
                                                    <con:param name="achSecuencia">
                                                        <con:path>$sequenceId</con:path>
                                                    </con:param>
                                                    <con:param name="pxpErrorCode">
                                                        <con:path>fn:substring(fn:string(fn:concat($reasonCode, '-', $messages)), 1, 500)</con:path>
                                                    </con:param>
                                                    <con:param name="pxpResult">
                                                        <con:path>fn:string($successIndicator)</con:path>
                                                    </con:param>
                                                    <con:param name="consultaDatosACHEnviadoResponse">
                                                        <con:path>if(empty($RSPConsultaDatosACHEnviado)) then(
	&lt;ns0:ConsultaDatosACHEnviadoResponse xmlns:ns0="T24WebServicesImpl"/> 
)else(
	$RSPConsultaDatosACHEnviado
)</con:path>
                                                    </con:param>
                                                    <con:param name="mensajeErrorProceso">
                                                        <con:path>fn:substring(fn:string($scenariosTest/MENSAJE_ERROR_PROCESO/text()), 1, 500)</con:path>
                                                    </con:param>
                                                    <con:param name="estadoProceso">
                                                        <con:path>fn:string($scenariosTest/ESTADO_PROCESO/text())</con:path>
                                                    </con:param>
                                                    <con:param name="refControlT24">
                                                        <con:path>fn:string($RSPRegistrarACHEnviados/Status/transactionId/text())</con:path>
                                                    </con:param>
                                                    <con:param name="codigoProceso">
                                                        <con:path>$proceso</con:path>
                                                    </con:param>
                                                    <con:param name="pxpIdRef">
                                                        <con:path>fn:string($scenariosTest/PXPIDREF/text())</con:path>
                                                    </con:param>
                                                    <con:param name="codigoErrorProceso">
                                                        <con:path>fn:string($scenariosTest/CODIGO_ERROR_PROCESO/text())</con:path>
                                                    </con:param>
                                                </con:xqueryTransform>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform>
                                        <con1:assign varName="sequenceId">
                                            <con:id>_ActionId-7875615858499647522-3966a751.17f2252b0eb.-7e52</con:id>
                                            <con1:expr>
                                                <con:xqueryText>if($sequenceId = "")then(
	string($RSPActualizaRegistroACHEnviado/act:PN_ACHSECUENCIA/text())
)else(
	$sequenceId
)</con:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                    </con1:responseTransform>
                                </con1:wsCallout>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="response" name="HN01_TransferenciasACH_ONLINE_response">
            <con3:stage name="FlujoSalida">
                <con3:context>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                    <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHType" prefix="tran"/>
                </con3:context>
                <con3:actions>
                    <con1:ifThenElse>
                        <con:id>_ActionId-3193859396475235595-d8155bc.16b2d4a82ae.-7e6a</con:id>
                        <con1:case>
                            <con1:condition>
                                <con:xqueryText>fn:upper-case(fn:string($respTransACH)) = 'SUCCESS'</con:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:ifThenElse>
                                    <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-5752</con:id>
                                    <con1:case>
                                        <con1:condition>
                                            <con:xqueryText>$reasonCode = '1005' and
fn:upper-case(fn:string($indicatorAutorization)) = 'SUCCESS'</con:xqueryText>
                                        </con1:condition>
                                        <con1:actions>
                                            <con1:replace varName="header" contents-only="true">
                                                <con:id>_ActionId-7311992800880199806-24e5488c.16efa90a2f0.-7ee5</con:id>
                                                <con1:expr>
                                                    <con:xqueryTransform>
                                                        <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/ProgramadasACHHeaderOut"/>
                                                        <con:param name="Response">
                                                            <con:path>$RSPTxnAch</con:path>
                                                        </con:param>
                                                    </con:xqueryTransform>
                                                </con1:expr>
                                            </con1:replace>
                                        </con1:actions>
                                    </con1:case>
                                    <con1:default>
                                        <con1:replace contents-only="true" varName="header">
                                            <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-5714</con:id>
                                            <con1:expr>
                                                <con:xqueryText><![CDATA[<aut:ResponseHeader>
	<transactionId>{ fn:string($RSPConsultaDatosACHEnviado/WSACHOUTGOINGType/gWSACHOUTGOINGDetailType/mWSACHOUTGOINGDetailType/IDTXNT24/text()) }</transactionId>
    <successIndicator>Success</successIndicator>
    <valueDate>{ fn-bea:date-to-string-with-format("yyyyMMdd", current-date()) }</valueDate>
</aut:ResponseHeader>]]></con:xqueryText>
                                            </con1:expr>
                                        </con1:replace>
                                    </con1:default>
                                </con1:ifThenElse>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con1:replace contents-only="true" varName="header">
                                <con:id>_ActionId-1183275552931819320--6d9c17c7.16ef5c128bd.-5756</con:id>
                                <con1:expr>
                                    <con:xqueryText><![CDATA[<aut:ResponseHeader>
	<successIndicator>
		{ 
			if(fn:string($respTransACH) = '') then(
				$errorCode
			)else(
				$respTransACH
			)
		}
	</successIndicator>
    <messages>
      	{
      		if(fn:string($msgTransferencia) = '') then(
      			if($validationMessageService != '') then(
	    			$validationMessageService
	    		)else(
	    			if(fn:string($messageTransACH) = '') then(
	    				fn:string($validationMessage) 
	    			)else(
	    				$messageTransACH	
	    			)
	    		)
      		)else(
      			fn:string($msgTransferencia)
      		) 
	    	
	    }
	</messages>
</aut:ResponseHeader>]]></con:xqueryText>
                                </con1:expr>
                            </con1:replace>
                        </con1:default>
                    </con1:ifThenElse>
                    <con1:replace contents-only="true" varName="body">
                        <con:id>_ActionId-3193859396475235595-d8155bc.16b2d4a82ae.-7dbe</con:id>
                        <con1:expr>
                            <con:xqueryText>if($sequenceId != '')then(
	&lt;tran:transferenciasACHResponse>
		&lt;SEQUENCE_ID>{$sequenceId}&lt;/SEQUENCE_ID>
	&lt;/tran:transferenciasACHResponse>
)else(
	&lt;tran:transferenciasACHResponse/>
)</con:xqueryText>
                        </con1:expr>
                    </con1:replace>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="error" name="_onErrorHandler-8954991653965782188--7007a373.16ada7dd515.-7609">
            <con3:stage name="ManejoErrorRegistrarACHEnviadoT24">
                <con3:context>
                    <con:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="validacionServicio">
                        <con:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7eae</con:id>
                        <con1:expr>
                            <con:xqueryTransform>
                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoRegistrarACHEnviados"/>
                                <con:param name="messages">
                                    <con:path>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())

return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con:path>
                                </con:param>
                                <con:param name="successIndicator">
                                    <con:path>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())

return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con:path>
                                </con:param>
                            </con:xqueryTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="errorCode">
                        <con:id>_ActionId-8954991653965782188--7007a373.16ada7dd515.-7608</con:id>
                        <con1:expr>
                            <con:xqueryText>fn:string($validacionServicio/ESTADO_PROCESO/text())</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                        <con:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7f03</con:id>
                        <con1:expr>
                            <con:xqueryText>fn:string($validacionServicio/VALIDACION_MENSAJE/text())</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessageTransfACH">
                        <con:id>_ActionId-2266305818621866675-32fe6d53.16cbf05230d.-7f74</con:id>
                        <con1:expr>
                            <con:xqueryText>$validationMessage</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con:resume>
                        <con:id>_ActionId-1198664836547443832--209b81e8.16b27de23a4.-784d</con:id>
                    </con:resume>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="error" name="_onErrorHandler-8954991653965782188--7007a373.16ada7dd515.-7602">
            <con3:stage name="ManejoErrorConsultaRegistroT24">
                <con3:context>
                    <con:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="validacionServicio">
                        <con:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7725</con:id>
                        <con1:expr>
                            <con:xqueryTransform>
                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoConsultaDatosACHEnviado"/>
                                <con:param name="txnStatus">
                                    <con:path>''</con:path>
                                </con:param>
                                <con:param name="messages">
                                    <con:path>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())

return
if($faultString != "") then (
	$faultString
) else (
	string($fault/ctx:reason/text())
)</con:path>
                                </con:param>
                                <con:param name="successIndicator">
                                    <con:path>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())

return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con:path>
                                </con:param>
                                <con:param name="zeroRecords">
                                    <con:path>''</con:path>
                                </con:param>
                                <con:param name="idRejection">
                                    <con:path>''</con:path>
                                </con:param>
                            </con:xqueryTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="errorCode">
                        <con:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7708</con:id>
                        <con1:expr>
                            <con:xqueryText>fn:string($validacionServicio/ESTADO_PROCESO/text())</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                        <con:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-76eb</con:id>
                        <con1:expr>
                            <con:xqueryText>fn:string($validacionServicio/VALIDACION_MENSAJE/text())</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessageTransfACH">
                        <con:id>_ActionId-2266305818621866675-32fe6d53.16cbf05230d.-7f02</con:id>
                        <con1:expr>
                            <con:xqueryText>$validationMessage</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con:resume>
                        <con:id>_ActionId-8954991653965782188--7007a373.16ada7dd515.-75fd</con:id>
                    </con:resume>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="error" name="_onErrorHandler-8954991653965782188--7007a373.16ada7dd515.-75f2">
            <con3:stage name="ManejoErrorTransferenciaACH_OtroBanco">
                <con3:context>
                    <con:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="validacionServicio">
                        <con:id>_ActionId-2927016048225087839-10a9aba.16c6cb8beb1.-7eaf</con:id>
                        <con1:expr>
                            <con:xqueryTransform>
                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoPayExpedite"/>
                                <con:param name="messages">
                                    <con:path>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())
return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con:path>
                                </con:param>
                                <con:param name="reasonCode">
                                    <con:path>''</con:path>
                                </con:param>
                                <con:param name="successIndicator">
                                    <con:path>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())
return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con:path>
                                </con:param>
                            </con:xqueryTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="respTransACH">
                        <con:id>_ActionId-8954991653965782188--7007a373.16ada7dd515.-75f1</con:id>
                        <con1:expr>
                            <con:xqueryText>fn:string($validacionServicio/ESTADO_PROCESO/text())</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="messageTransACH">
                        <con:id>_ActionId-8954991653965782188--7007a373.16ada7dd515.-75f0</con:id>
                        <con1:expr>
                            <con:xqueryText>fn:string($validacionServicio/VALIDACION_MENSAJE/text())</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="reasonCode">
                        <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7fe4</con:id>
                        <con1:expr>
                            <con:xqueryText>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())
return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="messages">
                        <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7fc7</con:id>
                        <con1:expr>
                            <con:xqueryText>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())
return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="successIndicator">
                        <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7f1b</con:id>
                        <con1:expr>
                            <con:xqueryText>$respTransACH</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con:resume>
                        <con:id>_ActionId-8954991653965782188--7007a373.16ada7dd515.-75ed</con:id>
                    </con:resume>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="error" name="_onErrorHandler-8966469340026468143--bdb7b12.16c246b0a4e.-7d60">
            <con3:stage name="ManejoErrorConfirmacionACHEnviado">
                <con3:context>
                    <con:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="validacionServicio">
                        <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-7c98</con:id>
                        <con1:expr>
                            <con:xqueryTransform>
                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoConfirmacionACHEnviado"/>
                                <con:param name="messages">
                                    <con:path>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())
return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con:path>
                                </con:param>
                                <con:param name="successIndicator">
                                    <con:path>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())
return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con:path>
                                </con:param>
                            </con:xqueryTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="errorCodeT24">
                        <con:id>_ActionId-5512939926709431582-5a6587d2.16c2ebe84a9.-7e92</con:id>
                        <con1:expr>
                            <con:xqueryText>fn:string($validacionServicio/ESTADO_PROCESO/text())</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="proceso">
                        <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7dd8</con:id>
                        <con1:expr>
                            <con:xqueryText>if(fn:string($respTransACH) = 'SUCCESS') then(
	'2'
)else(
	'4'
)</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con:resume>
                        <con:id>_ActionId-5512939926709431582-5a6587d2.16c2ebe84a9.-7e75</con:id>
                    </con:resume>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="error" name="_onErrorHandler-8966469340026468143--bdb7b12.16c246b0a4e.-7d5f">
            <con3:stage name="ManejoErrorConsultaDatosACHEnviado">
                <con3:context>
                    <con:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="validacionServicio">
                        <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-7b9a</con:id>
                        <con1:expr>
                            <con:xqueryTransform>
                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoConsultaConfirmacionACHEnviado"/>
                                <con:param name="txnStatus">
                                    <con:path>''</con:path>
                                </con:param>
                                <con:param name="idTxnT24">
                                    <con:path>''</con:path>
                                </con:param>
                                <con:param name="messages">
                                    <con:path>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())

return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con:path>
                                </con:param>
                                <con:param name="respTransACH">
                                    <con:path>''</con:path>
                                </con:param>
                                <con:param name="successIndicator">
                                    <con:path>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())

return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con:path>
                                </con:param>
                                <con:param name="idRejection">
                                    <con:path>''</con:path>
                                </con:param>
                                <con:param name="zeroRecords">
                                    <con:path>''</con:path>
                                </con:param>
                            </con:xqueryTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="proceso">
                        <con:id>_ActionId-2266305818621866675-32fe6d53.16cbf05230d.-7ee3</con:id>
                        <con1:expr>
                            <con:xqueryText>'6'</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con:resume>
                        <con:id>_ActionId-5512939926709431582-5a6587d2.16c2ebe84a9.-7e03</con:id>
                    </con:resume>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="error" name="_onErrorHandler-7777841812315021260-2a2c7ff3.16c299bf509.-7dfc">
            <con3:stage name="ManejoErrorProcesamientoLBTR">
                <con3:context>
                    <con:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="validacionServicio">
                        <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-7def</con:id>
                        <con1:expr>
                            <con:xqueryTransform>
                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoProcesamientoLBTR"/>
                                <con:param name="messages">
                                    <con:path>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())

return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con:path>
                                </con:param>
                                <con:param name="successIndicator">
                                    <con:path>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())

return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con:path>
                                </con:param>
                            </con:xqueryTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="respTransACH">
                        <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-7dd2</con:id>
                        <con1:expr>
                            <con:xqueryText>fn:string($validacionServicio/ESTADO_PROCESO/text())</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="messageTransACH">
                        <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-7db5</con:id>
                        <con1:expr>
                            <con:xqueryText>fn:string($validacionServicio/VALIDACION_MENSAJE/text())</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="reasonCode">
                        <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7ea7</con:id>
                        <con1:expr>
                            <con:xqueryText>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())

return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="successIndicator">
                        <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7e2f</con:id>
                        <con1:expr>
                            <con:xqueryText>$respTransACH</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="messages">
                        <con:id>_ActionId-4670695592672913571-7b0acdb5.16cd4486ba9.-7e35</con:id>
                        <con1:expr>
                            <con:xqueryText>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())

return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con:resume>
                        <con:id>_ActionId-5512939926709431582-5a6587d2.16c2ebe84a9.-7ee7</con:id>
                    </con:resume>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="error" name="_onErrorHandler-7777841812315021260-2a2c7ff3.16c299bf509.-7566">
            <con3:stage name="ManejoErrorActualizaRegistroACHEnviado">
                <con3:context>
                    <con:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="asuntoCorreo">
                        <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-77ee</con:id>
                        <con1:expr>
                            <con:xqueryText>'Error actualizando el registro de ACH en la BD'</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="mensajeCorreo">
                        <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-77d1</con:id>
                        <con1:expr>
                            <con:xqueryText>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())
return
	if($faultString != "") then (
		fn:concat('Ocurrio un error al momento de realizar la actualizacion del registro en la base de datos en ACH Enviados: ', fn:string($fault/ctx:errorCode/text()), ' ',$faultString)
	) else (
		fn:concat('Ocurrio un error al momento de realizar la actualizacion del registro en la base de datos en ACH Enviados: ', fn:string($fault/ctx:errorCode/text()), ' ',fn:string($fault/ctx:reason/text()))
	)</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con4:route>
                        <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-77b5</con:id>
                        <con4:service ref="Middleware/v2/BusinessServices/ITB/enviarCorreo/biz/enviarCorreo_db" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con4:operation>enviarCorreo</con4:operation>
                        <con4:outboundTransform>
                            <con1:replace contents-only="true" varName="body">
                                <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-777d</con:id>
                                <con1:expr>
                                    <con:xqueryTransform>
                                        <con:resource ref="Middleware/v2/Resources/Genericos/enviarCorreoIn"/>
                                        <con:param name="asunto">
                                            <con:path>$asuntoCorreo</con:path>
                                        </con:param>
                                        <con:param name="mensaje">
                                            <con:path>$mensajeCorreo</con:path>
                                        </con:param>
                                        <con:param name="direccion">
                                            <con:path>$correo</con:path>
                                        </con:param>
                                    </con:xqueryTransform>
                                </con1:expr>
                            </con1:replace>
                        </con4:outboundTransform>
                    </con4:route>
                    <con:resume>
                        <con:id>_ActionId-5512939926709431582-5a6587d2.16c2ebe84a9.-7f59</con:id>
                    </con:resume>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="error" name="_onErrorHandler-7777841812315021260-2a2c7ff3.16c299bf509.-7565">
            <con3:stage name="ManejoErrorsvcACHDevoluciones">
                <con3:context>
                    <con:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
                </con3:context>
                <con3:actions>
                    <con1:assign varName="validacionSvcACHDevoluciones">
                        <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-7b2a</con:id>
                        <con1:expr>
                            <con:xqueryTransform>
                                <con:resource ref="Middleware/v2/Resources/TransferenciasACH/xq/estadoProcesoSvcACHDevoluciones"/>
                                <con:param name="messages">
                                    <con:path>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())
return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con:path>
                                </con:param>
                                <con:param name="successIndicator">
                                    <con:path>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())
return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con:path>
                                </con:param>
                            </con:xqueryTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="proceso">
                        <con:id>_ActionId-2266305818621866675-32fe6d53.16cbf05230d.-7ec6</con:id>
                        <con1:expr>
                            <con:xqueryText>'5'</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con:resume>
                        <con:id>_ActionId-5512939926709431582-5a6587d2.16c2ebe84a9.-7c92</con:id>
                    </con:resume>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con3:pipeline type="error" name="_onErrorHandler-3737078030707750162-72ba21fd.16c861355b1.-7909">
            <con3:stage name="ManejoErrorRegistroNuevoACHEnviado">
                <con3:context/>
                <con3:actions>
                    <con1:assign varName="errorCode">
                        <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-78ec</con:id>
                        <con1:expr>
                            <con:xqueryText>'ERROR'</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                        <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-78cd</con:id>
                        <con1:expr>
                            <con:xqueryText>'R31-Error del sistema'</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessageService">
                        <con:id>_ActionId-2266305818621866675-32fe6d53.16cbf05230d.-7fae</con:id>
                        <con1:expr>
                            <con:xqueryText>$validationMessage</con:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con:resume>
                        <con:id>_ActionId-3737078030707750162-72ba21fd.16c861355b1.-78af</con:id>
                    </con:resume>
                </con3:actions>
            </con3:stage>
        </con3:pipeline>
        <con:flow xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
            <con:pipeline-node name="ValidacionesGenerales">
                <con:request>ValidacionesGenerales_request</con:request>
                <con:response>ValidacionesGenerales_response</con:response>
            </con:pipeline-node>
            <con:branch-node type="condition" name="ValidacionCrucePaisEmpresa">
                <con:context/>
                <con:branch-table variable="areSameSourceAndDestination">
                    <con:branch name="SameOriginAndDestination">
                        <con:operator>equals</con:operator>
                        <con:value>'YES'</con:value>
                        <con:flow>
                            <con:branch-node type="condition" name="RegionalizacionPaisEmpresa">
                                <con:context>
                                    <con4:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con4="http://www.bea.com/wli/sb/stages/config"/>
                                </con:context>
                                <con:branch-table variable="header">
                                    <con:xpath>
                                        <con4:xpathText xmlns:con4="http://www.bea.com/wli/sb/stages/config">./aut:RequestHeader/Region/SourceBank</con4:xpathText>
                                    </con:xpath>
                                    <con:branch name="HN01">
                                        <con:operator>equals</con:operator>
                                        <con:value>'HN01'</con:value>
                                        <con:flow>
                                            <con:pipeline-node name="HN01_TransferenciasACH">
                                                <con:request>HN01_TransferenciasACH_request</con:request>
                                                <con:response>HN01_TransferenciasACH_response</con:response>
                                            </con:pipeline-node>
                                            <con:branch-node type="condition" name="ACHTransportType">
                                                <con:context/>
                                                <con:branch-table variable="transportType">
                                                    <con:branch name="BATCH">
                                                        <con:operator>equals</con:operator>
                                                        <con:value>'BATCH'</con:value>
                                                        <con:flow>
                                                            <con:pipeline-node name="HN01_TransferenciasACH_BATCH">
                                                                <con:request>HN01_TransferenciasACH_BATCH_request</con:request>
                                                                <con:response>HN01_TransferenciasACH_BATCH_response</con:response>
                                                            </con:pipeline-node>
                                                        </con:flow>
                                                    </con:branch>
                                                    <con:branch name="ONLINE">
                                                        <con:operator>equals</con:operator>
                                                        <con:value>'ONLINE'</con:value>
                                                        <con:flow>
                                                            <con:pipeline-node name="HN01_TransferenciasACH_ONLINE">
                                                                <con:request>HN01_TransferenciasACH_ONLINE_request</con:request>
                                                                <con:response>HN01_TransferenciasACH_ONLINE_response</con:response>
                                                            </con:pipeline-node>
                                                        </con:flow>
                                                    </con:branch>
                                                    <con:default-branch>
                                                        <con:flow/>
                                                    </con:default-branch>
                                                </con:branch-table>
                                            </con:branch-node>
                                        </con:flow>
                                    </con:branch>
                                    <con:branch name="GT01">
                                        <con:operator>equals</con:operator>
                                        <con:value>'GT01'</con:value>
                                        <con:flow>
                                            <con:pipeline-node name="GT01_TransferenciasACH">
                                                <con:request>GT01_TransferenciasACH_request</con:request>
                                                <con:response>GT01_TransferenciasACH_response</con:response>
                                            </con:pipeline-node>
                                        </con:flow>
                                    </con:branch>
                                    <con:branch name="PA01">
                                        <con:operator>equals</con:operator>
                                        <con:value>'PA01'</con:value>
                                        <con:flow>
                                            <con:pipeline-node name="PA01_TransferenciasACH">
                                                <con:request>PA01_TransferenciasACH_request</con:request>
                                                <con:response>PA01_TransferenciasACH_response</con:response>
                                            </con:pipeline-node>
                                        </con:flow>
                                    </con:branch>
                                    <con:branch name="NI01">
                                        <con:operator>equals</con:operator>
                                        <con:value>'NI01'</con:value>
                                        <con:flow>
                                            <con:pipeline-node name="NI01_TransferenciasACH">
                                                <con:request>NI01_TransferenciasACH_request</con:request>
                                                <con:response>NI01_TransferenciasACH_response</con:response>
                                            </con:pipeline-node>
                                        </con:flow>
                                    </con:branch>
                                    <con:default-branch>
                                        <con:flow>
                                            <con:pipeline-node name="Default_TransferenciasACH">
                                                <con:request>Default_TransferenciasACH_request</con:request>
                                                <con:response>Default_TransferenciasACH_response</con:response>
                                            </con:pipeline-node>
                                        </con:flow>
                                    </con:default-branch>
                                </con:branch-table>
                            </con:branch-node>
                        </con:flow>
                    </con:branch>
                    <con:default-branch>
                        <con:flow>
                            <con:pipeline-node name="RegionalizacionPaisEmpresa_ConCruce">
                                <con:request>RegionalizacionPaisEmpresa_ConCruce_request</con:request>
                                <con:response>RegionalizacionPaisEmpresa_ConCruce_response</con:response>
                            </con:pipeline-node>
                        </con:flow>
                    </con:default-branch>
                </con:branch-table>
            </con:branch-node>
        </con:flow>
    </con3:router>
</con:pipelineEntry>