<bpel:process name="sjConsultaActivosCliente" targetNamespace="http://www.example.com/flow/Middleware/v2/BusinessServices/abanksGT/consultaActivosCliente/flow/sjConsultaActivosCliente" bea:name="sjConsultaActivosCliente" xmlns:tns="http://www.example.com/flow/Middleware/v2/BusinessServices/abanksGT/consultaActivosCliente/flow/sjConsultaActivosCliente" xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable" xmlns:rescon="http://www.bea.com/alsb/flow/resources/config" xmlns:bea="http://www.bea.com/bpel/ui/extensions" xmlns:ext="http://www.bea.com/bpel/extensions" xmlns:expr="http://www.bea.com/wli/sb/stages/config" xmlns:trf="http://www.bea.com/wli/sb/stages/transform/config" xmlns:bind="http://xmlns.oracle.com/pcbpel/adapter/db/AbanksGTSOAApplication/ConsultaActivosCliente/consultaActivosCliente" xmlns:ns1="http://xmlns.oracle.com/pcbpel/adapter/db/sp/consultaActivosCliente" xmlns:ns0="http://xmlns.oracle.com/pcbpel/adapter/db/sp/consultaListaCuentas" xmlns:ns2="http://xmlns.oracle.com/pcbpel/adapter/db/sp/consultaListaDepositosCliente" xmlns:ns3="http://xmlns.oracle.com/pcbpel/adapter/db/AbanksGTSOAApplication/ConsultaListaCuentas/consultaListaCuentas" xmlns:ns4="http://xmlns.oracle.com/pcbpel/adapter/db/AbanksGTSOAApplication/ConsultaListaDepositosCliente/consultaListaDepositosCliente">
    <bpel:partnerLinks>
        <bpel:partnerLink name="sjConsultaActivosCliente" partnerLinkType="tns:sjConsultaActivosCliente" myRole="sjConsultaActivosCliente">
	       </bpel:partnerLink>
	   <bpel:partnerLink name="consultaListaCuentas_db" partnerLinkType="tns:consultaListaCuentas_db_plnkType" partnerRole="consultaListaCuentas_db_PartnerRole">
	   </bpel:partnerLink>
	   <bpel:partnerLink name="consultaListaDepositosCliente_db" partnerLinkType="tns:consultaListaDepositosCliente_db_plnkType" partnerRole="consultaListaDepositosCliente_db_PartnerRole">
	   </bpel:partnerLink></bpel:partnerLinks>

	   <bpel:variables>
        <bpel:variable name="request" messageType="bind:args_in_msg">
	       </bpel:variable>
	       <bpel:variable name="response" messageType="bind:args_out_msg">
	       </bpel:variable>
    
    <bpel:variable name="reqConsultaListaCuentas" messageType="ns3:args_in_msg">
    </bpel:variable>
    <bpel:variable name="reqConsultaListaDepositos" messageType="ns4:args_in_msg">
    </bpel:variable>
    <bpel:variable name="rspConsultaListaCuentas" messageType="ns3:args_out_msg">
    </bpel:variable>
    <bpel:variable name="rspConsultaListaDepositos" messageType="ns4:args_out_msg">
    </bpel:variable></bpel:variables>

    <bpel:sequence>
        <bpel:receive partnerLink="sjConsultaActivosCliente" operation="consultaActivosCliente" variable="request" createInstance="yes">
	           <rescon:receiveInfo>
                <rescon:wsdl ref="Middleware/v2/BusinessServices/ABKGT/consultaActivosCliente/wsdl/consultaActivosCliente_db" binding="bind:consultaActivosCliente_ptt-binding"/>
            </rescon:receiveInfo>
        </bpel:receive>
        <bpel:flow bea:name="invokeCustomerOperations">
        	<bpel:scope bea:name="consultaListaCuentas">
        		
        		<bpel:sequence>
        			<bpel:assign>
        				<bpel:extensionAssignOperation>
        					<trf:assign varName="reqConsultaListaCuentas.InputParameters">
        						<trf:expr>
        							<expr:xqueryTransform>
        								<expr:resource ref="Middleware/v2/BusinessServices/ABKGT/consultaActivosCliente/xq/consultaActivosClienteCtasGTIn"/>
        								<expr:param name="inputParameters1">
        									<expr:path>$request.InputParameters</expr:path></expr:param></expr:xqueryTransform></trf:expr></trf:assign>
        				</bpel:extensionAssignOperation>
        			</bpel:assign>
        			<bpel:invoke operation="consultaListaCuentas" partnerLink="consultaListaCuentas_db" inputVariable="reqConsultaListaCuentas" outputVariable="rspConsultaListaCuentas">
        				<rescon:invokeInfo>
        					<rescon:service isProxy="false" ref="Middleware/v2/BusinessServices/ABKGT/consultaListaCuentas/biz/consultaListaCuentas_db"/></rescon:invokeInfo></bpel:invoke></bpel:sequence>
        	</bpel:scope>
        	<bpel:scope bea:name="consultaListaDepositos">
        		<bpel:sequence>
        			<bpel:assign>
        				<bpel:extensionAssignOperation>
        					<trf:assign varName="reqConsultaListaDepositos.InputParameters">
        						<trf:expr>
        							<expr:xqueryTransform>
        								<expr:resource ref="Middleware/v2/BusinessServices/ABKGT/consultaActivosCliente/xq/consultaActivosClienteDepsGTIn"/>
        								<expr:param name="inputParameters1">
        									<expr:path>$request.InputParameters</expr:path></expr:param></expr:xqueryTransform></trf:expr></trf:assign>
        				</bpel:extensionAssignOperation>
        			</bpel:assign>
        			<bpel:invoke operation="consultaListaDepositosCliente" partnerLink="consultaListaDepositosCliente_db" outputVariable="rspConsultaListaDepositos" inputVariable="reqConsultaListaDepositos">
        				<rescon:invokeInfo>
        					<rescon:service isProxy="false" ref="Middleware/v2/BusinessServices/ABKGT/consultaListaDepositos/biz/consultaListaDepositosCliente_db"/></rescon:invokeInfo></bpel:invoke></bpel:sequence>
        	</bpel:scope>
        </bpel:flow>
        <bpel:assign>
        	<bpel:extensionAssignOperation>
        		<trf:assign varName="response.OutputParameters">
        			<trf:expr>
        				<expr:xqueryTransform>
        					<expr:resource ref="Middleware/v2/Resources/ConsultaActivosCliente/xq/consultaActivosClienteGTOut"/>
        					
        					<expr:param name="outputParameters2">
        						<expr:path>$rspConsultaListaDepositos.OutputParameters</expr:path></expr:param>
        					<expr:param name="outputParameters1">
        						<expr:path>$rspConsultaListaCuentas.OutputParameters</expr:path></expr:param></expr:xqueryTransform></trf:expr></trf:assign>
        	</bpel:extensionAssignOperation>
        </bpel:assign>
        <bpel:reply partnerLink="sjConsultaActivosCliente" operation="consultaActivosCliente" variable="response"/>
    </bpel:sequence>
</bpel:process>