<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con3="http://www.bea.com/wli/sb/pipeline/config">
  <ser:coreEntry isProxy="true" isEnabled="true" isTracingEnabled="false" isAutoPublish="false">
    <ser:security>
      <con:custom-token-authentication>
        <con:username-password>
          <con:username-selector>
            <con:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:RequestHeader/Authentication/UserName/text()</con:xpath>
            <con:variable>header</con:variable>
          </con:username-selector>
          <con:password-selector>
            <con:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:RequestHeader/Authentication/Password/text()</con:xpath>
            <con:variable>header</con:variable>
          </con:password-selector>
        </con:username-password>
      </con:custom-token-authentication>
    </ser:security>
    <ser:binding type="SOAP" isSoap12="false" xsi:type="con4:SoapBindingType" xmlns:con4="http://www.bea.com/wli/sb/services/bindings/config">
      <con4:wsdl ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/wsdl/reprocesoACHRecibidasCRPS"/>
      <con4:port>
        <con4:name>reprocesoACHRecibidasCRPSSOAP</con4:name>
        <con4:namespace>http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCR/</con4:namespace>
      </con4:port>
      <con4:selector type="SOAP body"/>
      <con4:WSI-compliant>false</con4:WSI-compliant>
    </ser:binding>
    <ser:monitoring isEnabled="false">
      <ser:aggregationInterval>10</ser:aggregationInterval>
      <ser:pipelineMonitoringLevel>Pipeline</ser:pipelineMonitoringLevel>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
  </ser:coreEntry>
  <ser:endpointConfig>
    <tran:provider-id>http</tran:provider-id>
    <tran:inbound>true</tran:inbound>
    <tran:URI>
      <env:value>/SMiddleware/OperationsAndExecution/Payments/ReprocesoACHRecibidasCR</env:value>
    </tran:URI>
    <tran:inbound-properties/>
    <tran:all-headers>false</tran:all-headers>
    <tran:provider-specific xsi:type="http:HttpEndPointConfiguration">
      <http:inbound-properties>
        <http:use-https>true</http:use-https>
      </http:inbound-properties>
    </tran:provider-specific>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-7715966588124312103-7035df84.16a8d342f26.-7437">
    <con3:pipeline type="request" name="OperacionesReproceso_402_request">
      <con3:stage name="ReversionACHRecibido" errorHandler="_onErrorHandler-9186035235755702952-44726a00.16c6253849d.-7697">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
        </con3:context>
        <con3:actions>
          <con2:wsCallout>
            <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-798d</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ACH/Recibido/SvcACHRecibido/biz/svcACHRecibido" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>ReversionACHRecibido</con2:operation>
            <con2:request>
              <con2:body>$REQReversionACHRecibido</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>RSPReversionACHRecibido</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="REQReversionACHRecibido">
                <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7955</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/reversionACHRecibidoIn"/>
                    <con1:param name="pxpErrorCode">
                      <con1:path>fn:replace(fn:substring(fn:string($body/rep:reprocesoACHRecibidasCR/ERROR_MESSAGE/text()), 1, 150), '(\:|\[|\]|\\|\||\"|\^|\,|\$|\?|\*|\_|\-|\+|\{|\}|\(|\))', '.')</con1:path>
                    </con1:param>
                    <con1:param name="pxpResult">
                      <con1:path>fn:string($body/rep:reprocesoACHRecibidasCR/ERROR_CODE/text())</con1:path>
                    </con1:param>
                    <con1:param name="transactionId">
                      <con1:path>fn:string($body/rep:reprocesoACHRecibidasCR/T24_CONTROL_REF/text())</con1:path>
                    </con1:param>
                    <con1:param name="requestHeader1">
                      <con1:path>$header/aut:RequestHeader</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:assign varName="validacionReversionACHRecibido">
                <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-78e5</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/estadoProcesoReversionACHRecibido"/>
                    <con1:param name="messages">
                      <con1:path>if(fn:string-join($RSPReversionACHRecibido/Status/messages, ' ') = '') then(
	''
)else(
	fn:string-join($RSPReversionACHRecibido/Status/messages, '. ')
)</con1:path>
                    </con1:param>
                    <con1:param name="successIndicator">
                      <con1:path>fn:upper-case(fn:string($RSPReversionACHRecibido/Status/successIndicator/text()))</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="errorCode">
                <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-791d</con1:id>
                <con2:expr>
                  <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionReversionACHRecibido/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionReversionACHRecibido/ESTADO_PROCESO/text())

return
	if($codigoErrorProceso ='' or $estadoProceso = 'PENDING')then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="validationMessage">
                <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-78c8</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($validacionReversionACHRecibido/VALIDACION_MENSAJE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:responseTransform>
          </con2:wsCallout>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="OperacionesReproceso_101_request">
      <con3:stage name="ValidacionCuenta">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con3:context>
        <con3:actions>
          <con2:wsCallout>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7fb9</con1:id>
            <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v3/ProxyServices/ValidacionCuenta" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>validacionCuenta</con2:operation>
            <con2:request>
              <con2:body>$REQValidacionCuenta</con2:body>
              <con2:header>$REQHValidacionCuenta</con2:header>
            </con2:request>
            <con2:response>
              <con2:body>RSPValidacionCuenta</con2:body>
              <con2:header>RSPHValidacionCuenta</con2:header>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="REQValidacionCuenta">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7fbc</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/validacionCuentaIn"/>
                    <con1:param name="accountName">
                      <con1:path>fn:string($body/rep:reprocesoACHRecibidasCR/BEN_NAME/text())</con1:path>
                    </con1:param>
                    <con1:param name="accountNumber">
                      <con1:path>fn:string($body/rep:reprocesoACHRecibidasCR/BEN_ACCOUNT/text())</con1:path>
                    </con1:param>
                    <con1:param name="checkCancelled">
                      <con1:path>'YES'</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="REQHValidacionCuenta">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7e35</con1:id>
                <con2:expr>
                  <con1:xqueryText>$header</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:assign varName="validacionCreditoCuenta">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7fbb</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/estadoProcesoValidacionCuenta"/>
                    <con1:param name="accountStatus">
                      <con1:path>if(fn:string($RSPValidacionCuenta/ACCOUNT_STATUS/text()) = '') then(
	''
)else(
	fn:upper-case(fn:string($RSPValidacionCuenta/ACCOUNT_STATUS/text()))
)</con1:path>
                    </con1:param>
                    <con1:param name="messages">
                      <con1:path>if(fn:string-join($RSPHValidacionCuenta/aut:ResponseHeader/messages, ' ') = '') then(
	''
)else(
	fn:string($RSPHValidacionCuenta/aut:ResponseHeader/messages/text())
)</con1:path>
                    </con1:param>
                    <con1:param name="successIndicator">
                      <con1:path>fn:upper-case(fn:string($RSPHValidacionCuenta/aut:ResponseHeader/successIndicator/text()))</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="errorCode">
                <con1:id>_ActionId-3647311482654407720-593f5293.16bd2142abc.-7fd8</con1:id>
                <con2:expr>
                  <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionCreditoCuenta/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionCreditoCuenta/ESTADO_PROCESO/text())

return
	if($codigoErrorProceso ='')then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="validationMessage">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7fba</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($validacionCreditoCuenta/VALIDACION_MENSAJE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:responseTransform>
          </con2:wsCallout>
        </con3:actions>
      </con3:stage>
      <con3:stage name="ReprocesarACHRecibidos" errorHandler="_onErrorHandler-2346823499704620810-4eb098aa.16b4bd5e113.-71f2">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
          <con1:varNsDecl namespace="T24WebServicesImpl" prefix="t24"/>
        </con3:context>
        <con3:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7f4b</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage =''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7edd</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ACH/Recibido/SvcACHRecibido/biz/svcACHRecibido" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>ReprocesarACHRecibidos</con2:operation>
                  <con2:request>
                    <con2:body>$REQReprocesarACHRecibidos</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPReprocesarACHRecibidos</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQReprocesarACHRecibidos">
                      <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7dfd</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/reprocesarACHRecibidosIn"/>
                          <con1:param name="customerName">
                            <con1:path>''</con1:path>
                          </con1:param>
                          <con1:param name="customerId">
                            <con1:path>fn:string($RSPValidacionCuenta/CUSTOMER_ID/text())</con1:path>
                          </con1:param>
                          <con1:param name="tcccy">
                            <con1:path>''</con1:path>
                          </con1:param>
                          <con1:param name="tcCurrentAmt">
                            <con1:path>''</con1:path>
                          </con1:param>
                          <con1:param name="idProduct">
                            <con1:path>''</con1:path>
                          </con1:param>
                          <con1:param name="reprocesoACHRecibidasCR">
                            <con1:path>$body/rep:reprocesoACHRecibidasCR</con1:path>
                          </con1:param>
                          <con1:param name="requestHeader1">
                            <con1:path>$header/aut:RequestHeader</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:assign varName="validacionReprocesarACHRecibidos">
                      <con1:id>_ActionId-5597882473389280891--6f7a431b.16e03c5aa71.-7f42</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/estadoProcesoReprocesarACHRecibidos"/>
                          <con1:param name="messages">
                            <con1:path>if(fn:string-join($RSPReprocesarACHRecibidos/Status/messages, ' ') = '') then(
	''
)else(
	fn:string-join($RSPReprocesarACHRecibidos/Status/messages, '. ')
)</con1:path>
                          </con1:param>
                          <con1:param name="successIndicator">
                            <con1:path>fn:upper-case(fn:string($RSPReprocesarACHRecibidos/Status/successIndicator/text()))</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="errorCode">
                      <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7e6f</con1:id>
                      <con2:expr>
                        <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionReprocesarACHRecibidos/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionReprocesarACHRecibidos/ESTADO_PROCESO/text())

return
	if($codigoErrorProceso ='' or $estadoProceso = 'PENDING')then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="validationMessage">
                      <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7e52</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($validacionReprocesarACHRecibidos/VALIDACION_MENSAJE/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="OperacionesReproceso_201_request">
      <con3:stage name="ConsultarDatosTarjetaCredito">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaDatosTarjetaCreditoTypes" prefix="con"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/conDatoTarjeta" prefix="con1"/>
        </con3:context>
        <con3:actions>
          <con2:wsCallout>
            <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7f83</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/OSB/ConsultaDatosTarjetaCredito_v3/biz/ConsultaDatosTarjetaCredito_v3" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>consultaDatosTarjetaCredito</con2:operation>
            <con2:request>
              <con2:body>$REQconsultaDatosTarjetaCredito</con2:body>
              <con2:header>$REQHconsultaDatosTarjetaCredito</con2:header>
            </con2:request>
            <con2:response>
              <con2:body>RSPconsultaDatosTarjetaCredito</con2:body>
              <con2:header>RSPHconsultaDatosTarjetaCredito</con2:header>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="REQHconsultaDatosTarjetaCredito">
                <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7f4b</con1:id>
                <con2:expr>
                  <con1:xqueryText>$header</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con1:assign varName="REQconsultaDatosTarjetaCredito" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7f87</con4:id>
                <con1:expr>
                  <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                    <con4:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/consultaDatosTarjetaIn"/>
                    <con4:param name="cardNumber">
                      <con4:path>$body/rep:reprocesoACHRecibidasCR/BEN_ACCOUNT/text()</con4:path>
                    </con4:param>
                    <con4:param name="org">
                      <con4:path>''</con4:path>
                    </con4:param>
                  </con4:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:assign varName="cardStatus">
                <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7b29</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:upper-case(fn:string($RSPconsultaDatosTarjetaCredito/CARD_CURRENCY_INFORMATION[1]/CREDIT_CARD_STATUS/text()))</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="messages">
                <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7af1</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($RSPHconsultaDatosTarjetaCredito/aut:ResponseHeader/messages/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="success">
                <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7b62</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:upper-case(fn:string($RSPHconsultaDatosTarjetaCredito/aut:ResponseHeader/successIndicator/text()))</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="validacionConsultaDatosTarjetaCredito">
                <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7f86</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/estadoProcesoConsultaDatosTarjetaCredito"/>
                    <con1:param name="cardStatus">
                      <con1:path>$cardStatus</con1:path>
                    </con1:param>
                    <con1:param name="messages">
                      <con1:path>$messages</con1:path>
                    </con1:param>
                    <con1:param name="successIndicator">
                      <con1:path>$success</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="errorCode">
                <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7f85</con1:id>
                <con2:expr>
                  <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionConsultaDatosTarjetaCredito/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionConsultaDatosTarjetaCredito/ESTADO_PROCESO/text())

return
	if($codigoErrorProceso ='')then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="validationMessage">
                <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7f84</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($validacionConsultaDatosTarjetaCredito/VALIDACION_MENSAJE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:responseTransform>
          </con2:wsCallout>
        </con3:actions>
      </con3:stage>
      <con3:stage name="ConsultaSaldosTarjetaCredito">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con3:context>
        <con3:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7d9f</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage = ''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                  <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6099950342708189220--7e157c2e.17ba1d5c117.-75c1</con4:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/OSB/consultaSaldosTarjetaCredito_v2/biz/consultaSaldosTarjetaCredito" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>consultaSaldosTarjetaCredito</con1:operation>
                  <con1:request>
                    <con1:body>$REQConsultaSaldosTarjetaCredito</con1:body>
                    <con1:header>$REQHConsultaSaldosTarjetaCredito</con1:header>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPConsultaSaldosTarjetaCredito</con1:body>
                    <con1:header>RSPHConsultaSaldosTarjetaCredito</con1:header>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQHConsultaSaldosTarjetaCredito">
                      <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7ec8</con4:id>
                      <con1:expr>
                        <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">$header</con4:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="REQConsultaSaldosTarjetaCredito">
                      <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6099950342708189220--7e157c2e.17ba1d5c117.-75c9</con4:id>
                      <con1:expr>
                        <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                          <con4:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/consultaSaldosTarjetaCreditoIn"/>
                          <con4:param name="cardNumber">
                            <con4:path>fn:string($body/rep:reprocesoACHRecibidasCR/BEN_ACCOUNT/text())</con4:path>
                          </con4:param>
                        </con4:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="validacionConsultaSaldosTarjetaCredito">
                      <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6099950342708189220--7e157c2e.17ba1d5c117.-75c7</con4:id>
                      <con1:expr>
                        <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                          <con4:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/estadoProcesoConsultaSaldosTarjetaCredito"/>
                          <con4:param name="messages">
                            <con4:path>if(fn:upper-case(fn:string($RSPHConsultaSaldosTarjetaCredito/aut:ResponseHeader/messages/text())) = ('', 'CONSULTA EXITOSA')) then(
	''
)else(
	fn:string($RSPHConsultaSaldosTarjetaCredito/aut:ResponseHeader/messages/text())
)</con4:path>
                          </con4:param>
                          <con4:param name="successIndicator">
                            <con4:path>fn:upper-case(fn:string($RSPHConsultaSaldosTarjetaCredito/aut:ResponseHeader/successIndicator/text()))</con4:path>
                          </con4:param>
                        </con4:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="errorCode">
                      <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6099950342708189220--7e157c2e.17ba1d5c117.-75c6</con4:id>
                      <con1:expr>
                        <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">let $codigoErrorProceso := fn:string($validacionConsultaSaldosTarjetaCredito/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionConsultaSaldosTarjetaCredito/ESTADO_PROCESO/text())

return
	if($codigoErrorProceso ='')then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con4:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6099950342708189220--7e157c2e.17ba1d5c117.-75c5</con4:id>
                      <con1:expr>
                        <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($validacionConsultaSaldosTarjetaCredito/VALIDACION_MENSAJE/text())</con4:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con3:actions>
      </con3:stage>
      <con3:stage name="ReprocesarACHRecibidos" errorHandler="_onErrorHandler-2346823499704620810-4eb098aa.16b4bd5e113.-71f3">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaDatosTarjetaCreditoTypes" prefix="con"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaSaldosTarjetaCreditoTypes" prefix="con1"/>
        </con3:context>
        <con3:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7cf3</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage =''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7cbb</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ACH/Recibido/SvcACHRecibido/biz/svcACHRecibido" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>ReprocesarACHRecibidos</con2:operation>
                  <con2:request>
                    <con2:body>$REQReprocesarACHRecibidos</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPReprocesarACHRecibidos</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="consultaSaldosDetalle">
                      <con1:id>_ActionId-3647311482654407720-593f5293.16bd2142abc.-7efa</con1:id>
                      <con2:expr>
                        <con1:xqueryText><![CDATA[let $currency := fn:string($body/rep:reprocesoACHRecibidasCR/BEN_CURRENCY/text())

return
if($currency = 'HNL') then(
      if(fn:string($RSPConsultaSaldosTarjetaCredito/con1:consultaSaldosTarjetaCreditoResponseType/con1:consultaSaldosTarjetaCreditoResponseRecordType[1]/CURRENCY/text()) = 'HNL') then(
         <CONSULTA_SALDOS_RESPONSE>
            <TCCCY>{ fn:string($RSPConsultaSaldosTarjetaCredito/con1:consultaSaldosTarjetaCreditoResponseType/con1:consultaSaldosTarjetaCreditoResponseRecordType[1]/CURRENCY/text()) }</TCCCY>
            <TC_CURRENT_AMT>{ fn:string($RSPConsultaSaldosTarjetaCredito/con1:consultaSaldosTarjetaCreditoResponseType/con1:consultaSaldosTarjetaCreditoResponseRecordType[1]/CURRENT_BALANCE/text()) }</TC_CURRENT_AMT>
         </CONSULTA_SALDOS_RESPONSE>
      )else(
         <CONSULTA_SALDOS_RESPONSE>
            <TCCCY>{ fn:string($RSPConsultaSaldosTarjetaCredito/con1:consultaSaldosTarjetaCreditoResponseType/con1:consultaSaldosTarjetaCreditoResponseRecordType[2]/CURRENCY/text()) }</TCCCY>
            <TC_CURRENT_AMT>{ fn:string($RSPConsultaSaldosTarjetaCredito/con1:consultaSaldosTarjetaCreditoResponseType/con1:consultaSaldosTarjetaCreditoResponseRecordType[2]/CURRENT_BALANCE/text()) }</TC_CURRENT_AMT>
         </CONSULTA_SALDOS_RESPONSE>
      )
)else(
   
      if(fn:string($RSPConsultaSaldosTarjetaCredito/con1:consultaSaldosTarjetaCreditoResponseType/con1:consultaSaldosTarjetaCreditoResponseRecordType[1]/CURRENCY/text()) = 'USD') then(
         <CONSULTA_SALDOS_RESPONSE>
            <TCCCY>{ fn:string($RSPConsultaSaldosTarjetaCredito/con1:consultaSaldosTarjetaCreditoResponseType/con1:consultaSaldosTarjetaCreditoResponseRecordType[1]/CURRENCY/text()) }</TCCCY>
            <TC_CURRENT_AMT>{ fn:string($RSPConsultaSaldosTarjetaCredito/con1:consultaSaldosTarjetaCreditoResponseType/con1:consultaSaldosTarjetaCreditoResponseRecordType[1]/CURRENT_BALANCE/text()) }</TC_CURRENT_AMT>
         </CONSULTA_SALDOS_RESPONSE>	
      )else(
         <CONSULTA_SALDOS_RESPONSE>
            <TCCCY>{ fn:string($RSPConsultaSaldosTarjetaCredito/con1:consultaSaldosTarjetaCreditoResponseType/con1:consultaSaldosTarjetaCreditoResponseRecordType[2]/CURRENCY/text()) }</TCCCY>
            <TC_CURRENT_AMT>{ fn:string($RSPConsultaSaldosTarjetaCredito/con1:consultaSaldosTarjetaCreditoResponseType/con1:consultaSaldosTarjetaCreditoResponseRecordType[2]/CURRENT_BALANCE/text()) }</TC_CURRENT_AMT>
         </CONSULTA_SALDOS_RESPONSE>	
      )
)]]></con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="REQReprocesarACHRecibidos">
                      <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7c83</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/reprocesarACHRecibidosIn"/>
                          <con1:param name="customerName">
                            <con1:path>fn:string($RSPConsultaDatosTarjetaCredito/con:consultaDatosTarjetaCreditoResponseType/con:consultaDatosTarjetaCreditoResponseRecordType/ACCOUNT_HOLDER_NAME/text())</con1:path>
                          </con1:param>
                          <con1:param name="customerId">
                            <con1:path>fn:string($RSPConsultaDatosTarjetaCredito/con:consultaDatosTarjetaCreditoResponseType/con:consultaDatosTarjetaCreditoResponseRecordType/CUSTOMER_ID/text())</con1:path>
                          </con1:param>
                          <con1:param name="tcccy">
                            <con1:path>fn:string($consultaSaldosDetalle/TCCCY/text())</con1:path>
                          </con1:param>
                          <con1:param name="tcCurrentAmt">
                            <con1:path>fn:string($consultaSaldosDetalle/TC_CURRENT_AMT/text())</con1:path>
                          </con1:param>
                          <con1:param name="idProduct">
                            <con1:path>'Creditca'</con1:path>
                          </con1:param>
                          <con1:param name="reprocesoACHRecibidasCR">
                            <con1:path>$body/rep:reprocesoACHRecibidasCR</con1:path>
                          </con1:param>
                          <con1:param name="requestHeader1">
                            <con1:path>$header/aut:RequestHeader</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:assign varName="validacionReprocesarACHRecibidos">
                      <con1:id>_ActionId-5597882473389280891--6f7a431b.16e03c5aa71.-7eb6</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/estadoProcesoReprocesarACHRecibidos"/>
                          <con1:param name="messages">
                            <con1:path>if(fn:string-join($RSPReprocesarACHRecibidos/Status/messages, ' ') = '') then(
	''
)else(
	fn:string-join($RSPReprocesarACHRecibidos/Status/messages, '. ')
)</con1:path>
                          </con1:param>
                          <con1:param name="successIndicator">
                            <con1:path>fn:upper-case(fn:string($RSPReprocesarACHRecibidos/Status/successIndicator/text()))</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="errorCode">
                      <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7c4b</con1:id>
                      <con2:expr>
                        <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionReprocesarACHRecibidos/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionReprocesarACHRecibidos/ESTADO_PROCESO/text())

return
	if($codigoErrorProceso ='' or $estadoProceso = 'PENDING')then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="validationMessage">
                      <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7c2e</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($validacionReprocesarACHRecibidos/VALIDACION_MENSAJE/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="OperacionesReproceso_202_request">
      <con3:stage name="Variables">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
        </con3:context>
        <con3:actions>
          <con2:assign varName="balanceCurrency">
            <con1:id>_ActionId-4089100666458915325--118af25b.17c040ee44e.-6921</con1:id>
            <con2:expr>
              <con1:xqueryText>string($body/rep:reprocesoACHRecibidasCR/BEN_CURRENCY/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="currencyType">
            <con1:id>_ActionId-4089100666458915325--118af25b.17c040ee44e.-6959</con1:id>
            <con2:expr>
              <con1:xqueryText>if($balanceCurrency = "HNL")then(
	1
)else if($balanceCurrency = "USD")then(
	2
)else()</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con1:assign varName="ServiceId" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6099950342708189220--7e157c2e.17ba1d5c117.-7379</con4:id>
            <con1:expr>
              <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">'FICBCO0191'</con4:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="merchantNumberPName " xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6099950342708189220--7e157c2e.17ba1d5c117.-7340</con4:id>
            <con1:expr>
              <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">concat($ServiceId,'.',	string($header/aut:RequestHeader/Region/SourceBank/text()),
		'.',
	upper-case(string($header/aut:RequestHeader/Authentication/UserName/text())),
	'.MERCHANT_NUMBER')</con4:xqueryText>
            </con1:expr>
          </con1:assign>
          <con2:wsCallout>
            <con1:id>_ActionId-6099950342708189220--7e157c2e.17ba1d5c117.-7403</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>obtenerParametrizacion</con2:operation>
            <con2:request>
              <con2:body>$REQObtenerParametrizacion</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>RSPObtenerParametrizacion</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="REQObtenerParametrizacion">
                <con1:id>_ActionId-6099950342708189220--7e157c2e.17ba1d5c117.-7306</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                    <con1:param name="nombreParametros">
                      <con1:path>$merchantNumberPName</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con1:assign varName="errorCode" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6099950342708189220--7e157c2e.17ba1d5c117.-723d</con4:id>
                <con1:expr>
                  <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($RSPObtenerParametrizacion/osb:ERROR_CODE/text()))</con4:xqueryText>
                </con1:expr>
              </con1:assign>
              <con1:assign varName="validationMessage" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6099950342708189220--7e157c2e.17ba1d5c117.-7192</con4:id>
                <con1:expr>
                  <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">if($errorCode = 'SUCCESS') then(
	''
)else(
	fn:string($RSPObtenerParametrizacion/osb:ERROR_MESSAGE/text())
)</con4:xqueryText>
                </con1:expr>
              </con1:assign>
              <con1:assign varName="merchantNumber " xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6099950342708189220--7e157c2e.17ba1d5c117.-7159</con4:id>
                <con1:expr>
                  <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">$RSPObtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME = $merchantNumberPName]/osb:VALUE/text()</con4:xqueryText>
                </con1:expr>
              </con1:assign>
            </con2:responseTransform>
          </con2:wsCallout>
        </con3:actions>
      </con3:stage>
      <con3:stage name="ConsultaDatosTarjetaCredito">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/transferenciasACHRecibidasTypes" prefix="tran"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaDatosTarjetaCreditoTypes" prefix="con"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/conDatoTarjeta" prefix="con1"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
        </con3:context>
        <con3:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7ed0</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage =''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7eca</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/OSB/ConsultaDatosTarjetaCredito_v3/biz/ConsultaDatosTarjetaCredito_v3" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>consultaDatosTarjetaCredito</con2:operation>
                  <con2:request>
                    <con2:body>$REQconsultaDatosTarjetaCredito</con2:body>
                    <con2:header>$REQHconsultaDatosTarjetaCredito</con2:header>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPconsultaDatosTarjetaCredito</con2:body>
                    <con2:header>RSPHconsultaDatosTarjetaCredito</con2:header>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQHconsultaDatosTarjetaCredito">
                      <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7e3b</con1:id>
                      <con2:expr>
                        <con1:xqueryText>$header</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con1:assign varName="REQconsultaDatosTarjetaCredito" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                      <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7e38</con4:id>
                      <con1:expr>
                        <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                          <con4:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/consultaDatosTarjetaIn"/>
                          <con4:param name="cardNumber">
                            <con4:path>$body/rep:reprocesoACHRecibidasCR/BEN_ACCOUNT/text()</con4:path>
                          </con4:param>
                          <con4:param name="org">
                            <con4:path>''</con4:path>
                          </con4:param>
                        </con4:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:assign varName="errorCode">
                      <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7ecd</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($RSPHconsultaDatosTarjetaCredito/aut:ResponseHeader/successIndicator/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="validationMessage">
                      <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7ecc</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($RSPHconsultaDatosTarjetaCredito/aut:ResponseHeader/messages/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="org">
                      <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7ecb</con1:id>
                      <con2:expr>
                        <con1:xqueryText>if ($RSPconsultaDatosTarjetaCredito/CARD_CURRENCY_INFORMATION[1]/CURRENCY/text() = string($body/rep:reprocesoACHRecibidasCR/BEN_CURRENCY/text())) then
(
	$RSPconsultaDatosTarjetaCredito/CARD_CURRENCY_INFORMATION[1]/ORG/text()
)
else
(
	$RSPconsultaDatosTarjetaCredito/CARD_CURRENCY_INFORMATION[2]/ORG/text()
)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con3:actions>
      </con3:stage>
      <con3:stage name="PagosWSTCParameters">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con3:context>
        <con3:actions>
          <con2:assign varName="transactionCurrency">
            <con1:id>_ActionId-4071961328898436421-5c205110.17c52585584.-7edd</con1:id>
            <con2:expr>
              <con1:xqueryText>$body/rep:reprocesoACHRecibidasCR/BEN_CURRENCY/text()</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="userName">
            <con1:id>_ActionId-4071961328898436421-5c205110.17c52585584.-7ec0</con1:id>
            <con2:expr>
              <con1:xqueryText>$header/aut:RequestHeader/Authentication/UserName/text()</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="referenceNumber">
            <con1:id>_ActionId-4071961328898436421-5c205110.17c52585584.-7ea3</con1:id>
            <con2:expr>
              <con1:xqueryText>$body/rep:reprocesoACHRecibidasCR/ACH_SEQUENCE/text()</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="paymentAmount">
            <con1:id>_ActionId-4071961328898436421-5c205110.17c52585584.-7e86</con1:id>
            <con2:expr>
              <con1:xqueryText>$body/rep:reprocesoACHRecibidasCR/BEN_AMOUNT/text()</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="sourceBank">
            <con1:id>_ActionId-4071961328898436421-5c205110.17c52585584.-7e69</con1:id>
            <con2:expr>
              <con1:xqueryText>$header/aut:RequestHeader/Region/SourceBank/text()</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="destinationBank">
            <con1:id>_ActionId-4071961328898436421-5c205110.17c52585584.-7e4c</con1:id>
            <con2:expr>
              <con1:xqueryText>$header/aut:RequestHeader/Region/DestinationBank/text()</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="validDate">
            <con1:id>_ActionId-4071961328898436421-5c205110.17c52585584.-7e2f</con1:id>
            <con2:expr>
              <con1:xqueryText>$body/rep:reprocesoACHRecibidasCR/T24_DATE_TIME/text()</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="cardNumber">
            <con1:id>_ActionId-4071961328898436421-5c205110.17c52585584.-7dbf</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($body/rep:reprocesoACHRecibidasCR/BEN_ACCOUNT/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
        </con3:actions>
      </con3:stage>
      <con3:stage name="RegistrarPagosWSTC" errorHandler="_onErrorHandler-6832425211396364118-4757ae47.17e2fe23c97.-7bde">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/T24_P_APLICA_TC/" prefix="t24"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/registraPagoTC" prefix="reg"/>
        </con3:context>
        <con3:actions>
          <con2:wsCallout>
            <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7cfe</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/OSB/RegistrarTransaccionTCDB_v2/biz/RegistrarTransaccionTCDB_v2" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>registrarTransaccionTCDB</con2:operation>
            <con2:request>
              <con2:body>$REQregistrarTransaccionTCDB</con2:body>
              <con2:header>$REQHregistrarTransaccionTCDB</con2:header>
            </con2:request>
            <con2:response>
              <con2:body>RSPregistrarTransaccionTCDB</con2:body>
              <con2:header>RSPHregistrarTransaccionTCDB</con2:header>
            </con2:response>
            <con2:requestTransform>
              <con1:assign varName="REQHregistrarTransaccionTCDB" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7cc0</con4:id>
                <con1:expr>
                  <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">$header</con4:xqueryText>
                </con1:expr>
              </con1:assign>
              <con1:assign varName="REQregistrarTransaccionTCDB" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7ca2</con4:id>
                <con1:expr>
                  <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                    <con4:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/registrarTransaccionTCDBIn"/>
                    <con4:param name="currencyType">
                      <con4:path>$currencyType</con4:path>
                    </con4:param>
                    <con4:param name="transactionCurrency">
                      <con4:path>$transactionCurrency</con4:path>
                    </con4:param>
                    <con4:param name="destinationBank">
                      <con4:path>$destinationBank</con4:path>
                    </con4:param>
                    <con4:param name="cardNumber">
                      <con4:path>$cardNumber</con4:path>
                    </con4:param>
                    <con4:param name="exchangeRate">
                      <con4:path>''</con4:path>
                    </con4:param>
                    <con4:param name="org">
                      <con4:path>$org</con4:path>
                    </con4:param>
                    <con4:param name="validDate">
                      <con4:path>$validDate</con4:path>
                    </con4:param>
                    <con4:param name="referenceNumber">
                      <con4:path>$referenceNumber</con4:path>
                    </con4:param>
                    <con4:param name="sourceBank">
                      <con4:path>$sourceBank</con4:path>
                    </con4:param>
                    <con4:param name="userName">
                      <con4:path>$userName</con4:path>
                    </con4:param>
                    <con4:param name="channelSequence">
                      <con4:path>''</con4:path>
                    </con4:param>
                    <con4:param name="paymentAmount">
                      <con4:path>$paymentAmount</con4:path>
                    </con4:param>
                    <con4:param name="merchantNumber">
                      <con4:path>$merchantNumber</con4:path>
                    </con4:param>
                  </con4:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con1:assign varName="errorCode" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7c69</con4:id>
                <con1:expr>
                  <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RSPHregistrarTransaccionTCDB/aut:ResponseHeader/successIndicator/text())</con4:xqueryText>
                </con1:expr>
              </con1:assign>
              <con1:assign varName="validationMessage" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7c4b</con4:id>
                <con1:expr>
                  <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RSPHregistrarTransaccionTCDB/aut:ResponseHeader/messages/text())</con4:xqueryText>
                </con1:expr>
              </con1:assign>
            </con2:responseTransform>
          </con2:wsCallout>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="OperacionesReproceso_402_response">
      <con3:stage name="FlujoSalida">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
        </con3:context>
        <con3:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7890</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage =''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace contents-only="true" varName="header">
                  <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-77ea</con1:id>
                  <con2:expr>
                    <con1:xqueryText>&lt;aut:ResponseHeader>
      &lt;successIndicator>{ $errorCode }&lt;/successIndicator>
&lt;/aut:ResponseHeader></con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:replace contents-only="true" varName="body">
                  <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7795</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/reprocesoACHRecibidasCROut"/>
                      <con1:param name="sequenceACH">
                        <con1:path>xs:integer($body/rep:reprocesoACHRecibidasCR/ACH_SEQUENCE)</con1:path>
                      </con1:param>
                      <con1:param name="t24TransactionRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="pxpBatchRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="t24ControlRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="t24ClientCod">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="pxpIdTxnRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:replace varName="header" contents-only="true">
                <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-77b2</con1:id>
                <con2:expr>
                  <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>{ $errorCode }</successIndicator>
      <messages>{ $validationMessage }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                </con2:expr>
              </con2:replace>
              <con2:replace contents-only="true" varName="body">
                <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-775d</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;rep:reprocesoACHRecibidasCRResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="OperacionesReproceso_301_request">
      <con3:stage name="ConsultaGeneralPrestamo">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaGeneralPrestamoTypes" prefix="con"/>
        </con3:context>
        <con3:actions>
          <con2:wsCallout>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7b1f</con1:id>
            <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/ConsultaGeneralPrestamo" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>consultaGeneralPrestamo</con2:operation>
            <con2:request>
              <con2:body>$REQConsultaGeneralPrestamo</con2:body>
              <con2:header>$REQHConsultaGeneralPrestamo</con2:header>
            </con2:request>
            <con2:response>
              <con2:body>RSPConsultaGeneralPrestamo</con2:body>
              <con2:header>RSPHConsultaGeneralPrestamo</con2:header>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="REQConsultaGeneralPrestamo">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7b22</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/consultaGeneralPrestamoIn"/>
                    <con1:param name="loanId">
                      <con1:path>fn:string($body/rep:reprocesoACHRecibidasCR/BEN_ACCOUNT/text())</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="REQHConsultaGeneralPrestamo">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7b02</con1:id>
                <con2:expr>
                  <con1:xqueryText>$header</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:assign varName="validacionConsultaGeneralPrestamo">
                <con1:id>_ActionId-3647311482654407720-593f5293.16bd2142abc.-7e71</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/estadoProcesoConsultaGeneralPrestamo"/>
                    <con1:param name="currencyRequest">
                      <con1:path>string($body/rep:reprocesoACHRecibidasCR/BEN_CURRENCY/text())</con1:path>
                    </con1:param>
                    <con1:param name="messages">
                      <con1:path>if(fn:string($RSPHConsultaGeneralPrestamo/aut:ResponseHeader/messages/text()) = '') then(
	''
)else(
	fn:string($RSPHConsultaGeneralPrestamo/aut:ResponseHeader/messages/text())
)</con1:path>
                    </con1:param>
                    <con1:param name="loanCurrency">
                      <con1:path>if(fn:string($RSPConsultaGeneralPrestamo/con:consultaGeneralPrestamoResponseType/con:consultaGeneralPrestamoResponseRecordType/CURRENCY/text()) = '') then(
	''
)else(
	fn:upper-case(fn:string($RSPConsultaGeneralPrestamo/con:consultaGeneralPrestamoResponseType/con:consultaGeneralPrestamoResponseRecordType/CURRENCY/text()))
)</con1:path>
                    </con1:param>
                    <con1:param name="loanStatus">
                      <con1:path>if(fn:string($RSPConsultaGeneralPrestamo/con:consultaGeneralPrestamoResponseType/con:consultaGeneralPrestamoResponseRecordType/LOAN_STATUS/text()) = '') then(
	''
)else(
	fn:upper-case(fn:string($RSPConsultaGeneralPrestamo/con:consultaGeneralPrestamoResponseType/con:consultaGeneralPrestamoResponseRecordType/LOAN_STATUS/text()))
)</con1:path>
                    </con1:param>
                    <con1:param name="successIndicator">
                      <con1:path>fn:upper-case(fn:string($RSPHConsultaGeneralPrestamo/aut:ResponseHeader/successIndicator/text()))</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="errorCode">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7b21</con1:id>
                <con2:expr>
                  <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionConsultaGeneralPrestamo/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionConsultaGeneralPrestamo/ESTADO_PROCESO/text())

return
	if($codigoErrorProceso ='')then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="validationMessage">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7b20</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($validacionConsultaGeneralPrestamo/VALIDACION_MENSAJE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:responseTransform>
          </con2:wsCallout>
        </con3:actions>
      </con3:stage>
      <con3:stage name="ReprocesarACHRecibidos" errorHandler="_onErrorHandler-2346823499704620810-4eb098aa.16b4bd5e113.-71f1">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaGeneralPrestamoTypes" prefix="con"/>
        </con3:context>
        <con3:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7a93</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage =''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7a5b</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ACH/Recibido/SvcACHRecibido/biz/svcACHRecibido" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>ReprocesarACHRecibidos</con2:operation>
                  <con2:request>
                    <con2:body>$REQReprocesarACHRecibidos</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPReprocesarACHRecibidos</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQReprocesarACHRecibidos">
                      <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7a23</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/reprocesarACHRecibidosIn"/>
                          <con1:param name="customerName">
                            <con1:path>fn:string($RSPConsultaGeneralPrestamo/con:consultaGeneralPrestamoResponseType/con:consultaGeneralPrestamoResponseRecordType/LOAN_CUSTOMER_NAME/text())</con1:path>
                          </con1:param>
                          <con1:param name="customerId">
                            <con1:path>fn:string($RSPConsultaGeneralPrestamo/con:consultaGeneralPrestamoResponseType/con:consultaGeneralPrestamoResponseRecordType/CUSTOMER_ID/text())</con1:path>
                          </con1:param>
                          <con1:param name="tcccy">
                            <con1:path>''</con1:path>
                          </con1:param>
                          <con1:param name="tcCurrentAmt">
                            <con1:path>''</con1:path>
                          </con1:param>
                          <con1:param name="idProduct">
                            <con1:path>'Loanpayment'</con1:path>
                          </con1:param>
                          <con1:param name="reprocesoACHRecibidasCR">
                            <con1:path>$body/rep:reprocesoACHRecibidasCR</con1:path>
                          </con1:param>
                          <con1:param name="requestHeader1">
                            <con1:path>$header/aut:RequestHeader</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:assign varName="validacionReprocesarACHRecibidos">
                      <con1:id>_ActionId-5597882473389280891--6f7a431b.16e03c5aa71.-7e2b</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/estadoProcesoReprocesarACHRecibidos"/>
                          <con1:param name="messages">
                            <con1:path>if(fn:string-join($RSPReprocesarACHRecibidos/Status/messages, ' ') = '') then(
	''
)else(
	fn:string-join($RSPReprocesarACHRecibidos/Status/messages, '. ')
)</con1:path>
                          </con1:param>
                          <con1:param name="successIndicator">
                            <con1:path>fn:upper-case(fn:string($RSPReprocesarACHRecibidos/Status/successIndicator/text()))</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="errorCode">
                      <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-79eb</con1:id>
                      <con2:expr>
                        <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionReprocesarACHRecibidos/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionReprocesarACHRecibidos/ESTADO_PROCESO/text())

return
	if($codigoErrorProceso ='' or $estadoProceso = 'PENDING')then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="validationMessage">
                      <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-79ce</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($validacionReprocesarACHRecibidos/VALIDACION_MENSAJE/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="OperacionesReproceso_401_request">
      <con3:stage name="ConsultaRegistroACHRecibido" errorHandler="_onErrorHandler-9186035235755702952-44726a00.16c6253849d.-7cd5">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
        </con3:context>
        <con3:actions>
          <con2:wsCallout>
            <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7cd6</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ACH/Recibido/SvcACHRecibido/biz/svcACHRecibido" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>ConsultaRegistroACHRecibido</con2:operation>
            <con2:request>
              <con2:body>$REQConsultaRegistroACHRecibido</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>RSPConsultaRegistroACHRecibido</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="REQConsultaRegistroACHRecibido">
                <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7c67</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/consultaRegistroACHRecibidoIn"/>
                    <con1:param name="requestHeader1">
                      <con1:path>$header/aut:RequestHeader</con1:path>
                    </con1:param>
                    <con1:param name="transactionId">
                      <con1:path>fn:string($body/rep:reprocesoACHRecibidasCR/T24_CONTROL_REF/text())</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:assign varName="validacionConsultaRegistroACHRecibido">
                <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7c2f</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/estadoProcesoConsultaRegistroACHRecibido"/>
                    <con1:param name="txnStatus">
                      <con1:path>if(fn:string($RSPConsultaRegistroACHRecibido/WSACHINCOMINGCONFIRMType/gWSACHINCOMINGCONFIRMDetailType/mWSACHINCOMINGCONFIRMDetailType/TXNSTATUS/text()) = '') then(
	''
)else(
	fn:upper-case(fn:string($RSPConsultaRegistroACHRecibido/WSACHINCOMINGCONFIRMType/gWSACHINCOMINGCONFIRMDetailType/mWSACHINCOMINGCONFIRMDetailType/TXNSTATUS/text()))
)</con1:path>
                    </con1:param>
                    <con1:param name="messages">
                      <con1:path>if(fn:string-join($RSPConsultaRegistroACHRecibido/Status/messages, ' ') = '') then(
	''
)else(
	fn:string-join($RSPConsultaRegistroACHRecibido/Status/messages, '. ')
)</con1:path>
                    </con1:param>
                    <con1:param name="successIndicator">
                      <con1:path>fn:upper-case(fn:string($RSPConsultaRegistroACHRecibido/Status/successIndicator/text()))</con1:path>
                    </con1:param>
                    <con1:param name="zeroRecords">
                      <con1:path>if(fn:string($RSPConsultaRegistroACHRecibido/WSACHINCOMINGCONFIRMType/ZERORECORDS/text()) = '') then(
	''
)else(
	fn:upper-case(fn:string($RSPConsultaRegistroACHRecibido/WSACHINCOMINGCONFIRMType/ZERORECORDS/text()))
)</con1:path>
                    </con1:param>
                    <con1:param name="idRejection">
                      <con1:path>if(fn:string($RSPConsultaRegistroACHRecibido/WSACHINCOMINGCONFIRMType/gWSACHINCOMINGCONFIRMDetailType/mWSACHINCOMINGCONFIRMDetailType/IDREJECTION/text()) = '') then(
	''
)else(
	fn:string($RSPConsultaRegistroACHRecibido/WSACHINCOMINGCONFIRMType/gWSACHINCOMINGCONFIRMDetailType/mWSACHINCOMINGCONFIRMDetailType/IDREJECTION/text())
)</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="errorCode">
                <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7c12</con1:id>
                <con2:expr>
                  <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionConsultaRegistroACHRecibido/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionConsultaRegistroACHRecibido/ESTADO_PROCESO/text())

return
	if($codigoErrorProceso ='' or $estadoProceso = 'PENDING')then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="validationMessage">
                <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7bf5</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($validacionConsultaRegistroACHRecibido/VALIDACION_MENSAJE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:responseTransform>
          </con2:wsCallout>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con:pipeline type="request" name="ValidacionesGenerales_request" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="ValidacionXSD">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
        </con:context>
        <con:actions>
          <con1:validate xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7715966588124312103-7035df84.16a8d342f26.-770c</con2:id>
            <con1:schema ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xsd/reprocesoACHRecibidasCRTypes"/>
            <con1:schemaElement xmlns:rep="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes">rep:reprocesoACHRecibidasCR</con1:schemaElement>
            <con1:varName>body</con1:varName>
            <con1:location>
              <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">./rep:reprocesoACHRecibidasCR</con2:xpathText>
            </con1:location>
          </con1:validate>
        </con:actions>
      </con:stage>
      <con:stage name="ValidacionServicioRegional">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/ValidaServicioRegional" prefix="val"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
        </con:context>
        <con:actions>
          <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7715966588124312103-7035df84.16a8d342f26.-769e</con2:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ValidaServicioRegional/biz/ValidaServicioRegional_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>ValidaServicioRegional</con1:operation>
            <con1:request>
              <con1:body>$REQValidaServicioRegional</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>RSPValidaServicioRegional</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="REQValidaServicioRegional">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7715966588124312103-7035df84.16a8d342f26.-7666</con2:id>
                <con1:expr>
                  <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                    <con2:resource ref="Middleware/v2/Resources/Generales/xq/validaServicioRegionalIn"/>
                    <con2:param name="requestHeader1">
                      <con2:path>$header/aut:RequestHeader</con2:path>
                    </con2:param>
                    <con2:param name="serviceId">
                      <con2:path>"FICBCO0314"</con2:path>
                    </con2:param>
                  </con2:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con1:requestTransform>
            <con1:responseTransform>
              <con1:ifThenElse>
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7715966588124312103-7035df84.16a8d342f26.-762e</con2:id>
                <con1:case>
                  <con1:condition>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPValidaServicioRegional/val:PV_CODIGO_ERROR/text()) != 'SUCCESS'</con2:xqueryText>
                  </con1:condition>
                  <con1:actions>
                    <con1:replace contents-only="true" varName="header">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7715966588124312103-7035df84.16a8d342f26.-75f6</con2:id>
                      <con1:expr>
                        <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config"><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{fn:string($RSPValidaServicioRegional/val:PV_MENSAJE_ERROR/text())}</messages>
</aut:ResponseHeader>]]></con4:xqueryText>
                      </con1:expr>
                    </con1:replace>
                    <con1:replace contents-only="true" varName="body">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7715966588124312103-7035df84.16a8d342f26.-75d9</con2:id>
                      <con1:expr>
                        <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">&lt;rep:reprocesoACHRecibidasCRResponse/></con4:xqueryText>
                      </con1:expr>
                    </con1:replace>
                    <con2:reply xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                      <con2:id>_ActionId-7715966588124312103-7035df84.16a8d342f26.-7584</con2:id>
                    </con2:reply>
                  </con1:actions>
                </con1:case>
                <con1:default>
                  <con1:replace contents-only="true" varName="header">
                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7715966588124312103-7035df84.16a8d342f26.-75a1</con2:id>
                    <con1:expr>
                      <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                        <con4:resource ref="Middleware/v2/Resources/Generales/xq/aplicarValoresPorDefectoRegion"/>
                        <con4:param name="requestHeader">
                          <con4:path>$header/aut:RequestHeader</con4:path>
                        </con4:param>
                      </con4:xqueryTransform>
                    </con1:expr>
                  </con1:replace>
                </con1:default>
              </con1:ifThenElse>
            </con1:responseTransform>
          </con1:wsCallout>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con3:pipeline type="response" name="Default_ReprocesoACHRecibidasCR_response">
      <con3:stage name="FlujoSalida">
        <con3:context/>
        <con3:actions>
          <con2:Error>
            <con1:id>_ActionId-7715966588124312103-7035df84.16a8d342f26.-70e2</con1:id>
            <con2:errCode>MW-0008</con2:errCode>
            <con2:message>SERVICE NOT IMPLEMENTED YET FOR THIS COUNTRY/COMPANY</con2:message>
          </con2:Error>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="OperacionesReproceso_403_request">
      <con3:stage name="ConsultaTransaccionACH">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
        </con3:context>
        <con3:actions>
          <con2:wsCallout>
            <con1:id>_ActionId-6551179391049814920-d84cd64.17473496e7a.-7b5e</con1:id>
            <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/ConsultaTransaccionACH" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>consultaTransaccionACH</con2:operation>
            <con2:request>
              <con2:body>$REQConsultaTransaccionACH</con2:body>
              <con2:header>$REQHConsultaTransaccionACH</con2:header>
            </con2:request>
            <con2:response>
              <con2:body>RSPConsultaTransaccionACH</con2:body>
              <con2:header>RSPHConsultaTransaccionACH</con2:header>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="REQHConsultaTransaccionACH">
                <con1:id>_ActionId-4596900561166862598--befadfb.17509e5b81e.-7ffe</con1:id>
                <con2:expr>
                  <con1:xqueryText>$header</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="REQConsultaTransaccionACH">
                <con1:id>_ActionId-6551179391049814920-d84cd64.17473496e7a.-7af0</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/consultaTransaccionACHIn"/>
                    <con1:param name="sequencyT24">
                      <con1:path>fn:string($body/rep:reprocesoACHRecibidasCR/T24_CONTROL_REF/text())</con1:path>
                    </con1:param>
                    <con1:param name="searchCriteria">
                      <con1:path>'MESSAGEID'</con1:path>
                    </con1:param>
                    <con1:param name="updatedBackendYesNo">
                      <con1:path>'NO'</con1:path>
                    </con1:param>
                    <con1:param name="transactionType">
                      <con1:path>'INCOMING_CHECK'</con1:path>
                    </con1:param>
                    <con1:param name="searchValue">
                      <con1:path>fn:string($body/rep:reprocesoACHRecibidasCR/PXP_BATCH_REF/text())</con1:path>
                    </con1:param>
                    <con1:param name="transactionCurrency">
                      <con1:path>fn:string($body/rep:reprocesoACHRecibidasCR/BEN_CURRENCY/text())</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:assign varName="errorCode">
                <con1:id>_ActionId-6551179391049814920-d84cd64.17473496e7a.-7ac5</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:upper-case(fn:string($RSPHConsultaTransaccionACH/aut:ResponseHeader/successIndicator/text()))</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="validationMessage">
                <con1:id>_ActionId-6551179391049814920-d84cd64.17473496e7a.-7aae</con1:id>
                <con2:expr>
                  <con1:xqueryText>if($errorCode = 'SUCCESS') then(
	''
)else(
	string($RSPHConsultaTransaccionACH/aut:ResponseHeader/messages/text())
)</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:responseTransform>
          </con2:wsCallout>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="Default_ReprocesoACHRecibidasCR_request">
      <con3:stage name="FlujoEntrada">
        <con3:context/>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="error" name="_onErrorHandler-9186035235755702952-44726a00.16c6253849d.-7cd5">
      <con3:stage name="ManejoErrorConsultaRegistroACHRecibido">
        <con3:context>
          <con1:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
        </con3:context>
        <con3:actions>
          <con2:assign varName="validacionConsultaRegistroACHRecibido">
            <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7bbd</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/estadoProcesoConsultaRegistroACHRecibido"/>
                <con1:param name="txnStatus">
                  <con1:path>''</con1:path>
                </con1:param>
                <con1:param name="messages">
                  <con1:path>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())
return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con1:path>
                </con1:param>
                <con1:param name="successIndicator">
                  <con1:path>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())
return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con1:path>
                </con1:param>
                <con1:param name="zeroRecords">
                  <con1:path>''</con1:path>
                </con1:param>
                <con1:param name="idRejection">
                  <con1:path>''</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="errorCode">
            <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7ba0</con1:id>
            <con2:expr>
              <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionConsultaRegistroACHRecibido/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionConsultaRegistroACHRecibido/ESTADO_PROCESO/text())

return
	if($estadoProceso = 'PENDING') then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="validationMessage">
            <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7b83</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($validacionConsultaRegistroACHRecibido/VALIDACION_MENSAJE/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con1:resume>
            <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7b66</con1:id>
          </con1:resume>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="OperacionesReproceso_401_response">
      <con3:stage name="FlujoSalida">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
        </con3:context>
        <con3:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7af8</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage =''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace contents-only="true" varName="header">
                  <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7ac0</con1:id>
                  <con2:expr>
                    <con1:xqueryText>&lt;aut:ResponseHeader>
      &lt;successIndicator>{ $errorCode }&lt;/successIndicator>
&lt;/aut:ResponseHeader></con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:replace contents-only="true" varName="body">
                  <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7aa3</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/reprocesoACHRecibidasCROut"/>
                      <con1:param name="sequenceACH">
                        <con1:path>xs:integer($body/rep:reprocesoACHRecibidasCR/ACH_SEQUENCE)</con1:path>
                      </con1:param>
                      <con1:param name="t24TransactionRef">
                        <con1:path>if(fn:string($RSPConsultaRegistroACHRecibido/WSACHINCOMINGCONFIRMType/gWSACHINCOMINGCONFIRMDetailType/mWSACHINCOMINGCONFIRMDetailType/IDTXNT24/text()) = '') then (
	''
)else(
	fn:string($RSPConsultaRegistroACHRecibido/WSACHINCOMINGCONFIRMType/gWSACHINCOMINGCONFIRMDetailType/mWSACHINCOMINGCONFIRMDetailType/IDTXNT24/text())
)</con1:path>
                      </con1:param>
                      <con1:param name="pxpBatchRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="t24ControlRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="t24ClientCod">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="pxpIdTxnRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:replace contents-only="true" varName="header">
                <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7a6b</con1:id>
                <con2:expr>
                  <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>{ $errorCode }</successIndicator>
      <messages>{ $validationMessage }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                </con2:expr>
              </con2:replace>
              <con2:replace contents-only="true" varName="body">
                <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7a4e</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;rep:reprocesoACHRecibidasCRResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con:pipeline type="response" name="ValidacionesGenerales_response" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="MapeoError">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-7715966588124312103-7035df84.16a8d342f26.-74e0</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>not(fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) = ('SUCCESS', 'PENDING'))</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-7715966588124312103-7035df84.16a8d342f26.-74a8</con1:id>
                  <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>mapeoErrores</con2:operation>
                  <con2:request>
                    <con2:body>$REQmapeoErrores</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPmapeoErrores</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQmapeoErrores">
                      <con1:id>_ActionId-7715966588124312103-7035df84.16a8d342f26.-7470</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                          <con1:param name="CODIGO_ERROR">
                            <con1:path>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text()))</con1:path>
                          </con1:param>
                          <con1:param name="MENSAJE_ERROR">
                            <con1:path>fn:concat("FICBCO0314","$#$",fn:string-join($header/aut:ResponseHeader/messages, '||'))</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:replace contents-only="true" varName="header">
                      <con1:id>_ActionId-7715966588124312103-7035df84.16a8d342f26.-7438</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                          <con1:param name="mapeoErroresResponse1">
                            <con1:path>$RSPmapeoErrores</con1:path>
                          </con1:param>
                          <con1:param name="successIndicator">
                            <con1:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:replace>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con3:pipeline type="response" name="OperacionesReproceso_202_response">
      <con3:stage name="FlujoSalida">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
        </con3:context>
        <con3:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7591</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage =''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace varName="header" contents-only="true">
                  <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7559</con1:id>
                  <con2:expr>
                    <con1:xqueryText>&lt;aut:ResponseHeader>
      &lt;successIndicator>{ $errorCode }&lt;/successIndicator>
&lt;/aut:ResponseHeader></con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:replace varName="body" contents-only="true">
                  <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-753c</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/reprocesoACHRecibidasCROut"/>
                      <con1:param name="sequenceACH">
                        <con1:path>xs:integer($body/rep:reprocesoACHRecibidasCR/ACH_SEQUENCE)</con1:path>
                      </con1:param>
                      <con1:param name="t24TransactionRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="pxpBatchRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="t24ControlRef">
                        <con1:path>fn:string($RSPReprocesarACHRecibidos/Status/transactionId/text())</con1:path>
                      </con1:param>
                      <con1:param name="t24ClientCod">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="pxpIdTxnRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:replace varName="header" contents-only="true">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7504</con1:id>
                <con2:expr>
                  <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>{ $errorCode }</successIndicator>
      <messages>{ $validationMessage }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                </con2:expr>
              </con2:replace>
              <con2:replace varName="body" contents-only="true">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-74e7</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;rep:reprocesoACHRecibidasCRResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="OperacionesReproceso_101_response">
      <con3:stage name="FlujoSalida">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaGeneralPrestamoTypes" prefix="con"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
        </con3:context>
        <con3:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-77e1</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage =''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace varName="header" contents-only="true">
                  <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-77a9</con1:id>
                  <con2:expr>
                    <con1:xqueryText>&lt;aut:ResponseHeader>
      &lt;successIndicator>{ $errorCode }&lt;/successIndicator>
&lt;/aut:ResponseHeader></con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:replace varName="body" contents-only="true">
                  <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7754</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/reprocesoACHRecibidasCROut"/>
                      <con1:param name="sequenceACH">
                        <con1:path>xs:integer($body/rep:reprocesoACHRecibidasCR/ACH_SEQUENCE)</con1:path>
                      </con1:param>
                      <con1:param name="t24TransactionRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="pxpBatchRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="t24ControlRef">
                        <con1:path>fn:string($RSPReprocesarACHRecibidos/Status/transactionId/text())</con1:path>
                      </con1:param>
                      <con1:param name="t24ClientCod">
                        <con1:path>fn:string($RSPValidacionCuenta/CUSTOMER_ID/text())</con1:path>
                      </con1:param>
                      <con1:param name="pxpIdTxnRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:replace varName="header" contents-only="true">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7771</con1:id>
                <con2:expr>
                  <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>{ $errorCode }</successIndicator>
      <messages>{ $validationMessage }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                </con2:expr>
              </con2:replace>
              <con2:replace varName="body" contents-only="true">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7701</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;rep:reprocesoACHRecibidasCRResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="error" name="_onErrorHandler-7715966588124312103-7035df84.16a8d342f26.-7437">
      <con3:stage name="Manejorror">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
        </con3:context>
        <con3:actions>
          <con2:assign varName="errorCode">
            <con1:id>_ActionId-7715966588124312103-7035df84.16a8d342f26.-73c9</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($fault/ctx:errorCode/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="errorMessage">
            <con1:id>_ActionId-7715966588124312103-7035df84.16a8d342f26.-73ac</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($fault/ctx:reason/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:wsCallout>
            <con1:id>_ActionId-7715966588124312103-7035df84.16a8d342f26.-738f</con1:id>
            <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>mapeoErrores</con2:operation>
            <con2:request>
              <con2:body>$REQmapeoErrores</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>RSPmapeoErrores</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="REQmapeoErrores">
                <con1:id>_ActionId-7715966588124312103-7035df84.16a8d342f26.-7357</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                    <con1:param name="CODIGO_ERROR">
                      <con1:path>$errorCode</con1:path>
                    </con1:param>
                    <con1:param name="MENSAJE_ERROR">
                      <con1:path>fn:concat("FICBCO0314", "$#$", $errorMessage)</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:replace contents-only="true" varName="header">
                <con1:id>_ActionId-7715966588124312103-7035df84.16a8d342f26.-731f</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                    <con1:param name="mapeoErroresResponse1">
                      <con1:path>$RSPmapeoErrores</con1:path>
                    </con1:param>
                    <con1:param name="successIndicator">
                      <con1:path>$errorCode</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:replace>
            </con2:responseTransform>
          </con2:wsCallout>
          <con2:replace contents-only="true" varName="body">
            <con1:id>_ActionId-7715966588124312103-7035df84.16a8d342f26.-72b1</con1:id>
            <con2:expr>
              <con1:xqueryText>&lt;rep:reprocesoACHRecibidasCRResponse/></con1:xqueryText>
            </con2:expr>
          </con2:replace>
          <con1:reply>
            <con1:id>_ActionId-7715966588124312103-7035df84.16a8d342f26.-7294</con1:id>
          </con1:reply>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="error" name="_onErrorHandler-9186035235755702952-44726a00.16c6253849d.-7697">
      <con3:stage name="ManejoErrorReversionACHRecibido">
        <con3:context>
          <con1:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
        </con3:context>
        <con3:actions>
          <con2:assign varName="validacionReversionACHRecibido">
            <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-765f</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/estadoProcesoReversionACHRecibido"/>
                <con1:param name="messages">
                  <con1:path>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())
return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con1:path>
                </con1:param>
                <con1:param name="successIndicator">
                  <con1:path>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())
return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="errorCode">
            <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7642</con1:id>
            <con2:expr>
              <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionReversionACHRecibido/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionReversionACHRecibido/ESTADO_PROCESO/text())

return
	if($estadoProceso = 'PENDING') then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="validationMessage">
            <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7625</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($validacionReversionACHRecibido/VALIDACION_MENSAJE/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con1:resume>
            <con1:id>_ActionId-9186035235755702952-44726a00.16c6253849d.-7608</con1:id>
          </con1:resume>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="OperacionesReproceso_403_response">
      <con3:stage name="FlujoSalida">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
        </con3:context>
        <con3:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-6551179391049814920-d84cd64.17473496e7a.-7a65</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage =''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace contents-only="true" varName="header">
                  <con1:id>_ActionId-6551179391049814920-d84cd64.17473496e7a.-7a2c</con1:id>
                  <con2:expr>
                    <con1:xqueryText>&lt;aut:ResponseHeader>
      &lt;successIndicator>{ $errorCode }&lt;/successIndicator>
&lt;/aut:ResponseHeader></con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:replace contents-only="true" varName="body">
                  <con1:id>_ActionId-6551179391049814920-d84cd64.17473496e7a.-7a20</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/reprocesoACHRecibidasCROut"/>
                      <con1:param name="sequenceACH">
                        <con1:path>fn:string($body/rep:reprocesoACHRecibidasCR/ACH_SEQUENCE/text())</con1:path>
                      </con1:param>
                      <con1:param name="t24TransactionRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="pxpBatchRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="t24ControlRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="t24ClientCod">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="pxpIdTxnRef">
                        <con1:path>fn:string($RSPConsultaTransaccionACH/ORIGINAL_MESSAGE_ID/text())</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:replace contents-only="true" varName="header">
                <con1:id>_ActionId-6551179391049814920-d84cd64.17473496e7a.-7a06</con1:id>
                <con2:expr>
                  <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>{ $errorCode }</successIndicator>
      <messages>{ $validationMessage }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                </con2:expr>
              </con2:replace>
              <con2:replace contents-only="true" varName="body">
                <con1:id>_ActionId-6551179391049814920-d84cd64.17473496e7a.-79f7</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;rep:reprocesoACHRecibidasCRResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="Default_OperacionesReproceso_response">
      <con3:stage name="FlujoSalida">
        <con3:context/>
        <con3:actions>
          <con2:Error>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-71f4</con1:id>
            <con2:errCode>MW-0008</con2:errCode>
            <con2:message>REPROCESSING STAGE NOT IMPLEMENTED YET FOR THIS COUNTRY/COMPANY</con2:message>
          </con2:Error>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="Default_OperacionesReproceso_request">
      <con3:stage name="FlujoEntrada">
        <con3:context/>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="error" name="_onErrorHandler-2346823499704620810-4eb098aa.16b4bd5e113.-71f1">
      <con3:stage name="ManejoErrorReprocesarACHRecibidos">
        <con3:context>
          <con1:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
        </con3:context>
        <con3:actions>
          <con2:assign varName="validacionReprocesarACHRecibidos">
            <con1:id>_ActionId-5597882473389280891--6f7a431b.16e03c5aa71.-7df3</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/estadoProcesoReprocesarACHRecibidos"/>
                <con1:param name="messages">
                  <con1:path>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())
return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con1:path>
                </con1:param>
                <con1:param name="successIndicator">
                  <con1:path>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())
return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="errorCode">
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-6fef</con1:id>
            <con2:expr>
              <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionReprocesarACHRecibidos/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionReprocesarACHRecibidos/ESTADO_PROCESO/text())

return
	if($estadoProceso = 'PENDING') then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="validationMessage">
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-6fc2</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($validacionReprocesarACHRecibidos/VALIDACION_MENSAJE/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con1:resume>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-6fae</con1:id>
          </con1:resume>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="error" name="_onErrorHandler-2346823499704620810-4eb098aa.16b4bd5e113.-71f2">
      <con3:stage name="ManejoErrorReprocesarACHRecibidos">
        <con3:context>
          <con1:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
        </con3:context>
        <con3:actions>
          <con2:assign varName="validacionReprocesarACHRecibidos">
            <con1:id>_ActionId-5597882473389280891--6f7a431b.16e03c5aa71.-7f09</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/estadoProcesoReprocesarACHRecibidos"/>
                <con1:param name="messages">
                  <con1:path>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())
return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con1:path>
                </con1:param>
                <con1:param name="successIndicator">
                  <con1:path>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())
return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="errorCode">
            <con1:id>_ActionId-5097646066121658380-27e05a6a.16b948265c0.-7f76</con1:id>
            <con2:expr>
              <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionReprocesarACHRecibidos/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionReprocesarACHRecibidos/ESTADO_PROCESO/text())

return
	if($estadoProceso = 'PENDING') then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="validationMessage">
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7163</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($validacionReprocesarACHRecibidos/VALIDACION_MENSAJE/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con1:resume>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7129</con1:id>
          </con1:resume>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="error" name="_onErrorHandler-2346823499704620810-4eb098aa.16b4bd5e113.-71f3">
      <con3:stage name="ManejoErrorReprocesarACHRecibidos">
        <con3:context>
          <con1:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
        </con3:context>
        <con3:actions>
          <con2:assign varName="validacionReprocesarACHRecibidos">
            <con1:id>_ActionId-5597882473389280891--6f7a431b.16e03c5aa71.-7e63</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/estadoProcesoReprocesarACHRecibidos"/>
                <con1:param name="messages">
                  <con1:path>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())
return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con1:path>
                </con1:param>
                <con1:param name="successIndicator">
                  <con1:path>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())
return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="errorCode">
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-70f1</con1:id>
            <con2:expr>
              <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionReprocesarACHRecibidos/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionReprocesarACHRecibidos/ESTADO_PROCESO/text())

return
	if($estadoProceso = 'PENDING') then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="validationMessage">
            <con1:id>_ActionId-5097646066121658380-27e05a6a.16b948265c0.-7f74</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($validacionReprocesarACHRecibidos/VALIDACION_MENSAJE/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con1:resume>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7095</con1:id>
          </con1:resume>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="OperacionesReproceso_302_request">
      <con3:stage name="PagoPrestamoT24" errorHandler="_onErrorHandler-5920477162824467185-68389b64.16bb389d87d.-7ba4">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_PAG_PRESTAMO_T24/" prefix="osb"/>
        </con3:context>
        <con3:actions>
          <con2:wsCallout>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-795d</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoPrestamo/Resources/pagoPrestamoT24BS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>pagoPrestamoT24</con2:operation>
            <con2:request>
              <con2:body>$REQPagoPrestamoT24</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>RSPPagoPrestamoT24</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="REQPagoPrestamoT24">
                <con1:id>_ActionId-5920477162824467185-68389b64.16bb389d87d.-7ba5</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/pagoPrestamoT24In"/>
                    <con1:param name="reprocesoACHRecibidasCR">
                      <con1:path>$body/rep:reprocesoACHRecibidasCR</con1:path>
                    </con1:param>
                    <con1:param name="username">
                      <con1:path>fn:string($header/aut:RequestHeader/Authentication/UserName/text())</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:assign varName="validacionPagoPrestamoT24">
                <con1:id>_ActionId-3550708558248104745-41dad6e2.16bd3a59e8c.-7fc9</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/estadoProcesoPagoPrestamoT24"/>
                    <con1:param name="messages">
                      <con1:path>if(fn:string($RSPPagoPrestamoT24/osb:ERROR_MESSAGE/text()) = '') then(
	''
)else(
	fn:string($RSPPagoPrestamoT24/osb:ERROR_MESSAGE/text())
)</con1:path>
                    </con1:param>
                    <con1:param name="successIndicator">
                      <con1:path>fn:upper-case(fn:string($RSPPagoPrestamoT24/osb:ERROR_CODE/text()))</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="errorCode">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7395</con1:id>
                <con2:expr>
                  <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionPagoPrestamoT24/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionPagoPrestamoT24/ESTADO_PROCESO/text())

return
	if($codigoErrorProceso ='')then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="validationMessage">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7378</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($validacionPagoPrestamoT24/VALIDACION_MENSAJE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:responseTransform>
          </con2:wsCallout>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="OperacionesReproceso_302_response">
      <con3:stage name="FlujoSalida">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
        </con3:context>
        <con3:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-73cd</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage =''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace contents-only="true" varName="header">
                  <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7340</con1:id>
                  <con2:expr>
                    <con1:xqueryText>&lt;aut:ResponseHeader>
      &lt;successIndicator>{ $errorCode }&lt;/successIndicator>
&lt;/aut:ResponseHeader></con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:replace contents-only="true" varName="body">
                  <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7323</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/reprocesoACHRecibidasCROut"/>
                      <con1:param name="sequenceACH">
                        <con1:path>xs:integer($body/rep:reprocesoACHRecibidasCR/ACH_SEQUENCE)</con1:path>
                      </con1:param>
                      <con1:param name="t24TransactionRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="pxpBatchRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="t24ControlRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="t24ClientCod">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="pxpIdTxnRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:replace contents-only="true" varName="header">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-72eb</con1:id>
                <con2:expr>
                  <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>{ $errorCode }</successIndicator>
      <messages>{ $validationMessage }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                </con2:expr>
              </con2:replace>
              <con2:replace contents-only="true" varName="body">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-72ce</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;rep:reprocesoACHRecibidasCRResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="OperacionesReproceso_301_response">
      <con3:stage name="FlujoSalida">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaGeneralPrestamoTypes" prefix="con"/>
        </con3:context>
        <con3:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-74af</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage =''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace contents-only="true" varName="header">
                  <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7477</con1:id>
                  <con2:expr>
                    <con1:xqueryText>&lt;aut:ResponseHeader>
      &lt;successIndicator>{ $errorCode }&lt;/successIndicator>
&lt;/aut:ResponseHeader></con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:replace contents-only="true" varName="body">
                  <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7422</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/reprocesoACHRecibidasCROut"/>
                      <con1:param name="sequenceACH">
                        <con1:path>xs:integer($body/rep:reprocesoACHRecibidasCR/ACH_SEQUENCE)</con1:path>
                      </con1:param>
                      <con1:param name="t24TransactionRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="pxpBatchRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="t24ControlRef">
                        <con1:path>fn:string($RSPReprocesarACHRecibidos/Status/transactionId/text())</con1:path>
                      </con1:param>
                      <con1:param name="t24ClientCod">
                        <con1:path>fn:string($RSPConsultaGeneralPrestamo/con:consultaGeneralPrestamoResponseType/con:consultaGeneralPrestamoResponseRecordType/CUSTOMER_ID/text())</con1:path>
                      </con1:param>
                      <con1:param name="pxpIdTxnRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:replace contents-only="true" varName="header">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-743f</con1:id>
                <con2:expr>
                  <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>{ $errorCode }</successIndicator>
      <messages>{ $validationMessage }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                </con2:expr>
              </con2:replace>
              <con2:replace contents-only="true" varName="body">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7405</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;rep:reprocesoACHRecibidasCRResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="error" name="_onErrorHandler-5920477162824467185-68389b64.16bb389d87d.-7ba4">
      <con3:stage name="ManejoErrorPagoPrestamoT24">
        <con3:context>
          <con1:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
        </con3:context>
        <con3:actions>
          <con2:assign varName="validacionPagoPrestamoT24">
            <con1:id>_ActionId-3550708558248104745-41dad6e2.16bd3a59e8c.-7f91</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/estadoProcesoPagoPrestamoT24"/>
                <con1:param name="messages">
                  <con1:path>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())
return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con1:path>
                </con1:param>
                <con1:param name="successIndicator">
                  <con1:path>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())
return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="errorCode">
            <con1:id>_ActionId-5920477162824467185-68389b64.16bb389d87d.-7b4f</con1:id>
            <con2:expr>
              <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionPagoPrestamoT24/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionPagoPrestamoT24/ESTADO_PROCESO/text())

return
	if($estadoProceso = 'PENDING') then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="validationMessage">
            <con1:id>_ActionId-5920477162824467185-68389b64.16bb389d87d.-7b32</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($validacionPagoPrestamoT24/VALIDACION_MENSAJE/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con1:resume>
            <con1:id>_ActionId-5920477162824467185-68389b64.16bb389d87d.-7b15</con1:id>
          </con1:resume>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="OperacionesReproceso_201_response">
      <con3:stage name="FlujoSalida">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaDatosTarjetaCreditoTypes" prefix="con"/>
        </con3:context>
        <con3:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-76c8</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage =''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace contents-only="true" varName="header">
                  <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-75c9</con1:id>
                  <con2:expr>
                    <con1:xqueryText>&lt;aut:ResponseHeader>
      &lt;successIndicator>{ $errorCode }&lt;/successIndicator>
&lt;/aut:ResponseHeader></con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:replace contents-only="true" varName="body">
                  <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7603</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/ReprocesoACHRecibidasCR/xq/reprocesoACHRecibidasCROut"/>
                      <con1:param name="sequenceACH">
                        <con1:path>xs:integer($body/rep:reprocesoACHRecibidasCR/ACH_SEQUENCE)</con1:path>
                      </con1:param>
                      <con1:param name="t24TransactionRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="pxpBatchRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                      <con1:param name="t24ControlRef">
                        <con1:path>fn:string($RSPReprocesarACHRecibidos/Status/transactionId/text())</con1:path>
                      </con1:param>
                      <con1:param name="t24ClientCod">
                        <con1:path>fn:string($RSPConsultaDatosTarjetaCredito/con:consultaDatosTarjetaCreditoResponseType/con:consultaDatosTarjetaCreditoResponseRecordType/CUSTOMER_ID/text())</con1:path>
                      </con1:param>
                      <con1:param name="pxpIdTxnRef">
                        <con1:path>''</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:replace contents-only="true" varName="header">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-7620</con1:id>
                <con2:expr>
                  <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>{ $errorCode }</successIndicator>
      <messages>{ $validationMessage }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                </con2:expr>
              </con2:replace>
              <con2:replace contents-only="true" varName="body">
                <con1:id>_ActionId-2346823499704620810-4eb098aa.16b4bd5e113.-75e6</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;rep:reprocesoACHRecibidasCRResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="error" name="_onErrorHandler-6832425211396364118-4757ae47.17e2fe23c97.-7bde">
      <con3:stage name="ManejoErrorAplicaTCT24">
        <con3:context>
          <con1:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1"/>
        </con3:context>
        <con3:actions>
          <con2:assign varName="validacionAplicaTCT24">
            <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7b9f</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/v2/Resources/TransferenciasACHRecibidas/xq/estadoProcesoAplicaTCT24"/>
                <con1:param name="messages">
                  <con1:path>let $faultString := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultstring/text())
return
	if($faultString != "") then (
		$faultString
	) else (
		string($fault/ctx:reason/text())
	)</con1:path>
                </con1:param>
                <con1:param name="successIndicator">
                  <con1:path>let $faultCode := string($fault/ctx:details/con1:ReceivedFaultDetail/con1:faultcode/text())
return
	if($faultCode != "") then (
		$faultCode
	) else (
		string($fault/ctx:errorCode/text())
	)</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="errorCode">
            <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7b9e</con1:id>
            <con2:expr>
              <con1:xqueryText>let $codigoErrorProceso := fn:string($validacionAplicaTCT24/CODIGO_ERROR_PROCESO/text())
let $estadoProceso := fn:string($validacionAplicaTCT24/ESTADO_PROCESO/text())

return
	if($estadoProceso = 'PENDING') then(
		$estadoProceso
	)else(
		$codigoErrorProceso
	)</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="validationMessage">
            <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7b9d</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($validacionAplicaTCT24/VALIDACION_MENSAJE/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con1:resume>
            <con1:id>_ActionId-6832425211396364118-4757ae47.17e2fe23c97.-7b9c</con1:id>
          </con1:resume>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con:flow xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:pipeline-node name="ValidacionesGenerales">
        <con:request>ValidacionesGenerales_request</con:request>
        <con:response>ValidacionesGenerales_response</con:response>
      </con:pipeline-node>
      <con:branch-node type="condition" name="RegionalizacionPaisEmpresa">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:branch-table variable="header">
          <con:xpath>
            <con1:xpathText>./aut:RequestHeader/Region/SourceBank</con1:xpathText>
          </con:xpath>
          <con:branch name="HN01">
            <con:operator>equals</con:operator>
            <con:value>'HN01'</con:value>
            <con:flow>
              <con:branch-node type="condition" name="HN01_ReprocesoACHRecibidasCR">
                <con:context>
                  <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/reprocesoACHRecibidasCRTypes" prefix="rep"/>
                </con:context>
                <con:branch-table variable="body">
                  <con:xpath>
                    <con1:xpathText>./rep:reprocesoACHRecibidasCR/REPROCESSING_STAGE</con1:xpathText>
                  </con:xpath>
                  <con:branch name="REPROCESSING_STAGE_101">
                    <con:operator>equals</con:operator>
                    <con:value>101</con:value>
                    <con:flow>
                      <con:pipeline-node name="OperacionesReproceso_101">
                        <con:request>OperacionesReproceso_101_request</con:request>
                        <con:response>OperacionesReproceso_101_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:branch name="REPROCESSING_STAGE_201">
                    <con:operator>equals</con:operator>
                    <con:value>201</con:value>
                    <con:flow>
                      <con:pipeline-node name="OperacionesReproceso_201">
                        <con:request>OperacionesReproceso_201_request</con:request>
                        <con:response>OperacionesReproceso_201_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:branch name="REPROCESSING_STAGE_202">
                    <con:operator>equals</con:operator>
                    <con:value>202</con:value>
                    <con:flow>
                      <con:pipeline-node name="OperacionesReproceso_202">
                        <con:request>OperacionesReproceso_202_request</con:request>
                        <con:response>OperacionesReproceso_202_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:branch name="REPROCESSING_STAGE_301">
                    <con:operator>equals</con:operator>
                    <con:value>301</con:value>
                    <con:flow>
                      <con:pipeline-node name="OperacionesReproceso_301">
                        <con:request>OperacionesReproceso_301_request</con:request>
                        <con:response>OperacionesReproceso_301_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:branch name="REPROCESSING_STAGE_302">
                    <con:operator>equals</con:operator>
                    <con:value>302</con:value>
                    <con:flow>
                      <con:pipeline-node name="OperacionesReproceso_302">
                        <con:request>OperacionesReproceso_302_request</con:request>
                        <con:response>OperacionesReproceso_302_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:branch name="REPROCESSING_STAGE_401">
                    <con:operator>equals</con:operator>
                    <con:value>401</con:value>
                    <con:flow>
                      <con:pipeline-node name="OperacionesReproceso_401">
                        <con:request>OperacionesReproceso_401_request</con:request>
                        <con:response>OperacionesReproceso_401_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:branch name="REPROCESSING_STAGE_402">
                    <con:operator>equals</con:operator>
                    <con:value>402</con:value>
                    <con:flow>
                      <con:pipeline-node name="OperacionesReproceso_402">
                        <con:request>OperacionesReproceso_402_request</con:request>
                        <con:response>OperacionesReproceso_402_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:branch name="REPROCESSING_STAGE_403">
                    <con:operator>equals</con:operator>
                    <con:value>403</con:value>
                    <con:flow>
                      <con:pipeline-node name="OperacionesReproceso_403">
                        <con:request>OperacionesReproceso_403_request</con:request>
                        <con:response>OperacionesReproceso_403_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:default-branch>
                    <con:flow>
                      <con:pipeline-node name="Default_OperacionesReproceso">
                        <con:request>Default_OperacionesReproceso_request</con:request>
                        <con:response>Default_OperacionesReproceso_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:default-branch>
                </con:branch-table>
              </con:branch-node>
            </con:flow>
          </con:branch>
          <con:default-branch>
            <con:flow>
              <con:pipeline-node name="Default_ReprocesoACHRecibidasCR">
                <con:request>Default_ReprocesoACHRecibidasCR_request</con:request>
                <con:response>Default_ReprocesoACHRecibidasCR_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:default-branch>
        </con:branch-table>
      </con:branch-node>
    </con:flow>
  </ser:router>
</xml-fragment>