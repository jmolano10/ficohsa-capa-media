<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:con="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/pipeline/config">
  <ser:coreEntry isProxy="true" isEnabled="true" isAutoPublish="false" isTracingEnabled="false">
    <ser:security>
      <con2:custom-token-authentication>
        <con2:username-password>
          <con2:username-selector>
            <con2:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:RequestHeader/Authentication/UserName/text()</con2:xpath>
            <con2:variable>header</con2:variable>
          </con2:username-selector>
          <con2:password-selector>
            <con2:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:RequestHeader/Authentication/Password/text()</con2:xpath>
            <con2:variable>header</con2:variable>
          </con2:password-selector>
        </con2:username-password>
      </con2:custom-token-authentication>
    </ser:security>
    <ser:binding type="SOAP" isSoap12="false" xsi:type="con4:SoapBindingType" xmlns:con4="http://www.bea.com/wli/sb/services/bindings/config">
      <con4:wsdl ref="Middleware/v2/Resources/PagoPrestamo/wsdl/pagoPrestamoPS"/>
      <con4:port>
        <con4:name>pagoPrestamoPSSOAP</con4:name>
        <con4:namespace>http://www.ficohsa.com.hn/middleware.services/pagoPrestamoPS/</con4:namespace>
      </con4:port>
      <con4:selector type="SOAP body"/>
      <con4:WSI-compliant>false</con4:WSI-compliant>
    </ser:binding>
    <ser:monitoring isEnabled="true">
      <ser:aggregationInterval>720</ser:aggregationInterval>
      <ser:pipelineMonitoringLevel>Action</ser:pipelineMonitoringLevel>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
  </ser:coreEntry>
  <ser:endpointConfig>
    <tran:provider-id>http</tran:provider-id>
    <tran:inbound>true</tran:inbound>
    <tran:URI>
      <env:value>/SMiddleware/OperationsAndExecution/Payments/PagoPrestamo_v2</env:value>
    </tran:URI>
    <tran:inbound-properties/>
    <tran:all-headers>false</tran:all-headers>
    <tran:provider-specific xsi:type="http:HttpEndPointConfiguration">
      <http:inbound-properties>
        <http:use-https>true</http:use-https>
      </http:inbound-properties>
    </tran:provider-specific>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-8848777042473091319--23eafd38.13c2a05c9f3.-6642">
    <con3:pipeline type="error" name="_onErrorHandler-8848777042473091319--23eafd38.13c2a05c9f3.-6642">
      <con3:stage name="ManejoError">
        <con4:context xmlns:con3="http://www.bea.com/wli/sb/services/security/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaFICOPENTypes" prefix="con"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
        </con4:context>
        <con4:actions xmlns:con3="http://www.bea.com/wli/sb/services/security/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
          <con1:ifThenElse>
            <con:comment>Condicion para determinar si error se debe a un request que no cumple con definici√≥n XSD.</con:comment>
            <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7fe5</con:id>
            <con1:case>
              <con1:condition>
                <con:xqueryText>fn:string($fault/ctx:errorCode/text()) = "BEA-382505"</con:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:replace varName="header" contents-only="true">
                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7fbc</con:id>
                  <con1:expr>
                    <con:xqueryTransform>
                      <con:resource ref="Middleware/v2/Resources/Genericos/mapeoErrorValidate"/>
                      <con:param name="anyType1">
                        <con:path>$fault</con:path>
                      </con:param>
                    </con:xqueryTransform>
                  </con1:expr>
                </con1:replace>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:replace contents-only="true" varName="header">
                <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7fe3</con:id>
                <con1:expr>
                  <con:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{ concat(fn:string($fault/ctx:errorCode/text()), ": ", fn:string($fault/ctx:reason/text())) }</messages>
</aut:ResponseHeader>]]></con:xqueryText>
                </con1:expr>
              </con1:replace>
              <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/pipeline/config">
                <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7fdd</con:id>
                <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                <con1:operation>mapeoErrores</con1:operation>
                <con1:request>
                  <con1:body>$REQMapeoErrores</con1:body>
                </con1:request>
                <con1:response>
                  <con1:body>RSPMapeoErrores</con1:body>
                </con1:response>
                <con1:requestTransform>
                  <con1:assign varName="REQMapeoErrores">
                    <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7fdf</con:id>
                    <con1:expr>
                      <con:xqueryTransform>
                        <con:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                        <con:param name="CODIGO_ERROR">
                          <con:path>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text()))</con:path>
                        </con:param>
                        <con:param name="MENSAJE_ERROR">
                          <con:path>fn:concat("FICBCO0076","$#$",fn:string-join($header/aut:ResponseHeader/messages, '||'))</con:path>
                        </con:param>
                      </con:xqueryTransform>
                    </con1:expr>
                  </con1:assign>
                </con1:requestTransform>
                <con1:responseTransform>
                  <con1:replace varName="header" contents-only="true">
                    <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7fde</con:id>
                    <con1:expr>
                      <con:xqueryTransform>
                        <con:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                        <con:param name="mapeoErroresResponse1">
                          <con:path>$RSPMapeoErrores</con:path>
                        </con:param>
                        <con:param name="successIndicator">
                          <con:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con:path>
                        </con:param>
                      </con:xqueryTransform>
                    </con1:expr>
                  </con1:replace>
                </con1:responseTransform>
              </con1:wsCallout>
            </con1:default>
          </con1:ifThenElse>
          <con1:replace contents-only="true" varName="body">
            <con:id>_ActionId-8848777042473091319--23eafd38.13c2a05c9f3.-6607</con:id>
            <con1:expr>
              <con:xqueryText>&lt;pag:pagoPrestamoResponse/></con:xqueryText>
            </con1:expr>
          </con1:replace>
          <con:reply>
            <con:id>_ActionId-8848777042473091319--23eafd38.13c2a05c9f3.-6606</con:id>
          </con:reply>
        </con4:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="ValidacionesGenerales_request">
      <con3:stage name="ValidacionXSD">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
        </con3:context>
        <con3:actions>
          <con1:validate>
            <con:id>_ActionId-4097820237566366414-3065a44c.14d9ff048d1.-7f8d</con:id>
            <con1:schema ref="Middleware/v2/Resources/PagoPrestamo/xsd/pagoPrestamoTypes"/>
            <con1:schemaElement xmlns:pag="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes">pag:pagoPrestamo</con1:schemaElement>
            <con1:varName>body</con1:varName>
            <con1:location>
              <con:xpathText>./pag:pagoPrestamo</con:xpathText>
            </con1:location>
          </con1:validate>
        </con3:actions>
      </con3:stage>
      <con3:stage name="ValidacionServicioRegional">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/ValidaServicioRegional" prefix="val"/>
        </con3:context>
        <con3:actions>
          <con1:wsCallout>
            <con:id>_ActionId-4097820237566366414-3065a44c.14d9ff048d1.-7f55</con:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ValidaServicioRegional/biz/ValidaServicioRegional_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>ValidaServicioRegional</con1:operation>
            <con1:request>
              <con1:body>$reqValidaServicioRegional</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>respValidaServicioRegional</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="reqValidaServicioRegional">
                <con:id>_ActionId-4097820237566366414-3065a44c.14d9ff048d1.-7f1d</con:id>
                <con1:expr>
                  <con:xqueryTransform>
                    <con:resource ref="Middleware/v2/Resources/Generales/xq/validaServicioRegionalIn"/>
                    <con:param name="requestHeader1">
                      <con:path>$header/aut:RequestHeader</con:path>
                    </con:param>
                    <con:param name="serviceId">
                      <con:path>"FICBCO0076"</con:path>
                    </con:param>
                  </con:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con1:requestTransform>
            <con1:responseTransform>
              <con1:ifThenElse>
                <con:id>_ActionId-4097820237566366414-3065a44c.14d9ff048d1.-7ee5</con:id>
                <con1:case>
                  <con1:condition>
                    <con:xqueryText>fn:string($respValidaServicioRegional/val:PV_CODIGO_ERROR/text()) != 'SUCCESS'</con:xqueryText>
                  </con1:condition>
                  <con1:actions>
                    <con1:replace contents-only="true" varName="header">
                      <con:id>_ActionId-4097820237566366414-3065a44c.14d9ff048d1.-7ead</con:id>
                      <con1:expr>
                        <con:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{fn:string($respValidaServicioRegional/val:PV_MENSAJE_ERROR/text())}</messages>
</aut:ResponseHeader>]]></con:xqueryText>
                      </con1:expr>
                    </con1:replace>
                    <con1:replace contents-only="true" varName="body">
                      <con:id>_ActionId-4097820237566366414-3065a44c.14d9ff048d1.-7e90</con:id>
                      <con1:expr>
                        <con:xqueryText>&lt;pag:pagoPrestamoResponse/></con:xqueryText>
                      </con1:expr>
                    </con1:replace>
                    <con:reply>
                      <con:id>_ActionId-4097820237566366414-3065a44c.14d9ff048d1.-7e73</con:id>
                    </con:reply>
                  </con1:actions>
                </con1:case>
                <con1:default>
                  <con1:replace contents-only="true" varName="header">
                    <con:id>_ActionId-4097820237566366414-3065a44c.14d9ff048d1.-7e3b</con:id>
                    <con1:expr>
                      <con:xqueryTransform>
                        <con:resource ref="Middleware/v2/Resources/Generales/xq/aplicarValoresPorDefectoRegion"/>
                        <con:param name="requestHeader">
                          <con:path>$header/aut:RequestHeader</con:path>
                        </con:param>
                      </con:xqueryTransform>
                    </con1:expr>
                  </con1:replace>
                  <con1:assign varName="loanType">
                    <con:id>_ActionId-4097820237566366414-3065a44c.14d9ff048d1.-7e39</con:id>
                    <con1:expr>
                      <con:xqueryTransform>
                        <con:resource ref="Middleware/Business_Resources/pagoPrestamo/consultaGeneralPrestamo/validarTipoPrestamo"/>
                        <con:param name="NumeroPrestamo">
                          <con:path>fn:string($body/pag:pagoPrestamo/LOAN_NUMBER/text())</con:path>
                        </con:param>
                      </con:xqueryTransform>
                    </con1:expr>
                  </con1:assign>
                  <con2:assign varName="areSameSourceAndDestination" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
                    <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5363</con4:id>
                    <con2:expr>
                      <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                        <con4:resource ref="Middleware/v2/Resources/Generales/xq/validarCrucePaisEmpresa"/>
                        <con4:param name="requestHeader">
                          <con4:path>$header/aut:RequestHeader</con4:path>
                        </con4:param>
                      </con4:xqueryTransform>
                    </con2:expr>
                  </con2:assign>
                </con1:default>
              </con1:ifThenElse>
            </con1:responseTransform>
          </con1:wsCallout>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="ValidacionesGenerales_response">
      <con3:stage name="MapeoError">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con3:context>
        <con3:actions>
          <con1:ifThenElse>
            <con:id>_ActionId-5165187676452498133--660a4447.157dcfdc56d.-5757</con:id>
            <con1:case>
              <con1:condition>
                <con:xqueryText>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) != "SUCCESS"</con:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con:id>_ActionId-5165187676452498133--660a4447.157dcfdc56d.-5754</con:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>mapeoErrores</con1:operation>
                  <con1:request>
                    <con1:body>$REQMapeoErrores</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPMapeoErrores</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQMapeoErrores">
                      <con:id>_ActionId-5165187676452498133--660a4447.157dcfdc56d.-5756</con:id>
                      <con1:expr>
                        <con:xqueryTransform>
                          <con:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                          <con:param name="CODIGO_ERROR">
                            <con:path>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text()))</con:path>
                          </con:param>
                          <con:param name="MENSAJE_ERROR">
                            <con:path>fn:concat("FICBCO0076","$#$",fn:string-join($header/aut:ResponseHeader/messages, '||'))</con:path>
                          </con:param>
                        </con:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:replace varName="header" contents-only="true">
                      <con:id>_ActionId-5165187676452498133--660a4447.157dcfdc56d.-5755</con:id>
                      <con1:expr>
                        <con:xqueryTransform>
                          <con:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                          <con:param name="mapeoErroresResponse1">
                            <con:path>$RSPMapeoErrores</con:path>
                          </con:param>
                          <con:param name="successIndicator">
                            <con:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con:path>
                          </con:param>
                        </con:xqueryTransform>
                      </con1:expr>
                    </con1:replace>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="ABANKS_request">
      <con3:stage name="Abanks_proxyRequest">
        <con3:context>
          <con:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/sjConsultaProductos" prefix="con"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con3:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_CON_GENERAL_PRESTAMO/" prefix="osb" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
          <con3:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_PAG_PRESTAMO_T24/" prefix="osb1" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
          <con4:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb2" xmlns:con4="http://www.bea.com/wli/sb/stages/config"/>
        </con3:context>
        <con3:actions>
          <con1:assign varName="paymentAmount">
            <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5170</con:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/PAYMENT_AMOUNT/text()</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="loanNumber">
            <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-516f</con:id>
            <con1:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/LOAN_NUMBER/text()</con3:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="originalLoanNumber">
            <con:id>_ActionId-2955661912422161236-14bac7d5.15416d182bf.-7fc5</con:id>
            <con1:expr>
              <con:xqueryText>$body/pag:pagoPrestamo/LOAN_NUMBER/text()</con:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="PaymentType">
            <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-516e</con:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/PAYMENT_TYPE/text()</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="debit_credit">
            <con:id>_ActionId-2149632243897235089--547c28b6.170a2464351.-7f4c</con:id>
            <con1:expr>
              <con:xqueryText>$body/pag:pagoPrestamo/DEBIT_CREDIT/text()</con:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:ifThenElse>
            <con4:comment xmlns:con4="http://www.bea.com/wli/sb/stages/config">IfThen PaymentType</con4:comment>
            <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f50</con:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($PaymentType)) = "ACCOUNT_DEBIT"</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:assign varName="debitAccount">
                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f4f</con:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/DEBIT_ACCOUNT/text()</con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:ifThenElse>
                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f4e</con:id>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($debitAccount) != ""</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7e90</con:id>
                        <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/SJS/consultaProductos/biz/sjConsultaProductos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>consultaProductos</con1:operation>
                        <con1:request>
                          <con1:body>$REQConsProductos</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>RSPConsProductos</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="REQConsProductos">
                            <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7e77</con:id>
                            <con1:expr>
                              <con:xqueryTransform>
                                <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPtmoConsProductosIn"/>
                                <con:param name="ldapUsername">
                                  <con:path>fn:string($header/aut:RequestHeader/Authentication/UserName/text())</con:path>
                                </con:param>
                                <con:param name="accountNumber">
                                  <con:path>$debitAccount</con:path>
                                </con:param>
                                <con:param name="ldapPassword">
                                  <con:path>fn:string($header/aut:RequestHeader/Authentication/Password/text())</con:path>
                                </con:param>
                                <con:param name="loanNumber">
                                  <con:path>$loanNumber</con:path>
                                </con:param>
                              </con:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:assign varName="successIndPtmo">
                            <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7e53</con:id>
                            <con1:expr>
                              <con:xqueryText>fn:string($RSPConsProductos/con:PRODUCTS/con:PRODUCT[con:TYPE="PTM"][con:ID=$loanNumber]/con:SUCCESS_INDICATOR/text())</con:xqueryText>
                            </con1:expr>
                          </con1:assign>
                          <con1:assign varName="successIndCuenta">
                            <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7e35</con:id>
                            <con1:expr>
                              <con:xqueryText>fn:string($RSPConsProductos/con:PRODUCTS/con:PRODUCT[con:TYPE="CTA"][con:ID=$debitAccount]/con:SUCCESS_INDICATOR/text())</con:xqueryText>
                            </con1:expr>
                          </con1:assign>
                        </con1:responseTransform>
                      </con1:wsCallout>
                      <con1:ifThenElse>
                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f49</con:id>
                        <con1:case>
                          <con1:condition>
                            <con:xqueryText>fn:upper-case(fn:string($successIndPtmo)) = "SUCCESS" and
fn:upper-case(fn:string($successIndCuenta)) = "SUCCESS"</con:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:assign varName="loanCurrency">
                              <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7d89</con:id>
                              <con1:expr>
                                <con:xqueryText>fn:string($RSPConsProductos/con:PRODUCTS/con:PRODUCT[con:TYPE="PTM"][con:ID=$loanNumber]/con:CURRENCY/text())</con:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:assign varName="accountCurrency">
                              <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7d8b</con:id>
                              <con1:expr>
                                <con:xqueryText>fn:string($RSPConsProductos/con:PRODUCTS/con:PRODUCT[con:TYPE="CTA"][con:ID=$debitAccount]/con:CURRENCY/text())</con:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:wsCallout>
                              <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fc3</con:id>
                              <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>obtenerParametrizacion</con1:operation>
                              <con1:request>
                                <con1:body>$REQobtenerParametrizacion</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>RESobtenerParametrizacion</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="creditAcctParam">
                                  <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fc6</con:id>
                                  <con1:expr>
                                    <con:xqueryText>fn:concat("T24T134.",$loanCurrency,"CREDITACCTNO")</con:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                                <con1:assign varName="REQobtenerParametrizacion">
                                  <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fc5</con:id>
                                  <con1:expr>
                                    <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                      <con4:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                                      <con4:param name="nombreParametros">
                                        <con4:path>fn:concat($creditAcctParam,"||T24T133.TXNTYPELOANPYMT","||T24T057.INTACCOUNT.USERS")</con4:path>
                                      </con4:param>
                                    </con4:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform>
                                <con1:assign varName="statusParametrizacion">
                                  <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fc4</con:id>
                                  <con1:expr>
                                    <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESobtenerParametrizacion/osb2:ERROR_CODE/text())</con4:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:responseTransform>
                            </con1:wsCallout>
                            <con1:ifThenElse>
                              <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fb9</con:id>
                              <con1:case>
                                <con1:condition>
                                  <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">$statusParametrizacion = "SUCCESS"</con4:xqueryText>
                                </con1:condition>
                                <con1:actions>
                                  <con1:assign varName="creditAccount">
                                    <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fb8</con:id>
                                    <con1:expr>
                                      <con:xqueryText>fn:string($RESobtenerParametrizacion/osb2:CONFIGURACIONES/osb2:CONFIGURACIONES_ITEM[osb2:NAME=$creditAcctParam]/osb2:VALUE/text())</con:xqueryText>
                                    </con1:expr>
                                  </con1:assign>
                                  <con1:assign varName="uuid">
                                    <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fb7</con:id>
                                    <con1:expr>
                                      <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                        <con4:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                                      </con4:xqueryTransform>
                                    </con1:expr>
                                  </con1:assign>
                                  <con1:assign varName="trxType">
                                    <con:id>_ActionId-2149632243897235089--547c28b6.170a2464351.-7d7c</con:id>
                                    <con1:expr>
                                      <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESobtenerParametrizacion/osb2:CONFIGURACIONES/osb2:CONFIGURACIONES_ITEM[osb2:NAME="T24T133.TXNTYPELOANPYMT"]/osb2:VALUE/text())</con4:xqueryText>
                                    </con1:expr>
                                  </con1:assign>
                                  <con1:assign varName="authParametro">
                                    <con:id>_ActionId-2149632243897235089--547c28b6.170a2464351.-7c18</con:id>
                                    <con1:expr>
                                      <con:xqueryText>'0'</con:xqueryText>
                                    </con1:expr>
                                  </con1:assign>
                                  <con1:ifThenElse>
                                    <con:id>_ActionId-2149632243897235089--547c28b6.170a2464351.-7e64</con:id>
                                    <con1:case>
                                      <con1:condition>
                                        <con:xqueryText>$accountCurrency = $loanCurrency</con:xqueryText>
                                      </con1:condition>
                                      <con1:actions>
                                        <con1:wsCallout>
                                          <con:id>_ActionId-2149632243897235089--547c28b6.170a2464351.-7d36</con:id>
                                          <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/Transferencias/Resources/transferenciasBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                          <con1:operation>Transfmodelbankentrecuentas</con1:operation>
                                          <con1:request>
                                            <con1:body>$REQUESTTRAN</con1:body>
                                          </con1:request>
                                          <con1:response>
                                            <con1:body>RESPONSETRAN</con1:body>
                                          </con1:response>
                                          <con1:requestTransform>
                                            <con1:assign varName="REQUESTTRAN">
                                              <con:id>_ActionId-2149632243897235089--547c28b6.170a2464351.-7d06</con:id>
                                              <con1:expr>
                                                <con:xqueryTransform>
                                                  <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/debitoPrestamoCuentaIn"/>
                                                  <con:param name="transactionType">
                                                    <con:path>$trxType</con:path>
                                                  </con:param>
                                                  <con:param name="accountCurrency">
                                                    <con:path>$accountCurrency</con:path>
                                                  </con:param>
                                                  <con:param name="requestHeader">
                                                    <con:path>$header/aut:RequestHeader</con:path>
                                                  </con:param>
                                                  <con:param name="creditAccount">
                                                    <con:path>$creditAccount</con:path>
                                                  </con:param>
                                                  <con:param name="uuid">
                                                    <con:path>fn:string($uuid)</con:path>
                                                  </con:param>
                                                  <con:param name="pagoPrestamo">
                                                    <con:path>$body/pag:pagoPrestamo</con:path>
                                                  </con:param>
                                                </con:xqueryTransform>
                                              </con1:expr>
                                            </con1:assign>
                                          </con1:requestTransform>
                                          <con1:responseTransform/>
                                        </con1:wsCallout>
                                      </con1:actions>
                                    </con1:case>
                                    <con1:default>
                                      <con1:ifThenElse>
                                        <con:id>_ActionId-2149632243897235089--547c28b6.170a2464351.-7e62</con:id>
                                        <con1:case>
                                          <con1:condition>
                                            <con:xqueryText>$debit_credit = 'CREDIT'</con:xqueryText>
                                          </con1:condition>
                                          <con1:actions>
                                            <con1:wsCallout>
                                              <con:id>_ActionId-2149632243897235089--547c28b6.170a2464351.-7e5c</con:id>
                                              <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/Transferencias/Resources/transferenciasBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                              <con1:operation>Transfentrecuentasinstrcredito</con1:operation>
                                              <con1:request>
                                                <con1:body>$REQUESTTRAN</con1:body>
                                              </con1:request>
                                              <con1:response>
                                                <con1:body>RESPONSETRAN</con1:body>
                                              </con1:response>
                                              <con1:requestTransform>
                                                <con1:assign varName="REQUESTTRAN">
                                                  <con:id>_ActionId-2149632243897235089--547c28b6.170a2464351.-7e5d</con:id>
                                                  <con1:expr>
                                                    <con:xqueryTransform>
                                                      <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/debitoPrestamoCuentaAuthIn"/>
                                                      <con:param name="transactionType">
                                                        <con:path>$trxType</con:path>
                                                      </con:param>
                                                      <con:param name="auth">
                                                        <con:path>$authParametro</con:path>
                                                      </con:param>
                                                      <con:param name="requestHeader">
                                                        <con:path>$header/aut:RequestHeader</con:path>
                                                      </con:param>
                                                      <con:param name="uuid">
                                                        <con:path>fn:string($uuid)</con:path>
                                                      </con:param>
                                                      <con:param name="creditAccount">
                                                        <con:path>$creditAccount</con:path>
                                                      </con:param>
                                                      <con:param name="pagoPrestamo">
                                                        <con:path>$body/pag:pagoPrestamo</con:path>
                                                      </con:param>
                                                    </con:xqueryTransform>
                                                  </con1:expr>
                                                </con1:assign>
                                              </con1:requestTransform>
                                              <con1:responseTransform/>
                                            </con1:wsCallout>
                                          </con1:actions>
                                        </con1:case>
                                        <con1:default>
                                          <con1:assign varName="intAccountUsers">
                                            <con:id>_ActionId-2149632243897235089--547c28b6.170a2464351.-7bf5</con:id>
                                            <con1:expr>
                                              <con:xqueryText>fn:string($RESPONSEobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME="T24T057.INTACCOUNT.USERS"]/osb:VALUE/text())</con:xqueryText>
                                            </con1:expr>
                                          </con1:assign>
                                          <con1:wsCallout>
                                            <con:id>_ActionId-2149632243897235089--547c28b6.170a2464351.-7baf</con:id>
                                            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/Transferencias/Resources/transferenciasBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                            <con1:operation>Transferenciaentrecuentas</con1:operation>
                                            <con1:request>
                                              <con1:body>$REQUESTTRAN</con1:body>
                                            </con1:request>
                                            <con1:response>
                                              <con1:body>RESPONSETRAN</con1:body>
                                            </con1:response>
                                            <con1:requestTransform>
                                              <con1:assign varName="REQUESTTRAN">
                                                <con:id>_ActionId-2149632243897235089--547c28b6.170a2464351.-7b7c</con:id>
                                                <con1:expr>
                                                  <con:xqueryTransform>
                                                    <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPrestamoAuthIn"/>
                                                    <con:param name="transactionType">
                                                      <con:path>$trxType</con:path>
                                                    </con:param>
                                                    <con:param name="auth">
                                                      <con:path>$authParametro</con:path>
                                                    </con:param>
                                                    <con:param name="requestHeader">
                                                      <con:path>$header/aut:RequestHeader</con:path>
                                                    </con:param>
                                                    <con:param name="creditAccount">
                                                      <con:path>$creditAccount</con:path>
                                                    </con:param>
                                                    <con:param name="uuid">
                                                      <con:path>fn:string($uuid)</con:path>
                                                    </con:param>
                                                    <con:param name="pagoPrestamo">
                                                      <con:path>$body/pag:pagoPrestamo</con:path>
                                                    </con:param>
                                                  </con:xqueryTransform>
                                                </con1:expr>
                                              </con1:assign>
                                            </con1:requestTransform>
                                            <con1:responseTransform/>
                                          </con1:wsCallout>
                                        </con1:default>
                                      </con1:ifThenElse>
                                    </con1:default>
                                  </con1:ifThenElse>
                                  <con1:assign varName="successIndicator">
                                    <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fb3</con:id>
                                    <con1:expr>
                                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/successIndicator/text()</con3:xqueryText>
                                    </con1:expr>
                                  </con1:assign>
                                </con1:actions>
                              </con1:case>
                              <con1:default>
                                <con1:assign varName="message">
                                  <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fb2</con:id>
                                  <con1:expr>
                                    <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESobtenerParametrizacion/osb2:ERROR_MESSAGE/text())</con4:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                                <con4:skip xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                  <con4:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fb1</con4:id>
                                </con4:skip>
                              </con1:default>
                            </con1:ifThenElse>
                            <con1:ifThenElse>
                              <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fa4</con:id>
                              <con1:case>
                                <con1:condition>
                                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicator)) = "SUCCESS"</con3:xqueryText>
                                </con1:condition>
                                <con1:actions>
                                  <con1:assign varName="transactionId">
                                    <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fa3</con:id>
                                    <con1:expr>
                                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/transactionId/text()</con3:xqueryText>
                                    </con1:expr>
                                  </con1:assign>
                                  <con1:assign varName="valueDate">
                                    <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fa2</con:id>
                                    <con1:expr>
                                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/FUNDSTRANSFERType/DEBITVALUEDATE/text()</con3:xqueryText>
                                    </con1:expr>
                                  </con1:assign>
                                  <con1:wsCallout>
                                    <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fa0</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoPrestamo/Resources/pagoPrestamoT24BS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>pagoPrestamoT24</con1:operation>
                                    <con1:request>
                                      <con1:body>$REQUESTABANKS</con1:body>
                                    </con1:request>
                                    <con1:response>
                                      <con1:body>RESPONSEABANKS</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                      <con1:assign varName="REQUESTABANKS">
                                        <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7fa1</con:id>
                                        <con1:expr>
                                          <con:xqueryTransform>
                                            <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPrestamoIn"/>
                                            <con:param name="requestHeader">
                                              <con:path>$header/aut:RequestHeader</con:path>
                                            </con:param>
                                            <con:param name="pagoPrestamo">
                                              <con:path>$body/pag:pagoPrestamo</con:path>
                                            </con:param>
                                            <con:param name="transactionID">
                                              <con:path>fn:string($transactionId)</con:path>
                                            </con:param>
                                          </con:xqueryTransform>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform/>
                                  </con1:wsCallout>
                                  <con1:assign varName="successIndicatorAbanks">
                                    <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7f9f</con:id>
                                    <con1:expr>
                                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSEABANKS/osb1:ERROR_CODE/text()</con3:xqueryText>
                                    </con1:expr>
                                  </con1:assign>
                                  <con1:ifThenElse>
                                    <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7f9e</con:id>
                                    <con1:case>
                                      <con1:condition>
                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicatorAbanks)) != "SUCCESS"</con2:xqueryText>
                                      </con1:condition>
                                      <con1:actions>
                                        <con1:wsCallout>
                                          <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7f9b</con:id>
                                          <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/ReversarTransaccion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                          <con1:operation>reversarTransaccion</con1:operation>
                                          <con1:request>
                                            <con1:body>$REQUESTREVTRAN</con1:body>
                                            <con1:header>$REQUESTHEADER</con1:header>
                                          </con1:request>
                                          <con1:response>
                                            <con1:body>RESPONSEREVTRAN</con1:body>
                                            <con1:header>RESPONSEHEADER</con1:header>
                                          </con1:response>
                                          <con1:requestTransform>
                                            <con1:assign varName="REQUESTREVTRAN">
                                              <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7f9d</con:id>
                                              <con1:expr>
                                                <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                                  <con2:resource ref="Middleware/Business_Resources/pagoPrestamo/reversarTransaccion/reversarTransaccionIn"/>
                                                  <con2:param name="transactionId">
                                                    <con2:path>$transactionId</con2:path>
                                                  </con2:param>
                                                </con2:xqueryTransform>
                                              </con1:expr>
                                            </con1:assign>
                                            <con1:assign varName="REQUESTHEADER">
                                              <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7f9c</con:id>
                                              <con1:expr>
                                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$header</con3:xqueryText>
                                              </con1:expr>
                                            </con1:assign>
                                          </con1:requestTransform>
                                          <con1:responseTransform/>
                                        </con1:wsCallout>
                                        <con1:assign varName="message">
                                          <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7f9a</con:id>
                                          <con1:expr>
                                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSEABANKS/osb1:ERROR_MESSAGE/text()</con3:xqueryText>
                                          </con1:expr>
                                        </con1:assign>
                                      </con1:actions>
                                    </con1:case>
                                    <con1:default/>
                                  </con1:ifThenElse>
                                </con1:actions>
                              </con1:case>
                              <con1:default>
                                <con1:assign varName="message">
                                  <con:id>_ActionId-1978285484543006078--319bfb32.1707d88ec1f.-7f99</con:id>
                                  <con1:expr>
                                    <con:xqueryText>fn:string-join($RESPONSETRAN/Status/messages/text(),"-")</con:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:default>
                            </con1:ifThenElse>
                          </con1:actions>
                        </con1:case>
                        <con1:default>
                          <con1:assign varName="message">
                            <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f26</con:id>
                            <con1:expr>
                              <con:xqueryText>if ($successIndPtmo != "SUCCESS") then (
	fn:string($RSPConsProductos/con:PRODUCTS/con:PRODUCT[con:TYPE="PTM"][con:ID=$loanNumber]/con:MESSAGE/text())
) else (
	fn:string($RSPConsProductos/con:PRODUCTS/con:PRODUCT[con:TYPE="CTA"][con:ID=$accountNumber]/con:MESSAGE/text())
)</con:xqueryText>
                            </con1:expr>
                          </con1:assign>
                        </con1:default>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:default>
                    <con1:assign varName="message">
                      <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f25</con:id>
                      <con1:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">"REQUIRED FIELDS NOT SUPPLIED"</con3:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:default>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($PaymentType)) = "CASH"</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f23</con:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/consultaGeneralPrestamo/Resources/consultaGeneralPrestamoBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>consultaGeneralPrestamo</con1:operation>
                  <con1:request>
                    <con1:body>$REQUESTCONPRES</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RESPONSECONPRES</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQUESTCONPRES">
                      <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f24</con:id>
                      <con1:expr>
                        <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                          <con3:resource ref="Middleware/Business_Resources/pagoPrestamo/consultaGeneralPrestamo/consultaGeneralPrestamoIn"/>
                          <con3:param name="pagoPrestamo">
                            <con3:path>$body/pag:pagoPrestamo</con3:path>
                          </con3:param>
                        </con3:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform/>
                </con1:wsCallout>
                <con1:assign varName="successIndicatorPrestamo">
                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f22</con:id>
                  <con1:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:ERROR_CODE/text()</con3:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:assign varName="currencyPrestamo">
                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f21</con:id>
                  <con1:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:CURRENCY/text()</con3:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:ifThenElse>
                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f20</con:id>
                  <con1:case>
                    <con1:condition>
                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicatorPrestamo)) = "SUCCESS"</con3:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="uuid">
                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f1f</con:id>
                        <con1:expr>
                          <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                            <con4:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                          </con4:xqueryTransform>
                        </con1:expr>
                      </con1:assign>
                      <con1:ifThenElse>
                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f1e</con:id>
                        <con1:case>
                          <con1:condition>
                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($currencyPrestamo)) = "HNL"</con3:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f1c</con:id>
                              <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoPrestamo/Resources/DebitoPrestamo/debitoPrestamoBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>Depositoenefectivofase11</con1:operation>
                              <con1:request>
                                <con1:body>$REQUESTLOCAL</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>RESPONSETRAN</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="REQUESTLOCAL">
                                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f1d</con:id>
                                  <con1:expr>
                                    <con:xqueryTransform>
                                      <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/depositoPrestamoEfectivoLocalIn"/>
                                      <con:param name="uuid">
                                        <con:path>fn:string($uuid)</con:path>
                                      </con:param>
                                      <con:param name="requestHeader">
                                        <con:path>$header/aut:RequestHeader</con:path>
                                      </con:param>
                                      <con:param name="pagoPrestamo">
                                        <con:path>$body/pag:pagoPrestamo</con:path>
                                      </con:param>
                                    </con:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform/>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                        <con1:case>
                          <con1:condition>
                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($currencyPrestamo)) = "USD"</con3:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f1a</con:id>
                              <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoPrestamo/Resources/DebitoPrestamo/debitoPrestamoBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>Depositoenefectivofase12</con1:operation>
                              <con1:request>
                                <con1:body>$REQUESTEXTRANJERA</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>RESPONSETRAN</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="REQUESTEXTRANJERA">
                                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f1b</con:id>
                                  <con1:expr>
                                    <con:xqueryTransform>
                                      <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/depositoPrestamoEfectivoExtranjeraIn"/>
                                      <con:param name="uuid">
                                        <con:path>fn:string($uuid)</con:path>
                                      </con:param>
                                      <con:param name="requestHeader">
                                        <con:path>$header/aut:RequestHeader</con:path>
                                      </con:param>
                                      <con:param name="pagoPrestamo">
                                        <con:path>$body/pag:pagoPrestamo</con:path>
                                      </con:param>
                                    </con:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform/>
                            </con1:wsCallout>
                          </con1:actions>
                        </con1:case>
                      </con1:ifThenElse>
                      <con1:assign varName="successIndicator">
                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f19</con:id>
                        <con1:expr>
                          <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/successIndicator/text()</con3:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:assign varName="transactionId">
                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f18</con:id>
                        <con1:expr>
                          <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/transactionId/text()</con3:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:assign varName="valueDate">
                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f17</con:id>
                        <con1:expr>
                          <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/TELLERType/VALUEDATE2/text()</con3:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:ifThenElse>
                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f16</con:id>
                        <con1:case>
                          <con1:condition>
                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicator)) = "SUCCESS"</con3:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f14</con:id>
                              <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoPrestamo/Resources/pagoPrestamoT24BS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>pagoPrestamoT24</con1:operation>
                              <con1:request>
                                <con1:body>$REQUESTABANKS</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>RESPONSEABANKS</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="REQUESTABANKS">
                                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f15</con:id>
                                  <con1:expr>
                                    <con:xqueryTransform>
                                      <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPrestamoIn"/>
                                      <con:param name="requestHeader">
                                        <con:path>$header/aut:RequestHeader</con:path>
                                      </con:param>
                                      <con:param name="pagoPrestamo">
                                        <con:path>$body/pag:pagoPrestamo</con:path>
                                      </con:param>
                                      <con:param name="transactionID">
                                        <con:path>fn:string($transactionId)</con:path>
                                      </con:param>
                                    </con:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform/>
                            </con1:wsCallout>
                            <con1:assign varName="successIndicatorAbanks">
                              <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f13</con:id>
                              <con1:expr>
                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSEABANKS/osb1:ERROR_CODE/text()</con3:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:ifThenElse>
                              <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f12</con:id>
                              <con1:case>
                                <con1:condition>
                                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicatorAbanks)) != "SUCCESS"</con3:xqueryText>
                                </con1:condition>
                                <con1:actions>
                                  <con1:wsCallout>
                                    <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f0f</con:id>
                                    <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/ReversarTransaccion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>reversarTransaccion</con1:operation>
                                    <con1:request>
                                      <con1:body>$REQUESTREVTRAN</con1:body>
                                      <con1:header>$REQUESTHEADER</con1:header>
                                    </con1:request>
                                    <con1:response>
                                      <con1:body>RESPONSEREVTRAN</con1:body>
                                      <con1:header>RESPONSEHEADER</con1:header>
                                    </con1:response>
                                    <con1:requestTransform>
                                      <con1:assign varName="REQUESTREVTRAN">
                                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f11</con:id>
                                        <con1:expr>
                                          <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                                            <con3:resource ref="Middleware/Business_Resources/pagoPrestamo/reversarTransaccion/reversarTransaccionIn"/>
                                            <con3:param name="transactionId">
                                              <con3:path>$transactionId</con3:path>
                                            </con3:param>
                                          </con3:xqueryTransform>
                                        </con1:expr>
                                      </con1:assign>
                                      <con1:assign varName="REQUESTHEADER">
                                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f10</con:id>
                                        <con1:expr>
                                          <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$header</con3:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform/>
                                  </con1:wsCallout>
                                  <con1:assign varName="message">
                                    <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f0e</con:id>
                                    <con1:expr>
                                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSEABANKS/osb1:ERROR_MESSAGE/text()</con3:xqueryText>
                                    </con1:expr>
                                  </con1:assign>
                                </con1:actions>
                              </con1:case>
                              <con1:default/>
                            </con1:ifThenElse>
                          </con1:actions>
                        </con1:case>
                        <con1:default>
                          <con1:assign varName="message">
                            <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f0d</con:id>
                            <con1:expr>
                              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/messages/text()</con3:xqueryText>
                            </con1:expr>
                          </con1:assign>
                        </con1:default>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:default>
                    <con1:assign varName="message">
                      <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f0c</con:id>
                      <con1:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:ERROR_MESSAGE/text()</con3:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:default>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($PaymentType)) = "OWN_CHEQUE"</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:assign varName="message">
                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f0b</con:id>
                  <con1:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">"PAYMENT TYPE NOT AVAILABLE"</con3:xqueryText>
                  </con1:expr>
                </con1:assign>
              </con1:actions>
            </con1:case>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($PaymentType)) = "OTHER_BANK_CHEQUE"</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:assign varName="chequeNumber">
                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f0a</con:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/CHEQUE_NUMBER/text()</con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:assign varName="bankCode">
                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f09</con:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/BANK_CODE/text()</con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:ifThenElse>
                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f08</con:id>
                  <con1:case>
                    <con1:condition>
                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($chequeNumber) != "" and
fn:string($bankCode) != ""</con3:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f06</con:id>
                        <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/consultaGeneralPrestamo/Resources/consultaGeneralPrestamoBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>consultaGeneralPrestamo</con1:operation>
                        <con1:request>
                          <con1:body>$REQUESTCONPRES</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>RESPONSECONPRES</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="REQUESTCONPRES">
                            <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f07</con:id>
                            <con1:expr>
                              <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                                <con3:resource ref="Middleware/Business_Resources/pagoPrestamo/consultaGeneralPrestamo/consultaGeneralPrestamoIn"/>
                                <con3:param name="pagoPrestamo">
                                  <con3:path>$body/pag:pagoPrestamo</con3:path>
                                </con3:param>
                              </con3:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform/>
                      </con1:wsCallout>
                      <con1:assign varName="successIndicatorPrestamo">
                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f05</con:id>
                        <con1:expr>
                          <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:ERROR_CODE/text()</con3:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:assign varName="currencyPrestamo">
                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f04</con:id>
                        <con1:expr>
                          <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:CURRENCY/text()</con3:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:ifThenElse>
                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f03</con:id>
                        <con1:case>
                          <con1:condition>
                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicatorPrestamo)) = "SUCCESS"</con3:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con4:wsCallout xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                              <con2:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f00</con2:id>
                              <con4:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con4:operation>obtenerParametrizacion</con4:operation>
                              <con4:request>
                                <con4:body>$REQUESTobtenerParametrizacion</con4:body>
                              </con4:request>
                              <con4:response>
                                <con4:body>RESPONSEobtenerParametrizacion</con4:body>
                              </con4:response>
                              <con4:requestTransform>
                                <con4:assign varName="REQUESTobtenerParametrizacion">
                                  <con2:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f02</con2:id>
                                  <con4:expr>
                                    <con2:xqueryTransform>
                                      <con2:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                                      <con2:param name="nombreParametros">
                                        <con2:path>"T24T032.HNLOBCHQACCTNO||T24T032.USDOBCHQACCTNO"</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con4:expr>
                                </con4:assign>
                              </con4:requestTransform>
                              <con4:responseTransform>
                                <con4:assign varName="statusParametrizacion">
                                  <con2:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7f01</con2:id>
                                  <con4:expr>
                                    <con2:xqueryText>fn:string($RESPONSEobtenerParametrizacion/osb2:ERROR_CODE/text())</con2:xqueryText>
                                  </con4:expr>
                                </con4:assign>
                              </con4:responseTransform>
                            </con4:wsCallout>
                            <con1:ifThenElse>
                              <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7eff</con:id>
                              <con1:case>
                                <con1:condition>
                                  <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">$statusParametrizacion = "SUCCESS"</con4:xqueryText>
                                </con1:condition>
                                <con1:actions/>
                              </con1:case>
                              <con1:default>
                                <con1:assign varName="message">
                                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7efe</con:id>
                                  <con1:expr>
                                    <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESPONSEobtenerParametrizacion/osb2:ERROR_MESSAGE/text())</con4:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                                <con4:skip xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                  <con4:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7efd</con4:id>
                                </con4:skip>
                              </con1:default>
                            </con1:ifThenElse>
                            <con1:wsCallout>
                              <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7ef6</con:id>
                              <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoPrestamo/Resources/DepositoCombinado/depositoCombinadoBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>Depositocombinado</con1:operation>
                              <con1:request>
                                <con1:body>$REQUESTOTHERCHEQUE</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>RESPONSETRAN</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="uuid">
                                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7efc</con:id>
                                  <con1:expr>
                                    <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                      <con4:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                                    </con4:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                                <con1:ifThenElse>
                                  <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7efb</con:id>
                                  <con1:case>
                                    <con1:condition>
                                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($currencyPrestamo)) = "HNL"</con3:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="depositAccount">
                                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7efa</con:id>
                                        <con1:expr>
                                          <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESPONSEobtenerParametrizacion/osb2:CONFIGURACIONES/osb2:CONFIGURACIONES_ITEM[osb2:NAME="T24T032.HNLOBCHQACCTNO"]/osb2:VALUE/text())</con4:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                      <con1:assign varName="REQUESTOTHERCHEQUE">
                                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7ef9</con:id>
                                        <con1:expr>
                                          <con:xqueryTransform>
                                            <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/debitoPrestamoChequeLocalIn"/>
                                            <con:param name="uuid">
                                              <con:path>fn:string($uuid)</con:path>
                                            </con:param>
                                            <con:param name="depositAccount">
                                              <con:path>$depositAccount</con:path>
                                            </con:param>
                                            <con:param name="requestHeader">
                                              <con:path>$header/aut:RequestHeader</con:path>
                                            </con:param>
                                            <con:param name="pagoPrestamo">
                                              <con:path>$body/pag:pagoPrestamo</con:path>
                                            </con:param>
                                          </con:xqueryTransform>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                  <con1:case>
                                    <con1:condition>
                                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($currencyPrestamo)) = "USD"</con3:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                      <con1:assign varName="depositAccount">
                                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7ef8</con:id>
                                        <con1:expr>
                                          <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESPONSEobtenerParametrizacion/osb2:CONFIGURACIONES/osb2:CONFIGURACIONES_ITEM[osb2:NAME="T24T032.USDOBCHQACCTNO"]/osb2:VALUE/text())</con4:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                      <con1:assign varName="REQUESTOTHERCHEQUE">
                                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7ef7</con:id>
                                        <con1:expr>
                                          <con:xqueryTransform>
                                            <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/debitoPrestamoChequeExtranjeraIn"/>
                                            <con:param name="uuid">
                                              <con:path>fn:string($uuid)</con:path>
                                            </con:param>
                                            <con:param name="depositAccount">
                                              <con:path>$depositAccount</con:path>
                                            </con:param>
                                            <con:param name="requestHeader">
                                              <con:path>$header/aut:RequestHeader</con:path>
                                            </con:param>
                                            <con:param name="pagoPrestamo">
                                              <con:path>$body/pag:pagoPrestamo</con:path>
                                            </con:param>
                                          </con:xqueryTransform>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:actions>
                                  </con1:case>
                                </con1:ifThenElse>
                              </con1:requestTransform>
                              <con1:responseTransform/>
                            </con1:wsCallout>
                            <con1:assign varName="successIndicator">
                              <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7ef5</con:id>
                              <con1:expr>
                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/successIndicator/text()</con3:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:assign varName="transactionId">
                              <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7ef4</con:id>
                              <con1:expr>
                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/transactionId/text()</con3:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:assign varName="valueDate">
                              <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7ef3</con:id>
                              <con1:expr>
                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/TELLERFINANCIALSERVICESType/gTRANSACTION/mTRANSACTION/DRVALUEDATE/text()</con3:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:ifThenElse>
                              <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7ef2</con:id>
                              <con1:case>
                                <con1:condition>
                                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($currencyPrestamo)) = "HNL" or
fn:upper-case(fn:string($currencyPrestamo)) = "USD"</con3:xqueryText>
                                </con1:condition>
                                <con1:actions>
                                  <con1:ifThenElse>
                                    <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7ef1</con:id>
                                    <con1:case>
                                      <con1:condition>
                                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicator)) = "SUCCESS"</con3:xqueryText>
                                      </con1:condition>
                                      <con1:actions>
                                        <con1:wsCallout>
                                          <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7eef</con:id>
                                          <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoPrestamo/Resources/pagoPrestamoT24BS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                          <con1:operation>pagoPrestamoT24</con1:operation>
                                          <con1:request>
                                            <con1:body>$REQUESTABANKS</con1:body>
                                          </con1:request>
                                          <con1:response>
                                            <con1:body>RESPONSEABANKS</con1:body>
                                          </con1:response>
                                          <con1:requestTransform>
                                            <con1:assign varName="REQUESTABANKS">
                                              <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7ef0</con:id>
                                              <con1:expr>
                                                <con:xqueryTransform>
                                                  <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPrestamoIn"/>
                                                  <con:param name="requestHeader">
                                                    <con:path>$header/aut:RequestHeader</con:path>
                                                  </con:param>
                                                  <con:param name="pagoPrestamo">
                                                    <con:path>$body/pag:pagoPrestamo</con:path>
                                                  </con:param>
                                                  <con:param name="transactionID">
                                                    <con:path>fn:string($transactionId)</con:path>
                                                  </con:param>
                                                </con:xqueryTransform>
                                              </con1:expr>
                                            </con1:assign>
                                          </con1:requestTransform>
                                          <con1:responseTransform/>
                                        </con1:wsCallout>
                                        <con1:assign varName="successIndicatorAbanks">
                                          <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7eee</con:id>
                                          <con1:expr>
                                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSEABANKS/osb1:ERROR_CODE/text()</con3:xqueryText>
                                          </con1:expr>
                                        </con1:assign>
                                        <con1:ifThenElse>
                                          <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7eed</con:id>
                                          <con1:case>
                                            <con1:condition>
                                              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicatorAbanks)) != "SUCCESS"</con3:xqueryText>
                                            </con1:condition>
                                            <con1:actions>
                                              <con1:wsCallout>
                                                <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7eea</con:id>
                                                <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/ReversarTransaccion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con1:operation>reversarTransaccion</con1:operation>
                                                <con1:request>
                                                  <con1:body>$REQUESTREVTRAN</con1:body>
                                                  <con1:header>$REQUESTHEADER</con1:header>
                                                </con1:request>
                                                <con1:response>
                                                  <con1:body>RESPONSEREVTRAN</con1:body>
                                                  <con1:header>RESPONSEHEADER</con1:header>
                                                </con1:response>
                                                <con1:requestTransform>
                                                  <con1:assign varName="REQUESTREVTRAN">
                                                    <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7eec</con:id>
                                                    <con1:expr>
                                                      <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                                                        <con3:resource ref="Middleware/Business_Resources/pagoPrestamo/reversarTransaccion/reversarTransaccionIn"/>
                                                        <con3:param name="transactionId">
                                                          <con3:path>$transactionId</con3:path>
                                                        </con3:param>
                                                      </con3:xqueryTransform>
                                                    </con1:expr>
                                                  </con1:assign>
                                                  <con1:assign varName="REQUESTHEADER">
                                                    <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7eeb</con:id>
                                                    <con1:expr>
                                                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$header</con3:xqueryText>
                                                    </con1:expr>
                                                  </con1:assign>
                                                </con1:requestTransform>
                                                <con1:responseTransform/>
                                              </con1:wsCallout>
                                              <con1:assign varName="message">
                                                <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7ee9</con:id>
                                                <con1:expr>
                                                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSEABANKS/osb1:ERROR_MESSAGE/text()</con3:xqueryText>
                                                </con1:expr>
                                              </con1:assign>
                                            </con1:actions>
                                          </con1:case>
                                          <con1:default/>
                                        </con1:ifThenElse>
                                      </con1:actions>
                                    </con1:case>
                                    <con1:default>
                                      <con1:assign varName="message">
                                        <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7ee8</con:id>
                                        <con1:expr>
                                          <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/messages/text()</con3:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:default>
                                  </con1:ifThenElse>
                                </con1:actions>
                              </con1:case>
                              <con1:default/>
                            </con1:ifThenElse>
                          </con1:actions>
                        </con1:case>
                        <con1:default>
                          <con1:assign varName="message">
                            <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7ee7</con:id>
                            <con1:expr>
                              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:ERROR_MESSAGE/text()</con3:xqueryText>
                            </con1:expr>
                          </con1:assign>
                        </con1:default>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:default/>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:assign varName="message">
                <con:id>_ActionId-4358999482389258532--2af01323.159af486f26.-7ee6</con:id>
                <con1:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">"PAYMENT TYPE NOT SUPPORTED"</con3:xqueryText>
                </con1:expr>
              </con1:assign>
            </con1:default>
          </con1:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="ABANKS_response">
      <con3:stage name="Abanks_proxyResponse">
        <con3:context>
          <con2:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con3:context>
        <con3:actions>
          <con1:ifThenElse>
            <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5100</con:id>
            <con1:case>
              <con1:condition>
                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($message) != ""</con3:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:replace contents-only="true" varName="header">
                  <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50ff</con:id>
                  <con1:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config"><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{$message}</messages>
</aut:ResponseHeader>]]></con3:xqueryText>
                  </con1:expr>
                </con1:replace>
                <con1:replace contents-only="true" varName="body">
                  <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50fe</con:id>
                  <con1:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">&lt;pag:pagoPrestamoResponse/></con3:xqueryText>
                  </con1:expr>
                </con1:replace>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:replace contents-only="true" varName="header">
                <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50fd</con:id>
                <con1:expr>
                  <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                    <con3:resource ref="Middleware/Business_Resources/pagoPrestamo/pagoPrestamo/pagoPrestamoHeaderOut"/>
                    <con3:param name="valueDate">
                      <con3:path>$valueDate</con3:path>
                    </con3:param>
                    <con3:param name="outputParameters">
                      <con3:path>$RESPONSEABANKS</con3:path>
                    </con3:param>
                    <con3:param name="transactionId">
                      <con3:path>$transactionId</con3:path>
                    </con3:param>
                  </con3:xqueryTransform>
                </con1:expr>
              </con1:replace>
              <con1:replace contents-only="true" varName="body">
                <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50fc</con:id>
                <con1:expr>
                  <con:xqueryTransform>
                    <con:resource ref="Middleware/Business_Resources/pagoPrestamo/pagoPrestamo/pagoPrestamoOut"/>
                    <con:param name="outputParameters">
                      <con:path>$RESPONSEABANKS</con:path>
                    </con:param>
                    <con:param name="responseLoanNumber">
                      <con:path>$loanNumber</con:path>
                    </con:param>
                  </con:xqueryTransform>
                </con1:expr>
              </con1:replace>
            </con1:default>
          </con1:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="T24_request">
      <con3:stage name="T24_proxyRequest">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
        </con3:context>
        <con3:actions>
          <con1:wsCallout>
            <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50f9</con:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/ConsultasCuenta/Resources/consultaCuentasBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>Consultadedetallesdelacuenta</con1:operation>
            <con1:request>
              <con1:body>$REQConsCuenta</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>RSPConsCuenta</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="REQConsCuenta">
                <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50fb</con:id>
                <con1:expr>
                  <con:xqueryTransform>
                    <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/consultaDetalleCuentaIn"/>
                    <con:param name="requestHeader">
                      <con:path>$header/aut:RequestHeader</con:path>
                    </con:param>
                    <con:param name="pagoPrestamo">
                      <con:path>$body/pag:pagoPrestamo</con:path>
                    </con:param>
                  </con:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con1:requestTransform>
            <con1:responseTransform>
              <con1:assign varName="accountCurrency">
                <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50fa</con:id>
                <con1:expr>
                  <con:xqueryText>fn:string($RSPConsCuenta/WSACCOUNTLISTType/gWSACCOUNTLISTDetailType/mWSACCOUNTLISTDetailType[1]/CURRENCY/text())</con:xqueryText>
                </con1:expr>
              </con1:assign>
            </con1:responseTransform>
          </con1:wsCallout>
          <con1:wsCallout>
            <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50f6</con:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/consultaGeneralPrestamo/Resources/PrestamosT24BS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>PagoaprestamoAA</con1:operation>
            <con1:request>
              <con1:body>$REQPagoPtmoT24</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>RSPPagoPtmoT24</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="REQPagoPtmoT24">
                <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50f8</con:id>
                <con1:expr>
                  <con:xqueryTransform>
                    <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPrestamoT24In"/>
                    <con:param name="accountCurrency">
                      <con:path>$accountCurrency</con:path>
                    </con:param>
                    <con:param name="requestHeader">
                      <con:path>$header/aut:RequestHeader</con:path>
                    </con:param>
                    <con:param name="pagoPrestamo">
                      <con:path>$body/pag:pagoPrestamo</con:path>
                    </con:param>
                  </con:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con1:requestTransform>
            <con1:responseTransform>
              <con1:assign varName="successIndicatorT24">
                <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50f7</con:id>
                <con1:expr>
                  <con:xqueryText>fn:string($RSPPagoPtmoT24/Status/successIndicator/text())</con:xqueryText>
                </con1:expr>
              </con1:assign>
            </con1:responseTransform>
          </con1:wsCallout>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="T24_response">
      <con3:stage name="T24_proxyResponse">
        <con3:context>
          <con:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/sjConsultaPrestamoTypes" prefix="cons"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
          <con:varNsDecl namespace="T24WebServicesImpl" prefix="t24"/>
        </con3:context>
        <con3:actions>
          <con1:ifThenElse>
            <con:comment>Condici√≥n para determinar si se busca detalles del pago de pr√©stamo. Si el pago fue exitoso, se buscan detalles, de lo contrario se devuelve error.</con:comment>
            <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50f5</con:id>
            <con1:case>
              <con1:condition>
                <con:xqueryText>$successIndicatorT24 = "Success"</con:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50f3</con:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/consultaGeneralPrestamo/Resources/PrestamosT24BS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>ConsultadepagodeprestamoAA</con1:operation>
                  <con1:request>
                    <con1:body>$REQConsPagoPtmo</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPConsPagoPtmo</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQConsPagoPtmo">
                      <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50f4</con:id>
                      <con1:expr>
                        <con:xqueryTransform>
                          <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/consultaPagoPtmoT24In"/>
                          <con:param name="numeroPrestamo">
                            <con:path>fn:string($body/pag:pagoPrestamo/LOAN_NUMBER/text())</con:path>
                          </con:param>
                          <con:param name="requestHeader">
                            <con:path>$header/aut:RequestHeader</con:path>
                          </con:param>
                          <con:param name="transactionId">
                            <con:path>fn:string($RSPPagoPtmoT24/Status/transactionId/text())</con:path>
                          </con:param>
                        </con:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="successIndicatorQry2">
                      <con:id>_ActionId-6275502660260560169-5560e81c.14de8d7c23c.-7d56</con:id>
                      <con1:expr>
                        <con:xqueryText>fn:string($RSPConsPagoPtmo/WSFICOPAYMENTDETAILSAAType/gWSFICOPAYMENTDETAILSAADetailType/mWSFICOPAYMENTDETAILSAADetailType/TRANSINDICATOR/text())</con:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
                <con1:replace varName="body" contents-only="true">
                  <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50f2</con:id>
                  <con1:expr>
                    <con:xqueryTransform>
                      <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPrestamoT24Out"/>
                      <con:param name="successIndicatorQry2">
                        <con:path>fn:string($successIndicatorQry2)</con:path>
                      </con:param>
                      <con:param name="pagoaprestamoAAResponse">
                        <con:path>$RSPPagoPtmoT24</con:path>
                      </con:param>
                    </con:xqueryTransform>
                  </con1:expr>
                </con1:replace>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:replace varName="body" contents-only="true">
                <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50f1</con:id>
                <con1:expr>
                  <con:xqueryText>&lt;pag:pagoPrestamoResponse/></con:xqueryText>
                </con1:expr>
              </con1:replace>
            </con1:default>
          </con1:ifThenElse>
          <con1:replace varName="header" contents-only="true">
            <con:id>_ActionId-6050735543316898915--494f8364.158026416a9.-7f07</con:id>
            <con1:expr>
              <con:xqueryTransform>
                <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPrestamoT24HeaderOut"/>
                <con:param name="successIndicatorQry2">
                  <con:path>fn:string($successIndicatorQry2)</con:path>
                </con:param>
                <con:param name="pagoaprestamoAAResponse">
                  <con:path>$RSPPagoPtmoT24</con:path>
                </con:param>
              </con:xqueryTransform>
            </con1:expr>
          </con1:replace>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="ERROR_request">
      <con3:stage name="ERROR_proxyRequest">
        <con3:context/>
        <con3:actions>
          <con1:Error>
            <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-50ef</con:id>
            <con1:errCode>MW-0002</con1:errCode>
            <con1:message>INVALID REQUEST</con1:message>
          </con1:Error>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="ERROR_response"/>
    <con3:pipeline type="request" name="RegionalizacionPaisEmpresa_ConCruce_request">
      <con3:stage name="OperacionEnOrigen_PagoPrestamo">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con3:context>
        <con3:actions>
          <con1:Error>
            <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-507c</con:id>
            <con1:errCode>MW-0008</con1:errCode>
            <con1:message>SERVICE NOT IMPLEMENTED YET FOR THIS COUNTRY/COMPANY</con1:message>
          </con1:Error>
          <con1:ifThenElse>
            <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-507b</con:id>
            <con1:case>
              <con1:condition>
                <con:xqueryText>(:HNBanco:)
fn:string($header/aut:RequestHeader/Region/SourceBank/text()) = 'HN01'</con:xqueryText>
              </con1:condition>
              <con1:actions/>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con3:actions>
      </con3:stage>
      <con3:stage name="OperacionEnDestino_PagoPrestamo">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con3:context>
        <con3:actions>
          <con1:ifThenElse>
            <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-507a</con:id>
            <con1:case>
              <con1:condition>
                <con:xqueryText>(:HNBanco:)
fn:string($header/aut:RequestHeader/Region/DestinationBank/text()) = 'HN01'</con:xqueryText>
              </con1:condition>
              <con1:actions/>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="RegionalizacionPaisEmpresa_ConCruce_response"/>
    <con3:pipeline type="request" name="Default_PagoPrestamo_request">
      <con3:stage name="FlujoEntrada">
        <con3:context/>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="Default_PagoPrestamo_response">
      <con3:stage name="FlujoSalida">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/emisionChequesGerenciaTypes" prefix="emis"/>
        </con3:context>
        <con3:actions>
          <con1:Error>
            <con:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-500b</con:id>
            <con1:errCode>MW-0008</con1:errCode>
            <con1:message>SERVICE NOT IMPLEMENTED YET FOR THIS COUNTRY/COMPANY</con1:message>
          </con1:Error>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="GT01_PagoPrestamo_request">
      <con3:stage name="FlujoEntrada">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con3:context>
        <con3:actions>
          <con1:assign varName="paymentAmount">
            <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67cd</con:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/PAYMENT_AMOUNT/text()</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="loanNumber">
            <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67cc</con:id>
            <con1:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/LOAN_NUMBER/text()</con3:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="PaymentType">
            <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67cb</con:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/PAYMENT_TYPE/text()</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:ifThenElse>
            <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67ca</con:id>
            <con1:case>
              <con1:condition>
                <con:xqueryText>fn:string($PaymentType) != "" and
fn:string($loanNumber) != "" and
fn:string($paymentAmount) != ""</con:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:ifThenElse>
                  <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67c9</con:id>
                  <con1:case>
                    <con1:condition>
                      <con:xqueryText>fn:upper-case(fn:string($PaymentType)) = "ACCOUNT_DEBIT"</con:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67c7</con:id>
                        <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABKGT/pagoPrestamo/biz/PagoPrestamo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>PagoPrestamo</con1:operation>
                        <con1:request>
                          <con1:body>$rq</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>rp</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="rq">
                            <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67c8</con:id>
                            <con1:expr>
                              <con:xqueryTransform>
                                <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPtmoGTIn"/>
                                <con:param name="pagoPrestamo1">
                                  <con:path>$body/pag:pagoPrestamo</con:path>
                                </con:param>
                                <con:param name="requestHeader1">
                                  <con:path>$header/aut:RequestHeader</con:path>
                                </con:param>
                              </con:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform/>
                      </con1:wsCallout>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con:xqueryText>fn:upper-case(fn:string($PaymentType)) = "OTHER_BANK_CHEQUE"</con:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="message">
                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67c6</con:id>
                        <con1:expr>
                          <con:xqueryText>"PAYMENT TYPE NOT SUPPORTED"</con:xqueryText>
                        </con1:expr>
                      </con1:assign>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con:xqueryText>fn:upper-case(fn:string($PaymentType)) = "OWN_CHEQUE"</con:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="message">
                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67c5</con:id>
                        <con1:expr>
                          <con:xqueryText>"PAYMENT TYPE NOT SUPPORTED"</con:xqueryText>
                        </con1:expr>
                      </con1:assign>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con:xqueryText>fn:upper-case(fn:string($PaymentType)) = "CASH"</con:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="message">
                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67c4</con:id>
                        <con1:expr>
                          <con:xqueryText>"PAYMENT TYPE NOT SUPPORTED"</con:xqueryText>
                        </con1:expr>
                      </con1:assign>
                    </con1:actions>
                  </con1:case>
                  <con1:default>
                    <con1:assign varName="message">
                      <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67c3</con:id>
                      <con1:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">"PAYMENT TYPE NOT SUPPORTED"</con3:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:default>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:assign varName="message">
                <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67c2</con:id>
                <con1:expr>
                  <con:xqueryText>"REQUIRED FIELDS NOT SUPPLIED"</con:xqueryText>
                </con1:expr>
              </con1:assign>
            </con1:default>
          </con1:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="GT01_PagoPrestamo_response">
      <con3:stage name="FlujoSalida">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
        </con3:context>
        <con3:actions>
          <con1:ifThenElse>
            <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67c1</con:id>
            <con1:case>
              <con1:condition>
                <con:xqueryText>fn:string($message) != ""</con:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:replace contents-only="true" varName="header">
                  <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67c0</con:id>
                  <con1:expr>
                    <con:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{$message}</messages>
</aut:ResponseHeader>]]></con:xqueryText>
                  </con1:expr>
                </con1:replace>
                <con1:replace contents-only="true" varName="body">
                  <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-67bf</con:id>
                  <con1:expr>
                    <con:xqueryText>&lt;pag:pagoPrestamoResponse/></con:xqueryText>
                  </con1:expr>
                </con1:replace>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:replace contents-only="true" varName="header">
                <con:id>_ActionId-5165187676452498133--660a4447.157dcfdc56d.-5737</con:id>
                <con1:expr>
                  <con:xqueryTransform>
                    <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPtmoGTHeaderOut"/>
                    <con:param name="outputParameters1">
                      <con:path>$rp</con:path>
                    </con:param>
                  </con:xqueryTransform>
                </con1:expr>
              </con1:replace>
              <con1:ifThenElse>
                <con:id>_ActionId-5165187676452498133--660a4447.157dcfdc56d.-571a</con:id>
                <con1:case>
                  <con1:condition>
                    <con:xqueryText>fn:string($header/aut:ResponseHeader/successIndicator/text())!="SUCCESS"</con:xqueryText>
                  </con1:condition>
                  <con1:actions>
                    <con1:replace varName="body" contents-only="true">
                      <con:id>_ActionId-5165187676452498133--660a4447.157dcfdc56d.-56e2</con:id>
                      <con1:expr>
                        <con:xqueryText>&lt;pag:pagoPrestamoResponse/></con:xqueryText>
                      </con1:expr>
                    </con1:replace>
                  </con1:actions>
                </con1:case>
                <con1:default>
                  <con1:replace contents-only="true" varName="body">
                    <con:id>_ActionId-5165187676452498133--660a4447.157dcfdc56d.-56e0</con:id>
                    <con1:expr>
                      <con:xqueryTransform>
                        <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPtmoGTOut"/>
                        <con:param name="outputParameters1">
                          <con:path>$rp</con:path>
                        </con:param>
                      </con:xqueryTransform>
                    </con1:expr>
                  </con1:replace>
                </con1:default>
              </con1:ifThenElse>
            </con1:default>
          </con1:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="PA01_PagoPrestamo_request">
      <con3:stage name="FlujoEntrada">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con3:context>
        <con3:actions>
          <con1:assign varName="paymentAmount">
            <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-672e</con:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/PAYMENT_AMOUNT/text()</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="loanNumber">
            <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-672d</con:id>
            <con1:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/LOAN_NUMBER/text()</con3:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="PaymentType">
            <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-672c</con:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/PAYMENT_TYPE/text()</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:ifThenElse>
            <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-672b</con:id>
            <con1:case>
              <con1:condition>
                <con:xqueryText>fn:string($PaymentType) != "" and
fn:string($loanNumber) != "" and
fn:string($paymentAmount) != ""</con:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:ifThenElse>
                  <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-672a</con:id>
                  <con1:case>
                    <con1:condition>
                      <con:xqueryText>fn:upper-case(fn:string($PaymentType)) = "ACCOUNT_DEBIT"</con:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6728</con:id>
                        <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABKPA/pagoPrestamo/biz/pagoPrestamo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>pagoPrestamo</con1:operation>
                        <con1:request>
                          <con1:body>$rq</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>rp</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="rq">
                            <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6729</con:id>
                            <con1:expr>
                              <con:xqueryTransform>
                                <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPtmoPAIn"/>
                                <con:param name="pagoPrestamo1">
                                  <con:path>$body/pag:pagoPrestamo</con:path>
                                </con:param>
                                <con:param name="requestHeader1">
                                  <con:path>$header/aut:RequestHeader</con:path>
                                </con:param>
                              </con:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform/>
                      </con1:wsCallout>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con:xqueryText>fn:upper-case(fn:string($PaymentType)) = "OTHER_BANK_CHEQUE"</con:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="message">
                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6727</con:id>
                        <con1:expr>
                          <con:xqueryText>"PAYMENT TYPE NOT SUPPORTED"</con:xqueryText>
                        </con1:expr>
                      </con1:assign>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con:xqueryText>fn:upper-case(fn:string($PaymentType)) = "OWN_CHEQUE"</con:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="message">
                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6726</con:id>
                        <con1:expr>
                          <con:xqueryText>"PAYMENT TYPE NOT SUPPORTED"</con:xqueryText>
                        </con1:expr>
                      </con1:assign>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con:xqueryText>fn:upper-case(fn:string($PaymentType)) = "CASH"</con:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="message">
                        <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6725</con:id>
                        <con1:expr>
                          <con:xqueryText>"PAYMENT TYPE NOT SUPPORTED"</con:xqueryText>
                        </con1:expr>
                      </con1:assign>
                    </con1:actions>
                  </con1:case>
                  <con1:default>
                    <con1:assign varName="message">
                      <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6724</con:id>
                      <con1:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">"PAYMENT TYPE NOT SUPPORTED"</con3:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:default>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:assign varName="message">
                <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6723</con:id>
                <con1:expr>
                  <con:xqueryText>"REQUIRED FIELDS NOT SUPPLIED"</con:xqueryText>
                </con1:expr>
              </con1:assign>
            </con1:default>
          </con1:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="PA01_PagoPrestamo_response">
      <con3:stage name="FlujoSalida">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con3:context>
        <con3:actions>
          <con1:ifThenElse>
            <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6722</con:id>
            <con1:case>
              <con1:condition>
                <con:xqueryText>fn:string($message) != ""</con:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:replace contents-only="true" varName="header">
                  <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6721</con:id>
                  <con1:expr>
                    <con:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{$message}</messages>
</aut:ResponseHeader>]]></con:xqueryText>
                  </con1:expr>
                </con1:replace>
                <con1:replace contents-only="true" varName="body">
                  <con:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6720</con:id>
                  <con1:expr>
                    <con:xqueryText>&lt;pag:pagoPrestamoResponse/></con:xqueryText>
                  </con1:expr>
                </con1:replace>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:replace contents-only="true" varName="header">
                <con:id>_ActionId-5165187676452498133--660a4447.157dcfdc56d.-56de</con:id>
                <con1:expr>
                  <con:xqueryTransform>
                    <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPtmoPAHeaderOut"/>
                    <con:param name="outputParameters1">
                      <con:path>$rp</con:path>
                    </con:param>
                  </con:xqueryTransform>
                </con1:expr>
              </con1:replace>
              <con1:ifThenElse>
                <con:id>_ActionId-5165187676452498133--660a4447.157dcfdc56d.-56c1</con:id>
                <con1:case>
                  <con1:condition>
                    <con:xqueryText>fn:string($header/aut:ResponseHeader/successIndicator/text())!="SUCCESS"</con:xqueryText>
                  </con1:condition>
                  <con1:actions>
                    <con1:replace varName="body" contents-only="true">
                      <con:id>_ActionId-5165187676452498133--660a4447.157dcfdc56d.-5687</con:id>
                      <con1:expr>
                        <con:xqueryText>&lt;pag:pagoPrestamoResponse/></con:xqueryText>
                      </con1:expr>
                    </con1:replace>
                  </con1:actions>
                </con1:case>
                <con1:default>
                  <con1:replace contents-only="true" varName="body">
                    <con:id>_ActionId-5165187676452498133--660a4447.157dcfdc56d.-56bf</con:id>
                    <con1:expr>
                      <con:xqueryTransform>
                        <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPtmoPAOut"/>
                        <con:param name="outputParameters1">
                          <con:path>$rp</con:path>
                        </con:param>
                      </con:xqueryTransform>
                    </con1:expr>
                  </con1:replace>
                </con1:default>
              </con1:ifThenElse>
            </con1:default>
          </con1:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="NI01_PagoPrestamo_request">
      <con3:stage name="FlujoEntrada">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
        </con3:context>
        <con3:actions>
          <con1:ifThenElse>
            <con:id>_ActionId-7922194326261637699--3d29a154.15c3ae6e8a9.-7f93</con:id>
            <con1:case>
              <con1:condition>
                <con:xqueryText>fn:upper-case(fn:string($body/pag:pagoPrestamo/PAYMENT_TYPE/text())) = "ACCOUNT_DEBIT"</con:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:assign varName="validationMessage">
                  <con:id>_ActionId-7922194326261637699--3d29a154.15c3ae6e8a9.-7e1c</con:id>
                  <con1:expr>
                    <con:xqueryText>""</con:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:wsCallout>
                  <con:id>_ActionId-7922194326261637699--3d29a154.15c3ae6e8a9.-7f8f</con:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/CTS/prestamo/biz/prestamo" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>OpPagarPrestamo</con1:operation>
                  <con1:request>
                    <con1:body>$REQPagarPrestamo</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPPagarPrestamo</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQPagarPrestamo">
                      <con:id>_ActionId-7922194326261637699--3d29a154.15c3ae6e8a9.-7f90</con:id>
                      <con1:expr>
                        <con:xqueryTransform>
                          <con:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPrestamoNIIn"/>
                          <con:param name="pagoPrestamo">
                            <con:path>$body/pag:pagoPrestamo</con:path>
                          </con:param>
                        </con:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                    <con1:validate>
                      <con:id>_ActionId-2112113176119020215-aa64e43.15d2d4f33d0.-7ed6</con:id>
                      <con1:schema ref="Middleware/v2/BusinessServices/CTS/prestamo/xsd/services"/>
                      <con1:schemaElement xmlns:ser1="http://service.srvaplcobisprestamo.ecobis.cobiscorp">ser1:opPagarPrestamoSolicitud</con1:schemaElement>
                      <con1:varName>REQPagarPrestamo</con1:varName>
                      <con1:location>
                        <con:xpathText>.</con:xpathText>
                      </con1:location>
                    </con1:validate>
                  </con1:requestTransform>
                  <con1:responseTransform/>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:assign varName="validationMessage">
                <con:id>_ActionId-7922194326261637699--3d29a154.15c3ae6e8a9.-7e96</con:id>
                <con1:expr>
                  <con:xqueryText>"PAYMENT TYPE NOT SUPPORTED"</con:xqueryText>
                </con1:expr>
              </con1:assign>
            </con1:default>
          </con1:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="NI01_PagoPrestamo_response">
      <con3:stage name="FlujoSalida">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
        </con3:context>
        <con3:actions>
          <con1:ifThenElse>
            <con:id>_ActionId-7922194326261637699--3d29a154.15c3ae6e8a9.-7e09</con:id>
            <con1:case>
              <con1:condition>
                <con:xqueryText>$validationMessage = ""</con:xqueryText>
              </con1:condition>
              <con1:actions>
                <con4:replace varName="header" contents-only="true" xmlns:con3="http://www.bea.com/wli/sb/services/security/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                  <con1:id>_ActionId-7922194326261637699--3d29a154.15c3ae6e8a9.-7e07</con1:id>
                  <con4:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPrestamoNIHeaderOut"/>
                      <con1:param name="opPagarPrestamoRespuesta">
                        <con1:path>$RSPPagarPrestamo</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con4:expr>
                </con4:replace>
                <con1:ifThenElse>
                  <con:id>_ActionId-7922194326261637699--3d29a154.15c3ae6e8a9.-7e03</con:id>
                  <con1:case>
                    <con1:condition>
                      <con:xqueryText>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) = "SUCCESS"</con:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con4:replace varName="body" contents-only="true" xmlns:con3="http://www.bea.com/wli/sb/services/security/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                        <con1:id>_ActionId-7922194326261637699--3d29a154.15c3ae6e8a9.-7d3a</con1:id>
                        <con4:expr>
                          <con1:xqueryTransform>
                            <con1:resource ref="Middleware/v2/Resources/PagoPrestamo/xq/pagoPrestamoNIOut"/>
                            <con1:param name="opPagarPrestamoRespuesta">
                              <con1:path>$RSPPagarPrestamo</con1:path>
                            </con1:param>
                          </con1:xqueryTransform>
                        </con4:expr>
                      </con4:replace>
                    </con1:actions>
                  </con1:case>
                  <con1:default>
                    <con4:replace varName="body" contents-only="true" xmlns:con3="http://www.bea.com/wli/sb/services/security/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                      <con1:id>_ActionId-7922194326261637699--3d29a154.15c3ae6e8a9.-7d38</con1:id>
                      <con4:expr>
                        <con1:xqueryText>&lt;pag:pagoPrestamoResponse/></con1:xqueryText>
                      </con4:expr>
                    </con4:replace>
                  </con1:default>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con4:replace varName="header" contents-only="true" xmlns:con3="http://www.bea.com/wli/sb/services/security/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                <con1:id>_ActionId-7922194326261637699--3d29a154.15c3ae6e8a9.-7dac</con1:id>
                <con4:expr>
                  <con1:xqueryText><![CDATA[<aut:ResponseHeader>
	<successIndicator>Error</successIndicator>
	<messages>{$validationMessage}</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                </con4:expr>
              </con4:replace>
              <con4:replace varName="body" contents-only="true" xmlns:con3="http://www.bea.com/wli/sb/services/security/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                <con1:id>_ActionId-7922194326261637699--3d29a154.15c3ae6e8a9.-7d3c</con1:id>
                <con4:expr>
                  <con1:xqueryText>&lt;pag:pagoPrestamoResponse/></con1:xqueryText>
                </con4:expr>
              </con4:replace>
            </con1:default>
          </con1:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con:flow xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:pipeline-node name="ValidacionesGenerales">
        <con:request>ValidacionesGenerales_request</con:request>
        <con:response>ValidacionesGenerales_response</con:response>
      </con:pipeline-node>
      <con:branch-node type="condition" name="ValidacionCrucePaisEmpresa">
        <con:context/>
        <con:branch-table variable="areSameSourceAndDestination">
          <con:branch name="SameOriginAndDestination">
            <con:operator>equals</con:operator>
            <con:value>'YES'</con:value>
            <con:flow>
              <con:branch-node type="condition" name="RegionalizacionPaisEmpresa">
                <con:context>
                  <con4:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con4="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:branch-table variable="header">
                  <con:xpath>
                    <con4:xpathText xmlns:con4="http://www.bea.com/wli/sb/stages/config">./aut:RequestHeader/Region/SourceBank</con4:xpathText>
                  </con:xpath>
                  <con:branch name="HN01">
                    <con:operator>equals</con:operator>
                    <con:value>'HN01'</con:value>
                    <con:flow>
                      <con:branch-node type="condition" name="HN01_PagoPrestamo">
                        <con:context/>
                        <con:branch-table variable="loanType">
                          <con:branch name="Abanks">
                            <con:operator>equals</con:operator>
                            <con:value>"ABANKS"</con:value>
                            <con:flow>
                              <con:pipeline-node name="ABANKS">
                                <con:request>ABANKS_request</con:request>
                                <con:response>ABANKS_response</con:response>
                              </con:pipeline-node>
                            </con:flow>
                          </con:branch>
                          <con:branch name="T24">
                            <con:operator>equals</con:operator>
                            <con:value>"T24"</con:value>
                            <con:flow>
                              <con:pipeline-node name="T24">
                                <con:request>T24_request</con:request>
                                <con:response>T24_response</con:response>
                              </con:pipeline-node>
                            </con:flow>
                          </con:branch>
                          <con:default-branch>
                            <con:flow>
                              <con:pipeline-node name="ERROR">
                                <con:request>ERROR_request</con:request>
                                <con:response>ERROR_response</con:response>
                              </con:pipeline-node>
                            </con:flow>
                          </con:default-branch>
                        </con:branch-table>
                      </con:branch-node>
                    </con:flow>
                  </con:branch>
                  <con:branch name="GT01">
                    <con:operator>equals</con:operator>
                    <con:value>'GT01'</con:value>
                    <con:flow>
                      <con:pipeline-node name="GT01_PagoPrestamo">
                        <con:request>GT01_PagoPrestamo_request</con:request>
                        <con:response>GT01_PagoPrestamo_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:branch name="PA01">
                    <con:operator>equals</con:operator>
                    <con:value>'PA01'</con:value>
                    <con:flow>
                      <con:pipeline-node name="PA01_PagoPrestamo">
                        <con:request>PA01_PagoPrestamo_request</con:request>
                        <con:response>PA01_PagoPrestamo_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:branch name="NI01">
                    <con:operator>equals</con:operator>
                    <con:value>'NI01'</con:value>
                    <con:flow>
                      <con:pipeline-node name="NI01_PagoPrestamo">
                        <con:request>NI01_PagoPrestamo_request</con:request>
                        <con:response>NI01_PagoPrestamo_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:default-branch>
                    <con:flow>
                      <con:pipeline-node name="Default_PagoPrestamo">
                        <con:request>Default_PagoPrestamo_request</con:request>
                        <con:response>Default_PagoPrestamo_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:default-branch>
                </con:branch-table>
              </con:branch-node>
            </con:flow>
          </con:branch>
          <con:default-branch>
            <con:flow>
              <con:pipeline-node name="RegionalizacionPaisEmpresa_ConCruce">
                <con:request>RegionalizacionPaisEmpresa_ConCruce_request</con:request>
                <con:response>RegionalizacionPaisEmpresa_ConCruce_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:default-branch>
        </con:branch-table>
      </con:branch-node>
    </con:flow>
  </ser:router>
</xml-fragment>