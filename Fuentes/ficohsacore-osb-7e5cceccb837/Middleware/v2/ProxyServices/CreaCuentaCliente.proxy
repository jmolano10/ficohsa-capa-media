<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
  <ser:coreEntry isProxy="true" isEnabled="true" isTracingEnabled="false">
    <ser:security>
      <con3:custom-token-authentication>
        <con3:username-password>
          <con3:username-selector>
            <con3:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';./aut:RequestHeader/Authentication/UserName/text()</con3:xpath>
            <con3:variable>header</con3:variable>
          </con3:username-selector>
          <con3:password-selector>
            <con3:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';./aut:RequestHeader/Authentication/Password/text()</con3:xpath>
            <con3:variable>header</con3:variable>
          </con3:password-selector>
        </con3:username-password>
      </con3:custom-token-authentication>
    </ser:security>
    <ser:binding type="SOAP" isSoap12="false" xsi:type="con1:SoapBindingType" xmlns:con1="http://www.bea.com/wli/sb/services/bindings/config">
      <con1:wsdl ref="Middleware/v2/Resources/AperturaProductos/wsdl/aperturaProductosPS"/>
      <con1:port>
        <con1:name>aperturaProductosPSSOAP</con1:name>
        <con1:namespace>http://www.ficohsa.com.hn/middleware.services/aperturaProductosPS/</con1:namespace>
      </con1:port>
      <con1:selector type="SOAP body"/>
      <con1:WSI-compliant>false</con1:WSI-compliant>
    </ser:binding>
    <ser:monitoring isEnabled="false">
      <ser:aggregationInterval>10</ser:aggregationInterval>
      <ser:pipelineMonitoringLevel>Pipeline</ser:pipelineMonitoringLevel>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
  </ser:coreEntry>
  <ser:endpointConfig>
    <tran:provider-id>local</tran:provider-id>
    <tran:inbound>true</tran:inbound>
    <tran:inbound-properties/>
    <tran:all-headers>true</tran:all-headers>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-4034291471934029355-5f5ca871.171420fe941.-7814">
    <con:pipeline type="request" name="ValidacionesGenerales_request">
      <con:stage name="ValidacionXSD">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes" prefix="aper"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/tributosTypes" prefix="trib"/>
        </con:context>
        <con:actions>
          <con2:validate>
            <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-7935</con1:id>
            <con2:schema ref="Middleware/v2/Resources/AperturaProductos/xsd/aperturaProductosTypes"/>
            <con2:schemaElement xmlns:trib="http://www.ficohsa.com.hn/middleware.services/tributosTypes" xmlns:aper="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes">aper:creaCuentaCliente</con2:schemaElement>
            <con2:varName>body</con2:varName>
            <con2:location>
              <con1:xpathText>./aper:creaCuentaCliente</con1:xpathText>
            </con2:location>
            <con2:resultVarName/>
          </con2:validate>
        </con:actions>
      </con:stage>
      <con:stage name="ValidacionServicioRegional">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes" prefix="aper"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/ValidaServicioRegional" prefix="val"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/tributosTypes" prefix="trib"/>
        </con:context>
        <con:actions>
          <con2:wsCallout>
            <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-792e</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ValidaServicioRegional/biz/ValidaServicioRegional_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>ValidaServicioRegional</con2:operation>
            <con2:request>
              <con2:body>$reqValidaServicioRegional</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>respValidaServicioRegional</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="reqValidaServicioRegional">
                <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-7934</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/Generales/xq/validaServicioRegionalIn"/>
                    <con1:param name="requestHeader1">
                      <con1:path>$header/aut:RequestHeader</con1:path>
                    </con1:param>
                    <con1:param name="serviceId">
                      <con1:path>"FICBCO0403"</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:ifThenElse>
                <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-7933</con1:id>
                <con2:case>
                  <con2:condition>
                    <con1:xqueryText>fn:string($respValidaServicioRegional/val:PV_CODIGO_ERROR/text()) != 'SUCCESS'</con1:xqueryText>
                  </con2:condition>
                  <con2:actions>
                    <con2:replace contents-only="true" varName="header">
                      <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-7932</con1:id>
                      <con2:expr>
                        <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{fn:string($respValidaServicioRegional/val:PV_MENSAJE_ERROR/text())}</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                      </con2:expr>
                    </con2:replace>
                    <con2:replace contents-only="true" varName="body">
                      <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-7931</con1:id>
                      <con2:expr>
                        <con1:xqueryText>&lt;aper:creaCuentaClienteResponse/></con1:xqueryText>
                      </con2:expr>
                    </con2:replace>
                    <con1:reply>
                      <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-7930</con1:id>
                    </con1:reply>
                  </con2:actions>
                </con2:case>
                <con2:default>
                  <con2:replace contents-only="true" varName="header">
                    <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-792f</con1:id>
                    <con2:expr>
                      <con1:xqueryTransform>
                        <con1:resource ref="Middleware/v2/Resources/Generales/xq/aplicarValoresPorDefectoRegion"/>
                        <con1:param name="requestHeader">
                          <con1:path>$header/aut:RequestHeader</con1:path>
                        </con1:param>
                      </con1:xqueryTransform>
                    </con2:expr>
                  </con2:replace>
                </con2:default>
              </con2:ifThenElse>
            </con2:responseTransform>
          </con2:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="BitacoraRequest">
        <con:context xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/services/security/config">
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/services/security/config">
          <con5:assign varName="IdOSB" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config">
            <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-4938955964506616316--3b1d2a5a.171dcd3bba5.-65a9</con6:id>
            <con5:expr>
              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">fn:string($inbound/ctx:transport/ctx:request/tp:headers/tp:user-header[@name='Host']/@value)</con6:xqueryText>
            </con5:expr>
          </con5:assign>
          <con2:assign varName="uuidBitacoraRequest">
            <con1:id>_ActionId-4938955964506616316--3b1d2a5a.171dcd3bba5.-6974</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="originalBody">
            <con1:id>_ActionId-4938955964506616316--3b1d2a5a.171dcd3bba5.-6973</con1:id>
            <con2:expr>
              <con1:xqueryText>$body</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="originalHeader">
            <con1:id>_ActionId-4938955964506616316--3b1d2a5a.171dcd3bba5.-6972</con1:id>
            <con2:expr>
              <con1:xqueryText>$header</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con3:route>
            <con1:id>_ActionId-4938955964506616316--3b1d2a5a.171dcd3bba5.-6971</con1:id>
            <con3:service ref="Middleware/v2/BusinessServices/OSB/RegistrarBitacoraOSB_v2/biz/RegistrarBitacoraOSB_v2" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con3:operation>registrarBitacoraOSB</con3:operation>
            <con3:outboundTransform>
              <con3:replace contents-only="true" varName="body" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con5="http://www.bea.com/wli/sb/stages/logging/config" xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config">
                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-4938955964506616316--3b1d2a5a.171dcd3bba5.-6970</con6:id>
                <con3:location>
                  <con5:xpathText xmlns:con5="http://www.bea.com/wli/sb/stages/config">.</con5:xpathText>
                </con3:location>
                <con3:expr>
                  <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                    <con6:resource ref="Middleware/v2/Resources/Generales/xq/registrarBitacoraOSBIn"/>
                    <con6:param name="UuidReq">
                      <con6:path>""</con6:path>
                    </con6:param>
                    <con6:param name="IdOsb">
                      <con6:path>fn:string($inbound/ctx:transport/ctx:request/tp:headers/tp:user-header[@name='Host']/@value)</con6:path>
                    </con6:param>
                    <con6:param name="BancoDestino">
                      <con6:path>string($header/aut:RequestHeader/Region/DestinationBank/text())</con6:path>
                    </con6:param>
                    <con6:param name="Uuid">
                      <con6:path>$uuidBitacoraRequest</con6:path>
                    </con6:param>
                    <con6:param name="Contenido">
                      <con6:path>$body</con6:path>
                    </con6:param>
                    <con6:param name="BancoOrigen">
                      <con6:path>string($header/aut:RequestHeader/Region/SourceBank/text())</con6:path>
                    </con6:param>
                    <con6:param name="Usuario">
                      <con6:path>string($header/aut:RequestHeader/Authentication/UserName/text())</con6:path>
                    </con6:param>
                    <con6:param name="IdOperacion">
                      <con6:path>fn:string($operation)</con6:path>
                    </con6:param>
                    <con6:param name="Resultado">
                      <con6:path>""</con6:path>
                    </con6:param>
                    <con6:param name="IdServicio">
                      <con6:path>"FICBCO0403"</con6:path>
                    </con6:param>
                    <con6:param name="IdTxn">
                      <con6:path>""</con6:path>
                    </con6:param>
                    <con6:param name="TipoMensaje">
                      <con6:path>"REQ"</con6:path>
                    </con6:param>
                    <con6:param name="FechaTxn">
                      <con6:path>current-dateTime()</con6:path>
                    </con6:param>
                    <con6:param name="MensajeError">
                      <con6:path>""</con6:path>
                    </con6:param>
                  </con6:xqueryTransform>
                </con3:expr>
              </con3:replace>
            </con3:outboundTransform>
          </con3:route>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="ValidacionesGenerales_response">
      <con:stage name="MapeoError">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-792d</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) != "SUCCESS"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-792a</con1:id>
                  <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>mapeoErrores</con2:operation>
                  <con2:request>
                    <con2:body>$REQMapeoErrores</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPMapeoErrores</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQMapeoErrores">
                      <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-792c</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                          <con1:param name="MENSAJE_ERROR">
                            <con1:path>fn:concat("FICBCO0403","$#$",fn:string-join($header/aut:ResponseHeader/messages, '||'))</con1:path>
                          </con1:param>
                          <con1:param name="CODIGO_ERROR">
                            <con1:path>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text()))</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:replace varName="header" contents-only="true">
                      <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-792b</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                          <con1:param name="mapeoErroresResponse1">
                            <con1:path>$RSPMapeoErrores</con1:path>
                          </con1:param>
                          <con1:param name="successIndicator">
                            <con1:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:replace>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-4034291471934029355-5f5ca871.171420fe941.-7814">
      <con:stage name="ManejoError">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes" prefix="aper"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/tributosTypes" prefix="trib"/>
        </con:context>
        <con:actions>
          <con2:assign varName="errorCode">
            <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-7805</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($fault/ctx:errorCode/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="errorMessage">
            <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-7804</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($fault/ctx:reason/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:wsCallout>
            <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-7801</con1:id>
            <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>mapeoErrores</con2:operation>
            <con2:request>
              <con2:body>$reqMapeoErrores</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>respMapeoErrores</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="reqMapeoErrores">
                <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-7803</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                    <con1:param name="CODIGO_ERROR">
                      <con1:path>$errorCode</con1:path>
                    </con1:param>
                    <con1:param name="MENSAJE_ERROR">
                      <con1:path>fn:concat("FICBCO0403", "$#$", $errorMessage)</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:replace contents-only="true" varName="header">
                <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-7802</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                    <con1:param name="mapeoErroresResponse1">
                      <con1:path>$respMapeoErrores</con1:path>
                    </con1:param>
                    <con1:param name="successIndicator">
                      <con1:path>$errorCode</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:replace>
            </con2:responseTransform>
          </con2:wsCallout>
          <con2:replace varName="body" contents-only="true">
            <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-7800</con1:id>
            <con2:expr>
              <con1:xqueryText>&lt;aper:creaCuentaClienteResponse/></con1:xqueryText>
            </con2:expr>
          </con2:replace>
          <con1:reply>
            <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-77ff</con1:id>
          </con1:reply>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="CreaCuentaClienteHN_request">
      <con:stage name="ObtenerParametrizacion">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes" prefix="aper1"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-4780285559497282762--2c40e96c.1749c63a4be.-7d61</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>(count($body/aper1:creaCuentaCliente/CUSTOMER_INFORMATION/LEGAL_ID/text())>0)</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace contents-only="true" varName="body">
                  <con1:id>_ActionId-4780285559497282762--2c40e96c.1749c63a4be.-7d46</con1:id>
                  <con2:location>
                    <con1:xpathText>./aper1:creaCuentaCliente/CUSTOMER_INFORMATION/LEGAL_ID</con1:xpathText>
                  </con2:location>
                  <con2:expr>
                    <con1:xqueryText>replace($body/aper1:creaCuentaCliente/CUSTOMER_INFORMATION/LEGAL_ID/text(),'-','')</con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:replace varName="body" contents-only="true">
                  <con1:id>_ActionId-1528841706836344--72fe22ba.175230275d2.-7f85</con1:id>
                  <con2:location>
                    <con1:xpathText>./aper1:creaCuentaCliente/CUSTOMER_INFORMATION/FIRST_NAME</con1:xpathText>
                  </con2:location>
                  <con2:expr>
                    <con1:xqueryText>upper-case($body/aper1:creaCuentaCliente/CUSTOMER_INFORMATION/FIRST_NAME/text())</con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:replace varName="body" contents-only="true">
                  <con1:id>_ActionId-1528841706836344--72fe22ba.175230275d2.-7f9e</con1:id>
                  <con2:location>
                    <con1:xpathText>./aper1:creaCuentaCliente/CUSTOMER_INFORMATION/SECOND_NAME</con1:xpathText>
                  </con2:location>
                  <con2:expr>
                    <con1:xqueryText>upper-case($body/aper1:creaCuentaCliente/CUSTOMER_INFORMATION/SECOND_NAME/text())</con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:replace varName="body" contents-only="true">
                  <con1:id>_ActionId-1528841706836344--72fe22ba.175230275d2.-7f7a</con1:id>
                  <con2:location>
                    <con1:xpathText>./aper1:creaCuentaCliente/CUSTOMER_INFORMATION/FIRST_LASTNAME</con1:xpathText>
                  </con2:location>
                  <con2:expr>
                    <con1:xqueryText>upper-case($body/aper1:creaCuentaCliente/CUSTOMER_INFORMATION/FIRST_LASTNAME/text())</con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:replace contents-only="true" varName="body">
                  <con1:id>_ActionId-1528841706836344--72fe22ba.175230275d2.-7f5c</con1:id>
                  <con2:location>
                    <con1:xpathText>./aper1:creaCuentaCliente/CUSTOMER_INFORMATION/SECOND_LASTNAME</con1:xpathText>
                  </con2:location>
                  <con2:expr>
                    <con1:xqueryText>upper-case($body/aper1:creaCuentaCliente/CUSTOMER_INFORMATION/SECOND_LASTNAME/text())</con1:xqueryText>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
          <con2:assign varName="ErrorIdCustomer">
            <con1:id>_ActionId-7720093635378269189--580bd00.1756574a357.-6fb8</con1:id>
            <con2:expr>
              <con1:xqueryText>'0'</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="ErrorIdAccount">
            <con1:id>_ActionId-7720093635378269189--580bd00.1756574a357.-6f85</con1:id>
            <con2:expr>
              <con1:xqueryText>'0'</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="ErrorIdUser">
            <con1:id>_ActionId-7720093635378269189--580bd00.1756574a357.-6f98</con1:id>
            <con2:expr>
              <con1:xqueryText>'0'</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="ErrorIdCard">
            <con1:id>_ActionId-7720093635378269189--580bd00.1756574a357.-6fa7</con1:id>
            <con2:expr>
              <con1:xqueryText>'0'</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="existCustomer">
            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-6c54</con1:id>
            <con2:expr>
              <con1:xqueryText>if(count($body/aper1:creaCuentaCliente/CUSTOMER_INFORMATION/IS_NEW_CUSTOMER/text())=0) then(
"NO"
)else(
$body/aper1:creaCuentaCliente/CUSTOMER_INFORMATION/IS_NEW_CUSTOMER/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="sourceBank">
            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-7d4f</con1:id>
            <con2:expr>
              <con1:xqueryText>string($header/aut:RequestHeader/Region/SourceBank/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="operationTypeParam">
            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-7d4d</con1:id>
            <con2:expr>
              <con1:xqueryText>if (string($body/aper1:creaCuentaCliente/ACCOUNT_INFORMATION/OPERATION_TYPE/text())='') then(
"INDIVIDUAL")
else(
string($body/aper1:creaCuentaCliente/ACCOUNT_INFORMATION/OPERATION_TYPE/text())
)</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con1:assign varName="productTypeParam" xmlns:con="http://www.bea.com/wli/sb/stages/config" xmlns:con3="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/services/security/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-9036808973115216780-4be72e0a.172815789fb.-7d4b</con4:id>
            <con1:expr>
              <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">if($body/aper1:creaCuentaCliente/CREATE_DEBIT_CARD/text() = 'YES') then(
string($body/aper1:creaCuentaCliente/CARD_INFORMATION/TYPE/text())
)else ('')</con4:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/services/security/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-9036808973115216780-4be72e0a.172815789fb.-7d41</con4:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>obtenerParametrizacion</con1:operation>
            <con1:request>
              <con1:body>$REQobtenerParametrizacion</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>RESobtenerParametrizacion</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="params">
                <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-9036808973115216780-4be72e0a.172815789fb.-7d45</con4:id>
                <con1:expr>
                  <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">if($productTypeParam != '') then(
	fn:concat("FICBCO0403.PRODUCTTYPE.",$productTypeParam,".",$sourceBank,"||",
			"FICBCO0403.BRANCHCODE.",$sourceBank, "||",
		"FICBCO0403.ACCOUNTOFFICER.",$sourceBank, "||",
		"FICBCO0403.OPERTYPE.", $operationTypeParam,".",$sourceBank,"||",
		"FICBCO0403.PROCESSTYPE.HN01")
)
else(
	fn:concat("FICBCO0403.BRANCHCODE.",$sourceBank, "||",
	   	"FICBCO0403.ACCOUNTOFFICER.",$sourceBank, "||",
		"FICBCO0403.OPERTYPE.", $operationTypeParam,".",$sourceBank,"||",
		"FICBCO0403.PROCESSTYPE.HN01")
)</con4:xqueryText>
                </con1:expr>
              </con1:assign>
              <con1:assign varName="REQobtenerParametrizacion">
                <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-9036808973115216780-4be72e0a.172815789fb.-7d44</con4:id>
                <con1:expr>
                  <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                    <con4:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                    <con4:param name="nombreParametros">
                      <con4:path>$params</con4:path>
                    </con4:param>
                  </con4:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con1:requestTransform>
            <con1:responseTransform>
              <con1:ifThenElse>
                <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-1528841706836344--72fe22ba.175230275d2.-7fcf</con4:id>
                <con1:case>
                  <con1:condition>
                    <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESobtenerParametrizacion/osb:ERROR_CODE/text())='SUCCESS'</con4:xqueryText>
                  </con1:condition>
                  <con1:actions>
                    <con1:assign varName="errorCode">
                      <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-1528841706836344--72fe22ba.175230275d2.-7fcd</con4:id>
                      <con1:expr>
                        <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">'Success'</con4:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:actions>
                </con1:case>
                <con1:default>
                  <con1:assign varName="errorCode">
                    <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-1528841706836344--72fe22ba.175230275d2.-7fb5</con4:id>
                    <con1:expr>
                      <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESobtenerParametrizacion/osb:ERROR_CODE/text())</con4:xqueryText>
                    </con1:expr>
                  </con1:assign>
                </con1:default>
              </con1:ifThenElse>
              <con4:assign varName="validationMessage" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                <con1:id>_ActionId-1528841706836344--72fe22ba.175230275d2.-7fc9</con1:id>
                <con4:expr>
                  <con1:xqueryText>if(upper-case($errorCode) = 'Success') then(
	''
)
else(
	fn:string($RESobtenerParametrizacion/osb:ERROR_MESSAGE/text())
)</con1:xqueryText>
                </con4:expr>
              </con4:assign>
            </con1:responseTransform>
          </con1:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="CreacionCliente">
        <con:context>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes" prefix="aper"/>
        </con:context>
        <con:actions>
          <con2:assign varName="validationMessageCustomer">
            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-7c4f</con1:id>
            <con2:expr>
              <con1:xqueryText>""</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="errorCodeCustomer">
            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-7c4e</con1:id>
            <con2:expr>
              <con1:xqueryText>""</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="Customer">
            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-7c4d</con1:id>
            <con2:expr>
              <con1:xqueryText>""</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:ifThenElse>
            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-7488</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$existCustomer='YES'</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-7472</con1:id>
                  <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/CreaClienteSimplificadoHN" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>CreaClienteSimplificado</con2:operation>
                  <con2:request>
                    <con2:body>$REQCreaClienteSimplificado</con2:body>
                    <con2:header>$REQHeaderCreaClienteSimplificado</con2:header>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPCreaClienteSimplificado</con2:body>
                    <con2:header>RSPHeaderCreaClienteSimplificado</con2:header>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="branchcode">
                      <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-7423</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($RESobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=fn:concat("FICBCO0403.BRANCHCODE.",$sourceBank)]/osb:VALUE/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="accountofficer">
                      <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-740d</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($RESobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=fn:concat("FICBCO0403.ACCOUNTOFFICER.",$sourceBank)]/osb:VALUE/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="REQHeaderCreaClienteSimplificado">
                      <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-745a</con1:id>
                      <con2:expr>
                        <con1:xqueryText>$header</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="REQCreaClienteSimplificado">
                      <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-743b</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/creaClienteSimplificadoIN"/>
                          <con1:param name="creaCuentaClienteIN">
                            <con1:path>$body/aper:creaCuentaCliente</con1:path>
                          </con1:param>
                          <con1:param name="accountofficer">
                            <con1:path>$accountofficer</con1:path>
                          </con1:param>
                          <con1:param name="branchcode">
                            <con1:path>$branchcode</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:assign varName="errorCodeCustomer">
                      <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-73f2</con1:id>
                      <con2:expr>
                        <con1:xqueryText>$RSPHeaderCreaClienteSimplificado/aut:ResponseHeader/successIndicator/text()</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="ErrorIdCustomer">
                      <con1:id>_ActionId-7720093635378269189--580bd00.1756574a357.-6f68</con1:id>
                      <con2:expr>
                        <con1:xqueryText>if(upper-case($errorCodeCustomer) = 'SUCCESS') then(
	'0'
)
else(
	fn:string($RSPHeaderCreaClienteSimplificado/aut:ResponseHeader/messageId/text())
)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="validationMessageCustomer">
                      <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-73d4</con1:id>
                      <con2:expr>
                        <con1:xqueryText>if(upper-case($errorCodeCustomer) = 'SUCCESS') then(
	''
)
else(
	fn:string($RSPHeaderCreaClienteSimplificado/aut:ResponseHeader/messages/text())
)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="Customer">
                      <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-73bc</con1:id>
                      <con2:expr>
                        <con1:xqueryText>if(upper-case($errorCodeCustomer) != 'SUCCESS') then(
	''
)
else(
	fn:string($RSPCreaClienteSimplificado/COSTUMER_ID/text())
)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con1:skip>
                <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-73aa</con1:id>
              </con1:skip>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="CreacionCuenta">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes" prefix="aper"/>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
        </con:context>
        <con:actions>
          <con2:assign varName="errorCodeAccount">
            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-7ce5</con1:id>
            <con2:expr>
              <con1:xqueryText>""</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="accountNumber">
            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-7ce4</con1:id>
            <con2:expr>
              <con1:xqueryText>""</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="validationMessageAccount">
            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-7ce3</con1:id>
            <con2:expr>
              <con1:xqueryText>""</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="Customer">
            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-6968</con1:id>
            <con2:expr>
              <con1:xqueryText>if ($Customer="") then(
if (count($body/aper:creaCuentaCliente/ACCOUNT_INFORMATION/CUSTOMER_ID/text())=0) then(
"")
else($body/aper:creaCuentaCliente/ACCOUNT_INFORMATION/CUSTOMER_ID/text())
)
else($Customer)</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:ifThenElse>
            <con1:id>_ActionId-8788386998230798809--a399827.17189ca545d.-7a3e</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage = '' and $body/aper:creaCuentaCliente/CREATE_ACCOUNT/text() = 'YES'
and $existCustomer='NO' or $validationMessage = '' and $body/aper:creaCuentaCliente/CREATE_ACCOUNT/text() = 'YES'
and $existCustomer='YES' and upper-case($errorCodeCustomer) = 'SUCCESS'</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-8788386998230798809--a399827.17189ca545d.-7a39</con1:id>
                  <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/SolicitudAperturaCuentaHN" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>solicitudAperturaCuenta</con2:operation>
                  <con2:request>
                    <con2:body wrapped="false">$REQCreaCuentaCliente</con2:body>
                    <con2:header>$REQHeaderCreaCuentaCliente</con2:header>
                  </con2:request>
                  <con2:response>
                    <con2:body wrapped="false">RSPCreaCuentaCliente</con2:body>
                    <con2:header>RSPHeaderCreaCuentaCliente</con2:header>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="productTypeTD">
                      <con1:id>_ActionId-5786417062208361037--3fe9cb54.171c8feafb4.-76c4</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($RESobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=fn:concat("FICBCO0403.PRODUCTTYPE.",$productTypeParam,".",$sourceBank)]/osb:VALUE/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="processType">
                      <con1:id>_ActionId-5786417062208361037--3fe9cb54.171c8feafb4.-7750</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($RESobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME="FICBCO0403.PROCESSTYPE.HN01"]/osb:VALUE/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="branchCode">
                      <con1:id>_ActionId-5786417062208361037--3fe9cb54.171c8feafb4.-7788</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($RESobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=fn:concat("FICBCO0403.BRANCHCODE.",$sourceBank)]/osb:VALUE/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="operationType">
                      <con1:id>_ActionId-5786417062208361037--3fe9cb54.171c8feafb4.-778a</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($RESobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=fn:concat("FICBCO0403.OPERTYPE.", $operationTypeParam,".",$sourceBank)]/osb:VALUE/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="REQHeaderCreaCuentaCliente">
                      <con1:id>_ActionId-8788386998230798809--a399827.17189ca545d.-7a3d</con1:id>
                      <con2:expr>
                        <con1:xqueryText>$header</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="REQCreaCuentaCliente">
                      <con1:id>_ActionId-8788386998230798809--a399827.17189ca545d.-7a3c</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/solicitudAperturaCuentaIn"/>
                          <con1:param name="processType">
                            <con1:path>$processType</con1:path>
                          </con1:param>
                          <con1:param name="creaCuentaCliente">
                            <con1:path>$body/aper:creaCuentaCliente</con1:path>
                          </con1:param>
                          <con1:param name="operationType">
                            <con1:path>$operationType</con1:path>
                          </con1:param>
                          <con1:param name="branchCode">
                            <con1:path>$branchCode</con1:path>
                          </con1:param>
                          <con1:param name="customer">
                            <con1:path>$Customer</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:assign varName="errorCodeAccount">
                      <con1:id>_ActionId-8788386998230798809--a399827.17189ca545d.-7a3b</con1:id>
                      <con2:expr>
                        <con1:xqueryText>if (fn:string($RSPHeaderCreaCuentaCliente/aut:ResponseHeader/successIndicator/text())!='Success') then(
"ERROR")
else (
fn:string($RSPHeaderCreaCuentaCliente/aut:ResponseHeader/successIndicator/text())
)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="ErrorIdAccount">
                      <con1:id>_ActionId-7720093635378269189--580bd00.1756574a357.-6f51</con1:id>
                      <con2:expr>
                        <con1:xqueryText>if($errorCodeAccount = 'Success') then(
	'0'
)
else(
    if(count($RSPHeaderCreaCuentaCliente/aut:ResponseHeader/messageId) >=1) then(
	   $RSPHeaderCreaCuentaCliente/aut:ResponseHeader/messageId/text()
	
	 )else('-1')
)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="validationMessageAccount">
                      <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-7ce1</con1:id>
                      <con2:expr>
                        <con1:xqueryText>if($errorCodeAccount = 'Success') then(
	''
)
else(
	$RSPHeaderCreaCuentaCliente/aut:ResponseHeader/messages/text()
)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="accountNumber">
                      <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-7d22</con1:id>
                      <con2:expr>
                        <con1:xqueryText>if($errorCodeAccount != 'Success') then(
	''
)
else(
	$RSPCreaCuentaCliente/ACCOUNT_INFORMATION/ACCOUNT_NUMBER/text()
)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con1:skip>
                <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-7cca</con1:id>
              </con1:skip>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="CreacionUsuario">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes" prefix="aper"/>
        </con:context>
        <con:actions>
          <con2:assign varName="validationMessageUser">
            <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-7414</con1:id>
            <con2:expr>
              <con1:xqueryText>""</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="errorCodeUser">
            <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-7412</con1:id>
            <con2:expr>
              <con1:xqueryText>""</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="userName">
            <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-7410</con1:id>
            <con2:expr>
              <con1:xqueryText>""</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:ifThenElse>
            <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73ed</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$body/aper:creaCuentaCliente/CREATE_USER_ID/text()='YES'
and $body/aper:creaCuentaCliente/CREATE_ACCOUNT/text()='NO'and
$existCustomer='NO'</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:assign varName="DocumentType">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73ec</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$body/aper:creaCuentaCliente/USER_INFORMATION/DOCUMENT_TYPE_ID/text()</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="DocumentNumber">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73eb</con1:id>
                  <con2:expr>
                    <con1:xqueryText>replace($body/aper:creaCuentaCliente/USER_INFORMATION/DOCUMENT_NUMBER/text(),'-','')</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="names">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73ea</con1:id>
                  <con2:expr>
                    <con1:xqueryText>upper-case(normalize-space($body/aper:creaCuentaCliente/USER_INFORMATION/CUSTOMER_NAMES/text()))</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="lastname">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73e9</con1:id>
                  <con2:expr>
                    <con1:xqueryText>upper-case(normalize-space($body/aper:creaCuentaCliente/USER_INFORMATION/CUSTOMER_LAST_NAMES/text()))</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="productType">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73e8</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$body/aper:creaCuentaCliente/USER_INFORMATION/PRODUCT_TYPE_ID/text()</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="productNumber">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73e7</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$body/aper:creaCuentaCliente/USER_INFORMATION/PRODUCT_NUMBER/text()</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="phone">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73e6</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$body/aper:creaCuentaCliente/USER_INFORMATION/PHONE/text()</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="email">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73e5</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$body/aper:creaCuentaCliente/USER_INFORMATION/EMAIL/text()</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
              </con2:actions>
            </con2:case>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$body/aper:creaCuentaCliente/CREATE_USER_ID/text()='YES'
and $body/aper:creaCuentaCliente/CREATE_ACCOUNT/text()='NO'and
$existCustomer='YES'</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:assign varName="DocumentType">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73e4</con1:id>
                  <con2:expr>
                    <con1:xqueryText>"CEDULA"</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="DocumentNumber">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73e3</con1:id>
                  <con2:expr>
                    <con1:xqueryText>replace($body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/LEGAL_ID/text(),'-','')</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="names">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73e2</con1:id>
                  <con2:expr>
                    <con1:xqueryText>upper-case(normalize-space(concat($body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/FIRST_NAME/text()," ",$body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/SECOND_NAME/text())))</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="lastname">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73e1</con1:id>
                  <con2:expr>
                    <con1:xqueryText>upper-case(normalize-space(concat($body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/FIRST_LASTNAME/text()," ",$body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/SECOND_LASTNAME/text())))</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="productType">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73e0</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$body/aper:creaCuentaCliente/USER_INFORMATION/PRODUCT_TYPE_ID/text()</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="productNumber">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73df</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$body/aper:creaCuentaCliente/USER_INFORMATION/PRODUCT_NUMBER/text()</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="phone">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73de</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/PHONE_INFO/PHONE_NUMBER_ITEM[1]/PHONE_NUMBER/text()</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="email">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73dd</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/EMAIL_ADDRESS_INFO/EMAIL_ITEM[1]/EMAIL/text()</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
              </con2:actions>
            </con2:case>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$body/aper:creaCuentaCliente/CREATE_USER_ID/text()='YES'
and $body/aper:creaCuentaCliente/CREATE_ACCOUNT/text()='YES'and
$existCustomer='NO'</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:assign varName="DocumentType">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73dc</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$body/aper:creaCuentaCliente/USER_INFORMATION/DOCUMENT_TYPE_ID/text()</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="DocumentNumber">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73db</con1:id>
                  <con2:expr>
                    <con1:xqueryText>replace($body/aper:creaCuentaCliente/USER_INFORMATION/DOCUMENT_NUMBER/text(),'-','')</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="names">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73da</con1:id>
                  <con2:expr>
                    <con1:xqueryText>upper-case(normalize-space(($body/aper:creaCuentaCliente/USER_INFORMATION/CUSTOMER_NAMES/text())))</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="lastname">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73d9</con1:id>
                  <con2:expr>
                    <con1:xqueryText>upper-case(normalize-space($body/aper:creaCuentaCliente/USER_INFORMATION/CUSTOMER_LAST_NAMES/text()))</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="productType">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73d8</con1:id>
                  <con2:expr>
                    <con1:xqueryText>if(count($body/aper:creaCuentaCliente/USER_INFORMATION/PRODUCT_TYPE_ID/text())=0) then(
"AHO") 
else(
$body/aper:creaCuentaCliente/USER_INFORMATION/PRODUCT_TYPE_ID/text())</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="productNumber">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73d7</con1:id>
                  <con2:expr>
                    <con1:xqueryText>if(count($body/aper:creaCuentaCliente/USER_INFORMATION/PRODUCT_NUMBER/text())=0) then(
$accountNumber) 
else(
$body/aper:creaCuentaCliente/USER_INFORMATION/PRODUCT_NUMBER/text())</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="phone">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73d6</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$body/aper:creaCuentaCliente/USER_INFORMATION/PHONE/text()</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="email">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73d5</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$body/aper:creaCuentaCliente/USER_INFORMATION/EMAIL/text()</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
              </con2:actions>
            </con2:case>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$body/aper:creaCuentaCliente/CREATE_USER_ID/text()='YES'
and $body/aper:creaCuentaCliente/CREATE_ACCOUNT/text()='YES'and
$existCustomer='YES'</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:assign varName="DocumentType">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73d4</con1:id>
                  <con2:expr>
                    <con1:xqueryText>"CEDULA"</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="DocumentNumber">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73d3</con1:id>
                  <con2:expr>
                    <con1:xqueryText>replace($body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/LEGAL_ID/text(),'-','')</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="names">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73d2</con1:id>
                  <con2:expr>
                    <con1:xqueryText>upper-case(normalize-space(concat($body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/FIRST_NAME/text()," ",$body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/SECOND_NAME/text())))</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="lastname">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73d1</con1:id>
                  <con2:expr>
                    <con1:xqueryText>upper-case(normalize-space(concat($body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/FIRST_LASTNAME/text()," ",$body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/SECOND_LASTNAME/text())))</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="productType">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73d0</con1:id>
                  <con2:expr>
                    <con1:xqueryText>"AHO"</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="productNumber">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73cf</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$accountNumber</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="phone">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73ce</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/PHONE_INFO/PHONE_NUMBER_ITEM[1]/PHONE_NUMBER/text()</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="email">
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73cd</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/EMAIL_ADDRESS_INFO/EMAIL_ITEM[1]/EMAIL/text()</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con1:skip>
                <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73cc</con1:id>
              </con1:skip>
            </con2:default>
          </con2:ifThenElse>
          <con2:ifThenElse>
            <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73c4</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$body/aper:creaCuentaCliente/CREATE_USER_ID/text()='YES' and $productNumber!='' and $DocumentNumber !=''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73be</con1:id>
                  <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/CreaUsuarioSistema" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>creaUsuarioSistema</con2:operation>
                  <con2:request>
                    <con2:body>$REQCreaUsuarioSistema</con2:body>
                    <con2:header>$REQHeaderCreaUsuarioSistema</con2:header>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPCreaUsuarioSistema</con2:body>
                    <con2:header>RSPHeaderCreaUsuarioSistema</con2:header>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQHeaderCreaUsuarioSistema">
                      <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73c3</con1:id>
                      <con2:expr>
                        <con1:xqueryText>$header</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="REQCreaUsuarioSistema">
                      <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73c2</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/creaUsuarioSistemaIN"/>
                          <con1:param name="phone">
                            <con1:path>$phone</con1:path>
                          </con1:param>
                          <con1:param name="DocumentType">
                            <con1:path>$DocumentType</con1:path>
                          </con1:param>
                          <con1:param name="username">
                            <con1:path>$body/aper:creaCuentaCliente/USER_INFORMATION/USER_NAME/text()</con1:path>
                          </con1:param>
                          <con1:param name="lastname">
                            <con1:path>$lastname</con1:path>
                          </con1:param>
                          <con1:param name="ProductType">
                            <con1:path>$productType</con1:path>
                          </con1:param>
                          <con1:param name="ProductNumber">
                            <con1:path>$productNumber</con1:path>
                          </con1:param>
                          <con1:param name="names">
                            <con1:path>$names</con1:path>
                          </con1:param>
                          <con1:param name="email">
                            <con1:path>$email</con1:path>
                          </con1:param>
                          <con1:param name="DocumentNumber">
                            <con1:path>$DocumentNumber</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:assign varName="errorCodeUser">
                      <con1:id>_ActionId-7720093635378269189--580bd00.1756574a357.-6edb</con1:id>
                      <con2:expr>
                        <con1:xqueryText>$RSPHeaderCreaUsuarioSistema/aut:ResponseHeader/successIndicator/text()</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="ErrorIdUser">
                      <con1:id>_ActionId-7720093635378269189--580bd00.1756574a357.-6ed9</con1:id>
                      <con2:expr>
                        <con1:xqueryText>if(upper-case($errorCodeUser) = 'SUCCESS') then(
	'0'
)
else(
	fn:string($RSPHeaderCreaUsuarioSistema/aut:ResponseHeader/messageId/text())
)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="userName">
                      <con1:id>_ActionId-7720093635378269189--580bd00.1756574a357.-6edf</con1:id>
                      <con2:expr>
                        <con1:xqueryText>if(upper-case($errorCodeUser) != 'SUCCESS') then(
	''
)
else(
	fn:string($RSPCreaUsuarioSistema/USER_NAME/text())
)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="validationMessageUser">
                      <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-73c0</con1:id>
                      <con2:expr>
                        <con1:xqueryText>if(upper-case($errorCodeUser) = 'SUCCESS') then(
	''
)
else(
	fn:string($RSPHeaderCreaUsuarioSistema/aut:ResponseHeader/messages/text())
)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:assign varName="errorCodeUser">
                <con1:id>_ActionId-1528841706836344--72fe22ba.175230275d2.-7eb2</con1:id>
                <con2:expr>
                  <con1:xqueryText>'ERROR'</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="ErrorIdUser">
                <con1:id>_ActionId-7720093635378269189--580bd00.1756574a357.-6f35</con1:id>
                <con2:expr>
                  <con1:xqueryText>'-1'</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="validationMessageUser">
                <con1:id>_ActionId-1528841706836344--72fe22ba.175230275d2.-7f06</con1:id>
                <con2:expr>
                  <con1:xqueryText>'No se ingresaron campos obligatorios: PRODUCT_NUMBER o DOCUMENT_NUMBER'</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="AsignacionTD">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes" prefix="aper"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-4503775387572106694-5cc3ee37.1722f767a60.-699b</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$errorCodeAccount = 'Success'</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:ifThenElse>
                  <con1:id>_ActionId-4503775387572106694-5cc3ee37.1722f767a60.-698f</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$body/aper:creaCuentaCliente/CREATE_ACCOUNT/text() ='YES'
and $body/aper:creaCuentaCliente/CARD_INFORMATION/TYPE/text() != ''</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:wsCallout>
                        <con1:id>_ActionId-4503775387572106694-5cc3ee37.1722f767a60.-6988</con1:id>
                        <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/SolicitaTDCliente" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>solicitaTDCliente</con2:operation>
                        <con2:request>
                          <con2:body>$REQAsignaTDRelieve</con2:body>
                          <con2:header>$REQAsignaTDReleiveHeader</con2:header>
                        </con2:request>
                        <con2:response>
                          <con2:body>RSPAsignaTDReleive</con2:body>
                          <con2:header>RSPAsignaTDReleiveHeader</con2:header>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="cardNumber">
                            <con1:id>_ActionId-4503775387572106694-5cc3ee37.1722f767a60.-698e</con1:id>
                            <con2:expr>
                              <con1:xqueryText>if($body/aper:creaCuentaCliente/CARD_INFORMATION/CARD_NUMBER/text() != '')then(
	$body/aper:creaCuentaCliente/CARD_INFORMATION/CARD_NUMBER/text()
)else(
	''
)</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="REQAsignaTDReleiveHeader">
                            <con1:id>_ActionId-4503775387572106694-5cc3ee37.1722f767a60.-698d</con1:id>
                            <con2:expr>
                              <con1:xqueryText>$header</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="REQAsignaTDRelieve">
                            <con1:id>_ActionId-4503775387572106694-5cc3ee37.1722f767a60.-698c</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/asignaTDIN"/>
                                <con1:param name="TypeCard">
                                  <con1:path>$body/aper:creaCuentaCliente/CARD_INFORMATION/TYPE/text()</con1:path>
                                </con1:param>
                                <con1:param name="Account">
                                  <con1:path>$RSPCreaCuentaCliente/ACCOUNT_INFORMATION/ACCOUNT_NUMBER/text()</con1:path>
                                </con1:param>
                                <con1:param name="CardNumber">
                                  <con1:path>$cardNumber</con1:path>
                                </con1:param>
                                <con1:param name="CostumerCode">
                                  <con1:path>if ($Customer="") then(
$body/aper:creaCuentaCliente/ACCOUNT_INFORMATION/CUSTOMER_ID/text()
)
else($Customer)</con1:path>
                                </con1:param>
                                <con1:param name="Currency">
                                  <con1:path>$body/aper:creaCuentaCliente/ACCOUNT_INFORMATION/CURRENCY/text()</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform>
                          <con2:assign varName="lastCardNumber">
                            <con1:id>_ActionId-4503775387572106694-5cc3ee37.1722f767a60.-698b</con1:id>
                            <con2:expr>
                              <con1:xqueryText>$RSPAsignaTDReleive/LAST_CARD_NUMBER/text()</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="ErrorCodeAccount">
                            <con1:id>_ActionId-4503775387572106694-5cc3ee37.1722f767a60.-698a</con1:id>
                            <con2:expr>
                              <con1:xqueryText>$RSPAsignaTDReleiveHeader/aut:ResponseHeader/successIndicator/text()</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="ErrorIdCard">
                            <con1:id>_ActionId-7720093635378269189--580bd00.1756574a357.-6ec2</con1:id>
                            <con2:expr>
                              <con1:xqueryText>if($errorCodeAccount = 'Success') then(
	'0'
)
else(
	$RSPAsignaTDReleiveHeader/aut:ResponseHeader/messageId/text()
)</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="ValidationMessageAccount">
                            <con1:id>_ActionId-4503775387572106694-5cc3ee37.1722f767a60.-6989</con1:id>
                            <con2:expr>
                              <con1:xqueryText>if($errorCodeAccount = 'Success') then(
	''
)
else(
	$RSPAsignaTDReleiveHeader/aut:ResponseHeader/messages/text()
)</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                        </con2:responseTransform>
                      </con2:wsCallout>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con2:assign varName="ValidationMessageAccount">
                      <con1:id>_ActionId-4503775387572106694-5cc3ee37.1722f767a60.-6986</con1:id>
                      <con2:expr>
                        <con1:xqueryText>''</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="ErrorCodeAccount">
                      <con1:id>_ActionId-4503775387572106694-5cc3ee37.1722f767a60.-6985</con1:id>
                      <con2:expr>
                        <con1:xqueryText>''</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:default>
                </con2:ifThenElse>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con1:skip>
                <con1:id>_ActionId-4503775387572106694-5cc3ee37.1722f767a60.-6983</con1:id>
              </con1:skip>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="OrdenEmpaqueTD">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes" prefix="aper"/>
        </con:context>
        <con:actions>
          <con2:assign varName="validationMessageCard">
            <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-7386</con1:id>
            <con2:expr>
              <con1:xqueryText>""</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="referenceNumber">
            <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-7384</con1:id>
            <con2:expr>
              <con1:xqueryText>''</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="errorCodeCard">
            <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-7382</con1:id>
            <con2:expr>
              <con1:xqueryText>''</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:ifThenElse>
            <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-7377</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>($ValidationMessageAccount = '' 
and $body/aper:creaCuentaCliente/CREATE_DEBIT_CARD/text()='YES' 
and $body/aper:creaCuentaCliente/CREATE_ACCOUNT/text() ='YES')
or ($ValidationMessageAccount = '' and $validationMessageCustomer = ''
and $body/aper:creaCuentaCliente/CREATE_DEBIT_CARD/text()='YES' 
and $body/aper:creaCuentaCliente/CREATE_ACCOUNT/text() ='YES'
and $existCustomer='YES')</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-7371</con1:id>
                  <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/OrdenEmpaqueTD" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>ordenEmpaqueTD</con2:operation>
                  <con2:request>
                    <con2:body>$REQOrdenEmpaqueTD</con2:body>
                    <con2:header>$REQHeaderOrdenEmpaqueTD</con2:header>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPOrdenEmpaqueTD</con2:body>
                    <con2:header>RSPHeaderOrdenEmpaqueTD</con2:header>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQHeaderOrdenEmpaqueTD">
                      <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-7376</con1:id>
                      <con2:expr>
                        <con1:xqueryText>$header</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:ifThenElse>
                      <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-6e09</con1:id>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$existCustomer='YES'</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:assign varName="TypeAddress">
                            <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-6d82</con1:id>
                            <con2:expr>
                              <con1:xqueryText>$body/aper:creaCuentaCliente/PACKAGING_INFORMATION/DELIVERY_ADDRESS_INFO/ADDRESS_ITEM[1]/ADDRESS_TYPE/text()</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="DireccionEnvio">
                            <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-6e07</con1:id>
                            <con2:expr>
                              <con1:xqueryText>fn:concat($RSPCreaClienteSimplificado/ADDRESS_INFO/ADDRESS_ITEM[ADDRESS_TYPE=$TypeAddress]/ADDRESS_LINE_1/text(), 
$RSPCreaClienteSimplificado/ADDRESS_INFO/ADDRESS_ITEM[ADDRESS_TYPE=$TypeAddress]/ADDRESS_LINE_2/text())</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:replace varName="body" contents-only="true">
                            <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-6dd7</con1:id>
                            <con2:location>
                              <con1:xpathText>./aper:creaCuentaCliente/PACKAGING_INFORMATION/DELIVERY_ADDRESS_INFO/ADDRESS_ITEM[1]/ADDRESS_LINE</con1:xpathText>
                            </con2:location>
                            <con2:expr>
                              <con1:xqueryText>$DireccionEnvio</con1:xqueryText>
                            </con2:expr>
                          </con2:replace>
                        </con2:actions>
                      </con2:case>
                      <con2:default/>
                    </con2:ifThenElse>
                    <con2:assign varName="REQOrdenEmpaqueTD">
                      <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-7375</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/ordenEmpaqueTDIN"/>
                          <con1:param name="costumerId">
                            <con1:path>if ($Customer="") then(
$body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/CUSTOMER_ID/text()
)
else($Customer)</con1:path>
                          </con1:param>
                          <con1:param name="accountNumber">
                            <con1:path>$accountNumber</con1:path>
                          </con1:param>
                          <con1:param name="creaCuentaCliente">
                            <con1:path>$body/aper:creaCuentaCliente</con1:path>
                          </con1:param>
                          <con1:param name="branchCode">
                            <con1:path>$branchCode</con1:path>
                          </con1:param>
                          <con1:param name="productType">
                            <con1:path>$productTypeTD</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:assign varName="errorCodeCard">
                      <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-7374</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($RSPHeaderOrdenEmpaqueTD/aut:ResponseHeader/successIndicator/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="validationMessageCard">
                      <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-7373</con1:id>
                      <con2:expr>
                        <con1:xqueryText>if($errorCodeCard = 'Success') then(
	''
)
else(
	string($RSPHeaderOrdenEmpaqueTD/aut:ResponseHeader/messages/text())
)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="referenceNumber">
                      <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-7372</con1:id>
                      <con2:expr>
                        <con1:xqueryText>if($errorCodeCard = 'Success') then(
	$RSPOrdenEmpaqueTD/REFERENCE_NUMBER/text()
)
else(
	''
)</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:assign varName="validationMessageCard">
                <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-7370</con1:id>
                <con2:expr>
                  <con1:xqueryText>""</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="errorCodeCard">
                <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-736f</con1:id>
                <con2:expr>
                  <con1:xqueryText>""</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="referenceNumber">
                <con1:id>_ActionId-7193741021269798991--22f0615e.173b7295e69.-736e</con1:id>
                <con2:expr>
                  <con1:xqueryText>''</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="SincronizacionProductos">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes" prefix="aper"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-6166</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$body/aper:creaCuentaCliente/CREATE_ACCOUNT/text() ='YES' and $validationMessageAccount = '' and
$existCustomer='NO'</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:ifThenElse>
                  <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-6138</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>count($body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/LEGAL_ID/text())=0</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:wsCallout>
                        <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-6121</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v3/BusinessServices/ConsultasCliente/biz/sjConsultaClienteResiliencia" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>Consultadecliente</con2:operation>
                        <con2:request>
                          <con2:body>$REQConsultaCliente</con2:body>
                        </con2:request>
                        <con2:response>
                          <con2:body>RSPConsultaCliente</con2:body>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQConsultaCliente">
                            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-60ef</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/ConsultaClienteIn"/>
                                <con1:param name="requestHeader">
                                  <con1:path>$header/aut:RequestHeader</con1:path>
                                </con1:param>
                                <con1:param name="CustomerIdValue">
                                  <con1:path>$body/aper:creaCuentaCliente/ACCOUNT_INFORMATION/CUSTOMER_ID/text()</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform>
                          <con2:assign varName="legalID">
                            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-60dd</con1:id>
                            <con2:expr>
                              <con1:xqueryText>$RSPConsultaCliente/WSCUSTOMERType/gWSCUSTOMERDetailType/mWSCUSTOMERDetailType/LEGALID/text()</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                        </con2:responseTransform>
                      </con2:wsCallout>
                      <con2:wsCallout>
                        <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-6107</con1:id>
                        <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/ActualizaProductosCliente" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>actualizaProductosCliente</con2:operation>
                        <con2:request>
                          <con2:body>$REQActualizaProducto</con2:body>
                          <con2:header>$REQHeaderActualizaProducto</con2:header>
                        </con2:request>
                        <con2:response>
                          <con2:body>RSPActualizaProducto</con2:body>
                          <con2:header>RSPHeaderActualizaProducto</con2:header>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQHeaderActualizaProducto">
                            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-60c6</con1:id>
                            <con2:expr>
                              <con1:xqueryText>$header</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="REQActualizaProducto">
                            <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-60a1</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/actualizaProductoIN"/>
                                <con1:param name="Type">
                                  <con1:path>"LEGAL_ID"</con1:path>
                                </con1:param>
                                <con1:param name="DocumentNumber">
                                  <con1:path>$legalID</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform/>
                      </con2:wsCallout>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con2:wsCallout>
                      <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-5ffc</con1:id>
                      <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/ActualizaProductosCliente" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                      <con2:operation>actualizaProductosCliente</con2:operation>
                      <con2:request>
                        <con2:body>$REQActualizaProducto</con2:body>
                        <con2:header>$REQHeaderActualizaProducto</con2:header>
                      </con2:request>
                      <con2:response>
                        <con2:body>RSPActualizaProducto</con2:body>
                        <con2:header>RSPHeaderActualizaProducto</con2:header>
                      </con2:response>
                      <con2:requestTransform>
                        <con2:assign varName="REQHeaderActualizaProducto">
                          <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-5ffe</con1:id>
                          <con2:expr>
                            <con1:xqueryText>$header</con1:xqueryText>
                          </con2:expr>
                        </con2:assign>
                        <con2:assign varName="REQActualizaProducto">
                          <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-5ffd</con1:id>
                          <con2:expr>
                            <con1:xqueryTransform>
                              <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/actualizaProductoIN"/>
                              <con1:param name="Type">
                                <con1:path>"LEGAL_ID"</con1:path>
                              </con1:param>
                              <con1:param name="DocumentNumber">
                                <con1:path>$body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/LEGAL_ID/text()</con1:path>
                              </con1:param>
                            </con1:xqueryTransform>
                          </con2:expr>
                        </con2:assign>
                      </con2:requestTransform>
                      <con2:responseTransform/>
                    </con2:wsCallout>
                  </con2:default>
                </con2:ifThenElse>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con1:skip>
                <con1:id>_ActionId-9036808973115216780-4be72e0a.172815789fb.-6150</con1:id>
              </con1:skip>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="CreaCuentaClienteHN_response">
      <con:stage name="FlujodeSalida">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes" prefix="aper"/>
        </con:context>
        <con:actions>
          <con2:replace contents-only="true" varName="header" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config">
            <con1:id>_ActionId-6006567406046527689--56430da8.1717947a2b8.-7d9c</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/creaCuentaClienteHeaderOut"/>
                <con1:param name="validationMessage">
                  <con1:path>$validationMessage</con1:path>
                </con1:param>
                <con1:param name="errorCode">
                  <con1:path>$errorCode</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:replace>
          <con2:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config">
            <con1:id>_ActionId-6006567406046527689--56430da8.1717947a2b8.-7de9</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage = "" and  fn:upper-case($errorCode) = "SUCCESS"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace varName="body" contents-only="true">
                  <con1:id>_ActionId-6006567406046527689--56430da8.1717947a2b8.-7de8</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/creaCuentaClienteOut"/>
                      <con1:param name="referenceNumber">
                        <con1:path>$referenceNumber</con1:path>
                      </con1:param>
                      <con1:param name="userID">
                        <con1:path>$userName</con1:path>
                      </con1:param>
                      <con1:param name="errorCodeCustomer">
                        <con1:path>$errorCodeCustomer</con1:path>
                      </con1:param>
                      <con1:param name="accountNumber">
                        <con1:path>$accountNumber</con1:path>
                      </con1:param>
                      <con1:param name="validationMessageAccount">
                        <con1:path>$validationMessageAccount</con1:path>
                      </con1:param>
                      <con1:param name="validationMessageCard">
                        <con1:path>$validationMessageCard</con1:path>
                      </con1:param>
                      <con1:param name="errorCodeUser">
                        <con1:path>$errorCodeUser</con1:path>
                      </con1:param>
                      <con1:param name="validationMessageUser">
                        <con1:path>$validationMessageUser</con1:path>
                      </con1:param>
                      <con1:param name="errorCodeCard">
                        <con1:path>$errorCodeCard</con1:path>
                      </con1:param>
                      <con1:param name="errorCodeAccount">
                        <con1:path>$errorCodeAccount</con1:path>
                      </con1:param>
                      <con1:param name="customerID">
                        <con1:path>$Customer</con1:path>
                      </con1:param>
                      <con1:param name="validationMessageCustomer">
                        <con1:path>$validationMessageCustomer</con1:path>
                      </con1:param>
                      <con1:param name="errorIDCard">
                        <con1:path>$ErrorIdCard</con1:path>
                      </con1:param>
                      <con1:param name="errorIDUser">
                        <con1:path>$ErrorIdUser</con1:path>
                      </con1:param>
                      <con1:param name="errorIDAccount">
                        <con1:path>$ErrorIdAccount</con1:path>
                      </con1:param>
                      <con1:param name="errorIDCustomer">
                        <con1:path>$ErrorIdCustomer</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:replace varName="body" contents-only="true">
                <con1:id>_ActionId-6006567406046527689--56430da8.1717947a2b8.-7d48</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;aper:creaCuentaClienteResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="BitacoraResponse">
        <con:context xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/services/security/config">
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/services/security/config">
          <con2:assign varName="uuidBitacoraResponse">
            <con1:id>_ActionId-4938955964506616316--3b1d2a5a.171dcd3bba5.-68f9</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con3:route>
            <con1:id>_ActionId-4938955964506616316--3b1d2a5a.171dcd3bba5.-68f6</con1:id>
            <con3:service ref="Middleware/v2/BusinessServices/OSB/RegistrarBitacoraOSB_v2/biz/RegistrarBitacoraOSB_v2" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con3:operation>registrarBitacoraOSB</con3:operation>
            <con3:outboundTransform>
              <con3:replace contents-only="true" varName="body" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con5="http://www.bea.com/wli/sb/stages/logging/config" xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config">
                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-4938955964506616316--3b1d2a5a.171dcd3bba5.-68f5</con6:id>
                <con3:location>
                  <con5:xpathText xmlns:con5="http://www.bea.com/wli/sb/stages/config">.</con5:xpathText>
                </con3:location>
                <con3:expr>
                  <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                    <con6:resource ref="Middleware/v2/Resources/Generales/xq/registrarBitacoraOSBIn"/>
                    <con6:param name="UuidReq">
                      <con6:path>""</con6:path>
                    </con6:param>
                    <con6:param name="IdOsb">
                      <con6:path>fn:string($inbound/ctx:transport/ctx:request/tp:headers/tp:user-header[@name='Host']/@value)</con6:path>
                    </con6:param>
                    <con6:param name="BancoDestino">
                      <con6:path>string($originalHeader/aut:RequestHeader/Region/DestinationBank/text())</con6:path>
                    </con6:param>
                    <con6:param name="Uuid">
                      <con6:path>$uuidBitacoraResponse</con6:path>
                    </con6:param>
                    <con6:param name="Contenido">
                      <con6:path>$body</con6:path>
                    </con6:param>
                    <con6:param name="BancoOrigen">
                      <con6:path>string($originalHeader/aut:RequestHeader/Region/SourceBank/text())</con6:path>
                    </con6:param>
                    <con6:param name="Usuario">
                      <con6:path>string($originalHeader/aut:RequestHeader/Authentication/UserName/text())</con6:path>
                    </con6:param>
                    <con6:param name="IdOperacion">
                      <con6:path>fn:string($operation)</con6:path>
                    </con6:param>
                    <con6:param name="Resultado">
                      <con6:path>$errorCode</con6:path>
                    </con6:param>
                    <con6:param name="IdServicio">
                      <con6:path>"FICBCO0403"</con6:path>
                    </con6:param>
                    <con6:param name="IdTxn">
                      <con6:path>""</con6:path>
                    </con6:param>
                    <con6:param name="TipoMensaje">
                      <con6:path>"RSP"</con6:path>
                    </con6:param>
                    <con6:param name="FechaTxn">
                      <con6:path>current-dateTime()</con6:path>
                    </con6:param>
                    <con6:param name="MensajeError">
                      <con6:path>$validationMessage</con6:path>
                    </con6:param>
                  </con6:xqueryTransform>
                </con3:expr>
              </con3:replace>
            </con3:outboundTransform>
          </con3:route>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="Default_CreaCuentaCliente_request">
      <con:stage name="FlujoEntrada">
        <con:context/>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="Default_CreaCuentaCliente_response">
      <con:stage name="FlujoSalida">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:Error>
            <con1:id>_ActionId-4034291471934029355-5f5ca871.171420fe941.-7073</con1:id>
            <con2:errCode>MW-0008</con2:errCode>
            <con2:message>SERVICE NOT IMPLEMENTED YET FOR THIS COUNTRY/COMPANY</con2:message>
          </con2:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="CreaCuentaClienteNI_request">
      <con:stage name="ObtenerParemtrizacion">
        <con:context>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con4:assign varName="ValidationMessage" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
            <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-3963695453942570549--49814890.17aef1cf898.-7e91</con5:id>
            <con3:expr>
              <con2:xqueryText xmlns:con5="http://www.bea.com/wli/sb/stages/config">''</con2:xqueryText>
            </con3:expr>
          </con4:assign>
          <con4:assign varName="ErrorCode" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
            <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-3963695453942570549--49814890.17aef1cf898.-7e90</con5:id>
            <con3:expr>
              <con2:xqueryText xmlns:con5="http://www.bea.com/wli/sb/stages/config">'Success'</con2:xqueryText>
            </con3:expr>
          </con4:assign>
          <con4:wsCallout xmlns:con3="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
            <con3:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7f02</con3:id>
            <con4:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con4:operation>obtenerParametrizacion</con4:operation>
            <con4:request>
              <con4:body>$REQObtenerParametrizacion</con4:body>
            </con4:request>
            <con4:response>
              <con4:body>RSPObtenerParametrizacion</con4:body>
            </con4:response>
            <con4:requestTransform>
              <con4:assign varName="Channel">
                <con3:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7f0b</con3:id>
                <con4:expr>
                  <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">concat('FICBCO0403.CHANNEL.',fn:upper-case($header/aut:RequestHeader/Authentication/UserName/text()))</con4:xqueryText>
                </con4:expr>
              </con4:assign>
              <con4:assign varName="TransactionType">
                <con3:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7f0a</con3:id>
                <con4:expr>
                  <con3:xqueryText>'FICBCO0403.TRX.OPENING.ACCOUNT'</con3:xqueryText>
                </con4:expr>
              </con4:assign>
              <con4:assign varName="REQObtenerParametrizacion">
                <con3:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7f09</con3:id>
                <con4:expr>
                  <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                    <con4:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                    <con4:param name="nombreParametros">
                      <con4:path>fn:concat($TrxFiscan,"||",$StatusResponse,"||",$Channel,"||",$TransactionType,"||",$FiscanTrxSeq,"||",$CobisRiskTrx,"||",$CurrencyCode)</con4:path>
                    </con4:param>
                  </con4:xqueryTransform>
                </con4:expr>
              </con4:assign>
            </con4:requestTransform>
            <con4:responseTransform>
              <con4:ifThenElse>
                <con3:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7f08</con3:id>
                <con4:case>
                  <con4:condition>
                    <con3:xqueryText>count($RSPObtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$TransactionType]/osb:VALUE/text())>0</con3:xqueryText>
                  </con4:condition>
                  <con4:actions>
                    <con4:assign varName="TransactionTypeValue">
                      <con3:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7f07</con3:id>
                      <con4:expr>
                        <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">string($RSPObtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$TransactionType]/osb:VALUE/text())</con4:xqueryText>
                      </con4:expr>
                    </con4:assign>
                  </con4:actions>
                </con4:case>
                <con4:default>
                  <con4:assign varName="TransactionTypeValue">
                    <con3:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7f06</con3:id>
                    <con4:expr>
                      <con3:xqueryText>''</con3:xqueryText>
                    </con4:expr>
                  </con4:assign>
                </con4:default>
              </con4:ifThenElse>
              <con4:ifThenElse>
                <con3:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7f05</con3:id>
                <con4:case>
                  <con4:condition>
                    <con3:xqueryText>count($RSPObtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$Channel]/osb:VALUE/text())>0</con3:xqueryText>
                  </con4:condition>
                  <con4:actions>
                    <con4:assign varName="ChannelValue">
                      <con3:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7f04</con3:id>
                      <con4:expr>
                        <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">string($RSPObtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$Channel]/osb:VALUE/text())</con4:xqueryText>
                      </con4:expr>
                    </con4:assign>
                  </con4:actions>
                </con4:case>
                <con4:default>
                  <con4:assign varName="ChannelValue">
                    <con3:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7f03</con3:id>
                    <con4:expr>
                      <con3:xqueryText>''</con3:xqueryText>
                    </con4:expr>
                  </con4:assign>
                </con4:default>
              </con4:ifThenElse>
            </con4:responseTransform>
          </con4:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="CreacionCuenta">
        <con:context>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/OSB_Apertura_Cuenta" prefix="con"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes" prefix="aper"/>
        </con:context>
        <con:actions>
          <con2:wsCallout>
            <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7e6a</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/Cobis/AperturaCuenta/biz/OSB_Apertura_Cuenta_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>OSB_Apertura_Cuenta</con2:operation>
            <con2:request>
              <con2:body>$REQAperturaCuenta</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>RSPAperturaCuenta</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="REQAperturaCuenta">
                <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7e56</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/AperturaCuentaNIIN"/>
                    <con1:param name="creaCuentaClienteIN">
                      <con1:path>$body/aper:creaCuentaCliente</con1:path>
                    </con1:param>
                    <con1:param name="Date">
                      <con1:path>fn-bea:date-to-string-with-format("yyyy-MM-dd",fn:current-date())</con1:path>
                    </con1:param>
                    <con1:param name="requestHeaderIN">
                      <con1:path>$header/aut:RequestHeader</con1:path>
                    </con1:param>
                    <con1:param name="CodeTransaction">
                      <con1:path>$TransactionTypeValue</con1:path>
                    </con1:param>
                    <con1:param name="Channel">
                      <con1:path>$ChannelValue</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con3:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config">
                <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7dde</con1:id>
                <con2:case>
                  <con2:condition>
                    <con1:xqueryText>$RSPAperturaCuenta/con:o_desc_error/text()!='SUCCESS'</con1:xqueryText>
                  </con2:condition>
                  <con2:actions>
                    <con2:assign varName="ErrorCode">
                      <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7ddd</con1:id>
                      <con2:expr>
                        <con1:xqueryText>'ERROR'</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="ValidationMessage">
                      <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7ddc</con1:id>
                      <con2:expr>
                        <con1:xqueryText>$RSPAperturaCuenta/con:o_desc_error/text()</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:actions>
                </con2:case>
                <con2:default>
                  <con2:assign varName="ErrorCode">
                    <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7ddb</con1:id>
                    <con2:expr>
                      <con1:xqueryText>'Success'</con1:xqueryText>
                    </con2:expr>
                  </con2:assign>
                  <con2:assign varName="ValidationMessage">
                    <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7dda</con1:id>
                    <con2:expr>
                      <con1:xqueryText>''</con1:xqueryText>
                    </con2:expr>
                  </con2:assign>
                </con2:default>
              </con3:ifThenElse>
            </con2:responseTransform>
          </con2:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="SincronizacionProductos">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes" prefix="aper"/>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/OSB_Apertura_Cuenta" prefix="con"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7bb8</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$body/aper:creaCuentaCliente/CREATE_ACCOUNT/text() ='YES' and $ValidationMessage = ''</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:ifThenElse>
                  <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7bb7</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>count($body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/LEGAL_ID/text())=0</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:assign varName="LegalID">
                        <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7b61</con1:id>
                        <con2:expr>
                          <con1:xqueryText>data($RSPAperturaCuenta/con:RowSet[3]/con:Row[1]/con:Column[@name='#_Documento'])</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con2:wsCallout>
                        <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7bb1</con1:id>
                        <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/ActualizaProductosCliente" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>actualizaProductosCliente</con2:operation>
                        <con2:request>
                          <con2:body>$REQActualizaProducto</con2:body>
                          <con2:header>$REQHeaderActualizaProducto</con2:header>
                        </con2:request>
                        <con2:response>
                          <con2:body>RSPActualizaProducto</con2:body>
                          <con2:header>RSPHeaderActualizaProducto</con2:header>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQHeaderActualizaProducto">
                            <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7bb3</con1:id>
                            <con2:expr>
                              <con1:xqueryText>$header</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="REQActualizaProducto">
                            <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7bb2</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/actualizaProductoIN"/>
                                <con1:param name="Type">
                                  <con1:path>"LEGAL_ID"</con1:path>
                                </con1:param>
                                <con1:param name="DocumentNumber">
                                  <con1:path>$LegalID</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform/>
                      </con2:wsCallout>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con2:wsCallout>
                      <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7bae</con1:id>
                      <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/ActualizaProductosCliente" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                      <con2:operation>actualizaProductosCliente</con2:operation>
                      <con2:request>
                        <con2:body>$REQActualizaProducto</con2:body>
                        <con2:header>$REQHeaderActualizaProducto</con2:header>
                      </con2:request>
                      <con2:response>
                        <con2:body>RSPActualizaProducto</con2:body>
                        <con2:header>RSPHeaderActualizaProducto</con2:header>
                      </con2:response>
                      <con2:requestTransform>
                        <con2:assign varName="REQHeaderActualizaProducto">
                          <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7bb0</con1:id>
                          <con2:expr>
                            <con1:xqueryText>$header</con1:xqueryText>
                          </con2:expr>
                        </con2:assign>
                        <con2:assign varName="REQActualizaProducto">
                          <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7baf</con1:id>
                          <con2:expr>
                            <con1:xqueryTransform>
                              <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/actualizaProductoIN"/>
                              <con1:param name="Type">
                                <con1:path>"LEGAL_ID"</con1:path>
                              </con1:param>
                              <con1:param name="DocumentNumber">
                                <con1:path>$body/aper:creaCuentaCliente/CUSTOMER_INFORMATION/LEGAL_ID/text()</con1:path>
                              </con1:param>
                            </con1:xqueryTransform>
                          </con2:expr>
                        </con2:assign>
                      </con2:requestTransform>
                      <con2:responseTransform/>
                    </con2:wsCallout>
                  </con2:default>
                </con2:ifThenElse>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con1:skip>
                <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7bad</con1:id>
              </con1:skip>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="CreaCuentaClienteNI_response">
      <con:stage name="FlujodeSalida">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/aperturaProductosTypes" prefix="aper"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/actualizaDatosClienteTypes" prefix="act"/>
        </con:context>
        <con:actions>
          <con2:replace contents-only="true" varName="header">
            <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7cb6</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/creaCuentaClienteHeaderNIOut"/>
                <con1:param name="MessageError">
                  <con1:path>$ValidationMessage</con1:path>
                </con1:param>
                <con1:param name="ErrorCode">
                  <con1:path>$ErrorCode</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:replace>
          <con2:ifThenElse>
            <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7cb5</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$ErrorCode ='Success'</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace contents-only="true" varName="body">
                  <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7cb4</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/CreaCuentaCliente/xq/creaCuentaClienteNIOUT"/>
                      <con1:param name="outputParametersIN">
                        <con1:path>$RSPAperturaCuenta</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:replace contents-only="true" varName="body">
                <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7cb3</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;aper:creaCuentaClienteResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="BitacoraResponse">
        <con:context xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/services/security/config">
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con4="http://www.bea.com/wli/sb/services/security/config">
          <con2:assign varName="uuidBitacoraResponse">
            <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7f8e</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con3:route>
            <con1:id>_ActionId-3963695453942570549--49814890.17aef1cf898.-7f8d</con1:id>
            <con3:service ref="Middleware/v2/BusinessServices/OSB/RegistrarBitacoraOSB_v2/biz/RegistrarBitacoraOSB_v2" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con3:operation>registrarBitacoraOSB</con3:operation>
            <con3:outboundTransform>
              <con3:replace contents-only="true" varName="body" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con5="http://www.bea.com/wli/sb/stages/logging/config" xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config">
                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-3963695453942570549--49814890.17aef1cf898.-7f8c</con6:id>
                <con3:location>
                  <con5:xpathText xmlns:con5="http://www.bea.com/wli/sb/stages/config">.</con5:xpathText>
                </con3:location>
                <con3:expr>
                  <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                    <con6:resource ref="Middleware/v2/Resources/Generales/xq/registrarBitacoraOSBIn"/>
                    <con6:param name="UuidReq">
                      <con6:path>""</con6:path>
                    </con6:param>
                    <con6:param name="IdOsb">
                      <con6:path>fn:string($inbound/ctx:transport/ctx:request/tp:headers/tp:user-header[@name='Host']/@value)</con6:path>
                    </con6:param>
                    <con6:param name="BancoDestino">
                      <con6:path>string($originalHeader/aut:RequestHeader/Region/DestinationBank/text())</con6:path>
                    </con6:param>
                    <con6:param name="Uuid">
                      <con6:path>$uuidBitacoraResponse</con6:path>
                    </con6:param>
                    <con6:param name="Contenido">
                      <con6:path>$body</con6:path>
                    </con6:param>
                    <con6:param name="BancoOrigen">
                      <con6:path>string($originalHeader/aut:RequestHeader/Region/SourceBank/text())</con6:path>
                    </con6:param>
                    <con6:param name="Usuario">
                      <con6:path>string($originalHeader/aut:RequestHeader/Authentication/UserName/text())</con6:path>
                    </con6:param>
                    <con6:param name="IdOperacion">
                      <con6:path>fn:string($operation)</con6:path>
                    </con6:param>
                    <con6:param name="Resultado">
                      <con6:path>$errorCode</con6:path>
                    </con6:param>
                    <con6:param name="IdServicio">
                      <con6:path>"FICBCO0403"</con6:path>
                    </con6:param>
                    <con6:param name="IdTxn">
                      <con6:path>""</con6:path>
                    </con6:param>
                    <con6:param name="TipoMensaje">
                      <con6:path>"RSP"</con6:path>
                    </con6:param>
                    <con6:param name="FechaTxn">
                      <con6:path>current-dateTime()</con6:path>
                    </con6:param>
                    <con6:param name="MensajeError">
                      <con6:path>$validationMessage</con6:path>
                    </con6:param>
                  </con6:xqueryTransform>
                </con3:expr>
              </con3:replace>
            </con3:outboundTransform>
          </con3:route>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:flow>
      <con:pipeline-node name="ValidacionesGenerales">
        <con:request>ValidacionesGenerales_request</con:request>
        <con:response>ValidacionesGenerales_response</con:response>
      </con:pipeline-node>
      <con:branch-node type="condition" name="RegionalizacionPaisEmpresa">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:branch-table variable="header">
          <con:xpath>
            <con1:xpathText>./aut:RequestHeader/Region/SourceBank</con1:xpathText>
          </con:xpath>
          <con:branch name="HN01">
            <con:operator>equals</con:operator>
            <con:value>'HN01'</con:value>
            <con:flow>
              <con:pipeline-node name="CreaCuentaClienteHN">
                <con:request>CreaCuentaClienteHN_request</con:request>
                <con:response>CreaCuentaClienteHN_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:branch>
          <con:branch name="NI01">
            <con:operator>equals</con:operator>
            <con:value>'NI01'</con:value>
            <con:flow>
              <con:pipeline-node name="CreaCuentaClienteNI">
                <con:request>CreaCuentaClienteNI_request</con:request>
                <con:response>CreaCuentaClienteNI_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:branch>
          <con:default-branch>
            <con:flow>
              <con:pipeline-node name="Default_CreaCuentaCliente">
                <con:request>Default_CreaCuentaCliente_request</con:request>
                <con:response>Default_CreaCuentaCliente_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:default-branch>
        </con:branch-table>
      </con:branch-node>
    </con:flow>
  </ser:router>
</xml-fragment>