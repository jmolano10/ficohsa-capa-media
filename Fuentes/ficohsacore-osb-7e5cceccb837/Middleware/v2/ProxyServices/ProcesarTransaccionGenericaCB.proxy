<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:con="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config">
  <ser:coreEntry isProxy="true" isEnabled="true" isTracingEnabled="false" isAutoPublish="false">
    <ser:security>
      <con2:custom-token-authentication>
        <con2:username-password>
          <con2:username-selector>
            <con2:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:RequestHeader/Authentication/UserName/text()</con2:xpath>
            <con2:variable>header</con2:variable>
          </con2:username-selector>
          <con2:password-selector>
            <con2:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:RequestHeader/Authentication/Password/text()</con2:xpath>
            <con2:variable>header</con2:variable>
          </con2:password-selector>
        </con2:username-password>
      </con2:custom-token-authentication>
    </ser:security>
    <ser:binding type="SOAP" isSoap12="false" xsi:type="con2:SoapBindingType" xmlns:con2="http://www.bea.com/wli/sb/services/bindings/config">
      <con2:wsdl ref="Middleware/v2/Resources/TransaccionesGenericasCB/ProcesarTransaccionesGenericaCB/wsdl/procesaTransaccionesGenericasPS"/>
      <con2:port>
        <con2:name>procesaTransaccionesGenericasPSSOAP</con2:name>
        <con2:namespace>http://www.ficohsa.com.hn/middleware.services/procesaTransaccionesGenericasPS/</con2:namespace>
      </con2:port>
      <con2:selector type="SOAP body"/>
    </ser:binding>
    <ser:monitoring isEnabled="false">
      <ser:aggregationInterval>10</ser:aggregationInterval>
      <ser:pipelineMonitoringLevel>Pipeline</ser:pipelineMonitoringLevel>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
  </ser:coreEntry>
  <ser:endpointConfig>
    <tran:provider-id>http</tran:provider-id>
    <tran:inbound>true</tran:inbound>
    <tran:URI>
      <env:value>/Middleware/OperationsAndExecution/CustomerDeposits/procesaTransaccionesGenericasCB</env:value>
    </tran:URI>
    <tran:inbound-properties/>
    <tran:all-headers>false</tran:all-headers>
    <tran:provider-specific>
      <http:inbound-properties/>
    </tran:provider-specific>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-3716601621225469488-5c02e0f8.189b763a31b.1f79">
    <con:pipeline type="error" name="_onErrorHandler-3716601621225469488-5c02e0f8.189b763a31b.1f79" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="ErrorTransaccion">
        <con:context>
          <con2:userNsDecl namespace="/Middleware/v2/Resources/ProcesarTransaccionesGenericaCB/xsd/registrarTransaccionesGenericas_sp.xsd" prefix="pro" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con4:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/procesaTransaccionesGenericasType" prefix="proc" xmlns:con4="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con5:assign varName="cterrorCode" xmlns:con3="http://www.bea.com/wli/sb/stages/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config">
            <con3:id>_ActionId-3884641249908687900-38029058.18df6f1612a.-7d16</con3:id>
            <con5:expr>
              <con3:xqueryText>$fault/ctx:errorCode/text()</con3:xqueryText>
            </con5:expr>
          </con5:assign>
          <con5:assign varName="ctreason" xmlns:con3="http://www.bea.com/wli/sb/stages/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config">
            <con3:id>_ActionId-3884641249908687900-38029058.18df6f1612a.-7d0e</con3:id>
            <con5:expr>
              <con3:xqueryText>$fault/ctx:reason/text()</con3:xqueryText>
            </con5:expr>
          </con5:assign>
          <con5:assign varName="ctdetails" xmlns:con3="http://www.bea.com/wli/sb/stages/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config">
            <con3:id>_ActionId-3884641249908687900-38029058.18df6f1612a.-7d08</con3:id>
            <con5:expr>
              <con3:xqueryText>$fault/ctx:details/text()</con3:xqueryText>
            </con5:expr>
          </con5:assign>
          <con4:route xmlns:con3="http://www.bea.com/wli/sb/stages/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config">
            <con3:id>_ActionId-3884641249908687900-38029058.18df6f1612a.-7d20</con3:id>
            <con4:service ref="Middleware/v2/BusinessServices/TransaccionesAsincronas/DB/RegistrarErrorCB/biz/registrarTransaccionError_db" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con4:operation>registrarTransaccionError</con4:operation>
            <con4:outboundTransform>
              <con5:replace varName="body" contents-only="true" xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config">
                <con3:id>_ActionId-3884641249908687900-38029058.18df6f1612a.-7d1f</con3:id>
                <con5:location>
                  <con3:xpathText>.</con3:xpathText>
                </con5:location>
                <con5:expr>
                  <con3:xqueryTransform>
                    <con3:resource ref="Middleware/v2/Resources/ProcesarTransaccionCore/xq/registrarErrorProTRX"/>
                    <con3:param name="msrequest">
                      <con3:path>fn:concat('request OSB: ', fn-bea:serialize($body/proc:procesaTransaccionesGenericasRequest), 'request T24: ', fn-bea:serialize($REQProcesaTransaccionT24))</con3:path>
                    </con3:param>
                    <con3:param name="etapa">
                      <con3:path>0</con3:path>
                    </con3:param>
                    <con3:param name="descripcionError">
                      <con3:path>'ERROR GENERAL AL PROCESAR LA TRANSACCION'</con3:path>
                    </con3:param>
                    <con3:param name="msresponse">
                      <con3:path>fn:concat(fn-bea:serialize($body/proc:procesaTransaccionesGenericasResponse), 'errorCode: ', fn:string($cterrorCode), 'errorReason: ', fn:string($ctreason) , 'errorDetails: ', fn:string($ctdetails))</con3:path>
                    </con3:param>
                    <con3:param name="uuid">
                      <con3:path>$UUID</con3:path>
                    </con3:param>
                  </con3:xqueryTransform>
                </con5:expr>
              </con5:replace>
            </con4:outboundTransform>
          </con4:route>
          <con1:replace varName="header" contents-only="true">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3716601621225469488-5c02e0f8.189b763a31b.22f0</con2:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<aut:ResponseHeader>
	<successIndicator>{ string($fault/ctx:errorCode/text()) }</successIndicator>
	<messages>{ string($fault/ctx:reason/text()) }</messages>
</aut:ResponseHeader>]]></con2:xqueryText>
            </con1:expr>
          </con1:replace>
          <con1:replace varName="body" contents-only="true">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3716601621225469488-5c02e0f8.189b763a31b.2310</con2:id>
            <con1:expr>
              <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">&lt;proc:procesaTransaccionesGenericasResponse/></con4:xqueryText>
            </con1:expr>
          </con1:replace>
          <con2:reply xmlns:con2="http://www.bea.com/wli/sb/stages/config">
            <con2:id>_ActionId-3716601621225469488-5c02e0f8.189b763a31b.2335</con2:id>
          </con2:reply>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="RegistrarTransaccionGenerica_request" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="validacionRequest">
        <con:context>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/procesaTransaccionesGenericasType" prefix="proc" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:validate>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1489851422652012399--735f1a78.18a0a4bf22c.27f7</con2:id>
            <con1:schema ref="Middleware/v2/Resources/TransaccionesGenericasCB/ProcesarTransaccionesGenericaCB/xsd/procesaTransaccionesGenericasType"/>
            <con1:schemaElement xmlns:proc="http://www.ficohsa.com.hn/middleware.services/procesaTransaccionesGenericasType">proc:procesaTransaccionesGenericasRequest</con1:schemaElement>
            <con1:varName>body</con1:varName>
            <con1:location>
              <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">./proc:procesaTransaccionesGenericasRequest</con2:xpathText>
            </con1:location>
          </con1:validate>
        </con:actions>
      </con:stage>
      <con:stage name="ValidacionRegional" xmlns:con2="http://www.bea.com/wli/sb/stages/config">
        <con:context>
          <con2:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/registraClienteSolEmprendedor" prefix="reg"/>
          <con2:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/ValidaServicioRegional" prefix="val"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/serviciosEmpresarialesTypes" prefix="ser"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/procesaTransaccionesGenericasType" prefix="proc"/>
        </con:context>
        <con:actions>
          <con1:wsCallout>
            <con2:id>_ActionId-1489851422652012399--735f1a78.18a0a4bf22c.2493</con2:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ValidaServicioRegional/biz/ValidaServicioRegional_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>ValidaServicioRegional</con1:operation>
            <con1:request>
              <con1:body>$REQValidaRegional</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>RSPValidaRegional</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="REQValidaRegional">
                <con2:id>_ActionId-1489851422652012399--735f1a78.18a0a4bf22c.269e</con2:id>
                <con1:expr>
                  <con2:xqueryTransform>
                    <con2:resource ref="Middleware/v2/Resources/Generales/xq/validaServicioRegionalIn"/>
                    <con2:param name="serviceId">
                      <con2:path>"FICBCO0222"</con2:path>
                    </con2:param>
                    <con2:param name="requestHeader1">
                      <con2:path>$header/aut:RequestHeader</con2:path>
                    </con2:param>
                  </con2:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con1:requestTransform>
            <con1:responseTransform>
              <con1:ifThenElse>
                <con2:id>_ActionId-1489851422652012399--735f1a78.18a0a4bf22c.26d1</con2:id>
                <con1:case>
                  <con1:condition>
                    <con2:xqueryText>fn:string($RSPValidaRegional/val:PV_CODIGO_ERROR/text()) != 'SUCCESS'</con2:xqueryText>
                  </con1:condition>
                  <con1:actions>
                    <con1:replace varName="header" contents-only="true">
                      <con2:id>_ActionId-1489851422652012399--735f1a78.18a0a4bf22c.2783</con2:id>
                      <con1:expr>
                        <con2:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{fn:string($RSPValidaRegional/val:PV_MENSAJE_ERROR/text())}</messages>
</aut:ResponseHeader>]]></con2:xqueryText>
                      </con1:expr>
                    </con1:replace>
                    <con1:replace varName="body" contents-only="true">
                      <con2:id>_ActionId-1489851422652012399--735f1a78.18a0a4bf22c.7c0c</con2:id>
                      <con1:expr>
                        <con2:xqueryText>&lt;proc:procesaTransaccionesGenericasResponse/></con2:xqueryText>
                      </con1:expr>
                    </con1:replace>
                    <con2:reply>
                      <con2:id>_ActionId-1489851422652012399--735f1a78.18a0a4bf22c.27be</con2:id>
                    </con2:reply>
                  </con1:actions>
                </con1:case>
                <con1:default>
                  <con1:replace varName="header" contents-only="true">
                    <con2:id>_ActionId-1489851422652012399--735f1a78.18a0a4bf22c.275e</con2:id>
                    <con1:expr>
                      <con2:xqueryTransform>
                        <con2:resource ref="Middleware/v2/Resources/Generales/xq/aplicarValoresPorDefectoRegionCB"/>
                        <con2:param name="requestHeader">
                          <con2:path>$header/aut:RequestHeader</con2:path>
                        </con2:param>
                      </con2:xqueryTransform>
                    </con1:expr>
                  </con1:replace>
                </con1:default>
              </con1:ifThenElse>
            </con1:responseTransform>
          </con1:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="ObtenerParametrosTrxCB">
        <con:context>
          <con3:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerParametrosTrxGENCB" prefix="obt" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
          <con3:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/procesaTransaccionesGenericasType" prefix="proc" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
          <con3:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:assign varName="TipoTrx">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7e86</con3:id>
            <con1:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">if (fn:string($body/proc:procesaTransaccionesGenericasRequest/CODIGO_TRANSACCION/text()) = '') then(
'8'
)else ($body/proc:procesaTransaccionesGenericasRequest/CODIGO_TRANSACCION/text())</con3:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:wsCallout>
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7f2b</con3:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/TransaccionesGenericasCB/ObtenerParametrosCB/biz/obtenerParametrosTrxGENCB_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>obtenerParametrosTrxGENCB</con1:operation>
            <con1:request>
              <con1:body>$REQObtenerParamCB</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>RSPObtenerParamCB</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="REQObtenerParamCB">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7f07</con3:id>
                <con1:expr>
                  <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                    <con3:resource ref="Middleware/v2/Resources/TransaccionesGenericasCB/ProcesarTransaccionesGenericaCB/xq/obtenerParamCB"/>
                    <con3:param name="idCorresponsal">
                      <con3:path>$header/aut:RequestHeader/BankingCorrespondent/Id/text()</con3:path>
                    </con3:param>
                    <con3:param name="codOSB">
                      <con3:path>$body/proc:procesaTransaccionesGenericasRequest/TIPO_TRANSACCION/text()</con3:path>
                    </con3:param>
                    <con3:param name="tipoTRX">
                      <con3:path>$TipoTrx</con3:path>
                    </con3:param>
                    <con3:param name="pais">
                      <con3:path>$header/aut:RequestHeader/Region/SourceBank/text()</con3:path>
                    </con3:param>
                  </con3:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con1:requestTransform>
            <con1:responseTransform>
              <con1:assign varName="cuentaDebito">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7ee9</con3:id>
                <con1:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RSPObtenerParamCB/obt:PV_CUENTA_DEBITO/text()</con3:xqueryText>
                </con1:expr>
              </con1:assign>
              <con1:assign varName="cuentaCredito">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7ed6</con3:id>
                <con1:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RSPObtenerParamCB/obt:PV_CUENTA_CREDITO/text()</con3:xqueryText>
                </con1:expr>
              </con1:assign>
              <con1:assign varName="trxT24">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7ec5</con3:id>
                <con1:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RSPObtenerParamCB/obt:PV_TIPO_TRX_T24/text()</con3:xqueryText>
                </con1:expr>
              </con1:assign>
              <con1:assign varName="descripcionTrx">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7eb4</con3:id>
                <con1:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RSPObtenerParamCB/obt:PV_DESCRIPCION_TRX/text()</con3:xqueryText>
                </con1:expr>
              </con1:assign>
              <con1:assign varName="errorMessage">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7e3d</con3:id>
                <con1:expr>
                  <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RSPObtenerParamCB/obt:PV_ERRORMESSAGE/text())</con4:xqueryText>
                </con1:expr>
              </con1:assign>
              <con1:assign varName="errorCode">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7e2b</con3:id>
                <con1:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RSPObtenerParamCB/obt:PV_ERROR_CODE/text()</con3:xqueryText>
                </con1:expr>
              </con1:assign>
            </con1:responseTransform>
          </con1:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="obtenerUUID">
        <con:context>
          <con3:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/generarIDUnicoTypes" prefix="gen" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
          <con3:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
          <con3:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/procesaTransaccionesGenericasType" prefix="proc" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7e5c</con3:id>
            <con1:case>
              <con1:condition>
                <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">$errorCode != 'ERROR'</con4:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7e52</con3:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/GenerarIDUnico" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>generarIDUnico</con1:operation>
                  <con1:request>
                    <con1:body>$REQGenerarUUID</con1:body>
                    <con1:header>$REQHeaderGenerarUUID</con1:header>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPGenerarUUID</con1:body>
                    <con1:header>RSPHeaderGenerarUUID</con1:header>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQHeaderGenerarUUID">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7e56</con3:id>
                      <con1:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$header</con3:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:replace varName="REQHeaderGenerarUUID" contents-only="true">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7e55</con3:id>
                      <con1:expr>
                        <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                          <con3:resource ref="Middleware/v2/Resources/TransaccionesGenericasCB/ProcesarTransaccionesGenericaCB/xq/headerCBUUID"/>
                          <con3:param name="requestHeader1">
                            <con3:path>$header/aut:RequestHeader</con3:path>
                          </con3:param>
                        </con3:xqueryTransform>
                      </con1:expr>
                    </con1:replace>
                    <con1:assign varName="REQGenerarUUID">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7e54</con3:id>
                      <con1:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">&lt;gen:generarIDUnico/></con3:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="UUID">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7e53</con3:id>
                      <con1:expr>
                        <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RSPGenerarUUID/UUID/text())</con4:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:replace varName="header" contents-only="true">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7e18</con3:id>
                <con1:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config"><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{fn:string($errorMessage)}</messages>
</aut:ResponseHeader>]]></con3:xqueryText>
                </con1:expr>
              </con1:replace>
              <con1:replace varName="body" contents-only="true">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7e02</con3:id>
                <con1:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">&lt;proc:procesaTransaccionesGenericasResponse/></con3:xqueryText>
                </con1:expr>
              </con1:replace>
              <con3:reply xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                <con3:id>_ActionId-1337728428878685640--27f3b42.18df5a7d73f.-7d29</con3:id>
              </con3:reply>
            </con1:default>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="RegistrarTransaccionGenericaDB">
        <con:context>
          <con4:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/registrarTransaccionGenCB" prefix="rtg" xmlns:con4="http://www.bea.com/wli/sb/stages/config"/>
          <con4:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con4="http://www.bea.com/wli/sb/stages/config"/>
          <con4:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/procesaTransaccionesGenericasType" prefix="proc" xmlns:con4="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-3884641249908687900-38029058.18df6f1612a.-7da3</con4:id>
            <con1:case>
              <con1:condition>
                <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($UUID) != ''</con4:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-3884641249908687900-38029058.18df6f1612a.-7d97</con4:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/TransaccionesGenericasCB/RegistrarTransaccionGenericaCB/biz/registrarTransaccionGenCB_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>registrarTransaccionGenCB</con1:operation>
                  <con1:request>
                    <con1:body>$REQRegistrarTransaccionGenericaCB</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPRegistrarTransaccionGenericaCB</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQRegistrarTransaccionGenericaCB">
                      <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-3884641249908687900-38029058.18df6f1612a.-7d9c</con4:id>
                      <con1:expr>
                        <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                          <con4:resource ref="Middleware/v2/Resources/TransaccionesGenericasCB/ProcesarTransaccionesGenericaCB/xq/registrarTransaccionGenericaDBIn"/>
                          <con4:param name="UUID">
                            <con4:path>$UUID</con4:path>
                          </con4:param>
                          <con4:param name="cuentaDebito">
                            <con4:path>$cuentaDebito</con4:path>
                          </con4:param>
                          <con4:param name="procesaTransaccionesGenericasRequest">
                            <con4:path>$body/proc:procesaTransaccionesGenericasRequest</con4:path>
                          </con4:param>
                          <con4:param name="cuentaCredito">
                            <con4:path>$cuentaCredito</con4:path>
                          </con4:param>
                          <con4:param name="tipoTRX">
                            <con4:path>$TipoTrx</con4:path>
                          </con4:param>
                          <con4:param name="requestHeaderCB">
                            <con4:path>$header/aut:RequestHeader</con4:path>
                          </con4:param>
                          <con4:param name="tipoTRXT24">
                            <con4:path>$trxT24</con4:path>
                          </con4:param>
                        </con4:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="successIndicator">
                      <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-5747044243615565516-36c6899b.190563d8283.-2a25</con4:id>
                      <con1:expr>
                        <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">data($RSPRegistrarTransaccionGenericaCB/rtg:Pv_ErrorCode/text())</con4:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:ifThenElse>
                      <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-3884641249908687900-38029058.18df6f1612a.-7d9b</con4:id>
                      <con1:case>
                        <con1:condition>
                          <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">$RSPRegistrarTransaccionGenericaCB/rtg:Pv_ErrorCode/text() != 'SUCCESS'</con4:xqueryText>
                        </con1:condition>
                        <con1:actions>
                          <con1:replace varName="header" contents-only="true">
                            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-3884641249908687900-38029058.18df6f1612a.-7d9a</con4:id>
                            <con1:expr>
                              <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config"><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{fn:string($RSPRegistrarTransaccionGenericaCB/rtg:Pv_ErrorMessage/text())}</messages>
</aut:ResponseHeader>]]></con4:xqueryText>
                            </con1:expr>
                          </con1:replace>
                          <con1:replace varName="body" contents-only="true">
                            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-3884641249908687900-38029058.18df6f1612a.-7d99</con4:id>
                            <con1:expr>
                              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">&lt;proc:procesaTransaccionesGenericasResponse/></con3:xqueryText>
                            </con1:expr>
                          </con1:replace>
                          <con4:reply xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                            <con4:id>_ActionId-3884641249908687900-38029058.18df6f1612a.-7d98</con4:id>
                          </con4:reply>
                        </con1:actions>
                      </con1:case>
                      <con1:default/>
                    </con1:ifThenElse>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="Pre-T24">
        <con:context>
          <con4:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/procesaTransaccionesGenericasType" prefix="proc" xmlns:con4="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:assign varName="UUID2">
            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-5747044243615565516-36c6899b.190563d8283.-2954</con4:id>
            <con1:expr>
              <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">data($RSPGenerarUUID/UUID/text())</con4:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:replace varName="body" contents-only="true">
            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-5747044243615565516-36c6899b.190563d8283.-2952</con4:id>
            <con1:expr>
              <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                <con4:resource ref="Middleware/v2/Resources/TransaccionesGenericasCB/ProcesarTransaccionesGenericaCB/xq/procesarTransaccionGenericaCBToT24In"/>
                <con4:param name="UUID">
                  <con4:path>$UUID2</con4:path>
                </con4:param>
                <con4:param name="Debito">
                  <con4:path>$cuentaDebito</con4:path>
                </con4:param>
                <con4:param name="procesaTransaccionesGenericasRequest1">
                  <con4:path>$body/proc:procesaTransaccionesGenericasRequest</con4:path>
                </con4:param>
                <con4:param name="Ft">
                  <con4:path>$trxT24</con4:path>
                </con4:param>
                <con4:param name="Credito">
                  <con4:path>$cuentaCredito</con4:path>
                </con4:param>
              </con4:xqueryTransform>
            </con1:expr>
          </con1:replace>
        </con:actions>
      </con:stage>
      <con:stage name="T24">
        <con:context>
          <con4:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/procesaTransaccionesGenericasType" prefix="proc" xmlns:con4="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con3:route>
            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-5747044243615565516-36c6899b.190563d8283.-2958</con4:id>
            <con3:service ref="Middleware/v2/ProxyServices/ProcesarTransaccionGenericaCBT24" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con3:operation>procesaTransaccionesGenericas</con3:operation>
            <con3:outboundTransform/>
          </con3:route>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="RegistrarTransaccionGenerica_response" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="FlujoSalida" xmlns:con2="http://www.bea.com/wli/sb/stages/config">
        <con:context>
          <con2:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con2:userNsDecl namespace="/Middleware/v2/Resources/ProcesarTransaccionesGenericaCB/xsd/registrarTransaccionesGenericas_sp.xsd" prefix="pro"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/serviciosEmpresarialesTypes" prefix="ser"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/procesaTransaccionesGenericasType" prefix="proc"/>
        </con:context>
        <con:actions>
          <con1:replace contents-only="true" varName="header">
            <con2:id>_ActionId-3716601621225469488-5c02e0f8.189b763a31b.2222</con2:id>
            <con1:expr>
              <con2:xqueryText><![CDATA[<aut:ResponseHeader>
<successIndicator>{$successIndicator}</successIndicator>
<messageId>{$errorCode}</messageId>
</aut:ResponseHeader>]]></con2:xqueryText>
            </con1:expr>
          </con1:replace>
          <con1:replace varName="body" contents-only="true">
            <con2:id>_ActionId-5747044243615565516-36c6899b.190563d8283.-2935</con2:id>
            <con1:expr>
              <con2:xqueryTransform>
                <con2:resource ref="Middleware/v2/Resources/TransaccionesGenericasCB/ProcesarTransaccionesGenericaCB/xq/procesaTransaccionGenericaOut"/>
                <con2:param name="UUID">
                  <con2:path>$UUID</con2:path>
                </con2:param>
                <con2:param name="REFERENCIA_T24">
                  <con2:path>$UUID</con2:path>
                </con2:param>
              </con2:xqueryTransform>
            </con1:expr>
          </con1:replace>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:flow xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:pipeline-node name="RegistrarTransaccionGenerica">
        <con:request>RegistrarTransaccionGenerica_request</con:request>
        <con:response>RegistrarTransaccionGenerica_response</con:response>
      </con:pipeline-node>
    </con:flow>
  </ser:router>
</xml-fragment>