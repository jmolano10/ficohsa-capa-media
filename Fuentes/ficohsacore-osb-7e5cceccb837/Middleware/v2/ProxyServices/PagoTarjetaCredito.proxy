<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
  <ser:coreEntry isProxy="true" isEnabled="true" isTracingEnabled="false">
    <ser:security>
      <con3:custom-token-authentication>
        <con3:username-password>
          <con3:username-selector>
            <con3:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:RequestHeader/Authentication/UserName/text()</con3:xpath>
            <con3:variable>header</con3:variable>
          </con3:username-selector>
          <con3:password-selector>
            <con3:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:RequestHeader/Authentication/Password/text()</con3:xpath>
            <con3:variable>header</con3:variable>
          </con3:password-selector>
        </con3:username-password>
      </con3:custom-token-authentication>
    </ser:security>
    <ser:binding type="SOAP" isSoap12="false" xsi:type="con4:SoapBindingType" xmlns:con4="http://www.bea.com/wli/sb/services/bindings/config">
      <con4:wsdl ref="Middleware/v2/Resources/PagoTarjetaCredito/wsdl/pagoTarjetaCreditoPS"/>
      <con4:port>
        <con4:name>pagoTarjetaCreditoPSSOAP</con4:name>
        <con4:namespace>http://www.ficohsa.com.hn/middleware.services/pagoTarjetaCreditoPS/</con4:namespace>
      </con4:port>
      <con4:selector type="SOAP body"/>
      <con4:WSI-compliant>false</con4:WSI-compliant>
    </ser:binding>
    <ser:monitoring isEnabled="true">
      <ser:aggregationInterval>720</ser:aggregationInterval>
      <ser:pipelineMonitoringLevel>Action</ser:pipelineMonitoringLevel>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
  </ser:coreEntry>
  <ser:endpointConfig>
    <tran:provider-id>http</tran:provider-id>
    <tran:inbound>true</tran:inbound>
    <tran:URI>
      <env:value>/Middleware/OperationsAndExecution/Payments/PagoTarjetaCredito_v2</env:value>
    </tran:URI>
    <tran:inbound-properties/>
    <tran:all-headers>false</tran:all-headers>
    <tran:provider-specific>
      <http:inbound-properties>
        <http:use-https>true</http:use-https>
      </http:inbound-properties>
    </tran:provider-specific>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-8848777042473091319--23eafd38.13c2a05c9f3.-65c8">
    <con:pipeline type="error" name="_onErrorHandler-8848777042473091319--23eafd38.13c2a05c9f3.-65c8">
      <con:stage name="ManejoError">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaFICOPENTypes" prefix="con"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoTarjetaCreditoTypes" prefix="pag"/>
        </con:context>
        <con:actions>
          <con2:assign varName="errorCode">
            <con1:id>_ActionId-761262396148164090-fdfc10e.1646abc32bf.-7a01</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($fault/ctx:errorCode/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="errorMessage">
            <con1:id>_ActionId-761262396148164090-fdfc10e.1646abc32bf.-7a03</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($fault/ctx:reason/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con1:wsCallout xmlns:con3="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/services/security/config" xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-6625365696033715132--2734c6b3.15734272243.-7f7b</con6:id>
            <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>mapeoErrores</con1:operation>
            <con1:request>
              <con1:body>$REQMapeoErrores</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>RSPMapeoErrores</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="REQMapeoErrores">
                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-6625365696033715132--2734c6b3.15734272243.-7f7d</con6:id>
                <con1:expr>
                  <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                    <con6:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                    <con6:param name="CODIGO_ERROR">
                      <con6:path>$errorCode</con6:path>
                    </con6:param>
                    <con6:param name="MENSAJE_ERROR">
                      <con6:path>fn:concat("FICBCO0063","$#$",$errorMessage)</con6:path>
                    </con6:param>
                  </con6:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con1:requestTransform>
            <con1:responseTransform>
              <con1:replace varName="header" contents-only="true">
                <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-6625365696033715132--2734c6b3.15734272243.-7f7c</con6:id>
                <con1:expr>
                  <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                    <con6:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                    <con6:param name="mapeoErroresResponse1">
                      <con6:path>$RSPMapeoErrores</con6:path>
                    </con6:param>
                    <con6:param name="successIndicator">
                      <con6:path>$errorCode</con6:path>
                    </con6:param>
                  </con6:xqueryTransform>
                </con1:expr>
              </con1:replace>
            </con1:responseTransform>
          </con1:wsCallout>
          <con5:replace varName="body" contents-only="true" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config">
            <con1:id>_ActionId-761262396148164090-fdfc10e.1646abc32bf.-798a</con1:id>
            <con5:expr>
              <con1:xqueryText>&lt;pag:pagoTarjetaCreditoResponse/></con1:xqueryText>
            </con5:expr>
          </con5:replace>
          <con1:reply>
            <con1:id>_ActionId-8848777042473091319--23eafd38.13c2a05c9f3.-658c</con1:id>
          </con1:reply>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="ValidacionesGenerales_request">
      <con:stage name="ValidacionXSD">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoTarjetaCreditoTypes" prefix="pag"/>
        </con:context>
        <con:actions>
          <con2:validate>
            <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7c15</con1:id>
            <con2:schema ref="Middleware/Business_Resources/tarjetaCredito/PagoTarjetaCredito/pagoTarjetaCreditoTypes"/>
            <con2:schemaElement xmlns:pag="http://www.ficohsa.com.hn/middleware.services/pagoTarjetaCreditoTypes">pag:pagoTarjetaCredito</con2:schemaElement>
            <con2:varName>body</con2:varName>
            <con2:location>
              <con1:xpathText>./pag:pagoTarjetaCredito</con1:xpathText>
            </con2:location>
          </con2:validate>
        </con:actions>
      </con:stage>
      <con:stage name="ValidacionServicioRegional">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoTarjetaCreditoTypes" prefix="pag"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/ValidaServicioRegional" prefix="val"/>
        </con:context>
        <con:actions>
          <con2:wsCallout>
            <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7bdd</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ValidaServicioRegional/biz/ValidaServicioRegional_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>ValidaServicioRegional</con2:operation>
            <con2:request>
              <con2:body>$reqValidaServicioRegional</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>respValidaServicioRegional</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="reqValidaServicioRegional">
                <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7b6f</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/Generales/xq/validaServicioRegionalIn"/>
                    <con1:param name="requestHeader1">
                      <con1:path>$header/aut:RequestHeader</con1:path>
                    </con1:param>
                    <con1:param name="serviceId">
                      <con1:path>"FICBCO0063"</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:ifThenElse>
                <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7b37</con1:id>
                <con2:case>
                  <con2:condition>
                    <con1:xqueryText>fn:string($respValidaServicioRegional/val:PV_CODIGO_ERROR/text()) != 'SUCCESS'</con1:xqueryText>
                  </con2:condition>
                  <con2:actions>
                    <con2:replace contents-only="true" varName="header">
                      <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7aff</con1:id>
                      <con2:expr>
                        <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{fn:string($respValidaServicioRegional/val:PV_MENSAJE_ERROR/text())}</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                      </con2:expr>
                    </con2:replace>
                    <con2:replace contents-only="true" varName="body">
                      <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7ae2</con1:id>
                      <con2:expr>
                        <con1:xqueryText>&lt;pag:pagoTarjetaCreditoResponse/></con1:xqueryText>
                      </con2:expr>
                    </con2:replace>
                    <con1:reply>
                      <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7ac5</con1:id>
                    </con1:reply>
                  </con2:actions>
                </con2:case>
                <con2:default>
                  <con2:replace contents-only="true" varName="header">
                    <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7a57</con1:id>
                    <con2:expr>
                      <con1:xqueryTransform>
                        <con1:resource ref="Middleware/v2/Resources/Generales/xq/aplicarValoresPorDefectoRegion"/>
                        <con1:param name="requestHeader">
                          <con1:path>$header/aut:RequestHeader</con1:path>
                        </con1:param>
                      </con1:xqueryTransform>
                    </con2:expr>
                  </con2:replace>
                  <con2:assign varName="areSameSourceAndDestination">
                    <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ddc</con1:id>
                    <con2:expr>
                      <con1:xqueryTransform>
                        <con1:resource ref="Middleware/v2/Resources/Generales/xq/validarCrucePaisEmpresa"/>
                        <con1:param name="requestHeader">
                          <con1:path>$header/aut:RequestHeader</con1:path>
                        </con1:param>
                      </con1:xqueryTransform>
                    </con2:expr>
                  </con2:assign>
                </con2:default>
              </con2:ifThenElse>
            </con2:responseTransform>
          </con2:wsCallout>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="ValidacionesGenerales_response"/>
    <con:pipeline type="request" name="HN01_PagoTarjetaCredito_request">
      <con:stage name="FlujoEntrada">
        <con:context>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
          <con1:userNsDecl namespace="http://alcance.local/wsinfotarjetas/" prefix="tns"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoTarjetaCreditoTypes" prefix="pag"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultasType" prefix="con"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaTasaCambioTypes" prefix="con1"/>
        </con:context>
        <con:actions>
          <con2:assign varName="isValidRequest">
            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ce8</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/Business_Resources/tarjetaCredito/PagoTarjetaCredito/pagoTarjetaCreditoValidRequired"/>
                <con1:param name="pagoTarjetaCredito">
                  <con1:path>$body/pag:pagoTarjetaCredito</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:ifThenElse>
            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ce7</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$isValidRequest = "true"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ce4</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>obtenerParametrizacion</con2:operation>
                  <con2:request>
                    <con2:body>$REQObtenerParams</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPObtenerParams</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQObtenerParams">
                      <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ce6</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                          <con1:param name="nombreParametros">
                            <con1:path>"ALCC001.HNLCONTRACTID||ALCC001.USDCONTRACTID||ALCC001.CITIBINS"</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:assign varName="statusParametrizacion">
                      <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ce5</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($RSPObtenerParams/osb:ERROR_CODE/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:responseTransform>
                </con2:wsCallout>
                <con2:ifThenElse>
                  <con1:comment>Esta condicion determina si la tarjeta es "CITI" o Ficohsa, comparando el bin de la tarjeta del request contra los bines almacenados en la tabla de parametrización.</con1:comment>
                  <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ce3</con1:id>
                  <con2:case>
                    <con2:ifThenElse>
                      <con1:id>_ActionId-8487343609797435980-37b70000.1665428c906.-30e8</con1:id>
                      <con2:case>
                        <con2:condition/>
                        <con2:actions/>
                      </con2:case>
                      <con2:default/>
                    </con2:ifThenElse>
                    <con2:ifThenElse>
                      <con1:id>_ActionId-8487343609797435980-37b70000.1665428c906.-30e8</con1:id>
                      <con2:case>
                        <con2:condition/>
                        <con2:actions/>
                      </con2:case>
                      <con2:default/>
                    </con2:ifThenElse>
                    <con2:ifThenElse>
                      <con1:id>_ActionId-8487343609797435980-37b70000.1665428c906.-30e8</con1:id>
                      <con2:case>
                        <con2:condition/>
                        <con2:actions/>
                      </con2:case>
                      <con2:default/>
                    </con2:ifThenElse>
                    <con2:condition>
                      <con1:xqueryText>$statusParametrizacion = "SUCCESS"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:assign varName="citiBins">
                        <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ce2</con1:id>
                        <con2:expr>
                          <con1:xqueryText>fn:string($RSPObtenerParams/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME="ALCC001.CITIBINS"]/osb:VALUE/text())</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con2:assign varName="CARD_NUMBER">
                        <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ce1</con1:id>
                        <con2:expr>
                          <con1:xqueryText>fn:string($body/pag:pagoTarjetaCredito/CREDIT_CARD_NUMBER/text())</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con2:assign varName="citiCardFlag">
                        <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ce0</con1:id>
                        <con2:expr>
                          <con1:xqueryText>fn:index-of(fn:tokenize($citiBins,"\|\|"),fn:substring($CARD_NUMBER,1,8))</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con1:assign varName="uuid" xmlns:con3="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/services/security/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cdf</con5:id>
                        <con1:expr>
                          <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                            <con4:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                          </con4:xqueryTransform>
                        </con1:expr>
                      </con1:assign>
                      <con2:wsCallout>
                        <con1:id>_ActionId-6618453780973885631--2b4f9605.1665e89f8d9.-7c66</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/transaccionesAlcance/biz/transaccionesAlcance" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>consultarSaldos</con2:operation>
                        <con2:request>
                          <con2:body>$REQConsultaSaldosTC</con2:body>
                        </con2:request>
                        <con2:response>
                          <con2:body>RSPConsultaSaldosTC</con2:body>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQConsultaSaldosTC">
                            <con1:id>_ActionId-6618453780973885631--2b4f9605.1665e89f8d9.-7c6b</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/Business_Resources/tarjetaCredito/PagoTarjetaCredito/consultaSaldoTarjetaCreditoIn"/>
                                <con1:param name="pagoTarjetaCredito1">
                                  <con1:path>$body/pag:pagoTarjetaCredito</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform>
                          <con2:assign varName="RSPHdrConsultaSaldosTC">
                            <con1:id>_ActionId-6618453780973885631--2b4f9605.1665e89f8d9.-7c69</con1:id>
                            <con2:expr>
                              <con1:xqueryText>$header/aut:ResponseHeader</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="currentBalance">
                            <con1:id>_ActionId-6618453780973885631--2b4f9605.1665e89f8d9.-7c68</con1:id>
                            <con2:expr>
                              <con1:xqueryText>if (fn:string($body/pag:pagoTarjetaCredito/BALANCE_CURRENCY/text()) = "HNL") then (
	fn:string($RSPConsultaSaldosTC/tns:ConsultarSaldosVasaResult/tns:saldos/tns:ArrayOfStrucSaldosConsulta[tns:moneda="340"]/tns:saldoActual/text())
) else if (fn:string($body/pag:pagoTarjetaCredito/BALANCE_CURRENCY/text()) = "USD") then (
	fn:string($RSPConsultaSaldosTC/tns:ConsultarSaldosVasaResult/tns:saldos/tns:ArrayOfStrucSaldosConsulta[tns:moneda="840"]/tns:saldoActual/text())
) else ()</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="clientId">
                            <con1:id>_ActionId-6618453780973885631--2b4f9605.1665e89f8d9.-7c67</con1:id>
                            <con2:expr>
                              <con1:xqueryText>fn:string($RSPConsultaSaldosTC/tns:ConsultarSaldosVasaResult/tns:codigocliente/text())</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="estatusConfirmacion">
                            <con1:id>_ActionId-29625457076682130-117e9b31.167849c8975.-7d11</con1:id>
                            <con2:expr>
                              <con1:xqueryText>fn:string($RSPConsultaSaldosTC/tns:ConsultarSaldosVasaResult/tns:estatusConfirmacion/text())</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="mensajeConfirmacion">
                            <con1:id>_ActionId-29625457076682130-117e9b31.167849c8975.-7d0f</con1:id>
                            <con2:expr>
                              <con1:xqueryText>fn:string($RSPConsultaSaldosTC/tns:ConsultarSaldosVasaResult/tns:mensajeConfirmacion/text())</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-29625457076682130-117e9b31.167849c8975.-7d71</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>$estatusConfirmacion = '96'</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:replace varName="header" contents-only="true">
                                  <con1:id>_ActionId-29625457076682130-117e9b31.167849c8975.-7d70</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>ERROR LOOKING CREDIT CARD</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                                  </con2:expr>
                                </con2:replace>
                                <con2:replace varName="body" contents-only="true">
                                  <con1:id>_ActionId-29625457076682130-117e9b31.167849c8975.-7d6f</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>&lt;pag:pagoTarjetaCreditoResponse/></con1:xqueryText>
                                  </con2:expr>
                                </con2:replace>
                                <con1:reply>
                                  <con1:id>_ActionId-29625457076682130-117e9b31.167849c8975.-7d6e</con1:id>
                                </con1:reply>
                              </con2:actions>
                            </con2:case>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>$estatusConfirmacion != '00'</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:replace varName="header" contents-only="true">
                                  <con1:id>_ActionId-29625457076682130-117e9b31.167849c8975.-7d6d</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{$estatusConfirmacion}{$mensajeConfirmacion}</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                                  </con2:expr>
                                </con2:replace>
                                <con2:replace varName="body" contents-only="true">
                                  <con1:id>_ActionId-29625457076682130-117e9b31.167849c8975.-7d6c</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>&lt;pag:pagoTarjetaCreditoResponse/></con1:xqueryText>
                                  </con2:expr>
                                </con2:replace>
                                <con1:reply>
                                  <con1:id>_ActionId-29625457076682130-117e9b31.167849c8975.-7d6b</con1:id>
                                </con1:reply>
                              </con2:actions>
                            </con2:case>
                            <con2:default/>
                          </con2:ifThenElse>
                        </con2:responseTransform>
                      </con2:wsCallout>
                      <con2:ifThenElse>
                        <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cde</con1:id>
                        <con2:case>
                          <con2:condition>
                            <con1:xqueryText>fn:empty($citiCardFlag)</con1:xqueryText>
                          </con2:condition>
                          <con2:actions>
                            <con2:wsCallout>
                              <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cda</con1:id>
                              <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/tarjetaCredito/Resources/TarjetaCredito" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con2:operation>Pagodetarjetadecredito</con2:operation>
                              <con2:request>
                                <con2:body>$REQUEST</con2:body>
                              </con2:request>
                              <con2:response>
                                <con2:body>RESPONSE</con2:body>
                              </con2:response>
                              <con2:requestTransform>
                                <con2:assign varName="REQUEST">
                                  <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cdd</con1:id>
                                  <con2:expr>
                                    <con1:xqueryTransform>
                                      <con1:resource ref="Middleware/v2/Resources/PagoTarjetaCredito/xq/pagoTarjetaCreditoIn"/>
                                      <con1:param name="uuid">
                                        <con1:path>fn:string($uuid)</con1:path>
                                      </con1:param>
                                      <con1:param name="pagoTarjetaCredito">
                                        <con1:path>$body/pag:pagoTarjetaCredito</con1:path>
                                      </con1:param>
                                      <con1:param name="requestHeader">
                                        <con1:path>$header/aut:RequestHeader</con1:path>
                                      </con1:param>
                                      <con1:param name="currentBalance">
                                        <con1:path>fn:string($currentBalance)</con1:path>
                                      </con1:param>
                                      <con1:param name="clientId">
                                        <con1:path>fn:string($clientId)</con1:path>
                                      </con1:param>
                                    </con1:xqueryTransform>
                                  </con2:expr>
                                </con2:assign>
                              </con2:requestTransform>
                              <con2:responseTransform>
                                <con2:assign varName="successIndicatorPagodetarjetadecredito">
                                  <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cdc</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>$RESPONSE/Status/successIndicator/text()</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                                <con2:assign varName="transactionIdPagodetarjetadecredito">
                                  <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cdb</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>$RESPONSE/Status/transactionId/text()</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                              </con2:responseTransform>
                            </con2:wsCallout>
                            <con2:assign varName="nombreUsuario">
                              <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cd9</con1:id>
                              <con2:expr>
                                <con1:xqueryText>$header/aut:RequestHeader/Authentication/UserName/text()</con1:xqueryText>
                              </con2:expr>
                            </con2:assign>
                            <con2:ifThenElse>
                              <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cd8</con1:id>
                              <con2:case>
                                <con2:condition>
                                  <con1:xqueryText>$successIndicatorPagodetarjetadecredito = "Success" and fn:upper-case($nombreUsuario) != "SRV-ITINTB" and fn:upper-case($nombreUsuario) != "SRV-ITINTM"</con1:xqueryText>
                                </con2:condition>
                                <con2:actions>
                                  <con2:wsCallout>
                                    <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cd5</con1:id>
                                    <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/tarjetaCredito/Resources/AplicaTCT24_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con2:operation>aplicaTCT24</con2:operation>
                                    <con2:request>
                                      <con2:body>$REQaplicaTCT24</con2:body>
                                    </con2:request>
                                    <con2:response>
                                      <con2:body>RSPaplicaTCT24</con2:body>
                                    </con2:response>
                                    <con2:requestTransform>
                                      <con2:assign varName="REQaplicaTCT24">
                                        <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cd7</con1:id>
                                        <con2:expr>
                                          <con1:xqueryTransform>
                                            <con1:resource ref="Middleware/v2/Resources/PagoTarjetaCredito/xq/aplicarTCT24In"/>
                                            <con1:param name="pagoTarjetaCredito">
                                              <con1:path>$body/pag:pagoTarjetaCredito</con1:path>
                                            </con1:param>
                                            <con1:param name="requestHeader">
                                              <con1:path>$header/aut:RequestHeader</con1:path>
                                            </con1:param>
                                            <con1:param name="pagodetarjetadecreditoResponse">
                                              <con1:path>$RESPONSE</con1:path>
                                            </con1:param>
                                          </con1:xqueryTransform>
                                        </con2:expr>
                                      </con2:assign>
                                    </con2:requestTransform>
                                    <con2:responseTransform>
                                      <con2:assign varName="successIndicatorAplicaTCT24">
                                        <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cd6</con1:id>
                                        <con2:expr>
                                          <con1:xqueryText>$RSPaplicaTCT24/Status/successIndicator/text()</con1:xqueryText>
                                        </con2:expr>
                                      </con2:assign>
                                    </con2:responseTransform>
                                  </con2:wsCallout>
                                </con2:actions>
                              </con2:case>
                              <con2:default/>
                            </con2:ifThenElse>
                          </con2:actions>
                        </con2:case>
                        <con2:default>
                          <con2:assign varName="balanceCurrency">
                            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cd4</con1:id>
                            <con2:expr>
                              <con1:xqueryText>fn:string($body/pag:pagoTarjetaCredito/BALANCE_CURRENCY/text())</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="contractId">
                            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cd3</con1:id>
                            <con2:expr>
                              <con1:xqueryText>if ($balanceCurrency = "HNL") then (
	fn:string($RSPObtenerParams/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME="ALCC001.HNLCONTRACTID"]/osb:VALUE/text())
) elseif ($balanceCurrency = "USD") then (
	fn:string($RSPObtenerParams/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME="ALCC001.USDCONTRACTID"]/osb:VALUE/text())
) else ()</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:wsCallout>
                            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cd1</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/ConsultasCuenta/Resources/consultaCuentasBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Consultadedetallesdelacuenta</con2:operation>
                            <con2:request>
                              <con2:body>$REQConsultaCuenta</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RSPConsultaCuenta</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQConsultaCuenta">
                                <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cd2</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v2/Resources/PagoTarjetaCredito/xq/pagoTarjetaCitiConsultaCuentaIn"/>
                                    <con1:param name="pagoTarjetaCredito">
                                      <con1:path>$body/pag:pagoTarjetaCredito</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                          <con2:wsCallout>
                            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ccf</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineadbcta</con2:operation>
                            <con2:request>
                              <con2:body>$REQPagoRecaudo</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RSPPagoRecaudo</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQPagoRecaudo">
                                <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cd0</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v2/Resources/PagoTarjetaCredito/xq/pagoTarjetaCreditoCitiIn"/>
                                    <con1:param name="paymentCurrency">
                                      <con1:path>fn:string($RSPConsultaCuenta/WSACCOUNTLISTType/gWSACCOUNTLISTDetailType/mWSACCOUNTLISTDetailType/CURRENCY/text())</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>$uuid</con1:path>
                                    </con1:param>
                                    <con1:param name="pagoTarjetaCredito">
                                      <con1:path>$body/pag:pagoTarjetaCredito</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                    <con1:param name="contractId">
                                      <con1:path>$contractId</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                          <con2:assign varName="debitAccountCurrency">
                            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cce</con1:id>
                            <con2:expr>
                              <con1:xqueryText>data($RSPPagoRecaudo/FUNDSTRANSFERType/DEBITCURRENCY)</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                        </con2:default>
                      </con2:ifThenElse>
                    </con2:actions>
                  </con2:case>
                  <con2:default/>
                </con2:ifThenElse>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="HN01_PagoTarjetaCredito_response">
      <con:stage name="FlujoSalida">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaTasaCambioTypes" prefix="con1"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoTarjetaCreditoTypes" prefix="pag"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ccd</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$isValidRequest = "true"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:ifThenElse>
                  <con1:comment>Si la búsqueda de parámetros de base de datos fue exitosa, se avanza en el flujo. De lo contrario se devuelve mensaje de error indicando que no se pudo leer parámetros.</con1:comment>
                  <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ccc</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$statusParametrizacion = "SUCCESS"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:ifThenElse>
                        <con1:comment>Esta condicion determina si la tarjeta es "CITI" o Ficohsa, comparando el bin de la tarjeta del request contra los bines almacenados en la tabla de parametrización.</con1:comment>
                        <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ccb</con1:id>
                        <con2:case>
                          <con2:condition>
                            <con1:xqueryText>fn:empty($citiCardFlag)</con1:xqueryText>
                          </con2:condition>
                          <con2:actions>
                            <con2:replace contents-only="true" varName="header">
                              <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cca</con1:id>
                              <con2:expr>
                                <con1:xqueryTransform>
                                  <con1:resource ref="Middleware/Business_Resources/tarjetaCredito/PagoTarjetaCredito/pagoTarjetaCreditoHeaderOut"/>
                                  <con1:param name="pagodetarjetadecreditoResponse">
                                    <con1:path>$RESPONSE</con1:path>
                                  </con1:param>
                                </con1:xqueryTransform>
                              </con2:expr>
                            </con2:replace>
                            <con2:replace contents-only="true" varName="body">
                              <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cc9</con1:id>
                              <con2:expr>
                                <con1:xqueryTransform>
                                  <con1:resource ref="Middleware/Business_Resources/tarjetaCredito/PagoTarjetaCredito/pagoTarjetaCreditoOut"/>
                                  <con1:param name="pagodetarjetadecreditoResponse">
                                    <con1:path>$RESPONSE</con1:path>
                                  </con1:param>
                                </con1:xqueryTransform>
                              </con2:expr>
                            </con2:replace>
                          </con2:actions>
                        </con2:case>
                        <con2:default>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cc8</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>$balanceCurrency = $debitAccountCurrency</con1:xqueryText>
                              </con2:condition>
                              <con2:actions/>
                            </con2:case>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>$debitAccountCurrency != "null"</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:wsCallout>
                                  <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cc3</con1:id>
                                  <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/ConsultaTasaCambio" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                  <con2:operation>consultaTasaCambio</con2:operation>
                                  <con2:request>
                                    <con2:body>$REQUESTTasaCambio</con2:body>
                                    <con2:header>$REQUESTHTasaCambio</con2:header>
                                  </con2:request>
                                  <con2:response>
                                    <con2:body>RESPONSETasaCambio</con2:body>
                                    <con2:header>RESPONSEHTasaCambio</con2:header>
                                  </con2:response>
                                  <con2:requestTransform>
                                    <con2:assign varName="REQUESTHTasaCambio">
                                      <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cc7</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>$header</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                    <con2:assign varName="REQUESTTasaCambio">
                                      <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cc6</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/Business_Resources/tarjetaCredito/PagoTarjetaCredito/consultaTasaCambioUSDIn"/>
                                          <con1:param name="monedaLocal">
                                            <con1:path>"HNL"</con1:path>
                                          </con1:param>
                                          <con1:param name="monedaExtranjera">
                                            <con1:path>"USD"</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:requestTransform>
                                  <con2:responseTransform>
                                    <con2:assign varName="tasaCambioVenta">
                                      <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cc5</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>$RESPONSETasaCambio/con1:consultaTasaCambioResponseType/con1:consultaTasaCambioResponseRecordType/SELL_RATE/text()</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                    <con2:assign varName="tasaCambioCompra">
                                      <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cc4</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>$RESPONSETasaCambio/con1:consultaTasaCambioResponseType/con1:consultaTasaCambioResponseRecordType/BUY_RATE/text()</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:responseTransform>
                                </con2:wsCallout>
                              </con2:actions>
                            </con2:case>
                            <con2:default>
                              <con2:assign varName="debitAccountCurrency">
                                <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cc2</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>$balanceCurrency</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                            </con2:default>
                          </con2:ifThenElse>
                          <con2:replace varName="header" contents-only="true">
                            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cc1</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/Business_Resources/tarjetaCredito/PagoTarjetaCredito/pagoTarjetaCreditoCitiHeaderOut"/>
                                <con1:param name="pagoderecaudolocalylineadbctaResponse1">
                                  <con1:path>$RSPPagoRecaudo</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:replace>
                          <con2:replace varName="body" contents-only="true">
                            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cc0</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/Business_Resources/tarjetaCredito/PagoTarjetaCredito/pagoTarjetaCreditoCitiOut"/>
                                <con1:param name="tasaCambioCompra">
                                  <con1:path>$tasaCambioCompra</con1:path>
                                </con1:param>
                                <con1:param name="tasaCambioVenta">
                                  <con1:path>$tasaCambioVenta</con1:path>
                                </con1:param>
                                <con1:param name="balanceCurrency">
                                  <con1:path>$balanceCurrency</con1:path>
                                </con1:param>
                                <con1:param name="pagoderecaudolocalylineadbctaResponse1">
                                  <con1:path>$RSPPagoRecaudo</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:replace>
                        </con2:default>
                      </con2:ifThenElse>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con2:replace varName="header" contents-only="true">
                      <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cbf</con1:id>
                      <con2:expr>
                        <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>ERROR READING PAYMENT PARAMETERS</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                      </con2:expr>
                    </con2:replace>
                    <con2:replace varName="body" contents-only="true">
                      <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cbe</con1:id>
                      <con2:expr>
                        <con1:xqueryText>&lt;pag:pagoTarjetaCreditoResponse/></con1:xqueryText>
                      </con2:expr>
                    </con2:replace>
                  </con2:default>
                </con2:ifThenElse>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:replace contents-only="true" varName="header">
                <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cbd</con1:id>
                <con2:expr>
                  <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>REQUIRED FIELDS NOT SUPPLIED</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                </con2:expr>
              </con2:replace>
              <con2:replace contents-only="true" varName="body">
                <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5cbc</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;pag:pagoTarjetaCreditoResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="MapeoErrores">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con5:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/pipeline/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config">
            <con:id>_ActionId-6625365696033715132--2734c6b3.15734272243.-7f06</con:id>
            <con5:case>
              <con5:condition>
                <con:xqueryText>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) != "SUCCESS"</con:xqueryText>
              </con5:condition>
              <con5:actions>
                <con5:wsCallout>
                  <con:id>_ActionId-6625365696033715132--2734c6b3.15734272243.-7f03</con:id>
                  <con5:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con5:operation>mapeoErrores</con5:operation>
                  <con5:request>
                    <con5:body>$REQMapeoErrores</con5:body>
                  </con5:request>
                  <con5:response>
                    <con5:body>RSPMapeoErrores</con5:body>
                  </con5:response>
                  <con5:requestTransform>
                    <con5:assign varName="REQMapeoErrores">
                      <con:id>_ActionId-6625365696033715132--2734c6b3.15734272243.-7f05</con:id>
                      <con5:expr>
                        <con:xqueryTransform>
                          <con:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                          <con:param name="CODIGO_ERROR">
                            <con:path>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text()))</con:path>
                          </con:param>
                          <con:param name="MENSAJE_ERROR">
                            <con:path>fn:concat("FICBCO0063","$#$",fn:string-join($header/aut:ResponseHeader/messages, '||'))</con:path>
                          </con:param>
                        </con:xqueryTransform>
                      </con5:expr>
                    </con5:assign>
                  </con5:requestTransform>
                  <con5:responseTransform>
                    <con5:replace varName="header" contents-only="true">
                      <con:id>_ActionId-6625365696033715132--2734c6b3.15734272243.-7f04</con:id>
                      <con5:expr>
                        <con:xqueryTransform>
                          <con:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                          <con:param name="mapeoErroresResponse1">
                            <con:path>$RSPMapeoErrores</con:path>
                          </con:param>
                          <con:param name="successIndicator">
                            <con:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con:path>
                          </con:param>
                        </con:xqueryTransform>
                      </con5:expr>
                    </con5:replace>
                  </con5:responseTransform>
                </con5:wsCallout>
              </con5:actions>
            </con5:case>
            <con5:default/>
          </con5:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="RegionalizacionPaisEmpresa_ConCruce_request">
      <con:stage name="OperacionEnOrigen_PagoTarjetaCredito">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:Error>
            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5c13</con1:id>
            <con2:errCode>MW-0008</con2:errCode>
            <con2:message>SERVICE NOT IMPLEMENTED YET FOR THIS COUNTRY/COMPANY</con2:message>
          </con2:Error>
          <con2:ifThenElse>
            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5c12</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>(:HNBanco:)
fn:string($header/aut:RequestHeader/Region/SourceBank/text()) = 'HN01'</con1:xqueryText>
              </con2:condition>
              <con2:actions/>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="OperacionEnDestino_PagoTarjetaCredito">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5c11</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>(:HNBanco:)
fn:string($header/aut:RequestHeader/Region/DestinationBank/text()) = 'HN01'</con1:xqueryText>
              </con2:condition>
              <con2:actions/>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="RegionalizacionPaisEmpresa_ConCruce_response"/>
    <con:pipeline type="request" name="Default_PagoTarjetaCredito_request">
      <con:stage name="FlujoEntrada">
        <con:context/>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="Default_PagoTarjetaCredito_response">
      <con:stage name="FlujoSalida">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/emisionChequesGerenciaTypes" prefix="emis"/>
        </con:context>
        <con:actions>
          <con2:Error>
            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5ba2</con1:id>
            <con2:errCode>MW-0008</con2:errCode>
            <con2:message>SERVICE NOT IMPLEMENTED YET FOR THIS COUNTRY/COMPANY</con2:message>
          </con2:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="GT01_PagoTarjetaCredito_request">
      <con:stage name="FlujoEntrada">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoTarjetaCreditoTypes" prefix="pag"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:assign varName="isValidRequest">
            <con1:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-68f0</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/Business_Resources/tarjetaCredito/PagoTarjetaCredito/pagoTarjetaCreditoValidRequired"/>
                <con1:param name="pagoTarjetaCredito">
                  <con1:path>$body/pag:pagoTarjetaCredito</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:ifThenElse>
            <con1:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-68ef</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$isValidRequest = "true"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-68ed</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABKGT/pagoTarjetaCredito/biz/PagoTarjetaCredito_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>PagoTarjetaCredito</con2:operation>
                  <con2:request>
                    <con2:body>$rq</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>rp</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="rq">
                      <con1:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-68ee</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/PagoTarjetaCredito/xq/pagoTCGTIn"/>
                          <con1:param name="usuarioCanal">
                            <con1:path>fn:string($header/aut:RequestHeader/Authentication/UserName)</con1:path>
                          </con1:param>
                          <con1:param name="pagoTarjetaCredito1">
                            <con1:path>$body/pag:pagoTarjetaCredito</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform/>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con1:skip>
                <con1:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-68ec</con1:id>
              </con1:skip>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="GT01_PagoTarjetaCredito_response">
      <con:stage name="FlujoSalida">
        <con:context>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/PagoTarjetaCredito" prefix="ns0"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoTarjetaCreditoTypes" prefix="pag"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-6884045808838587795-4efc118f.157fd2912e3.-7f4c</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>fn:upper-case($rp/ns0:ERROR_CODE/text()) = "SUCCESS"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace contents-only="true" varName="header">
                  <con1:id>_ActionId-6884045808838587795-4efc118f.157fd2912e3.-7f4a</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/PagoTarjetaCredito/xq/pagoTCGTHeaderOut"/>
                      <con1:param name="outputParameters1">
                        <con1:path>$rp</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
                <con2:replace contents-only="true" varName="body">
                  <con1:id>_ActionId-6884045808838587795-4efc118f.157fd2912e3.-7f48</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/PagoTarjetaCredito/xq/pagoTCGTOut"/>
                      <con1:param name="inputParameters1">
                        <con1:path>$rq</con1:path>
                      </con1:param>
                      <con1:param name="outputParameters1">
                        <con1:path>$rp</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con5:wsCallout xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:id>_ActionId-4088370124543936452--7314a14b.15807524f89.-7f6e</con2:id>
                <con5:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                <con5:operation>mapeoErrores</con5:operation>
                <con5:request>
                  <con5:body>$reqMapeoErrores</con5:body>
                </con5:request>
                <con5:response>
                  <con5:body>respMapeoErrores</con5:body>
                </con5:response>
                <con5:requestTransform>
                  <con5:assign varName="reqMapeoErrores">
                    <con2:id>_ActionId-4088370124543936452--7314a14b.15807524f89.-7f70</con2:id>
                    <con5:expr>
                      <con2:xqueryTransform>
                        <con2:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                        <con2:param name="MENSAJE_ERROR">
                          <con2:path>fn:upper-case($rp/ns0:ERROR_MESSAGE/text())</con2:path>
                        </con2:param>
                        <con2:param name="CODIGO_ERROR">
                          <con2:path>fn:concat("FICBCO0063","$#$",fn:string-join(fn:upper-case($rp/ns0:ERROR_CODE/text()), '||'))</con2:path>
                        </con2:param>
                      </con2:xqueryTransform>
                    </con5:expr>
                  </con5:assign>
                </con5:requestTransform>
                <con5:responseTransform>
                  <con5:replace contents-only="true" varName="header">
                    <con2:id>_ActionId-4088370124543936452--7314a14b.15807524f89.-7f6f</con2:id>
                    <con5:expr>
                      <con2:xqueryTransform>
                        <con2:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                        <con2:param name="mapeoErroresResponse1">
                          <con2:path>$respMapeoErrores</con2:path>
                        </con2:param>
                        <con2:param name="successIndicator">
                          <con2:path>fn:upper-case($rp/ns0:ERROR_CODE/text())</con2:path>
                        </con2:param>
                      </con2:xqueryTransform>
                    </con5:expr>
                  </con5:replace>
                </con5:responseTransform>
              </con5:wsCallout>
              <con2:replace varName="body" contents-only="true">
                <con1:id>_ActionId-4088370124543936452--7314a14b.15807524f89.-7f34</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;pag:pagoTarjetaCreditoResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="PA01_PagoTarjetaCredito_request">
      <con:stage name="FlujoEntrada">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoTarjetaCreditoTypes" prefix="pag"/>
        </con:context>
        <con:actions>
          <con2:assign varName="isValidRequest">
            <con1:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6866</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/Business_Resources/tarjetaCredito/PagoTarjetaCredito/pagoTarjetaCreditoValidRequired"/>
                <con1:param name="pagoTarjetaCredito">
                  <con1:path>$body/pag:pagoTarjetaCredito</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:ifThenElse>
            <con1:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6865</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$isValidRequest = "true"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6863</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABKPA/pagoTarjetaCredito/biz/pagoTarjetaCredito_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>pagoTarjetaCredito</con2:operation>
                  <con2:request>
                    <con2:body>$rq</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>rp</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="rq">
                      <con1:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6864</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/PagoTarjetaCredito/xq/pagoTCPAIn"/>
                          <con1:param name="pagoTarjetaCredito1">
                            <con1:path>$body/pag:pagoTarjetaCredito</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform/>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con1:skip>
                <con1:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6862</con1:id>
              </con1:skip>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="PA01_PagoTarjetaCredito_response">
      <con:stage name="FlujoSalida">
        <con:context>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/pagoTarjetaCredito" prefix="ns0"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoTarjetaCreditoTypes" prefix="pag"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-3180483239834717332--14db50d2.153852e2314.-6861</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>fn:upper-case($rp/ns0:ERROR_CODE/text()) = "SUCCESS"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace contents-only="true" varName="body">
                  <con1:id>_ActionId-424218776797984113--110cde23.15820b9c7a7.-7cb9</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/PagoTarjetaCredito/xq/pagoTCPAOut"/>
                      <con1:param name="inputParameters1">
                        <con1:path>$rq</con1:path>
                      </con1:param>
                      <con1:param name="outputParameters1">
                        <con1:path>$rp</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
                <con2:replace contents-only="true" varName="header">
                  <con1:id>_ActionId-424218776797984113--110cde23.15820b9c7a7.-7cb7</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/PagoTarjetaCredito/xq/pagoTCPAHeaderOut"/>
                      <con1:param name="outputParameters1">
                        <con1:path>$rp</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con5:wsCallout xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:id>_ActionId-424218776797984113--110cde23.15820b9c7a7.-7cc5</con2:id>
                <con5:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                <con5:operation>mapeoErrores</con5:operation>
                <con5:request>
                  <con5:body>$reqMapeoErrores</con5:body>
                </con5:request>
                <con5:response>
                  <con5:body>respMapeoErrores</con5:body>
                </con5:response>
                <con5:requestTransform>
                  <con5:assign varName="reqMapeoErrores">
                    <con2:id>_ActionId-424218776797984113--110cde23.15820b9c7a7.-7cc7</con2:id>
                    <con5:expr>
                      <con2:xqueryTransform>
                        <con2:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                        <con2:param name="MENSAJE_ERROR">
                          <con2:path>fn:upper-case($rp/ns0:ERROR_MESSAGE/text())</con2:path>
                        </con2:param>
                        <con2:param name="CODIGO_ERROR">
                          <con2:path>fn:concat("FICBCO0063","$#$",fn:string-join(fn:upper-case($rp/ns0:ERROR_CODE/text()), '||'))</con2:path>
                        </con2:param>
                      </con2:xqueryTransform>
                    </con5:expr>
                  </con5:assign>
                </con5:requestTransform>
                <con5:responseTransform>
                  <con5:replace contents-only="true" varName="header">
                    <con2:id>_ActionId-424218776797984113--110cde23.15820b9c7a7.-7cc6</con2:id>
                    <con5:expr>
                      <con2:xqueryTransform>
                        <con2:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                        <con2:param name="mapeoErroresResponse1">
                          <con2:path>$respMapeoErrores</con2:path>
                        </con2:param>
                        <con2:param name="successIndicator">
                          <con2:path>fn:upper-case($rp/ns0:ERROR_CODE/text())</con2:path>
                        </con2:param>
                      </con2:xqueryTransform>
                    </con5:expr>
                  </con5:replace>
                </con5:responseTransform>
              </con5:wsCallout>
              <con2:replace varName="body" contents-only="true">
                <con1:id>_ActionId-424218776797984113--110cde23.15820b9c7a7.-7cc1</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;pag:pagoTarjetaCreditoResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="NI01_PagoTarjetaCredito_request">
      <con:stage name="ConsultaParametros">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
        </con:context>
        <con:actions>
          <con2:assign varName="bancoOrigen">
            <con1:id>_ActionId-761262396148164090-fdfc10e.1646abc32bf.-7b85</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($header/aut:RequestHeader/Region/SourceBank/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:wsCallout>
            <con1:id>_ActionId-761262396148164090-fdfc10e.1646abc32bf.-7ee5</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>obtenerParametrizacion</con2:operation>
            <con2:request>
              <con2:body>$REQobtenerParametrizacion</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>RSPobtenerParametrizacion</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="canalParameter">
                <con1:id>_ActionId-761262396148164090-fdfc10e.1646abc32bf.-7e73</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:upper-case(fn:concat('FICBCO0063.',$header/aut:RequestHeader/Authentication/UserName/text(),'-',$header/aut:RequestHeader/Region/SourceBank/text(),'.CANAL'))</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="usuarioPOSParameter">
                <con1:id>_ActionId-761262396148164090-fdfc10e.1646abc32bf.-7e75</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:upper-case(fn:concat('FICBCO0063.',$header/aut:RequestHeader/Authentication/UserName/text(),'-',$header/aut:RequestHeader/Region/SourceBank/text(),'.USUARIOPOS'))</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="numComercioParameter">
                <con1:id>_ActionId-761262396148164090-fdfc10e.1646abc32bf.-7e39</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:upper-case(fn:concat('FICBCO0063.',$header/aut:RequestHeader/Authentication/UserName/text(),'-',$header/aut:RequestHeader/Region/SourceBank/text(),'.COMERCIO'))</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="tipoMCCParamName">
                <con1:id>_ActionId-7229932661116692329--368e565f.165b0d82502.-7fe2</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:concat(
	'FICBCO0063.',
	fn:upper-case(string($header/aut:RequestHeader/Region/SourceBank/text())),
	'.',
	fn:upper-case(string($header/aut:RequestHeader/Authentication/UserName/text())),
	'.TIPO_MCC'
)</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="tipoIndicadorParamName">
                <con1:id>_ActionId-7229932661116692329--368e565f.165b0d82502.-7fc5</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:concat(
	'FICBCO0063.',
	fn:upper-case(string($header/aut:RequestHeader/Region/SourceBank/text())),
	'.',
	fn:upper-case(string($header/aut:RequestHeader/Authentication/UserName/text())),
	'.TIPO_INDICADOR'
)</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="longTrack2ParamName">
                <con1:id>_ActionId-7229932661116692329--368e565f.165b0d82502.-7fa8</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:concat(
	'FICBCO0063.',
	fn:upper-case(string($header/aut:RequestHeader/Region/SourceBank/text())),
	'.',
	fn:upper-case(string($header/aut:RequestHeader/Authentication/UserName/text())),
	'.LONG_TRACK_2'
)</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="codVerificadorParamName">
                <con1:id>_ActionId-7229932661116692329--368e565f.165b0d82502.-7f8b</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:concat(
	'FICBCO0063.',
	fn:upper-case(string($header/aut:RequestHeader/Region/SourceBank/text())),
	'.',
	fn:upper-case(string($header/aut:RequestHeader/Authentication/UserName/text())),
	'.COD_VERIFICADOR_TC'
)</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="metodoPagoParamName">
                <con1:id>_ActionId-7229932661116692329--368e565f.165b0d82502.-7f53</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:concat(
	'FICBCO0063.',
	fn:upper-case(string($header/aut:RequestHeader/Region/SourceBank/text())),
	'.',
	fn:upper-case(string($header/aut:RequestHeader/Authentication/UserName/text())),
	'.METODO_PAGO'
)</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="REQobtenerParametrizacion">
                <con1:id>_ActionId-761262396148164090-fdfc10e.1646abc32bf.-7dfd</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                    <con1:param name="nombreParametros">
                      <con1:path>fn:concat($canalParameter, '||', $usuarioPOSParameter, '||', $numComercioParameter, '||', $tipoMCCParamName, '||', $tipoIndicadorParamName, '||', $longTrack2ParamName, '||', $codVerificadorParamName, '||', $metodoPagoParamName)</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:assign varName="canalOriginador">
                <con1:id>_ActionId-761262396148164090-fdfc10e.1646abc32bf.-7d53</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$canalParameter]/osb:VALUE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="usuarioPOS">
                <con1:id>_ActionId-761262396148164090-fdfc10e.1646abc32bf.-7d55</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$usuarioPOSParameter]/osb:VALUE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="numComercio">
                <con1:id>_ActionId-761262396148164090-fdfc10e.1646abc32bf.-7ce1</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$numComercioParameter]/osb:VALUE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="tipoMCC">
                <con1:id>_ActionId-7229932661116692329--368e565f.165b0d82502.-7f36</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$tipoMCCParamName]/osb:VALUE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="tipoIndicador">
                <con1:id>_ActionId-7229932661116692329--368e565f.165b0d82502.-7f19</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$tipoIndicadorParamName]/osb:VALUE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="longTrack2">
                <con1:id>_ActionId-7229932661116692329--368e565f.165b0d82502.-7ee1</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$longTrack2ParamName]/osb:VALUE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="codVerificadorTC">
                <con1:id>_ActionId-7229932661116692329--368e565f.165b0d82502.-7ec4</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$codVerificadorParamName]/osb:VALUE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="metodoPago">
                <con1:id>_ActionId-7229932661116692329--368e565f.165b0d82502.-7ea7</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$metodoPagoParamName]/osb:VALUE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="errorCode">
                <con1:id>_ActionId-761262396148164090-fdfc10e.1646abc32bf.-7ca3</con1:id>
                <con2:expr>
                  <con1:xqueryText>$RSPobtenerParametrizacion/osb:ERROR_CODE/text()</con1:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="validationMessage">
                <con1:id>_ActionId-761262396148164090-fdfc10e.1646abc32bf.-7c63</con1:id>
                <con2:expr>
                  <con1:xqueryText>$RSPobtenerParametrizacion/osb:ERROR_MESSAGE/text()</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:responseTransform>
          </con2:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="FlujoEntrada">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoTarjetaCreditoTypes" prefix="pag"/>
        </con:context>
        <con:actions>
          <con2:assign varName="isValidRequest">
            <con1:id>_ActionId-5638112967191110029-6071ea0d.15e6313a983.-7f9b</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/Business_Resources/tarjetaCredito/PagoTarjetaCredito/pagoTarjetaCreditoValidRequired"/>
                <con1:param name="pagoTarjetaCredito">
                  <con1:path>$body/pag:pagoTarjetaCredito</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:ifThenElse>
            <con1:id>_ActionId-5638112967191110029-6071ea0d.15e6313a983.-7f9a</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$isValidRequest = "true"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-5638112967191110029-6071ea0d.15e6313a983.-7f98</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/CTS/pagoTarjetaCredito/biz/pagoTarjetaCredito" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>OpPagoTarjetaCredito</con2:operation>
                  <con2:request>
                    <con2:body>$REQPagoTarjetaCredito</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPPagoTarjetaCredito</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQPagoTarjetaCredito">
                      <con1:id>_ActionId-5638112967191110029-6071ea0d.15e6313a983.-7f99</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/PagoTarjetaCredito/xq/pagoTCNIIn"/>
                          <con1:param name="longTrack2">
                            <con1:path>$longTrack2</con1:path>
                          </con1:param>
                          <con1:param name="tipoMCC">
                            <con1:path>$tipoMCC</con1:path>
                          </con1:param>
                          <con1:param name="canalOriginador">
                            <con1:path>$canalOriginador</con1:path>
                          </con1:param>
                          <con1:param name="metodoPago">
                            <con1:path>$metodoPago</con1:path>
                          </con1:param>
                          <con1:param name="pagoTarjetaCredito">
                            <con1:path>$body/pag:pagoTarjetaCredito</con1:path>
                          </con1:param>
                          <con1:param name="codVerificadorTC">
                            <con1:path>$codVerificadorTC</con1:path>
                          </con1:param>
                          <con1:param name="tipoIndicador">
                            <con1:path>$tipoIndicador</con1:path>
                          </con1:param>
                          <con1:param name="bancoOrigen">
                            <con1:path>$bancoOrigen</con1:path>
                          </con1:param>
                          <con1:param name="usuarioPOS">
                            <con1:path>$usuarioPOS</con1:path>
                          </con1:param>
                          <con1:param name="numComercio">
                            <con1:path>$numComercio</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                    <con2:validate>
                      <con1:id>_ActionId-2824769717176825227--42e55818.15e82574f1d.-7f7f</con1:id>
                      <con2:schema ref="Middleware/v2/BusinessServices/CTS/pagoTarjetaCredito/xsd/services"/>
                      <con2:schemaElement xmlns:ser1="http://service.srvaplcobistarjetacredito.ecobis.cobiscorp" xmlns:ser2="http://service.srvaplcobistarjetacreditov2.ecobis.cobiscorp">ser2:opPagoTarjetaCreditoSolicitud</con2:schemaElement>
                      <con2:varName>REQPagoTarjetaCredito</con2:varName>
                      <con2:location>
                        <con1:xpathText>.</con1:xpathText>
                      </con2:location>
                    </con2:validate>
                  </con2:requestTransform>
                  <con2:responseTransform/>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con1:skip>
                <con1:id>_ActionId-5638112967191110029-6071ea0d.15e6313a983.-7f97</con1:id>
              </con1:skip>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="NI01_PagoTarjetaCredito_response">
      <con:stage name="FlujoSalida">
        <con:context>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/pagoTarjetaCredito" prefix="ns0"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoTarjetaCreditoTypes" prefix="pag"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://service.srvaplcobistarjetacredito.ecobis.cobiscorp" prefix="ser"/>
          <con1:varNsDecl namespace="http://dto.srvaplcobisentidades.ecobis.cobiscorp" prefix="dto"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-2782591435371988554--1a5c4d0b.15e80a2c1e4.-7e52</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$isValidRequest = "true"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace contents-only="true" varName="header">
                  <con1:id>_ActionId-2782591435371988554--1a5c4d0b.15e80a2c1e4.-7e50</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/PagoTarjetaCredito/xq/pagoTCNIHeaderOut"/>
                      <con1:param name="opPagoTarjetaCreditoRespuesta">
                        <con1:path>$RSPPagoTarjetaCredito</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
                <con2:ifThenElse>
                  <con1:id>_ActionId-1421898244305258921-59df3307.15e81a70f93.-7ffa</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>fn:string($header/aut:ResponseHeader/successIndicator/text()) = 'Success'</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:replace contents-only="true" varName="body">
                        <con1:id>_ActionId-1421898244305258921-59df3307.15e81a70f93.-7ff9</con1:id>
                        <con2:expr>
                          <con1:xqueryTransform>
                            <con1:resource ref="Middleware/v2/Resources/PagoTarjetaCredito/xq/pagoTCNIOut"/>
                            <con1:param name="opPagoTarjetaCreditoRespuesta">
                              <con1:path>$RSPPagoTarjetaCredito</con1:path>
                            </con1:param>
                          </con1:xqueryTransform>
                        </con2:expr>
                      </con2:replace>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con2:replace varName="body" contents-only="true">
                      <con1:id>_ActionId-1421898244305258921-59df3307.15e81a70f93.-7ff5</con1:id>
                      <con2:expr>
                        <con1:xqueryText>&lt;pag:pagoTarjetaCreditoResponse/></con1:xqueryText>
                      </con2:expr>
                    </con2:replace>
                  </con2:default>
                </con2:ifThenElse>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:replace varName="Header" contents-only="true">
                <con1:id>_ActionId-2782591435371988554--1a5c4d0b.15e80a2c1e4.-7e18</con1:id>
                <con2:expr>
                  <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>ERROR READING PAYMENT PARAMETERS</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                </con2:expr>
              </con2:replace>
              <con2:replace varName="body" contents-only="true">
                <con1:id>_ActionId-1421898244305258921-59df3307.15e81a70f93.-7f8e</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;pag:pagoTarjetaCreditoResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="MapeoError">
        <con4:context xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con4:context>
        <con4:actions xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
          <con2:ifThenElse>
            <con1:id>_ActionId-1421898244305258921-59df3307.15e81a70f93.-7ea4</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) != "SUCCESS"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-1421898244305258921-59df3307.15e81a70f93.-7ea1</con1:id>
                  <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>mapeoErrores</con2:operation>
                  <con2:request>
                    <con2:body>$REQMapeoErrores</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPMapeoErrores</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQMapeoErrores">
                      <con1:id>_ActionId-1421898244305258921-59df3307.15e81a70f93.-7ea3</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                          <con1:param name="CODIGO_ERROR">
                            <con1:path>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text()))</con1:path>
                          </con1:param>
                          <con1:param name="MENSAJE_ERROR">
                            <con1:path>fn:concat("FICBCO0063","$#$",fn:string-join($header/aut:ResponseHeader/messages, '||'))</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:replace varName="header" contents-only="true">
                      <con1:id>_ActionId-1421898244305258921-59df3307.15e81a70f93.-7ea2</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                          <con1:param name="mapeoErroresResponse1">
                            <con1:path>$RSPMapeoErrores</con1:path>
                          </con1:param>
                          <con1:param name="successIndicator">
                            <con1:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:replace>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con4:actions>
      </con:stage>
    </con:pipeline>
    <con:flow>
      <con:pipeline-node name="ValidacionesGenerales">
        <con:request>ValidacionesGenerales_request</con:request>
        <con:response>ValidacionesGenerales_response</con:response>
      </con:pipeline-node>
      <con:branch-node type="condition" name="ValidacionCrucePaisEmpresa">
        <con:context/>
        <con:branch-table variable="areSameSourceAndDestination">
          <con:branch name="SameOriginAndDestination">
            <con:operator>equals</con:operator>
            <con:value>'YES'</con:value>
            <con:flow>
              <con:branch-node type="condition" name="RegionalizacionPaisEmpresa">
                <con:context>
                  <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                </con:context>
                <con:branch-table variable="header">
                  <con:xpath>
                    <con1:xpathText>./aut:RequestHeader/Region/SourceBank</con1:xpathText>
                  </con:xpath>
                  <con:branch name="HN01">
                    <con:operator>equals</con:operator>
                    <con:value>'HN01'</con:value>
                    <con:flow>
                      <con:pipeline-node name="HN01_PagoTarjetaCredito">
                        <con:request>HN01_PagoTarjetaCredito_request</con:request>
                        <con:response>HN01_PagoTarjetaCredito_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:branch name="GT01">
                    <con:operator>equals</con:operator>
                    <con:value>'GT01'</con:value>
                    <con:flow>
                      <con:pipeline-node name="GT01_PagoTarjetaCredito">
                        <con:request>GT01_PagoTarjetaCredito_request</con:request>
                        <con:response>GT01_PagoTarjetaCredito_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:branch name="PA01">
                    <con:operator>equals</con:operator>
                    <con:value>'PA01'</con:value>
                    <con:flow>
                      <con:pipeline-node name="PA01_PagoTarjetaCredito">
                        <con:request>PA01_PagoTarjetaCredito_request</con:request>
                        <con:response>PA01_PagoTarjetaCredito_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:branch name="NI01">
                    <con:operator>equals</con:operator>
                    <con:value>'NI01'</con:value>
                    <con:flow>
                      <con:pipeline-node name="NI01_PagoTarjetaCredito">
                        <con:request>NI01_PagoTarjetaCredito_request</con:request>
                        <con:response>NI01_PagoTarjetaCredito_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:default-branch>
                    <con:flow>
                      <con:pipeline-node name="Default_PagoTarjetaCredito">
                        <con:request>Default_PagoTarjetaCredito_request</con:request>
                        <con:response>Default_PagoTarjetaCredito_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:default-branch>
                </con:branch-table>
              </con:branch-node>
            </con:flow>
          </con:branch>
          <con:default-branch>
            <con:flow>
              <con:pipeline-node name="RegionalizacionPaisEmpresa_ConCruce">
                <con:request>RegionalizacionPaisEmpresa_ConCruce_request</con:request>
                <con:response>RegionalizacionPaisEmpresa_ConCruce_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:default-branch>
        </con:branch-table>
      </con:branch-node>
    </con:flow>
  </ser:router>
</xml-fragment>