<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:con="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/pipeline/config">
  <ser:coreEntry isProxy="true" isEnabled="true" isTracingEnabled="false">
    <ser:binding type="SOAP" isSoap12="false" xsi:type="con3:SoapBindingType" xmlns:con3="http://www.bea.com/wli/sb/services/bindings/config">
      <con3:wsdl ref="Middleware/v3/Resources/PagoRecaudo/wsdl/pagoRecaudoPS"/>
      <con3:port>
        <con3:name>pagoRecaudoPSSOAP</con3:name>
        <con3:namespace>http://www.ficohsa.com.hn/middleware.services/pagoRecaudo/</con3:namespace>
      </con3:port>
      <con3:selector type="SOAP body"/>
      <con3:WSI-compliant>false</con3:WSI-compliant>
    </ser:binding>
    <ser:monitoring isEnabled="false">
      <ser:aggregationInterval>10</ser:aggregationInterval>
      <ser:pipelineMonitoringLevel>Pipeline</ser:pipelineMonitoringLevel>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
  </ser:coreEntry>
  <ser:endpointConfig>
    <tran:provider-id>local</tran:provider-id>
    <tran:inbound>true</tran:inbound>
    <tran:inbound-properties/>
    <tran:all-headers>true</tran:all-headers>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-6146410222775222576-47c13343.1661136ad8f.-78f8">
    <con:pipeline type="request" name="Default_PagoRecaudoPA_request" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="FlujoEntrada">
        <con:context/>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="Default_PagoRecaudoPA_response" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="FlujoSalida">
        <con:context/>
        <con:actions>
          <con1:Error>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7e0b</con2:id>
            <con1:errCode>MW-0008</con1:errCode>
            <con1:message>PAYMENT_METHOD NOT IMPLEMENTED YET FOR THIS COUNTRY/COMPANY</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="Operaciones_ACCT_DEBIT_request" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="BitacoraRequest">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:assign varName="uuidBitacoraRequest">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7d31</con2:id>
            <con1:expr>
              <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
              </con2:xqueryTransform>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="originalBody">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7d14</con2:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="originalHeader">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7cf7</con2:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$header</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:route xmlns:con1="http://www.bea.com/wli/sb/stages/publish/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7cdb</con2:id>
            <con1:service ref="Middleware/v2/BusinessServices/OSB/RegistrarBitacoraOSB_v2/biz/RegistrarBitacoraOSB_v2" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>registrarBitacoraOSB</con1:operation>
            <con1:outboundTransform>
              <con2:replace contents-only="true" varName="body" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7c6d</con3:id>
                <con2:location>
                  <con3:xpathText xmlns:con3="http://www.bea.com/wli/sb/stages/config">.</con3:xpathText>
                </con2:location>
                <con2:expr>
                  <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                    <con3:resource ref="Middleware/v2/Resources/Generales/xq/registrarBitacoraOSBIn"/>
                    <con3:param name="UuidReq">
                      <con3:path>""</con3:path>
                    </con3:param>
                    <con3:param name="IdOsb">
                      <con3:path>fn:string($inbound/ctx:transport/ctx:request/tp:headers/tp:user-header[@name='Host']/@value)</con3:path>
                    </con3:param>
                    <con3:param name="Uuid">
                      <con3:path>$uuidBitacoraRequest</con3:path>
                    </con3:param>
                    <con3:param name="BancoDestino">
                      <con3:path>string($header/aut:RequestHeader/Region/DestinationBank/text())</con3:path>
                    </con3:param>
                    <con3:param name="Contenido">
                      <con3:path>$body</con3:path>
                    </con3:param>
                    <con3:param name="BancoOrigen">
                      <con3:path>string($header/aut:RequestHeader/Region/SourceBank/text())</con3:path>
                    </con3:param>
                    <con3:param name="Usuario">
                      <con3:path>string($header/aut:RequestHeader/Authentication/UserName/text())</con3:path>
                    </con3:param>
                    <con3:param name="IdServicio">
                      <con3:path>"FICBCO0067"</con3:path>
                    </con3:param>
                    <con3:param name="IdOperacion">
                      <con3:path>fn:string($operation)</con3:path>
                    </con3:param>
                    <con3:param name="Resultado">
                      <con3:path>""</con3:path>
                    </con3:param>
                    <con3:param name="IdTxn">
                      <con3:path>""</con3:path>
                    </con3:param>
                    <con3:param name="TipoMensaje">
                      <con3:path>"REQ"</con3:path>
                    </con3:param>
                    <con3:param name="FechaTxn">
                      <con3:path>current-date()</con3:path>
                    </con3:param>
                    <con3:param name="MensajeError">
                      <con3:path>""</con3:path>
                    </con3:param>
                  </con3:xqueryTransform>
                </con2:expr>
              </con2:replace>
            </con1:outboundTransform>
          </con1:route>
        </con:actions>
      </con:stage>
      <con:stage name="LoginTelered">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/loginTeleredTypes" prefix="log" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:assign varName="validationMessage">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2954934501316854644--2df2b69b.166d4cbc916.-7f6b</con2:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">let $amount := fn:string($body/pag:pagoRecaudo/PAYMENT_INFORMATION/PAYMENT_AMOUNT/text())
return
(
	if(string(number($amount))!= 'NaN' and fn:string-length(fn:string(fn:substring-after($amount,'.'))) = 2)then
	(
		''
	)else(
		'ERROR:El monto no es valido'
	)
)</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5427297470998962245--5308b897.166d129bfe2.-7df0</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage = ""</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5427297470998962245--5308b897.166d129bfe2.-7de2</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/LoginTelered" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>loginTelered</con1:operation>
                  <con1:request>
                    <con1:body>$REQloginTelered</con1:body>
                    <con1:header>$REQHloginTelered</con1:header>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPloginTelered</con1:body>
                    <con1:header>RSPHloginTelered</con1:header>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:transport-headers copy-all="true">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5427297470998962245--5308b897.166d129bfe2.-7de7</con2:id>
                      <con1:header-set>outbound-request</con1:header-set>
                    </con1:transport-headers>
                    <con1:assign varName="REQloginTelered">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5427297470998962245--5308b897.166d129bfe2.-7de6</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/loginTeleredIn"/>
                          <con2:param name="channel">
                            <con2:path>''</con2:path>
                          </con2:param>
                          <con2:param name="forceNewSession">
                            <con2:path>false()</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="REQHloginTelered">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5427297470998962245--5308b897.166d129bfe2.-7de5</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$header</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5427297470998962245--5308b897.166d129bfe2.-7de4</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPHloginTelered/aut:ResponseHeader/successIndicator/text())</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5427297470998962245--5308b897.166d129bfe2.-7de3</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = 'Success') then(
	''
)
else(
	string($RSPHloginTelered/aut:ResponseHeader/messages/text())
)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="ValidarInformacionPago">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/validarInformacionPago" prefix="val" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7449</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7441</con2:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/TercerosPA/validarInformacionPago/biz/validarInformacionPago_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>validarInformacionPago</con1:operation>
                  <con1:request>
                    <con1:body>$REQvalidarInformacionPago</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPvalidarInformacionPago</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQvalidarInformacionPago">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7444</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/validarInformacionPagoIn"/>
                          <con2:param name="pagoRecaudo">
                            <con2:path>$body/pag:pagoRecaudo</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7443</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPvalidarInformacionPago/val:PV_CODIGOMENSAJE/text())</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7442</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = 'SUCCESS') then(
	''
)
else(
	fn:string($RSPvalidarInformacionPago/val:PV_DESCRIPCIONMENSAJE/text())
)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="ObtenerSecuencia">
        <con:context>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerSecuencia" prefix="obt" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7409</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7401</con2:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/obtenerSecuencia/biz/obtenerSecuencia_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>obtenerSecuencia</con1:operation>
                  <con1:request>
                    <con1:body>$REQobtenerSecuencia</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPobtenerSecuencia</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQobtenerSecuencia">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7404</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/Generales/xq/obtenerSecuenciaIn"/>
                          <con2:param name="sequenceType">
                            <con2:path>"ACT_AGR_PAYMENT"</con2:path>
                          </con2:param>
                          <con2:param name="seed">
                            <con2:path>''</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7403</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPobtenerSecuencia/obt:PV_CODIGO_ERROR/text())</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7402</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = 'SUCCESS') then(
	''
)
else(
	fn:string($RSPobtenerSecuencia/obt:PV_MENSAJE_ERROR/text())
)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="ArmarPagoRecaudo">
        <con:context>
          <con2:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/validarInformacionPago" prefix="val" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/loginTeleredTypes" prefix="log" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerSecuencia" prefix="obt" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/armarPagoRecaudo" prefix="arm" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2301472116672623833--59b0eac7.1680eee397b.-7ffb</con3:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2301472116672623833--59b0eac7.1680eee397b.-7ff7</con3:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/TercerosPA/armarPagoRecaudo/biz/armarPagoRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>armarPagoRecaudo</con1:operation>
                  <con1:request>
                    <con1:body>$REQarmarPagoRecaudo</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSParmarPagoRecaudo</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQarmarPagoRecaudo">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2301472116672623833--59b0eac7.1680eee397b.-7ffa</con3:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/armarPagoRecaudoIn"/>
                          <con2:param name="usuario">
                            <con2:path>fn:string($header/aut:RequestHeader/Authentication/UserName/text())</con2:path>
                          </con2:param>
                          <con2:param name="pagoRecaudo">
                            <con2:path>$body/pag:pagoRecaudo</con2:path>
                          </con2:param>
                          <con2:param name="sesion">
                            <con2:path>fn:string($RSPloginTelered/log:SESSION_ID/text())</con2:path>
                          </con2:param>
                          <con2:param name="tipoProducto">
                            <con2:path>fn:string($RSPvalidarInformacionPago/val:PV_APLICACION/text())</con2:path>
                          </con2:param>
                          <con2:param name="secuenciaPago">
                            <con2:path>fn:string($RSPobtenerSecuencia/obt:PV_SECUENCIA/text())</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2301472116672623833--59b0eac7.1680eee397b.-7ff9</con3:id>
                      <con1:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">string($RSParmarPagoRecaudo/arm:PV_CODIGOMENSAJE/text())</con3:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2301472116672623833--59b0eac7.1680eee397b.-7ff8</con3:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = 'SUCCESS') then(
	''
)else(
	fn:string($RSParmarPagoRecaudo/arm:PV_DESCRIPCIONMENSAJE/text())
)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="PignoracionSaldoRecaudo">
        <con:context>
          <con3:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/armarPagoRecaudo" prefix="arm" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerSecuencia" prefix="obt" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/AplicaCargoCuenta" prefix="apl" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/pignoracionSaldoRecaudo" prefix="pig" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/validarInformacionPago" prefix="val" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-73c9</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:assign varName="total">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-2a81</con3:id>
                  <con1:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">let $response := fn:string($RSParmarPagoRecaudo/arm:PC_REQUESTXML/text())
let $responseXML := fn-bea:inlinedXML($response)
return
	fn:string($responseXML/total/text())</con3:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:assign varName="bodyImpuesto">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-4187598656590165295-2a5a3916.168385d8bfa.-4a45</con3:id>
                  <con1:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$body</con3:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:replace contents-only="true" varName="bodyImpuesto">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-2a49</con3:id>
                  <con1:location>
                    <con3:xpathText xmlns:con3="http://www.bea.com/wli/sb/stages/config">./pag:pagoRecaudo/PAYMENT_INFORMATION/PAYMENT_AMOUNT</con3:xpathText>
                  </con1:location>
                  <con1:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$total</con3:xqueryText>
                  </con1:expr>
                </con1:replace>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2932167084375352697--1eed2fc4.166b0ed78a6.-7f93</con2:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABKPA/pignoracionSaldoRecaudo/biz/pignoracionSaldoRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>pignoracionSaldoRecaudo</con1:operation>
                  <con1:request>
                    <con1:body>$REQpignoracionSaldoRecaudo</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPpignoracionSaldoRecaudo</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="descripcion">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2168198399325066331--4f7715be.1670e9fa0a4.-7fc9</con2:id>
                      <con1:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">let $cobranza:= string($RSPvalidarInformacionPago/val:PV_NOMBRECOBRANZA/text())
let $debtorCode:= string($body/pag:pagoRecaudo/DEBTOR_CODE/text())
	return
		fn:concat('Pago ', $cobranza, ' CÃ³digo de Deudor ', $debtorCode)</con3:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="REQpignoracionSaldoRecaudo">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2932167084375352697--1eed2fc4.166b0ed78a6.-7eb5</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/pignoracionSaldoRecaudoIn"/>
                          <con2:param name="secuencia">
                            <con2:path>fn:string($RSPobtenerSecuencia/obt:PV_SECUENCIA/text())</con2:path>
                          </con2:param>
                          <con2:param name="pagoRecaudo">
                            <con2:path>$bodyImpuesto/pag:pagoRecaudo</con2:path>
                          </con2:param>
                          <con2:param name="descripcion">
                            <con2:path>$descripcion</con2:path>
                          </con2:param>
                          <con2:param name="validarInformacionPago">
                            <con2:path>$RSPvalidarInformacionPago</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2932167084375352697--1eed2fc4.166b0ed78a6.-7e44</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPpignoracionSaldoRecaudo/pig:PV_CODIGOMENSAJE/text())</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2932167084375352697--1eed2fc4.166b0ed78a6.-7e43</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode != 'SUCCESS')then(
	fn:string($RSPpignoracionSaldoRecaudo/pig:PV_DESCRIPCIONMENSAJE/text())
)else('')</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="EnrutadorTelered" errorHandler="_onErrorHandler-2301472116672623833--59b0eac7.1680eee397b.-7fbf">
        <con:context>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/armarPagoRecaudo" prefix="arm" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-704b</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7013</con2:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/Telered/EnrutadorTelered/biz/enrutadorTelered" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>PayBill</con1:operation>
                  <con1:request>
                    <con1:body>$REQPayBill</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPPayBill</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQPayBill">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-6fdb</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn-bea:inlinedXML(fn:string($RSParmarPagoRecaudo/arm:PC_REQUESTXML/text()))</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-6fa3</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPPayBill/error/codigo/text())</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-6f86</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = '' or $errorCode= '0') then(
	 ''
) else(
	fn:string($RSPPayBill/error/descripcion/text())
	
)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="ValidaCodigoErrorParaLoginTelered" errorHandler="_onErrorHandler-2301472116672623833--59b0eac7.1680eee397b.-7fbe">
        <con:context>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/loginTeleredTypes" prefix="log" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/armarPagoRecaudo" prefix="arm" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://dto.eis.pasarela.hubpagos.bytesw.com/" prefix="dto" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-6f18</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$errorCode = ('100001301','100001302')</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:assign varName="channel">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7ead</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPloginTelered/log:CHANNEL/text())</con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7fc9</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/LoginTelered" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>loginTelered</con1:operation>
                  <con1:request>
                    <con1:body>$REQloginTelered</con1:body>
                    <con1:header>$REQHloginTelered</con1:header>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPloginTelered</con1:body>
                    <con1:header>RSPHloginTelered</con1:header>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:transport-headers copy-all="true">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7f59</con2:id>
                      <con1:header-set>outbound-request</con1:header-set>
                    </con1:transport-headers>
                    <con1:assign varName="REQloginTelered">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7f91</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/loginTeleredIn"/>
                          <con2:param name="channel">
                            <con2:path>$channel</con2:path>
                          </con2:param>
                          <con2:param name="forceNewSession">
                            <con2:path>true()</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="REQHloginTelered">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7f3c</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$header</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7f04</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPHloginTelered/aut:ResponseHeader/successIndicator/text())</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7ee7</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = 'Success') then(
	''
)
else(
	string($RSPHloginTelered/aut:ResponseHeader/messages/text())
)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
                <con1:ifThenElse>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7e75</con2:id>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7dac</con2:id>
                        <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/Telered/EnrutadorTelered/biz/enrutadorTelered" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>PayBill</con1:operation>
                        <con1:request>
                          <con1:body>$REQPayBill</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>RSPPayBill</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="REQPayBill">
                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7da8</con2:id>
                            <con1:expr>
                              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn-bea:inlinedXML(fn:string($RSParmarPagoRecaudo/arm:PC_REQUESTXML/text()))</con2:xqueryText>
                            </con1:expr>
                          </con1:assign>
                          <con1:replace contents-only="true" varName="REQPayBill">
                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7da6</con2:id>
                            <con1:location>
                              <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">./sesionId</con2:xpathText>
                            </con1:location>
                            <con1:expr>
                              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPloginTelered/log:SESSION_ID/text())</con2:xqueryText>
                            </con1:expr>
                          </con1:replace>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:assign varName="errorCode">
                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7664524929006076546-49fcc2b5.1665fda2ca7.-7fa7</con2:id>
                            <con1:expr>
                              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPPayBill/error/codigo/text())</con2:xqueryText>
                            </con1:expr>
                          </con1:assign>
                          <con1:assign varName="validationMessage">
                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7664524929006076546-49fcc2b5.1665fda2ca7.-7f96</con2:id>
                            <con1:expr>
                              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = '' or $errorCode= '0') then(
	 ''
) else(
	fn:string($RSPPayBill/error/descripcion/text())
	
)</con2:xqueryText>
                            </con1:expr>
                          </con1:assign>
                        </con1:responseTransform>
                      </con1:wsCallout>
                    </con1:actions>
                  </con1:case>
                  <con1:default/>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="DespignoracionSaldoRecaudo">
        <con:context>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/despignoracionSaldoRecaudo" prefix="des" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerSecuencia" prefix="obt" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/pignoracionSaldoRecaudo" prefix="pig" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7d00</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">let $pignoracion := fn:string($RSPpignoracionSaldoRecaudo/pig:PV_CODIGOMENSAJE/text())
	return
		$pignoracion = 'SUCCESS'</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2932167084375352697--1eed2fc4.166b0ed78a6.-7f23</con2:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABKPA/despignoracionSaldoRecaudo/biz/despignoracionSaldoRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>despignoracionSaldoRecaudo</con1:operation>
                  <con1:request>
                    <con1:body>$REQdespignoracionSaldoRecaudo</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPdespignoracionSaldoRecaudo</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQdespignoracionSaldoRecaudo">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2932167084375352697--1eed2fc4.166b0ed78a6.-7dce</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/despignoracionSaldoRecaudoIn"/>
                          <con2:param name="codigoErrorTelered">
                            <con2:path>$errorCode</con2:path>
                          </con2:param>
                          <con2:param name="pagoRecaudo">
                            <con2:path>$bodyImpuesto/pag:pagoRecaudo</con2:path>
                          </con2:param>
                          <con2:param name="validarInformacionPago">
                            <con2:path>$RSPvalidarInformacionPago</con2:path>
                          </con2:param>
                          <con2:param name="codigoPignoracion">
                            <con2:path>fn:string($RSPpignoracionSaldoRecaudo/pig:PN_CODIGOPIGNORACION/text())</con2:path>
                          </con2:param>
                          <con2:param name="secuenciaPago">
                            <con2:path>fn:string($RSPobtenerSecuencia/obt:PV_SECUENCIA/text())</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2932167084375352697--1eed2fc4.166b0ed78a6.-7e08</con2:id>
                      <con1:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($RSPdespignoracionSaldoRecaudo/des:PV_CODIGOMENSAJE/text())</con3:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2932167084375352697--1eed2fc4.166b0ed78a6.-7e07</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode != 'SUCCESS')then(
	fn:string($RSPdespignoracionSaldoRecaudo/des:PV_DESCRIPCIONMENSAJE/text())
)else('')</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="RegistrarPagoRecuado">
        <con:context>
          <con3:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/despignoracionSaldoRecaudo" prefix="des" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerSecuencia" prefix="obt" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/armarPagoRecaudo" prefix="arm" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/registrarPagoRecaudo" prefix="reg" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-9060020410048637060--241ff629.1667ed1ab36.-7f74</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-9060020410048637060--241ff629.1667ed1ab36.-7f4b</con2:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/TercerosPA/registrarPagoRecaudo/biz/registrarPagoRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>registrarPagoRecaudo</con1:operation>
                  <con1:request>
                    <con1:body>$REQregistrarPagoRecaudo</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPregistrarPagoRecaudo</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQregistrarPagoRecaudo">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-9060020410048637060--241ff629.1667ed1ab36.-7f12</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/registrarPagoRecaudoIn"/>
                          <con2:param name="pagoRecaudo">
                            <con2:path>$body/pag:pagoRecaudo</con2:path>
                          </con2:param>
                          <con2:param name="responseXML">
                            <con2:path>$RSPPayBill</con2:path>
                          </con2:param>
                          <con2:param name="Pv_SecuenciaConsulta">
                            <con2:path>fn:string($RSParmarPagoRecaudo/arm:PV_SECUENCIACONSULTA/text())</con2:path>
                          </con2:param>
                          <con2:param name="Pv_SecuenciaPago">
                            <con2:path>fn:string($RSPobtenerSecuencia/obt:PV_SECUENCIA/text())</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-9060020410048637060--241ff629.1667ed1ab36.-7ea0</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPregistrarPagoRecaudo/reg:PV_CODIGOMENSAJE/text())</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-9060020410048637060--241ff629.1667ed1ab36.-7ea2</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = "SUCCESS")then(
	''
)else(
	fn:string($RSPregistrarPagoRecaudo/reg:PV_DESCRIPCIONMENSAJE/text())
	
)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="Operaciones_ACCT_DEBIT_response" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="FlujoSalida">
        <con:context>
          <con2:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerSecuencia" prefix="obt" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-9060020410048637060--241ff629.1667ed1ab36.-7e32</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage = ""</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:replace varName="header" contents-only="true">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-9060020410048637060--241ff629.1667ed1ab36.-7d8a</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<aut:ResponseHeader>
      <transactionId>{fn:string($RSPobtenerSecuencia/obt:PV_SECUENCIA/text())}</transactionId>
      <successIndicator>Success</successIndicator>
</aut:ResponseHeader>]]></con2:xqueryText>
                  </con1:expr>
                </con1:replace>
                <con1:replace varName="body" contents-only="true">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7d9d</con2:id>
                  <con1:expr>
                    <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                      <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/pagoRecaudoPAOut"/>
                      <con2:param name="pagoRecaudo">
                        <con2:path>$bodyImpuesto/pag:pagoRecaudo</con2:path>
                      </con2:param>
                      <con2:param name="validarInformacionPago">
                        <con2:path>$RSPvalidarInformacionPago</con2:path>
                      </con2:param>
                      <con2:param name="registrarPagoRecaudo">
                        <con2:path>$RSPregistrarPagoRecaudo</con2:path>
                      </con2:param>
                    </con2:xqueryTransform>
                  </con1:expr>
                </con1:replace>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:replace varName="header" contents-only="true">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7f5b</con2:id>
                <con1:expr>
                  <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<aut:ResponseHeader>
      <successIndicator>{$errorCode}</successIndicator>
      <messages>{ $validationMessage }</messages>
</aut:ResponseHeader>]]></con2:xqueryText>
                </con1:expr>
              </con1:replace>
              <con1:replace varName="body" contents-only="true">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7f3e</con2:id>
                <con1:expr>
                  <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;pag:pagoRecaudoResponse/></con2:xqueryText>
                </con1:expr>
              </con1:replace>
            </con1:default>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="MapeoError">
        <con:context>
          <con2:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3513093643520043769--748d29e3.167331ef003.-5955</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) != "SUCCESS"</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3513093643520043769--748d29e3.167331ef003.-591d</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>mapeoErrores</con1:operation>
                  <con1:request>
                    <con1:body>$REQMapeoErrores</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPMapeoErrores</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQMapeoErrores">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3513093643520043769--748d29e3.167331ef003.-58e5</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                          <con2:param name="MENSAJE_ERROR">
                            <con2:path>fn:concat("FICBCO0067","$#$",fn:string-join($header/aut:ResponseHeader/messages, '||'))</con2:path>
                          </con2:param>
                          <con2:param name="CODIGO_ERROR">
                            <con2:path>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text()))</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:replace contents-only="true" varName="header">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3513093643520043769--748d29e3.167331ef003.-58ad</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                          <con2:param name="mapeoErroresResponse1">
                            <con2:path>$RSPMapeoErrores</con2:path>
                          </con2:param>
                          <con2:param name="successIndicator">
                            <con2:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:replace>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="BitacoraResponse">
        <con4:context xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
          <con4:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con4="http://www.bea.com/wli/sb/stages/config"/>
          <con4:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con4="http://www.bea.com/wli/sb/stages/config"/>
        </con4:context>
        <con4:actions xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
          <con2:ifThenElse>
            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7ec9</con4:id>
            <con2:case>
              <con2:condition>
                <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($uuidBitacoraRequest) !=''</con4:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:assign varName="uuidBitacoraResponse">
                  <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7ec8</con4:id>
                  <con2:expr>
                    <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                      <con4:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                    </con4:xqueryTransform>
                  </con2:expr>
                </con2:assign>
                <con3:route>
                  <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7ec7</con4:id>
                  <con3:service ref="Middleware/v2/BusinessServices/OSB/RegistrarBitacoraOSB_v2/biz/RegistrarBitacoraOSB_v2" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>registrarBitacoraOSB</con3:operation>
                  <con3:outboundTransform>
                    <con2:replace contents-only="true" varName="body">
                      <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7ec6</con4:id>
                      <con2:location>
                        <con4:xpathText xmlns:con4="http://www.bea.com/wli/sb/stages/config">.</con4:xpathText>
                      </con2:location>
                      <con2:expr>
                        <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                          <con4:resource ref="Middleware/v2/Resources/Generales/xq/registrarBitacoraOSBIn"/>
                          <con4:param name="UuidReq">
                            <con4:path>$uuidBitacoraRequest</con4:path>
                          </con4:param>
                          <con4:param name="IdOsb">
                            <con4:path>fn:string($inbound/ctx:transport/ctx:request/tp:headers/tp:user-header[@name='Host']/@value)</con4:path>
                          </con4:param>
                          <con4:param name="Uuid">
                            <con4:path>$uuidBitacoraResponse</con4:path>
                          </con4:param>
                          <con4:param name="Contenido">
                            <con4:path>$body</con4:path>
                          </con4:param>
                          <con4:param name="Usuario">
                            <con4:path>string($originalHeader/aut:RequestHeader/Authentication/UserName/text())</con4:path>
                          </con4:param>
                          <con4:param name="FechaTxn">
                            <con4:path>current-date()</con4:path>
                          </con4:param>
                          <con4:param name="MensajeError">
                            <con4:path>fn:string($header/aut:ResponseHeader/messages/text())</con4:path>
                          </con4:param>
                          <con4:param name="BancoDestino">
                            <con4:path>string($originalHeader/aut:RequestHeader/Region/DestinationBank/text())</con4:path>
                          </con4:param>
                          <con4:param name="BancoOrigen">
                            <con4:path>string($originalHeader/aut:RequestHeader/Region/SourceBank/text())</con4:path>
                          </con4:param>
                          <con4:param name="IdOperacion">
                            <con4:path>fn:string($operation)</con4:path>
                          </con4:param>
                          <con4:param name="Resultado">
                            <con4:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con4:path>
                          </con4:param>
                          <con4:param name="IdServicio">
                            <con4:path>"FICBCO0067"</con4:path>
                          </con4:param>
                          <con4:param name="IdTxn">
                            <con4:path>fn:string($header/aut:ResponseHeader/transactionId/text())</con4:path>
                          </con4:param>
                          <con4:param name="TipoMensaje">
                            <con4:path>"RSP"</con4:path>
                          </con4:param>
                        </con4:xqueryTransform>
                      </con2:expr>
                    </con2:replace>
                  </con3:outboundTransform>
                </con3:route>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con4:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="Operaciones_CREDIT_CARD_request" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="BitacoraRequest">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:assign varName="uuidBitacoraRequest">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7a1a</con2:id>
            <con1:expr>
              <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
              </con2:xqueryTransform>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="originalBody">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7a19</con2:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="originalHeader">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7a18</con2:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$header</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:route xmlns:con1="http://www.bea.com/wli/sb/stages/publish/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7a17</con2:id>
            <con1:service ref="Middleware/v2/BusinessServices/OSB/RegistrarBitacoraOSB_v2/biz/RegistrarBitacoraOSB_v2" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>registrarBitacoraOSB</con1:operation>
            <con1:outboundTransform>
              <con2:replace contents-only="true" varName="body" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7a16</con3:id>
                <con2:location>
                  <con3:xpathText xmlns:con3="http://www.bea.com/wli/sb/stages/config">.</con3:xpathText>
                </con2:location>
                <con2:expr>
                  <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                    <con3:resource ref="Middleware/v2/Resources/Generales/xq/registrarBitacoraOSBIn"/>
                    <con3:param name="UuidReq">
                      <con3:path>""</con3:path>
                    </con3:param>
                    <con3:param name="IdOsb">
                      <con3:path>fn:string($inbound/ctx:transport/ctx:request/tp:headers/tp:user-header[@name='Host']/@value)</con3:path>
                    </con3:param>
                    <con3:param name="Uuid">
                      <con3:path>$uuidBitacoraRequest</con3:path>
                    </con3:param>
                    <con3:param name="BancoDestino">
                      <con3:path>string($header/aut:RequestHeader/Region/DestinationBank/text())</con3:path>
                    </con3:param>
                    <con3:param name="Contenido">
                      <con3:path>$body</con3:path>
                    </con3:param>
                    <con3:param name="BancoOrigen">
                      <con3:path>string($header/aut:RequestHeader/Region/SourceBank/text())</con3:path>
                    </con3:param>
                    <con3:param name="Usuario">
                      <con3:path>string($header/aut:RequestHeader/Authentication/UserName/text())</con3:path>
                    </con3:param>
                    <con3:param name="IdServicio">
                      <con3:path>"FICBCO0067"</con3:path>
                    </con3:param>
                    <con3:param name="IdOperacion">
                      <con3:path>fn:string($operation)</con3:path>
                    </con3:param>
                    <con3:param name="Resultado">
                      <con3:path>""</con3:path>
                    </con3:param>
                    <con3:param name="IdTxn">
                      <con3:path>""</con3:path>
                    </con3:param>
                    <con3:param name="TipoMensaje">
                      <con3:path>"REQ"</con3:path>
                    </con3:param>
                    <con3:param name="FechaTxn">
                      <con3:path>current-date()</con3:path>
                    </con3:param>
                    <con3:param name="MensajeError">
                      <con3:path>""</con3:path>
                    </con3:param>
                  </con3:xqueryTransform>
                </con2:expr>
              </con2:replace>
            </con1:outboundTransform>
          </con1:route>
        </con:actions>
      </con:stage>
      <con:stage name="LoginTelered">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/loginTeleredTypes" prefix="log" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:assign varName="validationMessage">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5353235221004373628-5f1bb099.166eebc9211.-7cd9</con2:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">let $amount := fn:string($body/pag:pagoRecaudo/PAYMENT_INFORMATION/PAYMENT_AMOUNT/text())
return
(
	if(string(number($amount))!= 'NaN' and fn:string-length(fn:string(fn:substring-after($amount,'.'))) = 2)then
	(
		''
	)else(
		'ERROR:El monto no es valido.'
	)
)</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5353235221004373628-5f1bb099.166eebc9211.-7ce7</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5353235221004373628-5f1bb099.166eebc9211.-7cdb</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/LoginTelered" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>loginTelered</con1:operation>
                  <con1:request>
                    <con1:body>$REQloginTelered</con1:body>
                    <con1:header>$REQHloginTelered</con1:header>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPloginTelered</con1:body>
                    <con1:header>RSPHloginTelered</con1:header>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:transport-headers copy-all="true">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5353235221004373628-5f1bb099.166eebc9211.-7ce0</con2:id>
                      <con1:header-set>outbound-request</con1:header-set>
                    </con1:transport-headers>
                    <con1:assign varName="REQloginTelered">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5353235221004373628-5f1bb099.166eebc9211.-7cdf</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/loginTeleredIn"/>
                          <con2:param name="channel">
                            <con2:path>''</con2:path>
                          </con2:param>
                          <con2:param name="forceNewSession">
                            <con2:path>false()</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="REQHloginTelered">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5353235221004373628-5f1bb099.166eebc9211.-7cde</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$header</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5353235221004373628-5f1bb099.166eebc9211.-7cdd</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">let $errorCode:= fn:string($RSPHloginTelered/aut:ResponseHeader/successIndicator/text())
 return
 	if($errorCode = 'Success') then(
		$errorCode
  	)else(
		fn:concat('TELERED_',$errorCode)
  	)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5353235221004373628-5f1bb099.166eebc9211.-7cdc</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = 'Success') then(
	''
)
else(
	string($RSPHloginTelered/aut:ResponseHeader/messages/text())
)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="ValidarInformacionPago">
        <con:context>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/validarInformacionPago" prefix="val" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7c5a</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7c22</con2:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/TercerosPA/validarInformacionPago/biz/validarInformacionPago_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>validarInformacionPago</con1:operation>
                  <con1:request>
                    <con1:body>$REQvalidarInformacionPago</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPvalidarInformacionPago</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQvalidarInformacionPago">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7bea</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/validarInformacionPagoIn"/>
                          <con2:param name="pagoRecaudo">
                            <con2:path>$body/pag:pagoRecaudo</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7bb2</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPvalidarInformacionPago/val:PV_CODIGOMENSAJE/text())</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7b95</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = 'SUCCESS') then(
	''
)
else(
	fn:string($RSPvalidarInformacionPago/val:PV_DESCRIPCIONMENSAJE/text())
)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="ObtenerSecuencia">
        <con:context>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerSecuencia" prefix="obt" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7b27</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7aef</con2:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/obtenerSecuencia/biz/obtenerSecuencia_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>obtenerSecuencia</con1:operation>
                  <con1:request>
                    <con1:body>$REQobtenerSecuencia</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPobtenerSecuencia</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQobtenerSecuencia">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7ab7</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/Generales/xq/obtenerSecuenciaIn"/>
                          <con2:param name="sequenceType">
                            <con2:path>"CC_AGR_PAYMENT"</con2:path>
                          </con2:param>
                          <con2:param name="seed">
                            <con2:path>''</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7a7f</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPobtenerSecuencia/obt:PV_CODIGO_ERROR/text())</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-7a62</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = 'SUCCESS') then(
	''
)
else(
	fn:string($RSPobtenerSecuencia/obt:PV_MENSAJE_ERROR/text())
)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="ArmarPagoRecaudo">
        <con:context>
          <con2:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/validarInformacionPago" prefix="val" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/loginTeleredTypes" prefix="log" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerSecuencia" prefix="obt" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/armarPagoRecaudo" prefix="arm" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-2a43</con3:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-2a3f</con3:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/TercerosPA/armarPagoRecaudo/biz/armarPagoRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>armarPagoRecaudo</con1:operation>
                  <con1:request>
                    <con1:body>$REQarmarPagoRecaudo</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSParmarPagoRecaudo</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQarmarPagoRecaudo">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-2a42</con3:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/armarPagoRecaudoIn"/>
                          <con2:param name="usuario">
                            <con2:path>fn:string($header/aut:RequestHeader/Authentication/UserName/text())</con2:path>
                          </con2:param>
                          <con2:param name="pagoRecaudo">
                            <con2:path>$body/pag:pagoRecaudo</con2:path>
                          </con2:param>
                          <con2:param name="sesion">
                            <con2:path>fn:string($RSPloginTelered/log:SESSION_ID/text())</con2:path>
                          </con2:param>
                          <con2:param name="tipoProducto">
                            <con2:path>fn:string($RSPvalidarInformacionPago/val:PV_APLICACION/text())</con2:path>
                          </con2:param>
                          <con2:param name="secuenciaPago">
                            <con2:path>fn:string($RSPobtenerSecuencia/obt:PV_SECUENCIA/text())</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-2a41</con3:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSParmarPagoRecaudo/arm:PV_CODIGOMENSAJE/text())</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-2a40</con3:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = 'SUCCESS') then(
	''
)
else(
	fn:string($RSParmarPagoRecaudo/arm:PV_DESCRIPCIONMENSAJE/text())
)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="Registrar Consumo">
        <con:context>
          <con3:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/armarPagoRecaudo" prefix="arm" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/validarInformacionPago" prefix="val" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerSecuencia" prefix="obt" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://alcance.local/wsinfotarjetas/" prefix="wsin" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con3:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/osbConOrgSequence" prefix="osb" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3331116291225557124-44e1877c.166165e7d09.-79f4</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:assign varName="total">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-29cb</con3:id>
                  <con1:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">let $response := fn:string($RSParmarPagoRecaudo/arm:PC_REQUESTXML/text())
let $responseXML := fn-bea:inlinedXML($response)
return
	fn:string($responseXML/total/text())</con3:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:assign varName="bodyImpuesto">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-4187598656590165295-2a5a3916.168385d8bfa.-4a62</con3:id>
                  <con1:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$body</con3:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:replace contents-only="true" varName="bodyImpuesto">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-29c9</con3:id>
                  <con1:location>
                    <con3:xpathText xmlns:con3="http://www.bea.com/wli/sb/stages/config">./pag:pagoRecaudo/PAYMENT_INFORMATION/PAYMENT_AMOUNT</con3:xpathText>
                  </con1:location>
                  <con1:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$total</con3:xqueryText>
                  </con1:expr>
                </con1:replace>
                <con1:ifThenElse>
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-7cbe</con3:id>
                  <con1:case>
                    <con1:condition>
                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con3:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-7974</con3:id>
                        <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/MasterDataPA/conOrgSequence/biz/osbConOrgSequence_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>osbConOrgSequence</con1:operation>
                        <con1:request>
                          <con1:body>$REQOsbConOrgSequence</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>RSPOsbConOrgSequence</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="REQOsbConOrgSequence">
                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-7978</con3:id>
                            <con1:expr>
                              <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                                <con3:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/conOrgSequenceIn"/>
                                <con3:param name="pagoRecaudo">
                                  <con3:path>$bodyImpuesto/pag:pagoRecaudo</con3:path>
                                </con3:param>
                              </con3:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                          <con1:validate>
                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-7977</con3:id>
                            <con1:schema ref="Middleware/v2/BusinessServices/MasterDataPA/conOrgSequence/xsd/osbConOrgSequence_sp"/>
                            <con1:schemaElement xmlns:osb="http://xmlns.oracle.com/pcbpel/adapter/db/sp/osbConOrgSequence">osb:InputParameters</con1:schemaElement>
                            <con1:varName>REQOsbConOrgSequence</con1:varName>
                          </con1:validate>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:assign varName="errorCode">
                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-7976</con3:id>
                            <con1:expr>
                              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">string($RSPOsbConOrgSequence/osb:CodigoError/text())</con3:xqueryText>
                            </con1:expr>
                          </con1:assign>
                          <con1:assign varName="validationMessage">
                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-7975</con3:id>
                            <con1:expr>
                              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">if(string($errorCode) != '0') then
(
	string($RSPOsbConOrgSequence/osb:MensajeError/text())
) else ('')</con3:xqueryText>
                            </con1:expr>
                          </con1:assign>
                        </con1:responseTransform>
                      </con1:wsCallout>
                      <con1:wsCallout>
                        <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-7cb6</con3:id>
                        <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/VisionPlusPA/onlineTransactions_v4/biz/onlineTransactions_v4" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>OnlinePaymentV4</con1:operation>
                        <con1:request>
                          <con1:body>$REQOnlinePaymentV4</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>RSPOnlinePaymentV4</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="REQOnlinePaymentV4">
                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-7cb9</con3:id>
                            <con1:expr>
                              <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                                <con3:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/onlinePaymentV4In"/>
                                <con3:param name="conOrgSequenceResponse">
                                  <con3:path>$RSPOsbConOrgSequence</con3:path>
                                </con3:param>
                                <con3:param name="pagoRecaudo">
                                  <con3:path>$bodyImpuesto/pag:pagoRecaudo</con3:path>
                                </con3:param>
                                <con3:param name="requestType">
                                  <con3:path>'A'</con3:path>
                                </con3:param>
                              </con3:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                          <con1:validate>
                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-7cb8</con3:id>
                            <con1:wsdl ref="Middleware/v2/BusinessServices/VisionPlusPA/onlineTransactions_v4/wsdl/OnlineTransactions_v4"/>
                            <con1:schemaElement xmlns:ot="http://www.procesa.com/fdcs/ot">ot:OnlinePaymentV4Request</con1:schemaElement>
                            <con1:varName>REQOnlinePaymentV4</con1:varName>
                          </con1:validate>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:assign varName="VPrespCode">
                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-7cb7</con3:id>
                            <con1:expr>
                              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($RSPOnlinePaymentV4/VPrespCode/text())</con3:xqueryText>
                            </con1:expr>
                          </con1:assign>
                          <con1:assign varName="errorCode">
                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1880944548811425111-505900e7.16cb1158f53.-1f18</con3:id>
                            <con1:expr>
                              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$VPrespCode</con3:xqueryText>
                            </con1:expr>
                          </con1:assign>
                          <con1:assign varName="validationMessage">
                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-7ba4</con3:id>
                            <con1:expr>
                              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">if ( $errorCode != '000' ) then (
    string($RSPOnlinePaymentV4/ActionDescription/text())
) else ('')</con3:xqueryText>
                            </con1:expr>
                          </con1:assign>
                        </con1:responseTransform>
                      </con1:wsCallout>
                    </con1:actions>
                  </con1:case>
                  <con1:default/>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="EnrutadorTelered" errorHandler="_onErrorHandler-992244388873434727--25d6e8f0.168384bc6c8.-295c">
        <con:context>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/armarPagoRecaudo" prefix="arm" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://dto.eis.pasarela.hubpagos.bytesw.com/" prefix="dto" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7dd3</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7d9b</con2:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/Telered/EnrutadorTelered/biz/enrutadorTelered" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>PayBill</con1:operation>
                  <con1:request>
                    <con1:body>$REQPayBill</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPPayBill</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQPayBill">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7d63</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn-bea:inlinedXML(fn:string($RSParmarPagoRecaudo/arm:PC_REQUESTXML/text()))</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7cf5</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">let $errorCode:= fn:string($RSPPayBill/error/codigo/text())
 return
 	if($errorCode = '' or $errorCode= '0') then(
		$errorCode
  	)else(
		fn:concat('TELERED_',$errorCode)
  	)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7cd8</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = '' or $errorCode= '0') then(
	 ''
) else(
	fn:string($RSPPayBill/error/descripcion/text())
	
)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="ValidaCodigoErrorParaLoginTelered" errorHandler="_onErrorHandler-992244388873434727--25d6e8f0.168384bc6c8.-28c8">
        <con:context>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/loginTeleredTypes" prefix="log" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/armarPagoRecaudo" prefix="arm" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7c6a</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$errorCode = ('TELERED_100001301','TELERED_100001302')</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:assign varName="channel">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7c32</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPloginTelered/log:CHANNEL/text())</con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7bfa</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/LoginTelered" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>loginTelered</con1:operation>
                  <con1:request>
                    <con1:body>$REQloginTelered</con1:body>
                    <con1:header>$REQHloginTelered</con1:header>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPloginTelered</con1:body>
                    <con1:header>RSPHloginTelered</con1:header>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:transport-headers copy-all="true">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7bc2</con2:id>
                      <con1:header-set>outbound-request</con1:header-set>
                    </con1:transport-headers>
                    <con1:assign varName="REQloginTelered">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7ba5</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/loginTeleredIn"/>
                          <con2:param name="channel">
                            <con2:path>$channel</con2:path>
                          </con2:param>
                          <con2:param name="forceNewSession">
                            <con2:path>true()</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="REQHloginTelered">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7b88</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$header</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7b50</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">let $errorCode:= fn:string($RSPHloginTelered/aut:ResponseHeader/successIndicator/text())
 return
 	if($errorCode = 'Success') then(
		$errorCode
  	)else(
		fn:concat('TELERED_',$errorCode)
  	)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7b33</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = 'Success') then(
	''
)
else(
	string($RSPHloginTelered/aut:ResponseHeader/messages/text())
)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
                <con1:ifThenElse>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7afb</con2:id>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7ac3</con2:id>
                        <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/Telered/EnrutadorTelered/biz/enrutadorTelered" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>PayBill</con1:operation>
                        <con1:request>
                          <con1:body>$REQPayBill</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>RSPPayBill</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="REQPayBill">
                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7a55</con2:id>
                            <con1:expr>
                              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn-bea:inlinedXML(fn:string($RSParmarPagoRecaudo/arm:PC_REQUESTXML/text()))</con2:xqueryText>
                            </con1:expr>
                          </con1:assign>
                          <con1:replace contents-only="true" varName="REQPayBill">
                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7a38</con2:id>
                            <con1:location>
                              <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">./sesionId</con2:xpathText>
                            </con1:location>
                            <con1:expr>
                              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPloginTelered/log:SESSION_ID/text())</con2:xqueryText>
                            </con1:expr>
                          </con1:replace>
                        </con1:requestTransform>
                        <con1:responseTransform>
                          <con1:assign varName="errorCode">
                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7664524929006076546-49fcc2b5.1665fda2ca7.-7f7f</con2:id>
                            <con1:expr>
                              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">let $errorCode:=  fn:string($RSPPayBill/error/codigo/text())
 return
 	if($errorCode = '' or $errorCode= '0') then(
		$errorCode
  	)else(
		fn:concat('TELERED_',$errorCode)
  	)</con2:xqueryText>
                            </con1:expr>
                          </con1:assign>
                          <con1:assign varName="validationMessage">
                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7664524929006076546-49fcc2b5.1665fda2ca7.-7f62</con2:id>
                            <con1:expr>
                              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = '' or $errorCode= '0') then(
	 ''
) else(
	fn:string($RSPPayBill/error/descripcion/text())
	
)</con2:xqueryText>
                            </con1:expr>
                          </con1:assign>
                        </con1:responseTransform>
                      </con1:wsCallout>
                    </con1:actions>
                  </con1:case>
                  <con1:default/>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="ReversarConsumo">
        <con:context>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/validarInformacionPago" prefix="val" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://alcance.local/wsinfotarjetas/" prefix="wsin" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerSecuencia" prefix="obt" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con3:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/osbConOrgSequence" prefix="osb" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-284819374149491321-5358174b.1661bbb5920.-7992</con2:id>
            <con1:case>
              <con1:condition>
                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$VPrespCode = '000' and $validationMessage != ''</con3:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-7783</con3:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/VisionPlusPA/onlineTransactions_v4/biz/onlineTransactions_v4" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>OnlinePaymentV4</con1:operation>
                  <con1:request>
                    <con1:body>$REQOnlinePaymentV4</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPOnlinePaymentV4</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQOnlinePaymentV4">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-777e</con3:id>
                      <con1:expr>
                        <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                          <con3:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/onlinePaymentV4In"/>
                          <con3:param name="conOrgSequenceResponse">
                            <con3:path>$RSPOsbConOrgSequence</con3:path>
                          </con3:param>
                          <con3:param name="pagoRecaudo">
                            <con3:path>$bodyImpuesto/pag:pagoRecaudo</con3:path>
                          </con3:param>
                          <con3:param name="requestType">
                            <con3:path>'R'</con3:path>
                          </con3:param>
                        </con3:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                    <con1:validate>
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-777d</con3:id>
                      <con1:wsdl ref="Middleware/v2/BusinessServices/VisionPlusPA/onlineTransactions_v4/wsdl/OnlineTransactions_v4"/>
                      <con1:schemaElement xmlns:ot="http://www.procesa.com/fdcs/ot">ot:OnlinePaymentV4Request</con1:schemaElement>
                      <con1:varName>REQOnlinePaymentV4</con1:varName>
                    </con1:validate>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-7778</con3:id>
                      <con1:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn-bea:trim(fn:string($RSPOnlinePaymentV4/ReasonActionCode/text()))</con3:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-221316238061254946-98f80c7.16c76f6cc2e.-7777</con3:id>
                      <con1:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">if ( $errorCode != '0' ) then (
    string($RSPOnlinePaymentV4/ActionDescription/text())
) else ('')</con3:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="RegistraPagoRecaudoTC">
        <con:context>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerSecuencia" prefix="obt" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/registraPagoRecaudoTC" prefix="reg" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/validarInformacionPago" prefix="val" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3103473954968016288-6ff809ad.16620f51b11.-7f1c</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage = ''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2932167084375352697--1eed2fc4.166b0ed78a6.-7cf0</con2:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABKPA/registraPagoRecaudoTC/biz/registraPagoRecaudoTC_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>registraPagoRecaudoTC</con1:operation>
                  <con1:request>
                    <con1:body>$REQregistraPagoRecaudoTC</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPregistraPagoRecaudoTC</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="descripcion">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-661601877065404601-531965eb.166f4e24fe0.-7fa6</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">let $cobranza:= $RSPvalidarInformacionPago/val:PV_NOMBRECOBRANZA/text()
let $debtorCode:=$body/pag:pagoRecaudo/DEBTOR_CODE/text()
	return
		fn:concat('Pago', " ", $cobranza, " ", 'CÃ³digo de Deudor', " ", $debtorCode)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="REQregistraPagoRecaudoTC">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2932167084375352697--1eed2fc4.166b0ed78a6.-7c97</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/registraPagoRecaudoTCIn"/>
                          <con2:param name="pagoRecaudo">
                            <con2:path>$bodyImpuesto/pag:pagoRecaudo</con2:path>
                          </con2:param>
                          <con2:param name="secuenciaPago">
                            <con2:path>fn:string($RSPobtenerSecuencia/obt:PV_SECUENCIA/text())</con2:path>
                          </con2:param>
                          <con2:param name="descripcion">
                            <con2:path>$descripcion</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2932167084375352697--1eed2fc4.166b0ed78a6.-7c4a</con2:id>
                      <con1:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($RSPregistraPagoRecaudoTC/reg:PV_CODIGOMENSAJE/text())</con3:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2932167084375352697--1eed2fc4.166b0ed78a6.-7c25</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode != 'SUCCESS') then(
	fn:string($RSPregistraPagoRecaudoTC/reg:PV_DESCRIPCIONMENSAJE/text())
)else('')</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="RegistrarPagoRecuado">
        <con:context>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerSecuencia" prefix="obt" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/armarPagoRecaudo" prefix="arm" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/registrarPagoRecaudo" prefix="reg" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7971176499636012541--57c55c41.166c6e15804.-7efa</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage =''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7971176499636012541--57c55c41.166c6e15804.-7ef6</con2:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/TercerosPA/registrarPagoRecaudo/biz/registrarPagoRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>registrarPagoRecaudo</con1:operation>
                  <con1:request>
                    <con1:body>$REQregistrarPagoRecaudo</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPregistrarPagoRecaudo</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQregistrarPagoRecaudo">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7971176499636012541--57c55c41.166c6e15804.-7ef9</con2:id>
                      <con1:expr>
                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                          <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/registrarPagoRecaudoIn"/>
                          <con2:param name="pagoRecaudo">
                            <con2:path>$body/pag:pagoRecaudo</con2:path>
                          </con2:param>
                          <con2:param name="responseXML">
                            <con2:path>$RSPPayBill</con2:path>
                          </con2:param>
                          <con2:param name="Pv_SecuenciaConsulta">
                            <con2:path>fn:string($RSParmarPagoRecaudo/arm:PV_SECUENCIACONSULTA/text())</con2:path>
                          </con2:param>
                          <con2:param name="Pv_SecuenciaPago">
                            <con2:path>fn:string($RSPobtenerSecuencia/obt:PV_SECUENCIA/text())</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7971176499636012541--57c55c41.166c6e15804.-7ef8</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($RSPregistrarPagoRecaudo/reg:PV_CODIGOMENSAJE/text())</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7971176499636012541--57c55c41.166c6e15804.-7ef7</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">if($errorCode = "SUCCESS")then(
	''
)else(
	fn:string($RSPregistrarPagoRecaudo/reg:PV_DESCRIPCIONMENSAJE/text())
	
)</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="Operaciones_CREDIT_CARD_response" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="FlujoSalida">
        <con:context>
          <con2:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerSecuencia" prefix="obt" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7e51</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage = ""</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:replace varName="header" contents-only="true">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7e50</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<aut:ResponseHeader>
	  <transactionId>{fn:string($RSPobtenerSecuencia/obt:PV_SECUENCIA/text())}</transactionId>
      <successIndicator>Success</successIndicator>
</aut:ResponseHeader>]]></con2:xqueryText>
                  </con1:expr>
                </con1:replace>
                <con1:replace varName="body" contents-only="true">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7d12</con2:id>
                  <con1:expr>
                    <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                      <con2:resource ref="Middleware/v2/Resources/PagoRecaudoPA/xq/pagoRecaudoPAOut"/>
                      <con2:param name="pagoRecaudo">
                        <con2:path>$bodyImpuesto/pag:pagoRecaudo</con2:path>
                      </con2:param>
                      <con2:param name="validarInformacionPago">
                        <con2:path>$RSPvalidarInformacionPago</con2:path>
                      </con2:param>
                      <con2:param name="registrarPagoRecaudo">
                        <con2:path>$RSPregistrarPagoRecaudo</con2:path>
                      </con2:param>
                    </con2:xqueryTransform>
                  </con1:expr>
                </con1:replace>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:replace varName="header" contents-only="true">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7e4f</con2:id>
                <con1:expr>
                  <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<aut:ResponseHeader>
      <successIndicator>{$errorCode}</successIndicator>
      <messages>{ $validationMessage }</messages>
</aut:ResponseHeader>]]></con2:xqueryText>
                </con1:expr>
              </con1:replace>
              <con1:replace varName="body" contents-only="true">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7e4e</con2:id>
                <con1:expr>
                  <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;pag:pagoRecaudoResponse/></con2:xqueryText>
                </con1:expr>
              </con1:replace>
            </con1:default>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="MapeoError">
        <con:context>
          <con2:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6414728710867383475--2a5e0a03.16834552543.-7fb1</con3:id>
            <con1:case>
              <con1:condition>
                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) != "SUCCESS"</con3:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6414728710867383475--2a5e0a03.16834552543.-7f79</con3:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>mapeoErrores</con1:operation>
                  <con1:request>
                    <con1:body>$REQMapeoErrores</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPMapeoErrores</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQMapeoErrores">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6414728710867383475--2a5e0a03.16834552543.-7f41</con3:id>
                      <con1:expr>
                        <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                          <con3:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                          <con3:param name="CODIGO_ERROR">
                            <con3:path>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text()))</con3:path>
                          </con3:param>
                          <con3:param name="MENSAJE_ERROR">
                            <con3:path>fn:concat("FICBCO0067","$#$",fn:string-join($header/aut:ResponseHeader/messages, '||'))</con3:path>
                          </con3:param>
                        </con3:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:replace varName="header" contents-only="true">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6414728710867383475--2a5e0a03.16834552543.-7f09</con3:id>
                      <con1:expr>
                        <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                          <con3:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                          <con3:param name="mapeoErroresResponse1">
                            <con3:path>$RSPMapeoErrores</con3:path>
                          </con3:param>
                          <con3:param name="successIndicator">
                            <con3:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con3:path>
                          </con3:param>
                        </con3:xqueryTransform>
                      </con1:expr>
                    </con1:replace>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="BitacoraResponse">
        <con4:context xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
          <con4:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con4="http://www.bea.com/wli/sb/stages/config"/>
        </con4:context>
        <con4:actions xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
          <con2:ifThenElse>
            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7dd9</con4:id>
            <con2:case>
              <con2:condition>
                <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($uuidBitacoraRequest) !=''</con4:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:assign varName="uuidBitacoraResponse">
                  <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7dd8</con4:id>
                  <con2:expr>
                    <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                      <con4:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                    </con4:xqueryTransform>
                  </con2:expr>
                </con2:assign>
                <con3:route>
                  <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7dd7</con4:id>
                  <con3:service ref="Middleware/v2/BusinessServices/OSB/RegistrarBitacoraOSB_v2/biz/RegistrarBitacoraOSB_v2" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>registrarBitacoraOSB</con3:operation>
                  <con3:outboundTransform>
                    <con2:replace contents-only="true" varName="body">
                      <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-614104850937335605--bd81380.1668e3a61bd.-7dd6</con4:id>
                      <con2:location>
                        <con4:xpathText xmlns:con4="http://www.bea.com/wli/sb/stages/config">.</con4:xpathText>
                      </con2:location>
                      <con2:expr>
                        <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                          <con4:resource ref="Middleware/v2/Resources/Generales/xq/registrarBitacoraOSBIn"/>
                          <con4:param name="UuidReq">
                            <con4:path>$uuidBitacoraRequest</con4:path>
                          </con4:param>
                          <con4:param name="IdOsb">
                            <con4:path>fn:string($inbound/ctx:transport/ctx:request/tp:headers/tp:user-header[@name='Host']/@value)</con4:path>
                          </con4:param>
                          <con4:param name="Uuid">
                            <con4:path>$uuidBitacoraResponse</con4:path>
                          </con4:param>
                          <con4:param name="Contenido">
                            <con4:path>$body</con4:path>
                          </con4:param>
                          <con4:param name="Usuario">
                            <con4:path>string($originalHeader/aut:RequestHeader/Authentication/UserName/text())</con4:path>
                          </con4:param>
                          <con4:param name="FechaTxn">
                            <con4:path>current-date()</con4:path>
                          </con4:param>
                          <con4:param name="MensajeError">
                            <con4:path>fn:string($header/aut:ResponseHeader/messages/text())</con4:path>
                          </con4:param>
                          <con4:param name="BancoDestino">
                            <con4:path>string($originalHeader/aut:RequestHeader/Region/DestinationBank/text())</con4:path>
                          </con4:param>
                          <con4:param name="BancoOrigen">
                            <con4:path>string($originalHeader/aut:RequestHeader/Region/SourceBank/text())</con4:path>
                          </con4:param>
                          <con4:param name="IdOperacion">
                            <con4:path>fn:string($operation)</con4:path>
                          </con4:param>
                          <con4:param name="Resultado">
                            <con4:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con4:path>
                          </con4:param>
                          <con4:param name="IdServicio">
                            <con4:path>"FICBCO0067"</con4:path>
                          </con4:param>
                          <con4:param name="IdTxn">
                            <con4:path>fn:string($header/aut:ResponseHeader/transactionId/text())</con4:path>
                          </con4:param>
                          <con4:param name="TipoMensaje">
                            <con4:path>"RSP"</con4:path>
                          </con4:param>
                        </con4:xqueryTransform>
                      </con2:expr>
                    </con2:replace>
                  </con3:outboundTransform>
                </con3:route>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con4:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-6146410222775222576-47c13343.1661136ad8f.-78f8" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="ManejoError">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:assign varName="errorCode">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-788a</con2:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($fault/ctx:errorCode/text())</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="errorMessage">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-786d</con2:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($fault/ctx:reason/text())</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:wsCallout>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7850</con2:id>
            <con1:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>mapeoErrores</con1:operation>
            <con1:request>
              <con1:body>$reqMapeoErrores</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>respMapeoErrores</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="reqMapeoErrores">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-7818</con2:id>
                <con1:expr>
                  <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                    <con2:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                    <con2:param name="MENSAJE_ERROR">
                      <con2:path>fn:concat("FICBCO0067", "$#$", $errorMessage)</con2:path>
                    </con2:param>
                    <con2:param name="CODIGO_ERROR">
                      <con2:path>$errorCode</con2:path>
                    </con2:param>
                  </con2:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con1:requestTransform>
            <con1:responseTransform>
              <con1:replace contents-only="true" varName="header">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-778b</con2:id>
                <con1:expr>
                  <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                    <con2:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                    <con2:param name="mapeoErroresResponse1">
                      <con2:path>$respMapeoErrores</con2:path>
                    </con2:param>
                    <con2:param name="successIndicator">
                      <con2:path>$errorCode</con2:path>
                    </con2:param>
                  </con2:xqueryTransform>
                </con1:expr>
              </con1:replace>
            </con1:responseTransform>
          </con1:wsCallout>
          <con1:replace varName="body" contents-only="true">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6146410222775222576-47c13343.1661136ad8f.-771d</con2:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;pag:pagoRecaudoResponse/></con2:xqueryText>
            </con1:expr>
          </con1:replace>
        </con:actions>
      </con:stage>
      <con:stage name="BitacoraResponseError">
        <con:context>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3789630717435303061--1085cf90.1662fea3cc0.-7f5d</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($uuidBitacoraRequest) !=''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:assign varName="uuidBitacoraError">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3789630717435303061--1085cf90.1662fea3cc0.-7f25</con2:id>
                  <con1:expr>
                    <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                      <con2:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                    </con2:xqueryTransform>
                  </con1:expr>
                </con1:assign>
                <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-3789630717435303061--1085cf90.1662fea3cc0.-7f09</con3:id>
                  <con2:service ref="Middleware/v2/BusinessServices/OSB/RegistrarBitacoraOSB_v2/biz/RegistrarBitacoraOSB_v2" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>registrarBitacoraOSB</con2:operation>
                  <con2:outboundTransform>
                    <con1:replace contents-only="true" varName="body">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-3789630717435303061--1085cf90.1662fea3cc0.-7e9b</con3:id>
                      <con1:expr>
                        <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                          <con3:resource ref="Middleware/v2/Resources/Generales/xq/registrarBitacoraOSBIn"/>
                          <con3:param name="UuidReq">
                            <con3:path>$uuidBitacoraRequest</con3:path>
                          </con3:param>
                          <con3:param name="IdOsb">
                            <con3:path>fn:string($inbound/ctx:transport/ctx:request/tp:headers/tp:user-header[@name='Host']/@value)</con3:path>
                          </con3:param>
                          <con3:param name="BancoDestino">
                            <con3:path>string($originalHeader/aut:RequestHeader/Region/DestinationBank/text())</con3:path>
                          </con3:param>
                          <con3:param name="Uuid">
                            <con3:path>$uuidBitacoraError</con3:path>
                          </con3:param>
                          <con3:param name="Contenido">
                            <con3:path>$body</con3:path>
                          </con3:param>
                          <con3:param name="BancoOrigen">
                            <con3:path>string($originalHeader/aut:RequestHeader/Region/SourceBank/text())</con3:path>
                          </con3:param>
                          <con3:param name="Usuario">
                            <con3:path>string($originalHeader/aut:RequestHeader/Authentication/UserName/text())</con3:path>
                          </con3:param>
                          <con3:param name="IdTxn">
                            <con3:path>fn:string($header/aut:ResponseHeader/transactionId/text())</con3:path>
                          </con3:param>
                          <con3:param name="IdOperacion">
                            <con3:path>fn:string($operation)</con3:path>
                          </con3:param>
                          <con3:param name="Resultado">
                            <con3:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con3:path>
                          </con3:param>
                          <con3:param name="IdServicio">
                            <con3:path>"FICBCO0067"</con3:path>
                          </con3:param>
                          <con3:param name="TipoMensaje">
                            <con3:path>"RSP"</con3:path>
                          </con3:param>
                          <con3:param name="FechaTxn">
                            <con3:path>current-date()</con3:path>
                          </con3:param>
                          <con3:param name="MensajeError">
                            <con3:path>string($header/aut:ResponseHeader/messages/text())</con3:path>
                          </con3:param>
                        </con3:xqueryTransform>
                      </con1:expr>
                    </con1:replace>
                  </con2:outboundTransform>
                </con2:route>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
          <con2:reply xmlns:con2="http://www.bea.com/wli/sb/stages/config">
            <con2:id>_ActionId-3789630717435303061--1085cf90.1662fea3cc0.-7e48</con2:id>
          </con2:reply>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con2:pipeline type="error" name="_onErrorHandler-2301472116672623833--59b0eac7.1680eee397b.-7fbf">
      <con2:stage name="ManejoErrorTelered">
        <con2:context/>
        <con2:actions>
          <con1:assign varName="errorCode">
            <con:id>_ActionId-2301472116672623833--59b0eac7.1680eee397b.-7f46</con:id>
            <con1:expr>
              <con:xqueryText>-1</con:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="validationMessage">
            <con:id>_ActionId-2301472116672623833--59b0eac7.1680eee397b.-7f29</con:id>
            <con1:expr>
              <con:xqueryText>string($fault/ctx:reason/text())</con:xqueryText>
            </con1:expr>
          </con1:assign>
          <con:resume>
            <con:id>_ActionId-2301472116672623833--59b0eac7.1680eee397b.-7da1</con:id>
          </con:resume>
        </con2:actions>
      </con2:stage>
    </con2:pipeline>
    <con2:pipeline type="error" name="_onErrorHandler-2301472116672623833--59b0eac7.1680eee397b.-7fbe">
      <con2:stage name="ManejoErrorTelered">
        <con2:context/>
        <con2:actions>
          <con1:assign varName="errorCode">
            <con:id>_ActionId-2301472116672623833--59b0eac7.1680eee397b.-7e9e</con:id>
            <con1:expr>
              <con:xqueryText>-1</con:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="validationMessage">
            <con:id>_ActionId-2301472116672623833--59b0eac7.1680eee397b.-7e81</con:id>
            <con1:expr>
              <con:xqueryText>string($fault/ctx:reason/text())</con:xqueryText>
            </con1:expr>
          </con1:assign>
          <con:resume>
            <con:id>_ActionId-2301472116672623833--59b0eac7.1680eee397b.-7dd9</con:id>
          </con:resume>
        </con2:actions>
      </con2:stage>
    </con2:pipeline>
    <con2:pipeline type="error" name="_onErrorHandler-992244388873434727--25d6e8f0.168384bc6c8.-295c">
      <con2:stage name="ManejoErrorTelered">
        <con2:context/>
        <con2:actions>
          <con1:assign varName="errorCode">
            <con:id>_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-28cb</con:id>
            <con1:expr>
              <con:xqueryText>-1</con:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="validationMessage">
            <con:id>_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-28ca</con:id>
            <con1:expr>
              <con:xqueryText>string($fault/ctx:reason/text())</con:xqueryText>
            </con1:expr>
          </con1:assign>
          <con:resume>
            <con:id>_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-28c9</con:id>
          </con:resume>
        </con2:actions>
      </con2:stage>
    </con2:pipeline>
    <con2:pipeline type="error" name="_onErrorHandler-992244388873434727--25d6e8f0.168384bc6c8.-28c8">
      <con2:stage name="ManejoErrorTelered">
        <con2:context/>
        <con2:actions>
          <con1:assign varName="errorCode">
            <con:id>_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-2855</con:id>
            <con1:expr>
              <con:xqueryText>-1</con:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="validationMessage">
            <con:id>_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-2854</con:id>
            <con1:expr>
              <con:xqueryText>string($fault/ctx:reason/text())</con:xqueryText>
            </con1:expr>
          </con1:assign>
          <con:resume>
            <con:id>_ActionId-992244388873434727--25d6e8f0.168384bc6c8.-2853</con:id>
          </con:resume>
        </con2:actions>
      </con2:stage>
    </con2:pipeline>
    <con:flow xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:branch-node type="condition" name="TipoProcesamiento">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:branch-table variable="body">
          <con:xpath>
            <con1:xpathText xmlns:con1="http://www.bea.com/wli/sb/stages/config">./pag:pagoRecaudo/PAYMENT_INFORMATION/PAYMENT_METHOD</con1:xpathText>
          </con:xpath>
          <con:branch name="PAYMENT_METHOD_ACCT_DEBIT">
            <con:operator>equals</con:operator>
            <con:value>'ACCT_DEBIT'</con:value>
            <con:flow>
              <con:pipeline-node name="Operaciones_ACCT_DEBIT">
                <con:request>Operaciones_ACCT_DEBIT_request</con:request>
                <con:response>Operaciones_ACCT_DEBIT_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:branch>
          <con:branch name="PAYMENT_METHOD_CREDIT_CARD">
            <con:operator>equals</con:operator>
            <con:value>'CREDIT_CARD'</con:value>
            <con:flow>
              <con:pipeline-node name="Operaciones_CREDIT_CARD">
                <con:request>Operaciones_CREDIT_CARD_request</con:request>
                <con:response>Operaciones_CREDIT_CARD_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:branch>
          <con:default-branch>
            <con:flow>
              <con:pipeline-node name="Default_PagoRecaudoPA">
                <con:request>Default_PagoRecaudoPA_request</con:request>
                <con:response>Default_PagoRecaudoPA_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:default-branch>
        </con:branch-table>
      </con:branch-node>
    </con:flow>
  </ser:router>
</xml-fragment>