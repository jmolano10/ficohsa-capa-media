<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config">
  <ser:coreEntry isProxy="true" isEnabled="true" isTracingEnabled="true" isAutoPublish="false">
    <ser:security>
      <con2:custom-token-authentication>
        <con2:username-password>
          <con2:username-selector>
            <con2:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:RequestHeader/Authentication/UserName/text()</con2:xpath>
            <con2:variable>header</con2:variable>
          </con2:username-selector>
          <con2:password-selector>
            <con2:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:RequestHeader/Authentication/Password/text()</con2:xpath>
            <con2:variable>header</con2:variable>
          </con2:password-selector>
        </con2:username-password>
      </con2:custom-token-authentication>
    </ser:security>
    <ser:binding type="SOAP" isSoap12="false" xsi:type="con5:SoapBindingType" xmlns:con5="http://www.bea.com/wli/sb/services/bindings/config">
      <con5:wsdl ref="Middleware/v2/Resources/ConsultaComisiones/wsdl/consultaComisionesPS"/>
      <con5:port>
        <con5:name>consultaComisionesPSSOAP</con5:name>
        <con5:namespace>http://www.ficohsa.com.hn/middleware.services/consultaComisionesPS/</con5:namespace>
      </con5:port>
      <con5:selector type="SOAP body"/>
      <con5:WSI-compliant>false</con5:WSI-compliant>
    </ser:binding>
    <ser:monitoring isEnabled="false">
      <ser:aggregationInterval>15</ser:aggregationInterval>
      <ser:pipelineMonitoringLevel>Action</ser:pipelineMonitoringLevel>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
  </ser:coreEntry>
  <ser:endpointConfig>
    <tran:provider-id>http</tran:provider-id>
    <tran:inbound>true</tran:inbound>
    <tran:URI>
      <env:value>/Middleware/OperationsAndExecution/CalculationServices/ConsultaComisiones</env:value>
    </tran:URI>
    <tran:inbound-properties/>
    <tran:all-headers>false</tran:all-headers>
    <tran:provider-specific>
      <http:inbound-properties/>
    </tran:provider-specific>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-64725220802179948-6e798512.155c58aa714.-7ab1">
    <con:pipeline type="request" name="ValidacionesGenerales_request">
      <con4:stage name="ValidacionXSD" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
        <con4:context>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionSwiftTypes" prefix="con"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionesTypes" prefix="con1"/>
        </con4:context>
        <con4:actions>
          <con3:validate>
            <con2:id>_ActionId-64725220802179948-6e798512.155c58aa714.-7db6</con2:id>
            <con3:schema ref="Middleware/v2/Resources/ConsultaComisiones/xsd/consultaComisionesTypes"/>
            <con3:schemaElement xmlns:con4="http://www.ficohsa.com.hn/middleware.services/consultaComisionSwiftTypes" xmlns:con5="http://www.ficohsa.com.hn/middleware.services/consultaComisionesTypes">con5:consultaComisiones</con3:schemaElement>
            <con3:varName>body</con3:varName>
            <con3:location>
              <con2:xpathText>./con1:consultaComisiones</con2:xpathText>
            </con3:location>
          </con3:validate>
        </con4:actions>
      </con4:stage>
      <con4:stage name="ValidacionServicioRegional" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
        <con4:context>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionSwiftTypes" prefix="con"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/ValidaServicioRegional" prefix="val"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionesTypes" prefix="con1"/>
        </con4:context>
        <con4:actions>
          <con3:wsCallout>
            <con2:id>_ActionId-64725220802179948-6e798512.155c58aa714.-7daf</con2:id>
            <con3:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ValidaServicioRegional/biz/ValidaServicioRegional_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con3:operation>ValidaServicioRegional</con3:operation>
            <con3:request>
              <con3:body>$reqValidaServicioRegional</con3:body>
            </con3:request>
            <con3:response>
              <con3:body>respValidaServicioRegional</con3:body>
            </con3:response>
            <con3:requestTransform>
              <con3:assign varName="reqValidaServicioRegional">
                <con2:id>_ActionId-64725220802179948-6e798512.155c58aa714.-7db5</con2:id>
                <con3:expr>
                  <con2:xqueryTransform>
                    <con2:resource ref="Middleware/v2/Resources/Generales/xq/validaServicioRegionalIn"/>
                    <con2:param name="requestHeader1">
                      <con2:path>$header/aut:RequestHeader</con2:path>
                    </con2:param>
                    <con2:param name="serviceId">
                      <con2:path>"FICBCO0205"</con2:path>
                    </con2:param>
                  </con2:xqueryTransform>
                </con3:expr>
              </con3:assign>
            </con3:requestTransform>
            <con3:responseTransform>
              <con3:ifThenElse>
                <con2:id>_ActionId-64725220802179948-6e798512.155c58aa714.-7db4</con2:id>
                <con3:case>
                  <con3:condition>
                    <con2:xqueryText>fn:string($respValidaServicioRegional/val:PV_CODIGO_ERROR/text()) != 'SUCCESS'</con2:xqueryText>
                  </con3:condition>
                  <con3:actions>
                    <con3:replace contents-only="true" varName="header">
                      <con2:id>_ActionId-64725220802179948-6e798512.155c58aa714.-7db3</con2:id>
                      <con3:expr>
                        <con2:xqueryText><![CDATA[<aut:ResponseHeader>
<successIndicator>ERROR</successIndicator>
<messages>{fn:string($respValidaServicioRegional/val:PV_MENSAJE_ERROR/text())}</messages>
</aut:ResponseHeader>]]></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                    <con3:replace contents-only="true" varName="body">
                      <con2:id>_ActionId-64725220802179948-6e798512.155c58aa714.-7db2</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                    <con2:reply>
                      <con2:id>_ActionId-64725220802179948-6e798512.155c58aa714.-7db1</con2:id>
                    </con2:reply>
                  </con3:actions>
                </con3:case>
                <con3:default>
                  <con3:replace contents-only="true" varName="header">
                    <con2:id>_ActionId-64725220802179948-6e798512.155c58aa714.-7db0</con2:id>
                    <con3:expr>
                      <con2:xqueryTransform>
                        <con2:resource ref="Middleware/v2/Resources/Generales/xq/aplicarValoresPorDefectoRegion"/>
                        <con2:param name="requestHeader">
                          <con2:path>$header/aut:RequestHeader</con2:path>
                        </con2:param>
                      </con2:xqueryTransform>
                    </con3:expr>
                  </con3:replace>
                </con3:default>
              </con3:ifThenElse>
            </con3:responseTransform>
          </con3:wsCallout>
        </con4:actions>
      </con4:stage>
      <con:stage name="BitacoraRequest">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con3:assign varName="uuidBitacoraRequest">
            <con1:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7b80</con1:id>
            <con3:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
              </con1:xqueryTransform>
            </con3:expr>
          </con3:assign>
          <con3:assign varName="originalBody">
            <con1:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7b55</con1:id>
            <con3:expr>
              <con1:xqueryText>$body</con1:xqueryText>
            </con3:expr>
          </con3:assign>
          <con3:assign varName="originalHeader">
            <con1:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7b32</con1:id>
            <con3:expr>
              <con1:xqueryText>$header</con1:xqueryText>
            </con3:expr>
          </con3:assign>
          <con4:route>
            <con1:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7afb</con1:id>
            <con4:service ref="Middleware/v2/BusinessServices/OSB/RegistrarBitacoraOSB_v2/biz/RegistrarBitacoraOSB_v2" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con4:operation>registrarBitacoraOSB</con4:operation>
            <con4:outboundTransform>
              <con3:replace varName="body" contents-only="true">
                <con1:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7ae2</con1:id>
                <con3:location>
                  <con1:xpathText>.</con1:xpathText>
                </con3:location>
                <con3:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/Generales/xq/registrarBitacoraOSBIn"/>
                    <con1:param name="Uuid">
                      <con1:path>$uuidBitacoraRequest</con1:path>
                    </con1:param>
                    <con1:param name="IdOperacion">
                      <con1:path>fn:string($operation)</con1:path>
                    </con1:param>
                    <con1:param name="IdOsb">
                      <con1:path>fn:string($inbound/ctx:transport/ctx:request/tp:headers/http:Host/text())</con1:path>
                    </con1:param>
                    <con1:param name="IdServicio">
                      <con1:path>"FICBCO0205"</con1:path>
                    </con1:param>
                    <con1:param name="MensajeError">
                      <con1:path>""</con1:path>
                    </con1:param>
                    <con1:param name="IdTxn">
                      <con1:path>""</con1:path>
                    </con1:param>
                    <con1:param name="UuidReq">
                      <con1:path>""</con1:path>
                    </con1:param>
                    <con1:param name="Resultado">
                      <con1:path>""</con1:path>
                    </con1:param>
                    <con1:param name="Usuario">
                      <con1:path>string($header/aut:RequestHeader/Authentication/UserName/text())</con1:path>
                    </con1:param>
                    <con1:param name="BancoOrigen">
                      <con1:path>string($header/aut:RequestHeader/Region/SourceBank/text())</con1:path>
                    </con1:param>
                    <con1:param name="Contenido">
                      <con1:path>$body</con1:path>
                    </con1:param>
                    <con1:param name="BancoDestino">
                      <con1:path>string($header/aut:RequestHeader/Region/DestinationBank/text())</con1:path>
                    </con1:param>
                    <con1:param name="TipoMensaje">
                      <con1:path>"REQ"</con1:path>
                    </con1:param>
                    <con1:param name="FechaTxn">
                      <con1:path>current-date()</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con3:expr>
              </con3:replace>
            </con4:outboundTransform>
          </con4:route>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="ValidacionesGenerales_response">
      <con:stage name="MapeoError">
        <con:context xmlns:jms="http://www.bea.com/wli/sb/transports/jms" xmlns:con4="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config">
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions xmlns:jms="http://www.bea.com/wli/sb/transports/jms" xmlns:con4="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config">
          <con3:ifThenElse>
            <con2:id>_ActionId-3220418792187352515-6a4d5860.15cb1dfcf96.-7d9e</con2:id>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) != "SUCCESS"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con2:id>_ActionId-3220418792187352515-6a4d5860.15cb1dfcf96.-7d9b</con2:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>mapeoErrores</con3:operation>
                  <con3:request>
                    <con3:body>$REQMapeoErrores</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>RSPMapeoErrores</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="REQMapeoErrores">
                      <con2:id>_ActionId-3220418792187352515-6a4d5860.15cb1dfcf96.-7d9d</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                          <con2:param name="CODIGO_ERROR">
                            <con2:path>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text()))</con2:path>
                          </con2:param>
                          <con2:param name="MENSAJE_ERROR">
                            <con2:path>fn:concat("FICBCO0205","$#$",fn:string-join($header/aut:ResponseHeader/messages, '||'))</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform>
                    <con3:replace varName="header" contents-only="true">
                      <con2:id>_ActionId-3220418792187352515-6a4d5860.15cb1dfcf96.-7d9c</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                          <con2:param name="mapeoErroresResponse1">
                            <con2:path>$RSPMapeoErrores</con2:path>
                          </con2:param>
                          <con2:param name="successIndicator">
                            <con2:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:replace>
                  </con3:responseTransform>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:default/>
          </con3:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="BitacoraResponse">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con3:ifThenElse>
            <con1:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7ab6</con1:id>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>fn:string($uuidBitacoraRequest) !=''</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:assign varName="uuidBitacoraResponse">
                  <con1:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7a82</con1:id>
                  <con3:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                    </con1:xqueryTransform>
                  </con3:expr>
                </con3:assign>
                <con4:route>
                  <con1:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7a52</con1:id>
                  <con4:service ref="Middleware/v2/BusinessServices/OSB/RegistrarBitacoraOSB_v2/biz/RegistrarBitacoraOSB_v2" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con4:operation>registrarBitacoraOSB</con4:operation>
                  <con4:outboundTransform>
                    <con3:replace varName="body" contents-only="true">
                      <con1:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7a20</con1:id>
                      <con3:location>
                        <con1:xpathText>.</con1:xpathText>
                      </con3:location>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/Generales/xq/registrarBitacoraOSBIn"/>
                          <con1:param name="Uuid">
                            <con1:path>$uuidBitacoraResponse</con1:path>
                          </con1:param>
                          <con1:param name="IdOperacion">
                            <con1:path>fn:string($operation)</con1:path>
                          </con1:param>
                          <con1:param name="IdOsb">
                            <con1:path>fn:string($inbound/ctx:transport/ctx:request/tp:headers/http:Host/text())</con1:path>
                          </con1:param>
                          <con1:param name="IdServicio">
                            <con1:path>"FICBCO0205"</con1:path>
                          </con1:param>
                          <con1:param name="MensajeError">
                            <con1:path>string($header/aut:ResponseHeader/messages/text())</con1:path>
                          </con1:param>
                          <con1:param name="IdTxn">
                            <con1:path>string($header/aut:ResponseHeader/transactionId/text())</con1:path>
                          </con1:param>
                          <con1:param name="UuidReq">
                            <con1:path>$uuidBitacoraRequest</con1:path>
                          </con1:param>
                          <con1:param name="Resultado">
                            <con1:path>string($header/aut:ResponseHeader/successIndicator/text())</con1:path>
                          </con1:param>
                          <con1:param name="Usuario">
                            <con1:path>string($originalHeader/aut:RequestHeader/Authentication/UserName/text())</con1:path>
                          </con1:param>
                          <con1:param name="BancoOrigen">
                            <con1:path>string($originalHeader/aut:RequestHeader/Region/SourceBank/text())</con1:path>
                          </con1:param>
                          <con1:param name="Contenido">
                            <con1:path>$body</con1:path>
                          </con1:param>
                          <con1:param name="BancoDestino">
                            <con1:path>string($originalHeader/aut:RequestHeader/Region/SourceBank/text())</con1:path>
                          </con1:param>
                          <con1:param name="TipoMensaje">
                            <con1:path>"RSP"</con1:path>
                          </con1:param>
                          <con1:param name="FechaTxn">
                            <con1:path>current-date()</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:replace>
                  </con4:outboundTransform>
                </con4:route>
              </con3:actions>
            </con3:case>
            <con3:default/>
          </con3:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="HNBanco_ConsultaComisiones_request">
      <con4:stage name="FlujoEntrada" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
        <con4:context>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionSwiftTypes" prefix="con"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionesTypes" prefix="con1"/>
        </con4:context>
        <con4:actions>
          <con3:assign varName="transaction_type">
            <con2:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-7a56</con2:id>
            <con3:expr>
              <con2:xqueryText>$body/con1:consultaComisiones/TRANSACTION_TYPE/text()</con2:xqueryText>
            </con3:expr>
          </con3:assign>
          <con3:ifThenElse>
            <con2:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-7b19</con2:id>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="LOCAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con2:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-782a</con2:id>
                  <con3:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ACH/consultaComisionACH/biz/svcConsultaComisionACH" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>ConsultadecomisionACH_Validate</con3:operation>
                  <con3:request>
                    <con3:body>$REQConsultadecomisionACH_Validate</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>RSPConsultadecomisionACH_Validate</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="REQConsultadecomisionACH_Validate">
                      <con2:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-77bc</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesLocalIn"/>
                          <con2:param name="consultaComisiones">
                            <con2:path>$body/con1:consultaComisiones</con2:path>
                          </con2:param>
                          <con2:param name="requestHeader">
                            <con2:path>$header/aut:RequestHeader</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="INTERNATIONAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con2:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-7b17</con2:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/ConsultaComisionSwift" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultaComisionSwift</con3:operation>
                  <con3:request>
                    <con3:body>$REQConsultaComisionSwift</con3:body>
                    <con3:header>$REQHeaderConsultaComisionSwift</con3:header>
                  </con3:request>
                  <con3:response>
                    <con3:body>RSPConsultaComisionSwift</con3:body>
                    <con3:header>RSPHeaderConsultaComisionSwift</con3:header>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="REQHeaderConsultaComisionSwift">
                      <con2:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-7898</con2:id>
                      <con3:expr>
                        <con2:xqueryText>$header</con2:xqueryText>
                      </con3:expr>
                    </con3:assign>
                    <con3:assign varName="REQConsultaComisionSwift">
                      <con2:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-7b18</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesInternacionalIn"/>
                          <con2:param name="consultaComisiones">
                            <con2:path>$body/con1:consultaComisiones</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="REGIONAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con2:id>_ActionId-2482472718747154416-68ad009a.155df8ffbd6.-7f84</con2:id>
                  <con3:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABK/consultaComisionRegional/biz/consultaComisionRegional_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultaComisionRegional</con3:operation>
                  <con3:request>
                    <con3:body>$REQComisionRegional</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>RSPComisionRegional</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="REQComisionRegional">
                      <con2:id>_ActionId-2482472718747154416-68ad009a.155df8ffbd6.-7f4c</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesRegionalIn"/>
                          <con2:param name="consultaComisiones">
                            <con2:path>$body/con1:consultaComisiones</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="WIHTDRAWAL_TC"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:assign varName="amount">
                  <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7f37</con2:id>
                  <con3:expr>
                    <con2:xqueryText>xs:string($body/con1:consultaComisiones/ADDITIONAL_INFO/INFO[NAME="WITHDRAWAL_AMOUNT"]/VALUE/text())</con2:xqueryText>
                  </con3:expr>
                </con3:assign>
                <con3:ifThenElse>
                  <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7f1a</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>$amount != '' and string(number($amount)) != 'NaN'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:wsCallout>
                        <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7f10</con2:id>
                        <con3:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con3:operation>obtenerParametrizacion</con3:operation>
                        <con3:request>
                          <con3:body>$REQobtenerParametrizacion</con3:body>
                        </con3:request>
                        <con3:response>
                          <con3:body>RSPobtenerParametrizacion</con3:body>
                        </con3:response>
                        <con3:requestTransform>
                          <con3:assign varName="parametroComision">
                            <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7f14</con2:id>
                            <con3:expr>
                              <con2:xqueryText>concat(
	'FICBCO0205.COMMWITHDRATC.',
	upper-case(string($header/aut:RequestHeader/Authentication/UserName/text())),
	'.',
	string($header/aut:RequestHeader/Region/SourceBank/text())
)</con2:xqueryText>
                            </con3:expr>
                          </con3:assign>
                          <con3:assign varName="REQobtenerParametrizacion">
                            <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7f13</con2:id>
                            <con3:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                                <con2:param name="nombreParametros">
                                  <con2:path>$parametroComision</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con3:expr>
                          </con3:assign>
                        </con3:requestTransform>
                        <con3:responseTransform>
                          <con3:assign varName="errorCode">
                            <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7f12</con2:id>
                            <con3:expr>
                              <con2:xqueryText>string($RSPobtenerParametrizacion/osb:ERROR_CODE/text())</con2:xqueryText>
                            </con3:expr>
                          </con3:assign>
                          <con3:assign varName="validationMessage">
                            <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7f11</con2:id>
                            <con3:expr>
                              <con2:xqueryText>string($RSPobtenerParametrizacion/osb:ERROR_MESSAGE/text())</con2:xqueryText>
                            </con3:expr>
                          </con3:assign>
                        </con3:responseTransform>
                      </con3:wsCallout>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:assign varName="errorCode">
                      <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7ed8</con2:id>
                      <con3:expr>
                        <con2:xqueryText>'ERROR'</con2:xqueryText>
                      </con3:expr>
                    </con3:assign>
                    <con3:assign varName="validationMessage">
                      <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7ebb</con2:id>
                      <con3:expr>
                        <con2:xqueryText>'El nombre del atributo NAME es inv√°lido o el monto declarado en el nodo VALUE es incorrecto'</con2:xqueryText>
                      </con3:expr>
                    </con3:assign>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>($transaction_type="ADVANCE_SALARY") and ($body/con1:consultaComisiones/ADDITIONAL_INFO/INFO[NAME = 'DEBIT_ACCOUNT'])</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con2:id>_ActionId-7207393863187064550-6c9256b3.169df4dd528.-6a88</con2:id>
                  <con3:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/T24/AnticipoSalario/biz/AnticipoSalario" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>ConsultaAnticipoSalario</con3:operation>
                  <con3:request>
                    <con3:body>$REQConsultaAnticipoSalario</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>RSPConsultaAnticipoSalario</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="REQConsultaAnticipoSalario">
                      <con2:id>_ActionId-7207393863187064550-6c9256b3.169df4dd528.-6a43</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/v2/BusinessServices/T24/AnticipoSalario/xq/ConsultaAnticipoSalarioIN"/>
                          <con2:param name="account">
                            <con2:path>fn:string($body/con1:consultaComisiones/ADDITIONAL_INFO/INFO[NAME="DEBIT_ACCOUNT"]/VALUE/text())</con2:path>
                          </con2:param>
                          <con2:param name="pass">
                            <con2:path>$header/aut:RequestHeader/Authentication/Password/text()</con2:path>
                          </con2:param>
                          <con2:param name="amount">
                            <con2:path>fn:string($body/con1:consultaComisiones/ADDITIONAL_INFO/INFO[NAME="AMOUNT"]/VALUE/text())</con2:path>
                          </con2:param>
                          <con2:param name="user">
                            <con2:path>$header/aut:RequestHeader/Authentication/UserName/text()</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="ACH_QR"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:assign varName="ACHParameter">
                  <con2:id>_ActionId-5850503505122415705-3d76ceaa.18c833fe054.-7eb7</con2:id>
                  <con3:expr>
                    <con2:xqueryText>'FICBCO0205.ACHQR.PARAMETER'</con2:xqueryText>
                  </con3:expr>
                </con3:assign>
                <con3:wsCallout>
                  <con2:id>_ActionId-5850503505122415705-3d76ceaa.18c833fe054.-7f5e</con2:id>
                  <con3:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>obtenerParametrizacion</con3:operation>
                  <con3:request>
                    <con3:body>$REQobtenerParametrizacionQR</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>RSPobtenerParametrizacionQR</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="REQobtenerParametrizacionQR">
                      <con2:id>_ActionId-5850503505122415705-3d76ceaa.18c833fe054.-7f2a</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                          <con2:param name="nombreParametros">
                            <con2:path>$ACHParameter</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform>
                    <con3:assign varName="errorCode">
                      <con2:id>_ActionId-5850503505122415705-3d76ceaa.18c833fe054.-7ef9</con2:id>
                      <con3:expr>
                        <con2:xqueryText>string($RSPobtenerParametrizacionQR/osb:ERROR_CODE/text())</con2:xqueryText>
                      </con3:expr>
                    </con3:assign>
                    <con3:assign varName="errorMessage">
                      <con2:id>_ActionId-5850503505122415705-3d76ceaa.18c833fe054.-7ed4</con2:id>
                      <con3:expr>
                        <con2:xqueryText>string($RSPobtenerParametrizacionQR/osb:ERROR_MESSAGE/text())</con2:xqueryText>
                      </con3:expr>
                    </con3:assign>
                    <con3:assign varName="amountQR">
                      <con2:id>_ActionId-5850503505122415705-3d76ceaa.18c833fe054.-7ddc</con2:id>
                      <con3:expr>
                        <con2:xqueryText>string($RSPobtenerParametrizacionQR/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM/osb:VALUE/text())</con2:xqueryText>
                      </con3:expr>
                    </con3:assign>
                  </con3:responseTransform>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:default/>
          </con3:ifThenElse>
        </con4:actions>
      </con4:stage>
    </con:pipeline>
    <con:pipeline type="response" name="HNBanco_ConsultaComisiones_response">
      <con4:stage name="FlujoSalida" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
        <con4:context>
          <con2:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionSwiftTypes" prefix="con"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionesTypes" prefix="con1"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/consultaComisionRegional" prefix="con2"/>
        </con4:context>
        <con4:actions>
          <con3:ifThenElse>
            <con2:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-7adf</con2:id>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="LOCAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace contents-only="true" varName="header">
                  <con2:id>_ActionId-7132781213442152570-45e2fe4d.155da313d2f.-7fc6</con2:id>
                  <con3:expr>
                    <con2:xqueryTransform>
                      <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesLocalHeaderOut"/>
                      <con2:param name="consultadecomisionACH_ValidateResponse">
                        <con2:path>$RSPConsultadecomisionACH_Validate</con2:path>
                      </con2:param>
                    </con2:xqueryTransform>
                  </con3:expr>
                </con3:replace>
                <con3:ifThenElse>
                  <con2:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-774a</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:upper-case($header/aut:ResponseHeader/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace varName="body" contents-only="true">
                        <con2:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-7686</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesLocalOut"/>
                            <con2:param name="consultadecomisionACH_ValidateResponse">
                              <con2:path>$RSPConsultadecomisionACH_Validate</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace varName="body" contents-only="true">
                      <con2:id>_ActionId-7132781213442152570-45e2fe4d.155da313d2f.-7f8d</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="ACH_QR"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace contents-only="true" varName="header">
                  <con2:id>_ActionId-5850503505122415705-3d76ceaa.18c833fe054.-7e7b</con2:id>
                  <con3:expr>
                    <con2:xqueryText><![CDATA[<aut:ResponseHeader>
{
if($errorMessage = '')then(
	<successIndicator>Success</successIndicator>
)else(
	<successIndicator>{ $errorCode }</successIndicator>,
	<messages>{ $errorMessage }</messages>
	)
}
</aut:ResponseHeader>]]></con2:xqueryText>
                  </con3:expr>
                </con3:replace>
                <con3:ifThenElse>
                  <con2:id>_ActionId-5850503505122415705-3d76ceaa.18c833fe054.-7e51</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:upper-case($header/aut:ResponseHeader/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace varName="body" contents-only="true">
                        <con2:id>_ActionId-5850503505122415705-3d76ceaa.18c833fe054.-7e1b</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesQROut"/>
                            <con2:param name="amount">
                              <con2:path>$amountQR</con2:path>
                            </con2:param>
                            <con2:param name="currency">
                              <con2:path>string($body/con1:consultaComisiones/SOURCE_CURRENCY/text())</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace varName="body">
                      <con2:id>_ActionId-5850503505122415705-3d76ceaa.18c833fe054.-7dff</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="INTERNATIONAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace varName="header" contents-only="false">
                  <con2:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-7926</con2:id>
                  <con3:expr>
                    <con2:xqueryText>$RSPHeaderConsultaComisionSwift</con2:xqueryText>
                  </con3:expr>
                </con3:replace>
                <con3:ifThenElse>
                  <con2:id>_ActionId-2482472718747154416-68ad009a.155df8ffbd6.-7e86</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:upper-case($header/aut:ResponseHeader/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace varName="body" contents-only="true">
                        <con2:id>_ActionId-2482472718747154416-68ad009a.155df8ffbd6.-7e84</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesInternacionalOut"/>
                            <con2:param name="consultaComisionSwiftResponse">
                              <con2:path>$RSPConsultaComisionSwift</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace varName="body" contents-only="true">
                      <con2:id>_ActionId-2482472718747154416-68ad009a.155df8ffbd6.-7e2d</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="REGIONAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace varName="header" contents-only="true">
                  <con2:id>_ActionId-2482472718747154416-68ad009a.155df8ffbd6.-7f13</con2:id>
                  <con3:expr>
                    <con2:xqueryTransform>
                      <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesRegionalHeaderOut"/>
                      <con2:param name="outputParameters">
                        <con2:path>$RSPComisionRegional</con2:path>
                      </con2:param>
                    </con2:xqueryTransform>
                  </con3:expr>
                </con3:replace>
                <con3:ifThenElse>
                  <con2:id>_ActionId-2482472718747154416-68ad009a.155df8ffbd6.-7e67</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:upper-case($header/aut:ResponseHeader/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace varName="body" contents-only="true">
                        <con2:id>_ActionId-2482472718747154416-68ad009a.155df8ffbd6.-7e65</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesRegionalOut"/>
                            <con2:param name="outputParameters">
                              <con2:path>$RSPComisionRegional</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace varName="body" contents-only="true">
                      <con2:id>_ActionId-2482472718747154416-68ad009a.155df8ffbd6.-7df5</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="WIHTDRAWAL_TC"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace varName="header " contents-only="true">
                  <con2:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7f35</con2:id>
                  <con3:expr>
                    <con2:xqueryText><![CDATA[<aut:ResponseHeader>
{
if($validationMessage = '')then(
	<successIndicator>Success</successIndicator>
)else(
	<successIndicator>{ $errorCode }</successIndicator>,
	<messages>{ $validationMessage }</messages>
	)
}
</aut:ResponseHeader>]]></con2:xqueryText>
                  </con3:expr>
                </con3:replace>
                <con3:ifThenElse>
                  <con2:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7f0a</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:upper-case($header/aut:ResponseHeader/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace varName="body" contents-only="true">
                        <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7fa5</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesWithdrawalTCHNOut"/>
                            <con2:param name="amount">
                              <con2:path>$amount</con2:path>
                            </con2:param>
                            <con2:param name="currency">
                              <con2:path>string($body/con1:consultaComisiones/SOURCE_CURRENCY/text())</con2:path>
                            </con2:param>
                            <con2:param name="percent">
                              <con2:path>xs:decimal($RSPobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$parametroComision]/osb:VALUE/text())</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace varName="body" contents-only="true">
                      <con2:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7ec5</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>($transaction_type="ADVANCE_SALARY") and ($body/con1:consultaComisiones/ADDITIONAL_INFO/INFO[NAME = 'DEBIT_ACCOUNT'])</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:assign varName="countMessage">
                  <con2:id>_ActionId-7207393863187064550-6c9256b3.169df4dd528.-6a0b</con2:id>
                  <con3:expr>
                    <con2:xqueryText>fn:count($RSPConsultaAnticipoSalario/Status/messages)</con2:xqueryText>
                  </con3:expr>
                </con3:assign>
                <con3:ifThenElse>
                  <con2:id>_ActionId-7207393863187064550-6c9256b3.169df4dd528.-699b</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>$countMessage != "0" and fn:upper-case($RSPConsultaAnticipoSalario/Status/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace varName="header" contents-only="true">
                        <con2:id>_ActionId-7207393863187064550-6c9256b3.169df4dd528.-68f7</con2:id>
                        <con3:expr>
                          <con2:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>NO RECORDS</successIndicator>
      <messages>0 records returned</messages>
</aut:ResponseHeader>]]></con2:xqueryText>
                        </con3:expr>
                      </con3:replace>
                      <con3:replace varName="body" contents-only="true">
                        <con2:id>_ActionId-7207393863187064550-6c9256b3.169df4dd528.-68da</con2:id>
                        <con3:expr>
                          <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:upper-case($RSPConsultaAnticipoSalario/Status/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace varName="header" contents-only="true">
                        <con2:id>_ActionId-2126096511861253268-359459f8.170c0e06573.-4d27</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesAdvanceSalaryHeaderOUT"/>
                            <con2:param name="consultaAnticipoSalarioResponse1">
                              <con2:path>$RSPConsultaAnticipoSalario</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                      <con3:replace varName="body" contents-only="true">
                        <con2:id>_ActionId-2126096511861253268-359459f8.170c0e06573.-4d25</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesAdvanceSalaryOut"/>
                            <con2:param name="commisionAmount">
                              <con2:path>fn:string($RSPConsultaAnticipoSalario/NOFILEFICOCASHADVANCEWSType/gNOFILEFICOCASHADVANCEWSDetailType/mNOFILEFICOCASHADVANCEWSDetailType/COMMISSIONAMOUNT/text())</con2:path>
                            </con2:param>
                            <con2:param name="commisionPercent">
                              <con2:path>fn:string($RSPConsultaAnticipoSalario/NOFILEFICOCASHADVANCEWSType/gNOFILEFICOCASHADVANCEWSDetailType/mNOFILEFICOCASHADVANCEWSDetailType/COMMISSIONPERCENT/text())</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace varName="header" contents-only="true">
                      <con2:id>_ActionId-7207393863187064550-6c9256b3.169df4dd528.-684d</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesAdvanceSalaryHeaderOUT"/>
                          <con2:param name="consultaAnticipoSalarioResponse1">
                            <con2:path>$RSPConsultaAnticipoSalario</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:replace>
                    <con3:replace varName="body" contents-only="true">
                      <con2:id>_ActionId-7207393863187064550-6c9256b3.169df4dd528.-6830</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:default/>
          </con3:ifThenElse>
        </con4:actions>
      </con4:stage>
    </con:pipeline>
    <con:pipeline type="request" name="Default_ConsultaComisiones_request">
      <con4:stage name="FlujoEntrada" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
        <con4:context/>
      </con4:stage>
    </con:pipeline>
    <con:pipeline type="response" name="Default_ConsultaComisiones_response">
      <con4:stage name="FlujoSalida" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
        <con4:context>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionSwiftTypes" prefix="con"/>
        </con4:context>
        <con4:actions>
          <con4:Error xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con3="http://www.bea.com/wli/sb/services/security/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
            <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-64725220802179948-6e798512.155c58aa714.-7c47</con5:id>
            <con4:errCode>MW-0008</con4:errCode>
            <con4:message>SERVICE NOT IMPLEMENTED YET FOR THIS COUNTRY/COMPANY</con4:message>
          </con4:Error>
        </con4:actions>
      </con4:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-64725220802179948-6e798512.155c58aa714.-7ab1">
      <con:stage name="ManejorError">
        <con:context xmlns:con4="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/routing/config">
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionesTypes" prefix="con3"/>
        </con:context>
        <con:actions xmlns:con4="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/routing/config">
          <con3:assign varName="errorCode">
            <con1:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-7f50</con1:id>
            <con3:expr>
              <con1:xqueryText>fn:string($fault/ctx:errorCode/text())</con1:xqueryText>
            </con3:expr>
          </con3:assign>
          <con4:assign varName="errorMessage" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con3="http://www.bea.com/wli/sb/services/security/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
            <con1:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-7f4f</con1:id>
            <con4:expr>
              <con5:xqueryText xmlns:con5="http://www.bea.com/wli/sb/stages/config">fn:string($fault/ctx:reason/text())</con5:xqueryText>
            </con4:expr>
          </con4:assign>
          <con5:wsCallout xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
            <con1:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-7f4c</con1:id>
            <con5:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con5:operation>mapeoErrores</con5:operation>
            <con5:request>
              <con5:body>$reqMapeoErrores</con5:body>
            </con5:request>
            <con5:response>
              <con5:body>respMapeoErrores</con5:body>
            </con5:response>
            <con5:requestTransform>
              <con5:assign varName="reqMapeoErrores">
                <con1:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-7f4e</con1:id>
                <con5:expr>
                  <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                    <con6:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                    <con6:param name="MENSAJE_ERROR">
                      <con6:path>fn:concat("FICBCO0205", "$#$", $errorMessage)</con6:path>
                    </con6:param>
                    <con6:param name="CODIGO_ERROR">
                      <con6:path>$errorCode</con6:path>
                    </con6:param>
                  </con6:xqueryTransform>
                </con5:expr>
              </con5:assign>
            </con5:requestTransform>
            <con5:responseTransform>
              <con5:replace contents-only="true" varName="header">
                <con1:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-7f4d</con1:id>
                <con5:expr>
                  <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                    <con6:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                    <con6:param name="mapeoErroresResponse1">
                      <con6:path>$respMapeoErrores</con6:path>
                    </con6:param>
                    <con6:param name="successIndicator">
                      <con6:path>$errorCode</con6:path>
                    </con6:param>
                  </con6:xqueryTransform>
                </con5:expr>
              </con5:replace>
            </con5:responseTransform>
          </con5:wsCallout>
          <con3:replace contents-only="true" varName="body">
            <con1:id>_ActionId-8633399259171102322--318686b0.155cb77933d.-7f4b</con1:id>
            <con3:expr>
              <con1:xqueryText>&lt;con3:consultaComisionesResponse/></con1:xqueryText>
            </con3:expr>
          </con3:replace>
        </con:actions>
      </con:stage>
      <con:stage name="BitacoraResponseError">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con3:ifThenElse>
            <con1:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-79aa</con1:id>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>fn:string($uuidBitacoraRequest) !=''</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:assign varName="uuidBitacoraError">
                  <con1:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7970</con1:id>
                  <con3:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                    </con1:xqueryTransform>
                  </con3:expr>
                </con3:assign>
                <con4:route>
                  <con1:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7940</con1:id>
                  <con4:service ref="Middleware/v2/BusinessServices/OSB/RegistrarBitacoraOSB_v2/biz/RegistrarBitacoraOSB_v2" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con4:operation>registrarBitacoraOSB</con4:operation>
                  <con4:outboundTransform>
                    <con3:replace varName="body" contents-only="true">
                      <con1:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-791d</con1:id>
                      <con3:location>
                        <con1:xpathText>.</con1:xpathText>
                      </con3:location>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/Generales/xq/registrarBitacoraOSBIn"/>
                          <con1:param name="Uuid">
                            <con1:path>$uuidBitacoraError</con1:path>
                          </con1:param>
                          <con1:param name="IdOperacion">
                            <con1:path>fn:string($operation)</con1:path>
                          </con1:param>
                          <con1:param name="IdOsb">
                            <con1:path>fn:string($inbound/ctx:transport/ctx:request/tp:headers/http:Host/text())</con1:path>
                          </con1:param>
                          <con1:param name="IdServicio">
                            <con1:path>"FICBCO0205"</con1:path>
                          </con1:param>
                          <con1:param name="MensajeError">
                            <con1:path>string($header/aut:ResponseHeader/messages/text())</con1:path>
                          </con1:param>
                          <con1:param name="IdTxn">
                            <con1:path>string($header/aut:ResponseHeader/successIndicator/text())</con1:path>
                          </con1:param>
                          <con1:param name="UuidReq">
                            <con1:path>$uuidBitacoraRequest</con1:path>
                          </con1:param>
                          <con1:param name="Resultado">
                            <con1:path>string($header/aut:ResponseHeader/successIndicator/text())</con1:path>
                          </con1:param>
                          <con1:param name="Usuario">
                            <con1:path>string($originalHeader/aut:RequestHeader/Authentication/UserName/text())</con1:path>
                          </con1:param>
                          <con1:param name="BancoOrigen">
                            <con1:path>string($originalHeader/aut:RequestHeader/Region/SourceBank/text())</con1:path>
                          </con1:param>
                          <con1:param name="Contenido">
                            <con1:path>$body</con1:path>
                          </con1:param>
                          <con1:param name="BancoDestino">
                            <con1:path>string($originalHeader/aut:RequestHeader/Region/DestinationBank/text())</con1:path>
                          </con1:param>
                          <con1:param name="TipoMensaje">
                            <con1:path>"RSP"</con1:path>
                          </con1:param>
                          <con1:param name="FechaTxn">
                            <con1:path>current-date()</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:replace>
                  </con4:outboundTransform>
                </con4:route>
              </con3:actions>
            </con3:case>
            <con3:default/>
          </con3:ifThenElse>
          <con1:reply xmlns:con4="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/routing/config">
            <con1:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7919</con1:id>
          </con1:reply>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="GTBanco_ConsultaComisiones_request">
      <con4:stage name="FlujoEntrada" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
        <con4:context>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionSwiftTypes" prefix="con"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionesTypes" prefix="con1"/>
        </con4:context>
        <con4:actions>
          <con3:assign varName="transaction_type">
            <con2:id>_ActionId-6613771611251370495-7e2cc8d8.1574ce33e77.-7d73</con2:id>
            <con3:expr>
              <con2:xqueryText>$body/con1:consultaComisiones/TRANSACTION_TYPE/text()</con2:xqueryText>
            </con3:expr>
          </con3:assign>
          <con3:ifThenElse>
            <con2:id>_ActionId-6613771611251370495-7e2cc8d8.1574ce33e77.-7d71</con2:id>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="LOCAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7fab</con2:id>
                  <con3:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABKGT/consultaComisiones/biz/consultaComisiones_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultaComisiones</con3:operation>
                  <con3:request>
                    <con3:body>$REQconsultaComisiones</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>RSPconsultaComisiones</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="REQconsultaComisiones">
                      <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7fac</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesLocalGTIn"/>
                          <con2:param name="consultaComisiones">
                            <con2:path>$body/con1:consultaComisiones</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="INTERNATIONAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con2:id>_ActionId-6613771611251370495-7e2cc8d8.1574ce33e77.-7d6b</con2:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/ConsultaComisionSwift" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultaComisionSwift</con3:operation>
                  <con3:request>
                    <con3:body>$REQConsultaComisionSwift</con3:body>
                    <con3:header>$REQHeaderConsultaComisionSwift</con3:header>
                  </con3:request>
                  <con3:response>
                    <con3:body>RSPConsultaComisionSwift</con3:body>
                    <con3:header>RSPHeaderConsultaComisionSwift</con3:header>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="REQHeaderConsultaComisionSwift">
                      <con2:id>_ActionId-6613771611251370495-7e2cc8d8.1574ce33e77.-7d6d</con2:id>
                      <con3:expr>
                        <con2:xqueryText>$header</con2:xqueryText>
                      </con3:expr>
                    </con3:assign>
                    <con3:assign varName="REQConsultaComisionSwift">
                      <con2:id>_ActionId-6613771611251370495-7e2cc8d8.1574ce33e77.-7d6c</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesInternacionalGTIn"/>
                          <con2:param name="consultaComisiones">
                            <con2:path>$body/con1:consultaComisiones</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="REGIONAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7f5e</con2:id>
                  <con3:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABKGT/consultaComisionRegional/biz/consultaComisionRegional_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultaComisionRegional</con3:operation>
                  <con3:request>
                    <con3:body>$REQComisionRegional</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>RSPComisionRegional</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="REQComisionRegional">
                      <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7ec0</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesRegionalGTIn"/>
                          <con2:param name="destinationCountry">
                            <con2:path>fn:string($header/aut:RequestHeader/Region/DestinationBank/text())</con2:path>
                          </con2:param>
                          <con2:param name="consultaComisiones">
                            <con2:path>$body/con1:consultaComisiones</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="WIHTDRAWAL_TC"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:assign varName="amount">
                  <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7d9e</con2:id>
                  <con3:expr>
                    <con2:xqueryText>xs:string($body/con1:consultaComisiones/ADDITIONAL_INFO/INFO[NAME="WITHDRAWAL_AMOUNT"]/VALUE/text())</con2:xqueryText>
                  </con3:expr>
                </con3:assign>
                <con3:ifThenElse>
                  <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7d64</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>$amount != '' and string(number($amount)) != 'NaN'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:wsCallout>
                        <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7d5a</con2:id>
                        <con3:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con3:operation>obtenerParametrizacion</con3:operation>
                        <con3:request>
                          <con3:body>$REQobtenerParametrizacion</con3:body>
                        </con3:request>
                        <con3:response>
                          <con3:body>RSPobtenerParametrizacion</con3:body>
                        </con3:response>
                        <con3:requestTransform>
                          <con3:assign varName="parametroComision">
                            <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7d5e</con2:id>
                            <con3:expr>
                              <con2:xqueryText>concat(
	'FICBCO0205.COMMWITHDRATC.',
	upper-case(string($header/aut:RequestHeader/Authentication/UserName/text())),
	'.',
	string($header/aut:RequestHeader/Region/SourceBank/text())
)</con2:xqueryText>
                            </con3:expr>
                          </con3:assign>
                          <con3:assign varName="REQobtenerParametrizacion">
                            <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7d5d</con2:id>
                            <con3:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                                <con2:param name="nombreParametros">
                                  <con2:path>$parametroComision</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con3:expr>
                          </con3:assign>
                        </con3:requestTransform>
                        <con3:responseTransform>
                          <con3:assign varName="errorCode">
                            <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7d5c</con2:id>
                            <con3:expr>
                              <con2:xqueryText>string($RSPobtenerParametrizacion/osb:ERROR_CODE/text())</con2:xqueryText>
                            </con3:expr>
                          </con3:assign>
                          <con3:assign varName="validationMessage">
                            <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7d5b</con2:id>
                            <con3:expr>
                              <con2:xqueryText>string($RSPobtenerParametrizacion/osb:ERROR_MESSAGE/text())</con2:xqueryText>
                            </con3:expr>
                          </con3:assign>
                        </con3:responseTransform>
                      </con3:wsCallout>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:assign varName="errorCode">
                      <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7d2a</con2:id>
                      <con3:expr>
                        <con2:xqueryText>'ERROR'</con2:xqueryText>
                      </con3:expr>
                    </con3:assign>
                    <con3:assign varName="validationMessage">
                      <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7cf3</con2:id>
                      <con3:expr>
                        <con2:xqueryText>'El nombre del atributo NAME es inv√°lido o el monto declarado en el nodo VALUE es incorrecto'</con2:xqueryText>
                      </con3:expr>
                    </con3:assign>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:default/>
          </con3:ifThenElse>
        </con4:actions>
      </con4:stage>
    </con:pipeline>
    <con:pipeline type="response" name="GTBanco_ConsultaComisiones_response">
      <con4:stage name="FlujoSalida" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
        <con4:context>
          <con2:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionSwiftTypes" prefix="con"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionesTypes" prefix="con1"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/consultaComisionRegional" prefix="con2"/>
        </con4:context>
        <con4:actions>
          <con3:ifThenElse>
            <con2:id>_ActionId-6613771611251370495-7e2cc8d8.1574ce33e77.-7d68</con2:id>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="LOCAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace varName="header" contents-only="true">
                  <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7f59</con2:id>
                  <con3:expr>
                    <con2:xqueryTransform>
                      <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesLocalGTHeaderOut"/>
                      <con2:param name="outputParameters">
                        <con2:path>$RSPconsultaComisiones</con2:path>
                      </con2:param>
                    </con2:xqueryTransform>
                  </con3:expr>
                </con3:replace>
                <con3:ifThenElse>
                  <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7f58</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:upper-case($header/aut:ResponseHeader/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace varName="body" contents-only="true">
                        <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7f57</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesLocalGTOut"/>
                            <con2:param name="consultaComisiones">
                              <con2:path>$body/con1:consultaComisiones</con2:path>
                            </con2:param>
                            <con2:param name="outputParameters">
                              <con2:path>$RSPconsultaComisiones</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace varName="body" contents-only="true">
                      <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7f56</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="INTERNATIONAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace varName="header" contents-only="false">
                  <con2:id>_ActionId-6613771611251370495-7e2cc8d8.1574ce33e77.-7d63</con2:id>
                  <con3:expr>
                    <con2:xqueryText>$RSPHeaderConsultaComisionSwift</con2:xqueryText>
                  </con3:expr>
                </con3:replace>
                <con3:ifThenElse>
                  <con2:id>_ActionId-6613771611251370495-7e2cc8d8.1574ce33e77.-7d62</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:upper-case($header/aut:ResponseHeader/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace varName="body" contents-only="true">
                        <con2:id>_ActionId-6613771611251370495-7e2cc8d8.1574ce33e77.-7d61</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesInternacionalGTOut"/>
                            <con2:param name="consultaComisionSwiftResponse">
                              <con2:path>$RSPConsultaComisionSwift</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace varName="body" contents-only="true">
                      <con2:id>_ActionId-6613771611251370495-7e2cc8d8.1574ce33e77.-7d60</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="REGIONAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace contents-only="true" varName="header">
                  <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7f04</con2:id>
                  <con3:expr>
                    <con2:xqueryTransform>
                      <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesRegionalGTHeaderOut"/>
                      <con2:param name="outputParameters">
                        <con2:path>$RSPComisionRegional</con2:path>
                      </con2:param>
                    </con2:xqueryTransform>
                  </con3:expr>
                </con3:replace>
                <con3:ifThenElse>
                  <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7e8f</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:upper-case($header/aut:ResponseHeader/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace varName="body" contents-only="true">
                        <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7e6d</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesRegionalGTOut"/>
                            <con2:param name="outputParameters">
                              <con2:path>$RSPComisionRegional</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace varName="body" contents-only="true">
                      <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7e8a</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="WIHTDRAWAL_TC"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace varName="header" contents-only="true">
                  <con2:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7dbe</con2:id>
                  <con3:expr>
                    <con2:xqueryText><![CDATA[<aut:ResponseHeader>
{
if($validationMessage = '')then(
	<successIndicator>Success</successIndicator>
)else(
	<successIndicator>{ $errorCode }</successIndicator>,
	<messages>{ $validationMessage }</messages>
	)
}
</aut:ResponseHeader>]]></con2:xqueryText>
                  </con3:expr>
                </con3:replace>
                <con3:ifThenElse>
                  <con2:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7d87</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:upper-case($header/aut:ResponseHeader/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace contents-only="true" varName="body">
                        <con2:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7d5b</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesWithdrawalTCGTOut"/>
                            <con2:param name="amount">
                              <con2:path>$amount</con2:path>
                            </con2:param>
                            <con2:param name="currency">
                              <con2:path>string($body/con1:consultaComisiones/SOURCE_CURRENCY/text())</con2:path>
                            </con2:param>
                            <con2:param name="percent">
                              <con2:path>xs:decimal($RSPobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$parametroComision]/osb:VALUE/text())</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace varName="body" contents-only="true">
                      <con2:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7d3f</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:default/>
          </con3:ifThenElse>
        </con4:actions>
      </con4:stage>
    </con:pipeline>
    <con:pipeline type="request" name="PABanco_ConsultaComisiones_request">
      <con4:stage name="FlujoEntrada" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
        <con4:context>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionSwiftTypes" prefix="con"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionesTypes" prefix="con1"/>
        </con4:context>
        <con4:actions>
          <con3:assign varName="transaction_type">
            <con2:id>_ActionId-5987652978499670569-5c332732.1575231bd7e.-7b84</con2:id>
            <con3:expr>
              <con2:xqueryText>$body/con1:consultaComisiones/TRANSACTION_TYPE/text()</con2:xqueryText>
            </con3:expr>
          </con3:assign>
          <con3:ifThenElse>
            <con2:id>_ActionId-5987652978499670569-5c332732.1575231bd7e.-7b82</con2:id>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="LOCAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7e5f</con2:id>
                  <con3:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABKGT/consultaComisiones/biz/consultaComisiones_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultaComisiones</con3:operation>
                  <con3:request>
                    <con3:body>$REQconsultaComisiones</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>RSPconsultaComisiones</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="REQconsultaComisiones">
                      <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7e60</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesLocalPAIn"/>
                          <con2:param name="consultaComisiones">
                            <con2:path>$body/con1:consultaComisiones</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="INTERNATIONAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con2:id>_ActionId-5987652978499670569-5c332732.1575231bd7e.-7b7f</con2:id>
                  <con3:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/ConsultaComisionSwift" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultaComisionSwift</con3:operation>
                  <con3:request>
                    <con3:body>$REQConsultaComisionSwift</con3:body>
                    <con3:header>$REQHeaderConsultaComisionSwift</con3:header>
                  </con3:request>
                  <con3:response>
                    <con3:body>RSPConsultaComisionSwift</con3:body>
                    <con3:header>RSPHeaderConsultaComisionSwift</con3:header>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="REQHeaderConsultaComisionSwift">
                      <con2:id>_ActionId-5987652978499670569-5c332732.1575231bd7e.-7b81</con2:id>
                      <con3:expr>
                        <con2:xqueryText>$header</con2:xqueryText>
                      </con3:expr>
                    </con3:assign>
                    <con3:assign varName="REQConsultaComisionSwift">
                      <con2:id>_ActionId-5987652978499670569-5c332732.1575231bd7e.-7b80</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesInternacionalPAIn"/>
                          <con2:param name="consultaComisiones">
                            <con2:path>$body/con1:consultaComisiones</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="REGIONAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7e33</con2:id>
                  <con3:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABKPA/consultaComisionRegional/biz/consultaComisionRegional_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>consultaComisionRegional</con3:operation>
                  <con3:request>
                    <con3:body>$REQComisionRegional</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>RSPComisionRegional</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="REQComisionRegional">
                      <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7e1a</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesRegionalPAIn"/>
                          <con2:param name="destinationCountry">
                            <con2:path>fn:string($header/aut:RequestHeader/Region/DestinationBank/text())</con2:path>
                          </con2:param>
                          <con2:param name="consultaComisiones">
                            <con2:path>$body/con1:consultaComisiones</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="WIHTDRAWAL_TC"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:assign varName="amount">
                  <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7dd9</con2:id>
                  <con3:expr>
                    <con2:xqueryText>xs:string($body/con1:consultaComisiones/ADDITIONAL_INFO/INFO[NAME="WITHDRAWAL_AMOUNT"]/VALUE/text())</con2:xqueryText>
                  </con3:expr>
                </con3:assign>
                <con3:ifThenElse>
                  <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7e5d</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>$amount != '' and string(number($amount)) != 'NaN'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:wsCallout>
                        <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7e53</con2:id>
                        <con3:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con3:operation>obtenerParametrizacion</con3:operation>
                        <con3:request>
                          <con3:body>$REQobtenerParametrizacion</con3:body>
                        </con3:request>
                        <con3:response>
                          <con3:body>RSPobtenerParametrizacion</con3:body>
                        </con3:response>
                        <con3:requestTransform>
                          <con3:assign varName="parametroComision">
                            <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7e57</con2:id>
                            <con3:expr>
                              <con2:xqueryText>concat(
	'FICBCO0205.COMMWITHDRATC.',
	upper-case(string($header/aut:RequestHeader/Authentication/UserName/text())),
	'.',
	string($header/aut:RequestHeader/Region/SourceBank/text())
)</con2:xqueryText>
                            </con3:expr>
                          </con3:assign>
                          <con3:assign varName="REQobtenerParametrizacion">
                            <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7e56</con2:id>
                            <con3:expr>
                              <con2:xqueryTransform>
                                <con2:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                                <con2:param name="nombreParametros">
                                  <con2:path>$parametroComision</con2:path>
                                </con2:param>
                              </con2:xqueryTransform>
                            </con3:expr>
                          </con3:assign>
                        </con3:requestTransform>
                        <con3:responseTransform>
                          <con3:assign varName="errorCode">
                            <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7e55</con2:id>
                            <con3:expr>
                              <con2:xqueryText>string($RSPobtenerParametrizacion/osb:ERROR_CODE/text())</con2:xqueryText>
                            </con3:expr>
                          </con3:assign>
                          <con3:assign varName="validationMessage">
                            <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7e54</con2:id>
                            <con3:expr>
                              <con2:xqueryText>string($RSPobtenerParametrizacion/osb:ERROR_MESSAGE/text())</con2:xqueryText>
                            </con3:expr>
                          </con3:assign>
                        </con3:responseTransform>
                      </con3:wsCallout>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:assign varName="errorCode">
                      <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7e11</con2:id>
                      <con3:expr>
                        <con2:xqueryText>'ERROR'</con2:xqueryText>
                      </con3:expr>
                    </con3:assign>
                    <con3:assign varName="validationMessage">
                      <con2:id>_ActionId-6775911441090465667--272efc48.1650015b11b.-7ddd</con2:id>
                      <con3:expr>
                        <con2:xqueryText>'El nombre del atributo NAME es inv√°lido o el monto declarado en el nodo VALUE es incorrecto'</con2:xqueryText>
                      </con3:expr>
                    </con3:assign>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:default/>
          </con3:ifThenElse>
        </con4:actions>
      </con4:stage>
    </con:pipeline>
    <con:pipeline type="response" name="PABanco_ConsultaComisiones_response">
      <con4:stage name="FlujoSalida" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
        <con4:context>
          <con2:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionSwiftTypes" prefix="con"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionesTypes" prefix="con1"/>
          <con2:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/consultaComisionRegional" prefix="con2"/>
        </con4:context>
        <con4:actions>
          <con3:ifThenElse>
            <con2:id>_ActionId-5987652978499670569-5c332732.1575231bd7e.-7b7c</con2:id>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="LOCAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace varName="header" contents-only="true">
                  <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7e59</con2:id>
                  <con3:expr>
                    <con2:xqueryTransform>
                      <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesLocalPAHeaderOut"/>
                      <con2:param name="outputParameters">
                        <con2:path>$RSPconsultaComisiones</con2:path>
                      </con2:param>
                    </con2:xqueryTransform>
                  </con3:expr>
                </con3:replace>
                <con3:ifThenElse>
                  <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7e58</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:upper-case($header/aut:ResponseHeader/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace varName="body" contents-only="true">
                        <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7e57</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesLocalPAOut"/>
                            <con2:param name="consultaComisiones">
                              <con2:path>$body/con1:consultaComisiones</con2:path>
                            </con2:param>
                            <con2:param name="outputParameters">
                              <con2:path>$RSPconsultaComisiones</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace varName="body" contents-only="true">
                      <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7e56</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="INTERNATIONAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace varName="header" contents-only="false">
                  <con2:id>_ActionId-5987652978499670569-5c332732.1575231bd7e.-7b79</con2:id>
                  <con3:expr>
                    <con2:xqueryText>$RSPHeaderConsultaComisionSwift</con2:xqueryText>
                  </con3:expr>
                </con3:replace>
                <con3:ifThenElse>
                  <con2:id>_ActionId-5987652978499670569-5c332732.1575231bd7e.-7b78</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:upper-case($header/aut:ResponseHeader/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace varName="body" contents-only="true">
                        <con2:id>_ActionId-5987652978499670569-5c332732.1575231bd7e.-7b77</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesInternacionalPAOut"/>
                            <con2:param name="consultaComisionSwiftResponse">
                              <con2:path>$RSPConsultaComisionSwift</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace varName="body" contents-only="true">
                      <con2:id>_ActionId-5987652978499670569-5c332732.1575231bd7e.-7b76</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="REGIONAL"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace contents-only="true" varName="header">
                  <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7e53</con2:id>
                  <con3:expr>
                    <con2:xqueryTransform>
                      <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesRegionalPAHeaderOut"/>
                      <con2:param name="outputParameters">
                        <con2:path>$RSPComisionRegional</con2:path>
                      </con2:param>
                    </con2:xqueryTransform>
                  </con3:expr>
                </con3:replace>
                <con3:ifThenElse>
                  <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7dee</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:upper-case($header/aut:ResponseHeader/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace contents-only="true" varName="body">
                        <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7dc7</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesRegionalPAOut"/>
                            <con2:param name="outputParameters">
                              <con2:path>$RSPComisionRegional</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace varName="body" contents-only="true">
                      <con2:id>_ActionId-3617910316539805332--1b6d657d.15f9c39054e.-7de8</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:case>
              <con3:condition>
                <con2:xqueryText>$transaction_type="WIHTDRAWAL_TC"</con2:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace varName="header" contents-only="true">
                  <con2:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7c0e</con2:id>
                  <con3:expr>
                    <con2:xqueryText><![CDATA[<aut:ResponseHeader>
{
if($validationMessage = '')then(
	<successIndicator>Success</successIndicator>
)else(
	<successIndicator>{ $errorCode }</successIndicator>,
	<messages>{ $validationMessage }</messages>
	)
}
</aut:ResponseHeader>]]></con2:xqueryText>
                  </con3:expr>
                </con3:replace>
                <con3:ifThenElse>
                  <con2:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7be1</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:upper-case($header/aut:ResponseHeader/successIndicator/text())='SUCCESS'</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace varName="body" contents-only="true">
                        <con2:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7bb1</con2:id>
                        <con3:expr>
                          <con2:xqueryTransform>
                            <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesWithdrawalTCPAOut"/>
                            <con2:param name="amount">
                              <con2:path>$amount</con2:path>
                            </con2:param>
                            <con2:param name="currency">
                              <con2:path>string($body/con1:consultaComisiones/SOURCE_CURRENCY/text())</con2:path>
                            </con2:param>
                            <con2:param name="percent">
                              <con2:path>xs:string($RSPobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME=$parametroComision]/osb:VALUE/text())</con2:path>
                            </con2:param>
                          </con2:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace varName="body" contents-only="true">
                      <con2:id>_ActionId-1793912583126623744-6f8aff7d.164fa95928d.-7b99</con2:id>
                      <con3:expr>
                        <con2:xqueryText>&lt;con1:consultaComisionesResponse/></con2:xqueryText>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:default/>
          </con3:ifThenElse>
        </con4:actions>
      </con4:stage>
    </con:pipeline>
    <con:pipeline type="request" name="NIBanco_ConsultaComisiones_request">
      <con:stage name="ObtenerParametrizaci√≥nMW">
        <con:context>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionesTypes" prefix="con"/>
        </con:context>
        <con:actions>
          <con3:ifThenElse>
            <con1:id>_ActionId-504511480168886616-31242481.180fd1f7444.-4810</con1:id>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>fn:string($body/con:consultaComisiones/TRANSACTION_TYPE/text()) = "REGIONAL"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace contents-only="true" varName="body">
                  <con1:id>_ActionId-504511480168886616-31242481.180fd1f7444.-47d8</con1:id>
                  <con3:location>
                    <con1:xpathText>./con:consultaComisiones/TRANSACTION_TYPE</con1:xpathText>
                  </con3:location>
                  <con3:expr>
                    <con1:xqueryText>"INTERGRUPAL"</con1:xqueryText>
                  </con3:expr>
                </con3:replace>
                <con3:wsCallout>
                  <con1:id>_ActionId-504511480168886616-31242481.180fd1f7444.-47cc</con1:id>
                  <con3:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>obtenerParametrizacion</con3:operation>
                  <con3:request>
                    <con3:body>$REQobtenerParametrizacion</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>RSPobtenerParametrizacion</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="tipoAchParam">
                      <con1:id>_ActionId-504511480168886616-31242481.180fd1f7444.-47d1</con1:id>
                      <con3:expr>
                        <con1:xqueryText>concat("FICBCO0205",".",fn:string($header/aut:RequestHeader/Region/DestinationBank/text()))</con1:xqueryText>
                      </con3:expr>
                    </con3:assign>
                    <con3:assign varName="REQobtenerParametrizacion">
                      <con1:id>_ActionId-504511480168886616-31242481.180fd1f7444.-47d0</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                          <con1:param name="nombreParametros">
                            <con1:path>$tipoAchParam</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                  </con3:requestTransform>
                  <con3:responseTransform>
                    <con3:assign varName="tipoAchValue">
                      <con1:id>_ActionId-504511480168886616-31242481.180fd1f7444.-47cf</con1:id>
                      <con3:expr>
                        <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb:CONFIGURACIONES/osb:CONFIGURACIONES_ITEM[osb:NAME = $tipoAchParam]/osb:VALUE/text())</con1:xqueryText>
                      </con3:expr>
                    </con3:assign>
                    <con3:assign varName="errorCode">
                      <con1:id>_ActionId-504511480168886616-31242481.180fd1f7444.-47ce</con1:id>
                      <con3:expr>
                        <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb:ERROR_CODE/text())</con1:xqueryText>
                      </con3:expr>
                    </con3:assign>
                    <con3:assign varName="validationMessage">
                      <con1:id>_ActionId-504511480168886616-31242481.180fd1f7444.-47cd</con1:id>
                      <con3:expr>
                        <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb:ERROR_MESSAGE/text())</con1:xqueryText>
                      </con3:expr>
                    </con3:assign>
                  </con3:responseTransform>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:default>
              <con3:assign varName="errorCode">
                <con1:id>_ActionId-504511480168886616-31242481.180fd1f7444.-44dd</con1:id>
                <con3:expr>
                  <con1:xqueryText>"SUCCESS"</con1:xqueryText>
                </con3:expr>
              </con3:assign>
            </con3:default>
          </con3:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="OpConsultaComisiones">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionesTypes" prefix="con"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb"/>
        </con:context>
        <con:actions>
          <con3:ifThenElse>
            <con1:id>_ActionId-6899168316773989874-7d62a14b.17c752f5c1b.-6c68</con1:id>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>upper-case($errorCode) = "SUCCESS"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:wsCallout>
                  <con1:id>_ActionId-6899168316773989874-7d62a14b.17c752f5c1b.-6c5e</con1:id>
                  <con3:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/CTS/cuenta/biz/cuenta" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con3:operation>OpConsultaComisiones</con3:operation>
                  <con3:request>
                    <con3:body>$REQconsultaComisiones</con3:body>
                  </con3:request>
                  <con3:response>
                    <con3:body>RSPconsultaComisiones</con3:body>
                  </con3:response>
                  <con3:requestTransform>
                    <con3:assign varName="REQconsultaComisiones">
                      <con1:id>_ActionId-6899168316773989874-7d62a14b.17c752f5c1b.-6c60</con1:id>
                      <con3:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesNIIn"/>
                          <con1:param name="tipoAchValue">
                            <con1:path>$tipoAchValue</con1:path>
                          </con1:param>
                          <con1:param name="consultaComisiones">
                            <con1:path>$body/con:consultaComisiones</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con3:expr>
                    </con3:assign>
                    <con3:validate>
                      <con1:id>_ActionId-6899168316773989874-7d62a14b.17c752f5c1b.-6c5f</con1:id>
                      <con3:schema ref="Middleware/v2/BusinessServices/CTS/cuenta/xsd/services"/>
                      <con3:schemaElement xmlns:ser1="http://service.srvaplcobiscuenta.ecobis.cobiscorp">ser1:opConsultaComisionesSolicitud</con3:schemaElement>
                      <con3:varName>REQconsultaComisiones</con3:varName>
                      <con3:location>
                        <con1:xpathText>.</con1:xpathText>
                      </con3:location>
                    </con3:validate>
                  </con3:requestTransform>
                  <con3:responseTransform/>
                </con3:wsCallout>
              </con3:actions>
            </con3:case>
            <con3:default/>
          </con3:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="NIBanco_ConsultaComisiones_response">
      <con:stage name="FlujoSalida">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaComisionesTypes" prefix="con"/>
        </con:context>
        <con:actions>
          <con3:ifThenElse>
            <con1:id>_ActionId-6899168316773989874-7d62a14b.17c752f5c1b.-6c26</con1:id>
            <con3:case>
              <con3:condition>
                <con1:xqueryText>upper-case($errorCode) = "SUCCESS"</con1:xqueryText>
              </con3:condition>
              <con3:actions>
                <con3:replace varName="header" contents-only="true">
                  <con1:id>_ActionId-6899168316773989874-7d62a14b.17c752f5c1b.-6c24</con1:id>
                  <con3:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesNIHeaderOut"/>
                      <con1:param name="opConsultaComisionesRespuesta">
                        <con1:path>$RSPconsultaComisiones</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con3:expr>
                </con3:replace>
                <con3:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                  <con2:id>_ActionId-6899168316773989874-7d62a14b.17c752f5c1b.-6c20</con2:id>
                  <con3:case>
                    <con3:condition>
                      <con2:xqueryText>fn:string($header/aut:ResponseHeader/successIndicator/text())!="Success"</con2:xqueryText>
                    </con3:condition>
                    <con3:actions>
                      <con3:replace varName="body" contents-only="true">
                        <con2:id>_ActionId-6899168316773989874-7d62a14b.17c752f5c1b.-6c1f</con2:id>
                        <con3:expr>
                          <con2:xqueryText>&lt;con:consultaComisionesResponse/></con2:xqueryText>
                        </con3:expr>
                      </con3:replace>
                    </con3:actions>
                  </con3:case>
                  <con3:default>
                    <con3:replace contents-only="true" varName="body">
                      <con2:id>_ActionId-6899168316773989874-7d62a14b.17c752f5c1b.-6be2</con2:id>
                      <con3:expr>
                        <con2:xqueryTransform>
                          <con2:resource ref="Middleware/v2/Resources/ConsultaComisiones/xq/consultaComisionesNIOut"/>
                          <con2:param name="opConsultaComisionesRespuesta">
                            <con2:path>$RSPconsultaComisiones</con2:path>
                          </con2:param>
                        </con2:xqueryTransform>
                      </con3:expr>
                    </con3:replace>
                  </con3:default>
                </con3:ifThenElse>
              </con3:actions>
            </con3:case>
            <con3:default>
              <con3:replace contents-only="true" varName="header">
                <con1:id>_ActionId-6899168316773989874-7d62a14b.17c752f5c1b.-6be6</con1:id>
                <con3:expr>
                  <con1:xqueryText><![CDATA[<aut:ResponseHeader>
	<successIndicator>{$errorCode}</successIndicator>
	<messages>{$validationMessage}</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                </con3:expr>
              </con3:replace>
              <con3:replace contents-only="true" varName="body">
                <con1:id>_ActionId-6899168316773989874-7d62a14b.17c752f5c1b.-6baa</con1:id>
                <con3:expr>
                  <con1:xqueryText>&lt;con:consultaComisionesResponse/></con1:xqueryText>
                </con3:expr>
              </con3:replace>
            </con3:default>
          </con3:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:flow>
      <con:pipeline-node name="ValidacionesGenerales">
        <con:request>ValidacionesGenerales_request</con:request>
        <con:response>ValidacionesGenerales_response</con:response>
      </con:pipeline-node>
      <con:branch-node type="condition" name="RegionalizacionPaisEmpresa">
        <con4:context xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con4:context>
        <con4:branch-table variable="header" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
          <con4:xpath>
            <con2:xpathText>./aut:RequestHeader/Region/SourceBank</con2:xpathText>
          </con4:xpath>
          <con4:branch name="HNBanco">
            <con4:operator>equals</con4:operator>
            <con4:value>'HN01'</con4:value>
            <con4:flow>
              <con4:pipeline-node name="HNBanco_ConsultaComisiones">
                <con4:request>HNBanco_ConsultaComisiones_request</con4:request>
                <con4:response>HNBanco_ConsultaComisiones_response</con4:response>
              </con4:pipeline-node>
            </con4:flow>
          </con4:branch>
          <con4:branch name="GT01">
            <con4:operator>equals</con4:operator>
            <con4:value>'GT01'</con4:value>
            <con4:flow>
              <con4:pipeline-node name="GTBanco_ConsultaComisiones">
                <con4:request>GTBanco_ConsultaComisiones_request</con4:request>
                <con4:response>GTBanco_ConsultaComisiones_response</con4:response>
              </con4:pipeline-node>
            </con4:flow>
          </con4:branch>
          <con4:branch name="PA01">
            <con4:operator>equals</con4:operator>
            <con4:value>'PA01'</con4:value>
            <con4:flow>
              <con4:pipeline-node name="PABanco_ConsultaComisiones">
                <con4:request>PABanco_ConsultaComisiones_request</con4:request>
                <con4:response>PABanco_ConsultaComisiones_response</con4:response>
              </con4:pipeline-node>
            </con4:flow>
          </con4:branch>
          <con4:branch name="NI01">
            <con4:operator>equals</con4:operator>
            <con4:value>'NI01'</con4:value>
            <con4:flow>
              <con4:pipeline-node name="NIBanco_ConsultaComisiones">
                <con4:request>NIBanco_ConsultaComisiones_request</con4:request>
                <con4:response>NIBanco_ConsultaComisiones_response</con4:response>
              </con4:pipeline-node>
            </con4:flow>
          </con4:branch>
          <con4:default-branch>
            <con4:flow>
              <con4:pipeline-node name="Default_ConsultaComisiones">
                <con4:request>Default_ConsultaComisiones_request</con4:request>
                <con4:response>Default_ConsultaComisiones_response</con4:response>
              </con4:pipeline-node>
            </con4:flow>
          </con4:default-branch>
        </con4:branch-table>
      </con:branch-node>
    </con:flow>
  </ser:router>
</xml-fragment>