<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con3="http://www.bea.com/wli/sb/stages/logging/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con5="http://www.bea.com/wli/sb/services/security/config" xmlns:con6="http://www.bea.com/wli/sb/stages/routing/config">
  <ser:coreEntry isProxy="true" isEnabled="true" isTracingEnabled="false" isAutoPublish="false">
    <ser:security>
      <con5:custom-token-authentication>
        <con5:username-password>
          <con5:username-selector>
            <con5:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:RequestHeader/Authentication/UserName/text()</con5:xpath>
            <con5:variable>header</con5:variable>
          </con5:username-selector>
          <con5:password-selector>
            <con5:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:RequestHeader/Authentication/Password/text()</con5:xpath>
            <con5:variable>header</con5:variable>
          </con5:password-selector>
        </con5:username-password>
      </con5:custom-token-authentication>
    </ser:security>
    <ser:binding type="SOAP" isSoap12="false" xsi:type="con6:SoapBindingType" xmlns:con6="http://www.bea.com/wli/sb/services/bindings/config">
      <con6:wsdl ref="Middleware/v3/Resources/PagoRecaudo/wsdl/pagoRecaudoPS"/>
      <con6:port>
        <con6:name>pagoRecaudoPSSOAP</con6:name>
        <con6:namespace>http://www.ficohsa.com.hn/middleware.services/pagoRecaudo/</con6:namespace>
      </con6:port>
      <con6:selector type="SOAP body"/>
      <con6:WSI-compliant>false</con6:WSI-compliant>
    </ser:binding>
    <ser:monitoring isEnabled="true">
      <ser:aggregationInterval>720</ser:aggregationInterval>
      <ser:pipelineMonitoringLevel>Action</ser:pipelineMonitoringLevel>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
    <ser:throttling enabled="false">
      <ser:capacity>0</ser:capacity>
      <ser:maxQueueLength>0</ser:maxQueueLength>
      <ser:timeToLive>0</ser:timeToLive>
    </ser:throttling>
    <ser:messageTracing enabled="false">
      <ser:detailsLevel>Terse</ser:detailsLevel>
      <ser:maxSize>8192</ser:maxSize>
    </ser:messageTracing>
  </ser:coreEntry>
  <ser:endpointConfig>
    <tran:provider-id>http</tran:provider-id>
    <tran:inbound>true</tran:inbound>
    <tran:URI>
      <env:value>/SMiddleware/OperationsAndExecution/Payments/PagoRecaudo_v2</env:value>
    </tran:URI>
    <tran:inbound-properties/>
    <tran:all-headers>false</tran:all-headers>
    <tran:provider-specific xsi:type="http:HttpEndPointConfiguration">
      <http:inbound-properties>
        <http:use-https>true</http:use-https>
      </http:inbound-properties>
    </tran:provider-specific>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-7745914743304006832--2b29889c.13e0dda97de.-77ec">
    <con:pipeline type="response" name="ValidacionesGenerales1_response"/>
    <con:pipeline type="request" name="ValidacionesGenerales1_request">
      <con:stage name="ValidacionXSD">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
        </con:context>
        <con:actions>
          <con2:validate>
            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ba2</con1:id>
            <con2:schema ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoTypes"/>
            <con2:schemaElement xmlns:pag="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes">pag:pagoRecaudo</con2:schemaElement>
            <con2:varName>body</con2:varName>
            <con2:location>
              <con1:xpathText>./pag:pagoRecaudo</con1:xpathText>
            </con2:location>
          </con2:validate>
        </con:actions>
      </con:stage>
      <con:stage name="ValidacionServicioRegional">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/ValidaServicioRegional" prefix="val"/>
        </con:context>
        <con:actions>
          <con2:wsCallout>
            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7b9a</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ValidaServicioRegional/biz/ValidaServicioRegional_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>ValidaServicioRegional</con2:operation>
            <con2:request>
              <con2:body>$reqValidaServicioRegional</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>respValidaServicioRegional</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="reqValidaServicioRegional">
                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ba1</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/Generales/xq/validaServicioRegionalIn"/>
                    <con1:param name="requestHeader1">
                      <con1:path>$header/aut:RequestHeader</con1:path>
                    </con1:param>
                    <con1:param name="serviceId">
                      <con1:path>"FICBCO0067"</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:ifThenElse>
                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ba0</con1:id>
                <con2:case>
                  <con2:condition>
                    <con1:xqueryText>fn:string($respValidaServicioRegional/val:PV_CODIGO_ERROR/text()) != 'SUCCESS'</con1:xqueryText>
                  </con2:condition>
                  <con2:actions>
                    <con2:replace contents-only="true" varName="header">
                      <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7b9f</con1:id>
                      <con2:expr>
                        <con1:xqueryText><![CDATA[<aut:ResponseHeader>
<successIndicator>ERROR</successIndicator>
<messages>{fn:string($respValidaServicioRegional/val:PV_MENSAJE_ERROR/text())}</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                      </con2:expr>
                    </con2:replace>
                    <con2:replace contents-only="true" varName="body">
                      <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7b9e</con1:id>
                      <con2:expr>
                        <con1:xqueryText>&lt;pag:pagoRecaudoResponse/></con1:xqueryText>
                      </con2:expr>
                    </con2:replace>
                    <con1:reply>
                      <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7b9d</con1:id>
                    </con1:reply>
                  </con2:actions>
                </con2:case>
                <con2:default>
                  <con2:replace contents-only="true" varName="header">
                    <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7b9c</con1:id>
                    <con2:expr>
                      <con1:xqueryTransform>
                        <con1:resource ref="Middleware/v2/Resources/Generales/xq/aplicarValoresPorDefectoRegion"/>
                        <con1:param name="requestHeader">
                          <con1:path>$header/aut:RequestHeader</con1:path>
                        </con1:param>
                      </con1:xqueryTransform>
                    </con2:expr>
                  </con2:replace>
                  <con2:assign varName="areSameSourceAndDestination">
                    <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7b9b</con1:id>
                    <con2:expr>
                      <con1:xqueryTransform>
                        <con1:resource ref="Middleware/v2/Resources/Generales/xq/validarCrucePaisEmpresa"/>
                        <con1:param name="requestHeader">
                          <con1:path>$header/aut:RequestHeader</con1:path>
                        </con1:param>
                      </con1:xqueryTransform>
                    </con2:expr>
                  </con2:assign>
                </con2:default>
              </con2:ifThenElse>
            </con2:responseTransform>
          </con2:wsCallout>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="Default_PagoRecaudo_response">
      <con:stage name="FlujoSalida">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/emisionChequesGerenciaTypes" prefix="emis"/>
        </con:context>
        <con:actions>
          <con2:Error>
            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7bbe</con1:id>
            <con2:errCode>MW-0008</con2:errCode>
            <con2:message>SERVICE NOT IMPLEMENTED YET FOR THIS COUNTRY/COMPANY</con2:message>
          </con2:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="HNBanco_PagoRecaudo_response">
      <con:stage name="consultaUsuario" errorHandler="_onErrorHandler-7574666020233826098--7470f80a.153bfa2e568.-7fd3">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-4912419341260919808--4992c4cc.1539b534ee0.-7f38</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>fn:string($RESPONSE/Status/successIndicator/text()) = "Success" and
$validationMessage = ""</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-4912419341260919808--4992c4cc.1539b534ee0.-7f14</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/Core/Resources/CoreBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>Consultadeusuariosdelsistema</con2:operation>
                  <con2:request>
                    <con2:body>$REQConsUsuario</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPConsUsuario</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:ifThenElse>
                      <con1:comment>Condicion para determinar si la transacción es del módulo de FT o TT. Los posibles valore son:
* count($RESPONSE/TELLERType) > 0 = TRUE => Transacción es del módulo TT
* count($RESPONSE/TELLERType) > 0 = FALSO => Transacción es del módulo FT</con1:comment>
                      <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7fd4</con1:id>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>count($RESPONSE/TELLERType) > 0</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:assign varName="REQConsUsuario">
                            <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7f7a</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoConsultaUsuarioTellerIn"/>
                                <con1:param name="tELLERType1">
                                  <con1:path>$RESPONSE/TELLERType</con1:path>
                                </con1:param>
                                <con1:param name="requestHeader1">
                                  <con1:path>$header/aut:RequestHeader</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:actions>
                      </con2:case>
                      <con2:default>
                        <con2:assign varName="REQConsUsuario">
                          <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7f5d</con1:id>
                          <con2:expr>
                            <con1:xqueryTransform>
                              <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoConsultaUsuarioTransferIn"/>
                              <con1:param name="fUNDSTRANSFERType1">
                                <con1:path>$RESPONSE/FUNDSTRANSFERType</con1:path>
                              </con1:param>
                              <con1:param name="requestHeader">
                                <con1:path>$header/aut:RequestHeader</con1:path>
                              </con1:param>
                            </con1:xqueryTransform>
                          </con2:expr>
                        </con2:assign>
                        <con2:assign varName="cuentaTemp">
                          <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7f10</con1:id>
                          <con2:expr>
                            <con1:xqueryText>fn:string($RESPONSE/FUNDSTRANSFERType/DEBITACCTNO/text())</con1:xqueryText>
                          </con2:expr>
                        </con2:assign>
                      </con2:default>
                    </con2:ifThenElse>
                  </con2:requestTransform>
                  <con2:responseTransform/>
                </con2:wsCallout>
                <con2:assign varName="branchName">
                  <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7f28</con1:id>
                  <con2:expr>
                    <con1:xqueryText>fn:string($RSPConsUsuario/WSUSERType/gWSUSERDetailType/mWSUSERDetailType/BRANCHNAME/text())</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="consultaCuenta" errorHandler="_onErrorHandler-7574666020233826098--7470f80a.153bfa2e568.-7e97">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:comment>Condicion para determinar si se procede con la consulta de la cuenta.</con1:comment>
            <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7e98</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>fn:string($cuentaTemp) != "" and
fn:string($RESPONSE/Status/successIndicator/text()) = "Success" and
$validationMessage = ""</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7e2d</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/ConsultasCuenta/Resources/consultaCuentasBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>Consultadedetallesdelacuenta</con2:operation>
                  <con2:request>
                    <con2:body>$REQConsCuenta</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPConsCuenta</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQConsCuenta">
                      <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7e06</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoConsultaDetalleCuentaIn"/>
                          <con1:param name="cuentaTemp">
                            <con1:path>fn:string($cuentaTemp)</con1:path>
                          </con1:param>
                          <con1:param name="requestHeader1">
                            <con1:path>$header/aut:RequestHeader</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:assign varName="cuenta">
                      <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7dec</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoConsultaDetalleCuentaOut"/>
                          <con1:param name="consultadedetallesdelacuentaResponse">
                            <con1:path>$RSPConsCuenta</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:assign varName="cuenta">
                <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7dc7</con1:id>
                <con2:expr>
                  <con1:xqueryText>""</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="ProxyResponse">
        <con:context xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="T24WebServicesImpl" prefix="t24"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/FLINK/OSB_K_RECAUDOS_REF_ONLINE/OSB_ARMAR_MENSAJE/" prefix="osb"/>
        </con:context>
        <con:actions xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
          <con1:assign varName="username" xmlns:con3="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/services/security/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-988878641415943334--dd48f69.1562263714c.-7d43</con6:id>
            <con1:expr>
              <con6:xqueryText xmlns:con6="http://www.bea.com/wli/sb/stages/config">fn:string($header/aut:RequestHeader/Authentication/UserName/text())</con6:xqueryText>
            </con1:expr>
          </con1:assign>
          <con2:ifThenElse>
            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c41</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage != ""</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace varName="header" contents-only="false">
                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c40</con1:id>
                  <con2:expr>
                    <con1:xqueryText>$RESHeaderRegistraPago</con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:replace varName="body" contents-only="true">
                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c3f</con1:id>
                  <con2:expr>
                    <con1:xqueryText>&lt;pag:pagoRecaudoResponse/></con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con1:skip>
                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c3e</con1:id>
                </con1:skip>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:ifThenElse>
                <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-66a5</con1:id>
                <con2:case>
                  <con2:condition>
                    <con1:xqueryText>fn:string($type) = "MOBILE_RECHARGE" or fn:string($type) = "MOBILE_PACKAGE"</con1:xqueryText>
                  </con2:condition>
                  <con2:actions>
                    <con2:ifThenElse>
                      <con1:id>_ActionId-9124541888682138008--355a5d1c.16c73b3130d.-6308</con1:id>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>fn:string($type) = "MOBILE_RECHARGE"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:replace contents-only="false" varName="header">
                            <con1:id>_ActionId-9124541888682138008--355a5d1c.16c73b3130d.-6306</con1:id>
                            <con2:expr>
                              <con1:xqueryText>$RSPHeaderCompraRecarga</con1:xqueryText>
                            </con2:expr>
                          </con2:replace>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-9124541888682138008--355a5d1c.16c73b3130d.-6302</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>$header/aut:ResponseHeader/successIndicator = "Success"</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:replace contents-only="true" varName="body">
                                  <con1:id>_ActionId-9124541888682138008--355a5d1c.16c73b3130d.-6301</con1:id>
                                  <con2:expr>
                                    <con1:xqueryTransform>
                                      <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoCompraRecargaOut"/>
                                      <con1:param name="compraRecargaResponse">
                                        <con1:path>$RSPCompraRecarga</con1:path>
                                      </con1:param>
                                      <con1:param name="consultaDetalleContratoRecaudosResponse">
                                        <con1:path>$RSPConsultaDetalleContratoRecaudos</con1:path>
                                      </con1:param>
                                    </con1:xqueryTransform>
                                  </con2:expr>
                                </con2:replace>
                              </con2:actions>
                            </con2:case>
                            <con2:default>
                              <con2:replace contents-only="true" varName="body">
                                <con1:id>_ActionId-9124541888682138008--355a5d1c.16c73b3130d.-6300</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>&lt;pag:pagoRecaudoResponse/></con1:xqueryText>
                                </con2:expr>
                              </con2:replace>
                            </con2:default>
                          </con2:ifThenElse>
                        </con2:actions>
                      </con2:case>
                      <con2:default>
                        <con2:replace contents-only="false" varName="header">
                          <con1:id>_ActionId-9124541888682138008--355a5d1c.16c73b3130d.-62c8</con1:id>
                          <con2:expr>
                            <con1:xqueryText>$RSPHdrCompraPaquetes</con1:xqueryText>
                          </con2:expr>
                        </con2:replace>
                        <con2:ifThenElse>
                          <con1:id>_ActionId-9124541888682138008--355a5d1c.16c73b3130d.-6258</con1:id>
                          <con2:case>
                            <con2:condition>
                              <con1:xqueryText>$header/aut:ResponseHeader/successIndicator = "Success"</con1:xqueryText>
                            </con2:condition>
                            <con2:actions>
                              <con2:replace varName="body" contents-only="true">
                                <con1:id>_ActionId-9124541888682138008--355a5d1c.16c73b3130d.-621e</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoCompraPaqueteOut"/>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="compraPaqueteResponse">
                                      <con1:path>$RSPCompraPaquetes</con1:path>
                                    </con1:param>
                                    <con1:param name="consultaDetalleContratoRecaudosResponse">
                                      <con1:path>$RSPConsultaDetalleContratoRecaudos</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:replace>
                            </con2:actions>
                          </con2:case>
                          <con2:default>
                            <con2:replace varName="body" contents-only="true">
                              <con1:id>_ActionId-9124541888682138008--355a5d1c.16c73b3130d.-61e6</con1:id>
                              <con2:expr>
                                <con1:xqueryText>&lt;pag:pagoRecaudoResponse/></con1:xqueryText>
                              </con2:expr>
                            </con2:replace>
                          </con2:default>
                        </con2:ifThenElse>
                      </con2:default>
                    </con2:ifThenElse>
                  </con2:actions>
                </con2:case>
                <con2:default>
                  <con2:ifThenElse>
                    <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65c0</con1:id>
                    <con2:case>
                      <con2:condition>
                        <con1:xqueryText>fn:string($RESPONSE/Status/successIndicator/text()) = "Success"</con1:xqueryText>
                      </con2:condition>
                      <con2:actions>
                        <con2:ifThenElse>
                          <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65bf</con1:id>
                          <con2:case>
                            <con2:condition>
                              <con1:xqueryText>fn:string($type) = "REFERENCED_ONLINE"</con1:xqueryText>
                            </con2:condition>
                            <con2:actions>
                              <con2:wsCallout>
                                <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65ba</con1:id>
                                <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/armarMensajeRecaudo/biz/armarMensajeRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                <con2:operation>armarMensajeRecaudo</con2:operation>
                                <con2:request>
                                  <con2:body>$REQUESTarmarMensajeRecaudoRES</con2:body>
                                </con2:request>
                                <con2:response>
                                  <con2:body>RESPONSEarmarMensajeRecaudoRES</con2:body>
                                </con2:response>
                                <con2:requestTransform>
                                  <con2:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/stages/logging/config">
                                    <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65be</con1:id>
                                    <con2:case>
                                      <con2:condition>
                                        <con1:xqueryText>count($RESPONSE/TELLERType) > 0</con1:xqueryText>
                                      </con2:condition>
                                      <con2:actions>
                                        <con2:assign varName="REQUESTarmarMensajeRecaudoRES">
                                          <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65bd</con1:id>
                                          <con2:expr>
                                            <con1:xqueryTransform>
                                              <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/armarMensajeResponseTTIn"/>
                                              <con1:param name="consultadeparametroscoreResponse">
                                                <con1:path>$RESPONSEConsultadeparametroscore</con1:path>
                                              </con1:param>
                                              <con1:param name="pagoRecaudo">
                                                <con1:path>$body/pag:pagoRecaudo</con1:path>
                                              </con1:param>
                                              <con1:param name="consultaDetalleContratoRecaudosResponse">
                                                <con1:path>$RSPConsultaDetalleContratoRecaudos</con1:path>
                                              </con1:param>
                                              <con1:param name="serviceResponse">
                                                <con1:path>$ServiceResponseREQ</con1:path>
                                              </con1:param>
                                              <con1:param name="tELLERType">
                                                <con1:path>$RESPONSE/TELLERType</con1:path>
                                              </con1:param>
                                            </con1:xqueryTransform>
                                          </con2:expr>
                                        </con2:assign>
                                      </con2:actions>
                                    </con2:case>
                                    <con2:default>
                                      <con2:assign varName="REQUESTarmarMensajeRecaudoRES">
                                        <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65bc</con1:id>
                                        <con2:expr>
                                          <con1:xqueryTransform>
                                            <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/armarMensajeResponseFTIn"/>
                                            <con1:param name="consultadeparametroscoreResponse">
                                              <con1:path>$RESPONSEConsultadeparametroscore</con1:path>
                                            </con1:param>
                                            <con1:param name="pagoRecaudo">
                                              <con1:path>$body/pag:pagoRecaudo</con1:path>
                                            </con1:param>
                                            <con1:param name="consultaDetalleContratoRecaudosResponse">
                                              <con1:path>$RSPConsultaDetalleContratoRecaudos</con1:path>
                                            </con1:param>
                                            <con1:param name="fUNDSTRANSFERType">
                                              <con1:path>$RESPONSE/FUNDSTRANSFERType</con1:path>
                                            </con1:param>
                                            <con1:param name="serviceResponse">
                                              <con1:path>$ServiceResponseREQ</con1:path>
                                            </con1:param>
                                          </con1:xqueryTransform>
                                        </con2:expr>
                                      </con2:assign>
                                    </con2:default>
                                  </con2:ifThenElse>
                                </con2:requestTransform>
                                <con2:responseTransform>
                                  <con2:assign varName="successIndicatoArmarMensajeRecaudoRES">
                                    <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65bb</con1:id>
                                    <con2:expr>
                                      <con1:xqueryText>fn:string($RESPONSEarmarMensajeRecaudoRES/osb:CODIGO_RESPUESTA/text())</con1:xqueryText>
                                    </con2:expr>
                                  </con2:assign>
                                </con2:responseTransform>
                              </con2:wsCallout>
                              <con2:ifThenElse>
                                <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65b9</con1:id>
                                <con2:case>
                                  <con2:condition>
                                    <con1:xqueryText>fn:upper-case($successIndicatoArmarMensajeRecaudoRES) = "SUCCESS"</con1:xqueryText>
                                  </con2:condition>
                                  <con2:actions>
                                    <con2:assign varName="RESPONSE">
                                      <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65b8</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>fn-bea:inlinedXML(fn:string($RESPONSEarmarMensajeRecaudoRES/osb:MENSAJE/text()))</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:actions>
                                </con2:case>
                                <con2:default>
                                  <con2:replace varName="header" contents-only="true">
                                    <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65b7</con1:id>
                                    <con2:expr>
                                      <con1:xqueryText><![CDATA[<aut:ResponseHeader>
<successIndicator>ERROR</successIndicator>
<messages>{ fn:string($RESPONSEarmarMensajeRecaudoRES/osb:MENSAJE_RESPUESTA/text()) }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                                    </con2:expr>
                                  </con2:replace>
                                  <con2:replace contents-only="true" varName="body">
                                    <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65b6</con1:id>
                                    <con2:expr>
                                      <con1:xqueryText>&lt;pag:pagoRecaudoResponse/></con1:xqueryText>
                                    </con2:expr>
                                  </con2:replace>
                                  <con1:skip>
                                    <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65b5</con1:id>
                                  </con1:skip>
                                </con2:default>
                              </con2:ifThenElse>
                            </con2:actions>
                          </con2:case>
                          <con2:default/>
                        </con2:ifThenElse>
                        <con2:wsCallout>
                          <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65b3</con1:id>
                          <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/recaudos/Resources/ActualizarEstadoRelacionOperacionRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                          <con2:operation>actualizarEstadoRelacionOperacionRecaudo</con2:operation>
                          <con2:request>
                            <con2:body>$REQUESTactualizarEstadoRelacionOperacionRecaudo</con2:body>
                          </con2:request>
                          <con2:response>
                            <con2:body>RESPONSEactualizarEstadoRelacionOperacionRecaudo</con2:body>
                          </con2:response>
                          <con2:requestTransform>
                            <con2:assign varName="REQUESTactualizarEstadoRelacionOperacionRecaudo">
                              <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65b4</con1:id>
                              <con2:expr>
                                <con1:xqueryTransform>
                                  <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoActualizarEstadoRelacionOperRecaudoIn"/>
                                  <con1:param name="estadoAnterior">
                                    <con1:path>"1"</con1:path>
                                  </con1:param>
                                  <con1:param name="codigoDeudor">
                                    <con1:path>fn:string($body/pag:pagoRecaudo/DEBTOR_CODE/text())</con1:path>
                                  </con1:param>
                                  <con1:param name="estadoNuevo">
                                    <con1:path>"2"</con1:path>
                                  </con1:param>
                                  <con1:param name="codigoContrato">
                                    <con1:path>fn:string($body/pag:pagoRecaudo/CONTRACT_ID/text())</con1:path>
                                  </con1:param>
                                  <con1:param name="codigoFactura">
                                    <con1:path>fn:string($body/pag:pagoRecaudo/BILL_INFORMATION/BILL_NUMBER/text())</con1:path>
                                  </con1:param>
                                </con1:xqueryTransform>
                              </con2:expr>
                            </con2:assign>
                          </con2:requestTransform>
                          <con2:responseTransform/>
                        </con2:wsCallout>
                        <con2:assign varName="headerRequest">
                          <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65b2</con1:id>
                          <con2:expr>
                            <con1:xqueryText>$header</con1:xqueryText>
                          </con2:expr>
                        </con2:assign>
                        <con2:assign varName="bodyRequest">
                          <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65b1</con1:id>
                          <con2:expr>
                            <con1:xqueryText>$body</con1:xqueryText>
                          </con2:expr>
                        </con2:assign>
                        <con2:ifThenElse>
                          <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65b0</con1:id>
                          <con2:case>
                            <con2:condition>
                              <con1:xqueryText>count($RESPONSE/TELLERType) > 0</con1:xqueryText>
                            </con2:condition>
                            <con2:actions>
                              <con2:replace varName="header" contents-only="true">
                                <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65af</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoTellerHeaderOut"/>
                                    <con1:param name="status">
                                      <con1:path>$RESPONSE/Status</con1:path>
                                    </con1:param>
                                    <con1:param name="tELLERType">
                                      <con1:path>$RESPONSE/TELLERType</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:replace>
                              <con2:ifThenElse>
                                <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65ae</con1:id>
                                <con2:case>
                                  <con2:condition>
                                    <con1:xqueryText>fn:string($type) = "REFERENCED_LOCAL"</con1:xqueryText>
                                  </con2:condition>
                                  <con2:actions>
                                    <con2:replace varName="body" contents-only="true">
                                      <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65ad</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoPagoAbanksTTOut"/>
                                          <con1:param name="consultadeparametroscoreResponse">
                                            <con1:path>$RESPONSEConsultadeparametroscore</con1:path>
                                          </con1:param>
                                          <con1:param name="pagoRecaudo">
                                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="outputParameters">
                                            <con1:path>$RSPPagoRecAbanks</con1:path>
                                          </con1:param>
                                          <con1:param name="authorizationCode">
                                            <con1:path>$authorizationCode</con1:path>
                                          </con1:param>
                                          <con1:param name="tELLERType">
                                            <con1:path>$RESPONSE/TELLERType</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:replace>
                                  </con2:actions>
                                </con2:case>
                                <con2:default>
                                  <con2:replace varName="body" contents-only="true">
                                    <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65ac</con1:id>
                                    <con2:expr>
                                      <con1:xqueryTransform>
                                        <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoTellerOut"/>
                                        <con1:param name="consultaDetalleContratoRecaudosResponse">
                                          <con1:path>$RSPConsultaDetalleContratoRecaudos</con1:path>
                                        </con1:param>
                                        <con1:param name="authorizationCode">
                                          <con1:path>$authorizationCode</con1:path>
                                        </con1:param>
                                        <con1:param name="consultadeusuariosdelsistemaResponse">
                                          <con1:path>$RSPConsUsuario</con1:path>
                                        </con1:param>
                                        <con1:param name="tELLERType">
                                          <con1:path>$RESPONSE/TELLERType</con1:path>
                                        </con1:param>
                                      </con1:xqueryTransform>
                                    </con2:expr>
                                  </con2:replace>
                                </con2:default>
                              </con2:ifThenElse>
                            </con2:actions>
                          </con2:case>
                          <con2:default>
                            <con2:replace varName="header" contents-only="true">
                              <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65ab</con1:id>
                              <con2:expr>
                                <con1:xqueryTransform>
                                  <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoTransferHeaderOut"/>
                                  <con1:param name="fUNDSTRANSFERType">
                                    <con1:path>$RESPONSE/FUNDSTRANSFERType</con1:path>
                                  </con1:param>
                                  <con1:param name="status">
                                    <con1:path>$RESPONSE/Status</con1:path>
                                  </con1:param>
                                </con1:xqueryTransform>
                              </con2:expr>
                            </con2:replace>
                            <con2:ifThenElse>
                              <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65aa</con1:id>
                              <con2:case>
                                <con2:condition>
                                  <con1:xqueryText>fn:string($type) = "REFERENCED_LOCAL"</con1:xqueryText>
                                </con2:condition>
                                <con2:actions>
                                  <con2:replace varName="body" contents-only="true">
                                    <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65a9</con1:id>
                                    <con2:expr>
                                      <con1:xqueryTransform>
                                        <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoPagoAbanksFTOut"/>
                                        <con1:param name="pagoRecaudo">
                                          <con1:path>$body/pag:pagoRecaudo</con1:path>
                                        </con1:param>
                                        <con1:param name="consultadeparametroscoreResponse">
                                          <con1:path>$RESPONSEConsultadeparametroscore</con1:path>
                                        </con1:param>
                                        <con1:param name="outputParameters">
                                          <con1:path>$RSPPagoRecAbanks</con1:path>
                                        </con1:param>
                                        <con1:param name="cuenta">
                                          <con1:path>fn:string($cuenta)</con1:path>
                                        </con1:param>
                                        <con1:param name="authorizationCode">
                                          <con1:path>$authorizationCode</con1:path>
                                        </con1:param>
                                        <con1:param name="fUNDSTRANSFERType">
                                          <con1:path>$RESPONSE/FUNDSTRANSFERType</con1:path>
                                        </con1:param>
                                      </con1:xqueryTransform>
                                    </con2:expr>
                                  </con2:replace>
                                </con2:actions>
                              </con2:case>
                              <con2:default>
                                <con2:replace varName="body" contents-only="true">
                                  <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65a8</con1:id>
                                  <con2:expr>
                                    <con1:xqueryTransform>
                                      <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoTransferOut"/>
                                      <con1:param name="consultaDetalleContratoRecaudosResponse">
                                        <con1:path>$RSPConsultaDetalleContratoRecaudos</con1:path>
                                      </con1:param>
                                      <con1:param name="cuenta">
                                        <con1:path>fn:string($cuenta)</con1:path>
                                      </con1:param>
                                      <con1:param name="authorizationCode">
                                        <con1:path>$authorizationCode</con1:path>
                                      </con1:param>
                                      <con1:param name="fUNDSTRANSFERType">
                                        <con1:path>$RESPONSE/FUNDSTRANSFERType</con1:path>
                                      </con1:param>
                                      <con1:param name="branchName">
                                        <con1:path>$branchName</con1:path>
                                      </con1:param>
                                    </con1:xqueryTransform>
                                  </con2:expr>
                                </con2:replace>
                                <con4:route>
                                  <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65a7</con1:id>
                                  <con4:service ref="Middleware/v2/BusinessServices/CNV/registrarRecibo/biz/registrarRecibo_db" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                  <con4:operation>registrarRecibo</con4:operation>
                                  <con4:outboundTransform>
                                    <con2:replace varName="body" contents-only="true">
                                      <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65a6</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoRegistrarReciboIn"/>
                                          <con1:param name="txnDate">
                                            <con1:path>fn:string($header/aut:ResponseHeader/valueDate/text())</con1:path>
                                          </con1:param>
                                          <con1:param name="dealslip">
                                            <con1:path>fn:string($body/pag:pagoRecaudoResponse/BILL_DETAIL/text())</con1:path>
                                          </con1:param>
                                          <con1:param name="inputter">
                                            <con1:path>fn:string($body/pag:pagoRecaudoResponse/INPUTTER/text())</con1:path>
                                          </con1:param>
                                          <con1:param name="debtorCode">
                                            <con1:path>fn:string(fn:tokenize($reqParams,"\|")[3])</con1:path>
                                          </con1:param>
                                          <con1:param name="altTxnId">
                                            <con1:path>""</con1:path>
                                          </con1:param>
                                          <con1:param name="contractId">
                                            <con1:path>fn:string(fn:tokenize($reqParams,"\|")[2])</con1:path>
                                          </con1:param>
                                          <con1:param name="transactionId">
                                            <con1:path>fn:string($header/aut:ResponseHeader/transactionId/text())</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:replace>
                                  </con4:outboundTransform>
                                </con4:route>
                              </con2:default>
                            </con2:ifThenElse>
                          </con2:default>
                        </con2:ifThenElse>
                      </con2:actions>
                    </con2:case>
                    <con2:default>
                      <con2:replace varName="header" contents-only="true">
                        <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65a5</con1:id>
                        <con2:expr>
                          <con1:xqueryText><![CDATA[<aut:ResponseHeader>
<successIndicator>{ fn:string($RESPONSE/Status/successIndicator/text()) }</successIndicator>
<messages>{ fn:string-join($RESPONSE/Status/messages/text()," ") }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                        </con2:expr>
                      </con2:replace>
                      <con2:replace contents-only="true" varName="body">
                        <con1:id>_ActionId-3811985094530719212--e62c8d5.156a456fc17.-65a4</con1:id>
                        <con2:expr>
                          <con1:xqueryText>&lt;pag:pagoRecaudoResponse/></con1:xqueryText>
                        </con2:expr>
                      </con2:replace>
                    </con2:default>
                  </con2:ifThenElse>
                </con2:default>
              </con2:ifThenElse>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="ConvertirHTML">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaRecaudoTypes" prefix="con"/>
          <con1:varNsDecl namespace="T24WebServicesImpl" prefix="t24"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/transformarReciboRecaudo" prefix="tran"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-988878641415943334--dd48f69.1562263714c.-7d9b</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$body/pag:pagoRecaudoResponse/BILL_DETAIL/text() != ""</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-988878641415943334--dd48f69.1562263714c.-7d99</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/CNV/transformarReciboRecaudo/biz/transformarReciboRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>transformarReciboRecaudo</con2:operation>
                  <con2:request>
                    <con2:body>$REQTransformarRecRecaudo</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPTransformarRecRecaudo</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQTransformarRecRecaudo">
                      <con1:id>_ActionId-988878641415943334--dd48f69.1562263714c.-7d9a</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/Generales/xq/transformarReciboRecaudoIn"/>
                          <con1:param name="username">
                            <con1:path>$username</con1:path>
                          </con1:param>
                          <con1:param name="dealslip">
                            <con1:path>fn:string($body/pag:pagoRecaudoResponse/BILL_DETAIL/text())</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform/>
                </con2:wsCallout>
                <con2:ifThenElse>
                  <con1:id>_ActionId-988878641415943334--dd48f69.1562263714c.-7d98</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>fn:upper-case($RSPTransformarRecRecaudo/tran:CODIGO_RESPUESTA/text()) = 'SUCCESS'</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:replace varName="body" contents-only="true">
                        <con1:id>_ActionId-988878641415943334--dd48f69.1562263714c.-7d97</con1:id>
                        <con2:location>
                          <con1:xpathText>./pag:pagoRecaudoResponse/BILL_DETAIL</con1:xpathText>
                        </con2:location>
                        <con2:expr>
                          <con1:xqueryText>$RSPTransformarRecRecaudo/tran:PV_DEALSLIP/text()</con1:xqueryText>
                        </con2:expr>
                      </con2:replace>
                    </con2:actions>
                  </con2:case>
                  <con2:default/>
                </con2:ifThenElse>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="MapeoError">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-9047835847604534838-7599437e.155bb5368e5.-712a</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) != "SUCCESS"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-9047835847604534838-7599437e.155bb5368e5.-7127</con1:id>
                  <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>mapeoErrores</con2:operation>
                  <con2:request>
                    <con2:body>$REQMapeoErrores</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPMapeoErrores</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQMapeoErrores">
                      <con1:id>_ActionId-9047835847604534838-7599437e.155bb5368e5.-7129</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                          <con1:param name="CODIGO_ERROR">
                            <con1:path>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text()))</con1:path>
                          </con1:param>
                          <con1:param name="MENSAJE_ERROR">
                            <con1:path>fn:concat("FICBCO0067","$#$",fn:string-join($header/aut:ResponseHeader/messages, '||'))</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:replace varName="header" contents-only="true">
                      <con1:id>_ActionId-9047835847604534838-7599437e.155bb5368e5.-7128</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                          <con1:param name="mapeoErroresResponse1">
                            <con1:path>$RSPMapeoErrores</con1:path>
                          </con1:param>
                          <con1:param name="successIndicator">
                            <con1:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:replace>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="BitacoraResponse">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaRecaudoTypes" prefix="con"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
        </con:context>
        <con:actions>
          <con1:assign varName="uuidBitacoraResponse" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c1c</con5:id>
            <con1:expr>
              <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                <con4:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
              </con4:xqueryTransform>
            </con1:expr>
          </con1:assign>
          <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c1b</con5:id>
            <con2:service ref="Middleware/v2/BusinessServices/registroBitacoraConvenios/biz/registroBitacoraConvenios" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>registroBitacoraConvenio</con2:operation>
            <con2:outboundTransform>
              <con1:assign varName="timestampBitacoraResponse">
                <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c1a</con5:id>
                <con1:expr>
                  <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                    <con4:resource ref="Middleware/Business_Resources/general/TimeStamp/obtenerTimestamp"/>
                  </con4:xqueryTransform>
                </con1:expr>
              </con1:assign>
              <con1:replace contents-only="true" varName="body">
                <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c19</con5:id>
                <con1:expr>
                  <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                    <con4:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/registrarBitacoraResponseIn"/>
                    <con4:param name="uuidBitacoraRequest">
                      <con4:path>$uuidBitacoraRequest</con4:path>
                    </con4:param>
                    <con4:param name="requestHeader">
                      <con4:path>$originalRequestHeader/aut:RequestHeader</con4:path>
                    </con4:param>
                    <con4:param name="pagoRecaudoResponse">
                      <con4:path>$body/pag:pagoRecaudoResponse</con4:path>
                    </con4:param>
                    <con4:param name="dateTimeBitacora">
                      <con4:path>$timestampBitacoraResponse</con4:path>
                    </con4:param>
                    <con4:param name="pagoRecaudo">
                      <con4:path>$originalRequestBody/pag:pagoRecaudo</con4:path>
                    </con4:param>
                    <con4:param name="uuidBitacora">
                      <con4:path>$uuidBitacoraResponse</con4:path>
                    </con4:param>
                    <con4:param name="traceProxy">
                      <con4:path>fn:string($traceProxy)</con4:path>
                    </con4:param>
                    <con4:param name="responseHeader">
                      <con4:path>$header/aut:ResponseHeader</con4:path>
                    </con4:param>
                  </con4:xqueryTransform>
                </con1:expr>
              </con1:replace>
            </con2:outboundTransform>
          </con2:route>
          <con5:skip xmlns:con4="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con5="http://www.bea.com/wli/sb/stages/config">
            <con5:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c18</con5:id>
          </con5:skip>
        </con:actions>
      </con:stage>
      <con:stage name="BitacoraTransaccion">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
        </con:context>
        <con:actions>
          <con2:assign varName="uuidBitacoraTransaccion">
            <con1:id>_ActionId-7257727533132088401--3c64eaff.1965dea866e.-7dc3</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con4:route>
            <con1:id>_ActionId-3681242578460545555-1216fdc5.196ab427994.-7fd3</con1:id>
            <con4:service ref="Middleware/v2/BusinessServices/registraBitacoraTransaccion/biz/registraBitacoraTransaccionBS" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con4:outboundTransform>
              <con2:replace varName="body" contents-only="true">
                <con1:id>_ActionId-3681242578460545555-1216fdc5.196ab427994.-7ec8</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/registraBitacoraTransaccionIn"/>
                    <con1:param name="pagoRecaudoResponse">
                      <con1:path>$body/pag:pagoRecaudoResponse</con1:path>
                    </con1:param>
                    <con1:param name="pagoRecaudo">
                      <con1:path>$originalRequestBody/pag:pagoRecaudo</con1:path>
                    </con1:param>
                    <con1:param name="requestHeader">
                      <con1:path>$originalRequestHeader/aut:RequestHeader</con1:path>
                    </con1:param>
                    <con1:param name="uuid">
                      <con1:path>$uuidBitacoraTransaccion</con1:path>
                    </con1:param>
                    <con1:param name="responseHeader">
                      <con1:path>$header/aut:ResponseHeader</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:replace>
            </con4:outboundTransform>
          </con4:route>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-7574666020233826098--7470f80a.153bfa2e568.-7fd3">
      <con:stage name="consultaUsuario_Fault">
        <con:context/>
        <con:actions>
          <con2:assign varName="branchName">
            <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7fa0</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($RESPONSE/FUNDSTRANSFERType/LROTHEROFFCER/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="cuentaTemp">
            <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7d78</con1:id>
            <con2:expr>
              <con1:xqueryText>""</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con1:resume>
            <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7fb5</con1:id>
          </con1:resume>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-7574666020233826098--7470f80a.153bfa2e568.-7e97">
      <con:stage name="consultaCuentaFault">
        <con:context/>
        <con:actions>
          <con2:assign varName="cuenta">
            <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7e75</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($RESPONSE/FUNDSTRANSFERType/DEBITACCTNO/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con1:resume>
            <con1:id>_ActionId-7574666020233826098--7470f80a.153bfa2e568.-7e62</con1:id>
          </con1:resume>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-7745914743304006832--2b29889c.13e0dda97de.-77ec">
      <con:stage name="ErrorProxy">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
        </con:context>
        <con:actions>
          <con2:replace contents-only="true" varName="header">
            <con1:id>_ActionId-7745914743304006832--2b29889c.13e0dda97de.-777e</con1:id>
            <con2:expr>
              <con1:xqueryText><![CDATA[<aut:ResponseHeader>
<successIndicator>ERROR</successIndicator>
<messages>{ concat(fn:string($fault/ctx:errorCode/text()), ": ", fn:string($fault/ctx:reason/text())) }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
            </con2:expr>
          </con2:replace>
          <con2:replace contents-only="true" varName="body">
            <con1:id>_ActionId-7745914743304006832--2b29889c.13e0dda97de.-7761</con1:id>
            <con2:expr>
              <con1:xqueryText>&lt;pag:pagoRecaudoResponse/></con1:xqueryText>
            </con2:expr>
          </con2:replace>
          <con1:assign varName="uuidBitacoraError" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-2401187029419953982--619784c.14680ea3f11.-7abe</con4:id>
            <con1:expr>
              <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                <con4:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
              </con4:xqueryTransform>
            </con1:expr>
          </con1:assign>
          <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-2401187029419953982--619784c.14680ea3f11.-7abd</con4:id>
            <con2:service ref="Middleware/v2/BusinessServices/registroBitacoraConvenios/biz/registroBitacoraConvenios" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:outboundTransform>
              <con1:assign varName="timestampBitacoraError">
                <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-2401187029419953982--619784c.14680ea3f11.-7abc</con4:id>
                <con1:expr>
                  <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                    <con4:resource ref="Middleware/Business_Resources/general/TimeStamp/obtenerTimestamp"/>
                  </con4:xqueryTransform>
                </con1:expr>
              </con1:assign>
              <con1:replace contents-only="true" varName="body">
                <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-2401187029419953982--619784c.14680ea3f11.-7abb</con4:id>
                <con1:expr>
                  <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                    <con4:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/registrarBitacoraResponseIn"/>
                    <con4:param name="uuidBitacoraRequest">
                      <con4:path>$uuidBitacoraRequest</con4:path>
                    </con4:param>
                    <con4:param name="requestHeader">
                      <con4:path>$originalRequestHeader/aut:RequestHeader</con4:path>
                    </con4:param>
                    <con4:param name="pagoRecaudoResponse">
                      <con4:path>$body/pag:pagoRecaudoResponse</con4:path>
                    </con4:param>
                    <con4:param name="dateTimeBitacora">
                      <con4:path>$timestampBitacoraError</con4:path>
                    </con4:param>
                    <con4:param name="pagoRecaudo">
                      <con4:path>$originalRequestBody/pag:pagoRecaudo</con4:path>
                    </con4:param>
                    <con4:param name="uuidBitacora">
                      <con4:path>$uuidBitacoraError</con4:path>
                    </con4:param>
                    <con4:param name="traceProxy">
                      <con4:path>fn:string($traceProxy)</con4:path>
                    </con4:param>
                    <con4:param name="responseHeader">
                      <con4:path>$header/aut:ResponseHeader</con4:path>
                    </con4:param>
                  </con4:xqueryTransform>
                </con1:expr>
              </con1:replace>
            </con2:outboundTransform>
          </con2:route>
          <con2:ifThenElse>
            <con1:id>_ActionId-3681242578460545555-1216fdc5.196ab427994.-7f76</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>fn:upper-case(fn:string($originalRequestHeader/aut:RequestHeader/Region/SourceBank/text())) != "HN01"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:assign varName="uuidBitacoraTransaccionError">
                  <con1:id>_ActionId-3681242578460545555-1216fdc5.196ab427994.-7f1a</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:assign>
                <con4:route>
                  <con1:id>_ActionId-3681242578460545555-1216fdc5.196ab427994.-7f3d</con1:id>
                  <con4:service ref="Middleware/v2/BusinessServices/registraBitacoraTransaccion/biz/registraBitacoraTransaccionBS" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con4:outboundTransform>
                    <con2:replace varName="body" contents-only="true">
                      <con1:id>_ActionId-3681242578460545555-1216fdc5.196ab427994.-7e93</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/registraBitacoraTransaccionIn"/>
                          <con1:param name="pagoRecaudoResponse">
                            <con1:path>$body/pag:pagoRecaudoResponse</con1:path>
                          </con1:param>
                          <con1:param name="pagoRecaudo">
                            <con1:path>$originalRequestBody/pag:pagoRecaudo</con1:path>
                          </con1:param>
                          <con1:param name="requestHeader">
                            <con1:path>$originalRequestHeader/aut:RequestHeader</con1:path>
                          </con1:param>
                          <con1:param name="uuid">
                            <con1:path>$uuidBitacoraTransaccionError</con1:path>
                          </con1:param>
                          <con1:param name="responseHeader">
                            <con1:path>$header/aut:ResponseHeader</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:replace>
                  </con4:outboundTransform>
                </con4:route>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
          <con6:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/pipeline/config" xmlns:con6="http://www.bea.com/wli/sb/stages/transform/config">
            <con:id>_ActionId-9047835847604534838-7599437e.155bb5368e5.-707c</con:id>
            <con6:case>
              <con6:condition>
                <con:xqueryText>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text())) != "SUCCESS"</con:xqueryText>
              </con6:condition>
              <con6:actions>
                <con6:wsCallout>
                  <con:id>_ActionId-9047835847604534838-7599437e.155bb5368e5.-7079</con:id>
                  <con6:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con6:operation>mapeoErrores</con6:operation>
                  <con6:request>
                    <con6:body>$REQMapeoErrores</con6:body>
                  </con6:request>
                  <con6:response>
                    <con6:body>RSPMapeoErrores</con6:body>
                  </con6:response>
                  <con6:requestTransform>
                    <con6:assign varName="REQMapeoErrores">
                      <con:id>_ActionId-9047835847604534838-7599437e.155bb5368e5.-707b</con:id>
                      <con6:expr>
                        <con:xqueryTransform>
                          <con:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                          <con:param name="CODIGO_ERROR">
                            <con:path>fn:upper-case(fn:string($header/aut:ResponseHeader/successIndicator/text()))</con:path>
                          </con:param>
                          <con:param name="MENSAJE_ERROR">
                            <con:path>fn:concat("FICBCO0067","$#$",fn:string-join($header/aut:ResponseHeader/messages, '||'))</con:path>
                          </con:param>
                        </con:xqueryTransform>
                      </con6:expr>
                    </con6:assign>
                  </con6:requestTransform>
                  <con6:responseTransform>
                    <con6:replace varName="header" contents-only="true">
                      <con:id>_ActionId-9047835847604534838-7599437e.155bb5368e5.-707a</con:id>
                      <con6:expr>
                        <con:xqueryTransform>
                          <con:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                          <con:param name="mapeoErroresResponse1">
                            <con:path>$RSPMapeoErrores</con:path>
                          </con:param>
                          <con:param name="successIndicator">
                            <con:path>fn:string($header/aut:ResponseHeader/successIndicator/text())</con:path>
                          </con:param>
                        </con:xqueryTransform>
                      </con6:expr>
                    </con6:replace>
                  </con6:responseTransform>
                </con6:wsCallout>
              </con6:actions>
            </con6:case>
            <con6:default/>
          </con6:ifThenElse>
          <con1:reply>
            <con1:id>_ActionId-7745914743304006832--2b29889c.13e0dda97de.-7744</con1:id>
          </con1:reply>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="HNBanco_PagoRecaudo_request">
      <con:stage name="BitacoraRequest">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
        </con:context>
        <con:actions>
          <con1:assign varName="originalRequestHeader" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ce1</con5:id>
            <con1:expr>
              <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">$header</con4:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="originalRequestBody" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ce0</con5:id>
            <con1:expr>
              <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">$body</con4:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="uuidBitacoraRequest" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cdf</con5:id>
            <con1:expr>
              <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                <con4:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
              </con4:xqueryTransform>
            </con1:expr>
          </con1:assign>
          <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cde</con5:id>
            <con2:service ref="Middleware/v2/BusinessServices/registroBitacoraConvenios/biz/registroBitacoraConvenios" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>registroBitacoraConvenio</con2:operation>
            <con2:outboundTransform>
              <con1:assign varName="timestampBitacoraRequest">
                <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cdd</con5:id>
                <con1:expr>
                  <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                    <con4:resource ref="Middleware/Business_Resources/general/TimeStamp/obtenerTimestamp"/>
                  </con4:xqueryTransform>
                </con1:expr>
              </con1:assign>
              <con1:replace contents-only="true" varName="body">
                <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cdc</con5:id>
                <con1:expr>
                  <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                    <con4:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/registrarBitacoraRequestIn"/>
                    <con4:param name="requestHeader">
                      <con4:path>$header/aut:RequestHeader</con4:path>
                    </con4:param>
                    <con4:param name="pagoRecaudo">
                      <con4:path>$body/pag:pagoRecaudo</con4:path>
                    </con4:param>
                    <con4:param name="uuid">
                      <con4:path>$uuidBitacoraRequest</con4:path>
                    </con4:param>
                    <con4:param name="dateTime">
                      <con4:path>$timestampBitacoraRequest</con4:path>
                    </con4:param>
                  </con4:xqueryTransform>
                </con1:expr>
              </con1:replace>
            </con2:outboundTransform>
          </con2:route>
        </con:actions>
      </con:stage>
      <con:stage name="ProxyRequest">
        <con:context>
          <con1:userNsDecl namespace="http://alcance.local/wsinfotarjetas/" prefix="tns"/>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/obtenerSecuencia" prefix="ns0"/>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb4"/>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/registraPagoTCxsd" prefix="ns1"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/FLINK/INT_K_CONVENIOS_NO_ESTANDAR/INT_CV_REGISTRAR_INFO_OPER/" prefix="int"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/FLINK/OSB_CONSULTAR_OPER_RECAUDO/" prefix="osb"/>
          <con1:varNsDecl namespace="T24WebServicesImpl" prefix="t24"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/FLINK/OSB_CONSULTAR_REF_DEPOSITANTE/" prefix="osb1"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/FLINK/OSB_K_RECAUDOS_REF_ONLINE/OSB_CONSULTAR_REF_ONLINE/" prefix="osb2"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/FLINK/OSB_K_RECAUDOS_REF_ONLINE/OSB_ARMAR_MENSAJE/" prefix="osb3"/>
          <con1:varNsDecl namespace="http://service.webserviceprovider.transporters.service.frametexx.com/" prefix="ser"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/consultaContratoReferenciado" prefix="con"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/pagoRecaudoAbanks" prefix="pag1"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaDetalleContratoRecaudosTypes" prefix="con1"/>
        </con:context>
        <con:actions>
          <con2:assign varName="validationMessage">
            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cdb</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoValidate"/>
                <con1:param name="pagoRecaudo">
                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="paymentMethod">
            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cda</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($body/pag:pagoRecaudo/PAYMENT_INFORMATION/PAYMENT_METHOD/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="debtor_code">
            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cd9</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($body/pag:pagoRecaudo/DEBTOR_CODE/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="reqParams">
            <con1:id>_ActionId-3950461790098045846-4b4e7c18.151166abb14.-7f5b</con1:id>
            <con2:expr>
              <con1:xqueryText>concat(
fn:string($header/aut:RequestHeader/Authentication/UserName/text()),"|",
fn:string($body/pag:pagoRecaudo/CONTRACT_ID/text()),"|",
fn:string($body/pag:pagoRecaudo/DEBTOR_CODE/text())
)</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="authorizationCode">
            <con1:id>_ActionId-8127192293546094921--2b896b04.17b7a10f01b.-7fae</con1:id>
            <con2:expr>
              <con1:xqueryText>''</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:ifThenElse>
            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cd8</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage = ""</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-2152864461021708203--1fd188f3.1567f549ec4.-7d46</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/OSB/ConsultaDetalleContratoRecaudo_v2/biz/ConsultaDetalleContratoRecaudo" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>consultaDetalleContratoRecaudos</con2:operation>
                  <con2:request>
                    <con2:body wrapped="false">$REQConsultaDetalleContratoRecaudos</con2:body>
                    <con2:header>$REQHeaderConsultaDetalleContratoRecaudos</con2:header>
                  </con2:request>
                  <con2:response>
                    <con2:body wrapped="false">RSPConsultaDetalleContratoRecaudos</con2:body>
                    <con2:header>RSPHeaderConsultaDetalleContratoRecaudos</con2:header>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQHeaderConsultaDetalleContratoRecaudos">
                      <con1:id>_ActionId-2152864461021708203--1fd188f3.1567f549ec4.-7d0c</con1:id>
                      <con2:expr>
                        <con1:xqueryText>$header</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="REQConsultaDetalleContratoRecaudos">
                      <con1:id>_ActionId-2152864461021708203--1fd188f3.1567f549ec4.-7d48</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoConsultaContratoIn"/>
                          <con1:param name="pagoRecaudo">
                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:assign varName="type">
                      <con1:id>_ActionId-4533626091260228093--17466af4.1569e432141.-661d</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($RSPConsultaDetalleContratoRecaudos/con1:consultaDetalleContratoRecaudosResponseType/con1:consultaDetalleContratoRecaudosResponseRecordType/CONTRACT_TYPE/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="contractName">
                      <con1:id>_ActionId-2152864461021708203--1fd188f3.1567f549ec4.-7d44</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($RSPConsultaDetalleContratoRecaudos/con1:consultaDetalleContratoRecaudosResponseType/con1:consultaDetalleContratoRecaudosResponseRecordType/CONTRACT_NAME/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con1:skip>
                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cd4</con1:id>
              </con1:skip>
            </con2:default>
          </con2:ifThenElse>
          <con2:assign varName="uuid">
            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cd3</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:ifThenElse>
            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cd2</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$type = ""</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:assign varName="validationMessage">
                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cd1</con1:id>
                  <con2:expr>
                    <con1:xqueryText>fn:concat("ERROR LOOKING COLLECTION TYPE ", fn:string-join($RSPHeaderConsultaDetalleContratoRecaudos/aut:ResponseHeader/messages, '. '))</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con1:skip>
                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cd0</con1:id>
                </con1:skip>
              </con2:actions>
            </con2:case>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$type = "LOCAL"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con1:id>_ActionId-9014052120823392757--26aa29da.156add2b8d4.-7d96</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/recaudos/Resources/ConsultarRelacionOperacionRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>consultarRelacionOperacionRecaudo</con2:operation>
                  <con2:request>
                    <con2:body wrapped="false">$REQUESTconsultarRelacionOperacionRecaudo</con2:body>
                    <con2:header/>
                  </con2:request>
                  <con2:response>
                    <con2:body wrapped="false">RESPONSEconsultarRelacionOperacionRecaudo</con2:body>
                    <con2:header/>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQUESTconsultarRelacionOperacionRecaudo">
                      <con1:id>_ActionId-9014052120823392757--26aa29da.156add2b8d4.-7d9a</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoConsultaRelacionOperIn"/>
                          <con1:param name="pagoRecaudo">
                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:ifThenElse>
                      <con1:id>_ActionId-9014052120823392757--26aa29da.156add2b8d4.-7d99</con1:id>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>fn:string($RESPONSEconsultarRelacionOperacionRecaudo/osb:CODIGO_ERROR/text()) != "SUCCESS"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:assign varName="validationMessage">
                            <con1:id>_ActionId-9014052120823392757--26aa29da.156add2b8d4.-7d98</con1:id>
                            <con2:expr>
                              <con1:xqueryText>fn:string($RESPONSEconsultarRelacionOperacionRecaudo/osb:MENSAJE_ERROR/text())</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con1:skip>
                            <con1:id>_ActionId-9014052120823392757--26aa29da.156add2b8d4.-7d97</con1:id>
                          </con1:skip>
                        </con2:actions>
                      </con2:case>
                      <con2:default/>
                    </con2:ifThenElse>
                  </con2:responseTransform>
                </con2:wsCallout>
                <con2:assign varName="cantidadFacturas">
                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cc8</con1:id>
                  <con2:expr>
                    <con1:xqueryText>count($RESPONSEconsultarRelacionOperacionRecaudo/osb:CODIGO_FACTURA/osb:ITEM)</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:ifThenElse>
                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cc7</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>number($cantidadFacturas) > 1</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:assign varName="validationMessage">
                        <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cc6</con1:id>
                        <con2:expr>
                          <con1:xqueryText>"MULTI BILL PAYMENTS FOR LOCAL COLLECTIONS ARE NOT AVAILABLE"</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con1:skip>
                        <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cc5</con1:id>
                      </con1:skip>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con2:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
                      <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cc4</con1:id>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$validationMessage != ""</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con1:skip>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cc3</con1:id>
                          </con1:skip>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "CASH"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cc1</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineaefec</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUEST</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSE</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cc2</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoLocalEfectivoIn"/>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "ACCT_DEBIT"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cbf</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineadbcta</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUEST</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSE</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cc0</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoLocalDebitoCuentaIn"/>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "OWN_CHEQUE"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cbd</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineachqpr</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUEST</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSE</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cbe</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoLocalChequePropioIn"/>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "OTHER_BANK_CHEQUE"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cbb</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineachqob</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUEST</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSE</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cbc</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoLocalChequeOtroBancoIn"/>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "CREDIT_CARD"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:assign varName="contractPaymentMethods">
                            <con1:id>_ActionId-2648626897390461746-7e5cc7cc.15241c99efe.-7c43</con1:id>
                            <con2:expr>
                              <con1:xqueryText>fn:string($RSPConsultaDetalleContratoRecaudos/con1:consultaDetalleContratoRecaudosResponseType/con1:consultaDetalleContratoRecaudosResponseRecordType/PAYMENT_METHODS/PAYMENT_METHOD/text())</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-2648626897390461746-7e5cc7cc.15241c99efe.-7c29</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>fn:contains($contractPaymentMethods,'CREDIT.CARD')</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:replace varName="proxyTrace" contents-only="false">
                                  <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-75cf</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>"prePagoRecaudoLineaTC"</con1:xqueryText>
                                  </con2:expr>
                                </con2:replace>
                                <con2:assign varName="paymentType">
                                  <con1:id>_ActionId-25933579928035449--7f91dd1e.17a8222adbd.-7e64</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>'FICBCO0067.PAYMENT.SERVICE'</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                                <con2:assign varName="debitAcctParamHNL">
                                  <con1:id>_ActionId-1935454175644208791--1ed8087c.17af4f1e7e8.-7f21</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>'T24T113.HNLDEBITAACCTNO'</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                                <con2:assign varName="debitAcctParamUSD">
                                  <con1:id>_ActionId-1935454175644208791--1ed8087c.17af4f1e7e8.-7ee7</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>'T24T113.USDDEBITACCTNO'</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                                <con2:wsCallout>
                                  <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7591</con1:id>
                                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                  <con2:operation>obtenerParametrizacion</con2:operation>
                                  <con2:request>
                                    <con2:body wrapped="false">$REQobtenerParametrizacion</con2:body>
                                    <con2:header/>
                                  </con2:request>
                                  <con2:response>
                                    <con2:body wrapped="false">RESobtenerParametrizacion</con2:body>
                                    <con2:header/>
                                  </con2:response>
                                  <con2:requestTransform>
                                    <con2:assign varName="REQobtenerParametrizacion">
                                      <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7594</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                                          <con1:param name="nombreParametros">
                                            <con1:path>fn:concat("T24T113.HNLDEBITAACCTNO","||",$paymentType,"||",$debitAcctParamHNL,"||",$debitAcctParamUSD)</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:requestTransform>
                                  <con2:responseTransform>
                                    <con2:assign varName="statusParametrizacion">
                                      <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7593</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>fn:string($RESobtenerParametrizacion/osb4:ERROR_CODE/text())</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                    <con2:assign varName="debitAccount">
                                      <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7592</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>fn:string($RESobtenerParametrizacion/osb4:CONFIGURACIONES/osb4:CONFIGURACIONES_ITEM[osb4:NAME="T24T113.HNLDEBITAACCTNO"]/osb4:VALUE/text())</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                    <con2:assign varName="paymentTypeValue">
                                      <con1:id>_ActionId-25933579928035449--7f91dd1e.17a8222adbd.-7dd9</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>fn:string($RESobtenerParametrizacion/osb4:CONFIGURACIONES/osb4:CONFIGURACIONES_ITEM[osb4:NAME="FICBCO0067.PAYMENT.SERVICE"]/osb4:VALUE/text())</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                    <con2:assign varName="validationMessage">
                                      <con1:id>_ActionId-2009442431897224083--18b76099.1811b19b131.-7fae</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>fn:string($RESobtenerParametrizacion/osb4:ERROR_MESSAGE/text())</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:responseTransform>
                                </con2:wsCallout>
                                <con2:ifThenElse>
                                  <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7523</con1:id>
                                  <con2:case>
                                    <con2:condition>
                                      <con1:xqueryText>$statusParametrizacion = "SUCCESS"</con1:xqueryText>
                                    </con2:condition>
                                    <con2:actions>
                                      <con2:wsCallout>
                                        <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7517</con1:id>
                                        <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/RegistraPagoTC" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                        <con2:operation>RegistraPagoTC</con2:operation>
                                        <con2:request>
                                          <con2:body wrapped="false">$REQRegistraPago</con2:body>
                                          <con2:header>$REQHeaderRegistraPago</con2:header>
                                        </con2:request>
                                        <con2:response>
                                          <con2:body wrapped="false">RESRegistraPago</con2:body>
                                          <con2:header>RESHeaderRegistraPago</con2:header>
                                        </con2:response>
                                        <con2:requestTransform>
                                          <con2:assign varName="REQHeaderRegistraPago">
                                            <con1:id>_ActionId-3430351506787836732--5c5b1738.17acf4b69e6.-7ec2</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>$header</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                          <con2:assign varName="transactionType">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-751c</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>'AUTHORIZATION'</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                          <con2:assign varName="userName">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-751b</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>fn:data($header/aut:RequestHeader/Authentication/UserName)</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                          <con2:assign varName="REQRegistraPago">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-751a</con1:id>
                                            <con2:expr>
                                              <con1:xqueryTransform>
                                                <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/Tx_PagoRecaudo_To_RegistraPagoTC"/>
                                                <con1:param name="paymentTypeValue">
                                                  <con1:path>$paymentTypeValue</con1:path>
                                                </con1:param>
                                                <con1:param name="transactionType">
                                                  <con1:path>$transactionType</con1:path>
                                                </con1:param>
                                                <con1:param name="pagoRecaudo1">
                                                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                                                </con1:param>
                                                <con1:param name="userName">
                                                  <con1:path>$userName</con1:path>
                                                </con1:param>
                                                <con1:param name="ORG">
                                                  <con1:path>''</con1:path>
                                                </con1:param>
                                                <con1:param name="contractName">
                                                  <con1:path>$contractName</con1:path>
                                                </con1:param>
                                              </con1:xqueryTransform>
                                            </con2:expr>
                                          </con2:assign>
                                        </con2:requestTransform>
                                        <con2:responseTransform>
                                          <con2:assign varName="authorizationCode">
                                            <con1:id>_ActionId-6331445151607000639-35f7b016.17b30d90a1a.-7fad</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>data($RESRegistraPago/AUTHORIZATION_CODE)</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                          <con2:assign varName="org">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7519</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>data($RESRegistraPago/ORG)</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                          <con2:assign varName="SEQ">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7518</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>data($RESRegistraPago/SECUENCIAL_NUMBER)</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                          <con2:assign varName="errorCodeRP">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-74de</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>fn:data($RESHeaderRegistraPago/aut:ResponseHeader/successIndicator)</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                          <con2:assign varName="validationMessage">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-74a5</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>if($errorCodeRP= 'SUCCESS') then
('')
else(fn:data($RESHeaderRegistraPago/aut:ResponseHeader/messages))</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                        </con2:responseTransform>
                                      </con2:wsCallout>
                                    </con2:actions>
                                  </con2:case>
                                  <con2:default/>
                                </con2:ifThenElse>
                                <con2:assign varName="debitAcctParamHNL">
                                  <con1:id>_ActionId-2009442431897224083--18b76099.1811b19b131.-7fac</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>"T24T113.HNLDEBITAACCTNO"</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                                <con2:assign varName="debitAcctParamUSD">
                                  <con1:id>_ActionId-2009442431897224083--18b76099.1811b19b131.-7faa</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>"T24T113.USDDEBITACCTNO"</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                                <con2:ifThenElse>
                                  <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-7841</con1:id>
                                  <con2:case>
                                    <con2:condition>
                                      <con1:xqueryText>$validationMessage =''</con1:xqueryText>
                                    </con2:condition>
                                    <con2:actions>
                                      <con2:wsCallout>
                                        <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-783f</con1:id>
                                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                        <con2:operation>Pagoderecaudolocalylineadbcta</con2:operation>
                                        <con2:request>
                                          <con2:body wrapped="false">$REQUEST</con2:body>
                                          <con2:header/>
                                        </con2:request>
                                        <con2:response>
                                          <con2:body wrapped="false">RESPONSE</con2:body>
                                          <con2:header/>
                                        </con2:response>
                                        <con2:requestTransform>
                                          <con2:assign varName="REQUEST">
                                            <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-7840</con1:id>
                                            <con2:expr>
                                              <con1:xqueryTransform>
                                                <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoLocalDbCtaIn"/>
                                                <con1:param name="pagoRecaudo1">
                                                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                                                </con1:param>
                                                <con1:param name="debitAcount">
                                                  <con1:path>$debitAccount</con1:path>
                                                </con1:param>
                                                <con1:param name="requestHeader1">
                                                  <con1:path>$header/aut:RequestHeader</con1:path>
                                                </con1:param>
                                                <con1:param name="uuid">
                                                  <con1:path>fn:string($uuid)</con1:path>
                                                </con1:param>
                                                <con1:param name="outputParameters1">
                                                  <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                                </con1:param>
                                              </con1:xqueryTransform>
                                            </con2:expr>
                                          </con2:assign>
                                        </con2:requestTransform>
                                        <con2:responseTransform/>
                                      </con2:wsCallout>
                                      <con2:ifThenElse>
                                        <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-783e</con1:id>
                                        <con2:case>
                                          <con2:condition>
                                            <con1:xqueryText>fn:upper-case(data($RESPONSE/Status/successIndicator)) != 'SUCCESS'</con1:xqueryText>
                                          </con2:condition>
                                          <con2:actions>
                                            <con2:wsCallout>
                                              <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-783a</con1:id>
                                              <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/RegistraPagoTC" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                              <con2:operation>RegistraPagoTC</con2:operation>
                                              <con2:request>
                                                <con2:body wrapped="false">$REQRegistraPago</con2:body>
                                                <con2:header>$REQHeaderRegistraPago</con2:header>
                                              </con2:request>
                                              <con2:response>
                                                <con2:body wrapped="false">RESRegistraPago</con2:body>
                                                <con2:header>RESHeaderRegistraPago</con2:header>
                                              </con2:response>
                                              <con2:requestTransform>
                                                <con2:assign varName="transactionType">
                                                  <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-783d</con1:id>
                                                  <con2:expr>
                                                    <con1:xqueryText>'REVERSION'</con1:xqueryText>
                                                  </con2:expr>
                                                </con2:assign>
                                                <con2:assign varName="REQHeaderRegistraPago">
                                                  <con1:id>_ActionId-3430351506787836732--5c5b1738.17acf4b69e6.-7e89</con1:id>
                                                  <con2:expr>
                                                    <con1:xqueryText>$header</con1:xqueryText>
                                                  </con2:expr>
                                                </con2:assign>
                                                <con2:assign varName="userName">
                                                  <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-783c</con1:id>
                                                  <con2:expr>
                                                    <con1:xqueryText>fn:data($header/aut:RequestHeader/Authentication/UserName)</con1:xqueryText>
                                                  </con2:expr>
                                                </con2:assign>
                                                <con2:assign varName="REQRegistraPago">
                                                  <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-783b</con1:id>
                                                  <con2:expr>
                                                    <con:xqueryTransform xmlns:con="http://www.bea.com/wli/sb/stages/config">
                                                      <con:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/Tx_PagoRecaudo_To_RegistraPagoTCReversion"/>
                                                      <con:param name="transactionType">
                                                        <con:path>$transactionType</con:path>
                                                      </con:param>
                                                      <con:param name="paymentTypeValue">
                                                        <con:path>$paymentTypeValue</con:path>
                                                      </con:param>
                                                      <con:param name="pagoRecaudo1">
                                                        <con:path>$body/pag:pagoRecaudo</con:path>
                                                      </con:param>
                                                      <con:param name="SEQ">
                                                        <con:path>$SEQ</con:path>
                                                      </con:param>
                                                      <con:param name="userName">
                                                        <con:path>$userName</con:path>
                                                      </con:param>
                                                      <con:param name="contractName">
                                                        <con:path>$contractName</con:path>
                                                      </con:param>
                                                      <con:param name="ORG">
                                                        <con:path>$org</con:path>
                                                      </con:param>
                                                    </con:xqueryTransform>
                                                  </con2:expr>
                                                </con2:assign>
                                              </con2:requestTransform>
                                              <con2:responseTransform>
                                                <con2:assign varName="errorCodeRP">
                                                  <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-73a9</con1:id>
                                                  <con2:expr>
                                                    <con1:xqueryText>fn:data($RESHeaderRegistraPago/aut:ResponseHeader/successIndicator)</con1:xqueryText>
                                                  </con2:expr>
                                                </con2:assign>
                                                <con2:assign varName="validationMessage">
                                                  <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7370</con1:id>
                                                  <con2:expr>
                                                    <con1:xqueryText>if($errorCodeRP= 'SUCCESS') then
('')
else(fn:data($RESHeaderRegistraPago/aut:ResponseHeader/messages))</con1:xqueryText>
                                                  </con2:expr>
                                                </con2:assign>
                                              </con2:responseTransform>
                                            </con2:wsCallout>
                                            <con2:ifThenElse>
                                              <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-7839</con1:id>
                                              <con2:case>
                                                <con2:condition>
                                                  <con1:xqueryText>$validationMessage !=''</con1:xqueryText>
                                                </con2:condition>
                                                <con2:actions>
                                                  <con2:assign varName="validationMessage">
                                                    <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-7838</con1:id>
                                                    <con2:expr>
                                                      <con1:xqueryText>"UNHANDLED PAYMENT FAILURE"</con1:xqueryText>
                                                    </con2:expr>
                                                  </con2:assign>
                                                </con2:actions>
                                              </con2:case>
                                              <con2:default/>
                                            </con2:ifThenElse>
                                          </con2:actions>
                                        </con2:case>
                                        <con2:default/>
                                      </con2:ifThenElse>
                                    </con2:actions>
                                  </con2:case>
                                  <con2:default/>
                                </con2:ifThenElse>
                              </con2:actions>
                            </con2:case>
                            <con2:default/>
                          </con2:ifThenElse>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "INTL_CHQ_US"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cb8</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineachqin</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUEST</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSE</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cb9</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoLocalChequeInternacionalUSIn"/>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "INTL_CHQ_NON_US"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:assign varName="validationMessage">
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cb7</con1:id>
                            <con2:expr>
                              <con1:xqueryText>"NOT YET IMPLEMENTED"</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                        </con2:actions>
                      </con2:case>
                      <con2:default/>
                    </con2:ifThenElse>
                  </con2:default>
                </con2:ifThenElse>
              </con2:actions>
            </con2:case>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$type = "ONLINE"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:assign varName="isExtended">
                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cb6</con1:id>
                  <con2:expr>
                    <con1:xqueryText>fn:string($body/pag:pagoRecaudo/EXTENDED_COLLECTION_YES_NO/text())</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:ifThenElse>
                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cb5</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$isExtended = "YES"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:wsCallout>
                        <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7caf</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/recaudos/Resources/RegistrarOperacionConvenioNoEstandar_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>registrarOperacionConvenioNoEstandar</con2:operation>
                        <con2:request>
                          <con2:body wrapped="false">$REQUESTregistrarOperacionConvenioNoEstandar</con2:body>
                          <con2:header/>
                        </con2:request>
                        <con2:response>
                          <con2:body wrapped="false">RESPONSEregistrarOperacionConvenioNoEstandar</con2:body>
                          <con2:header/>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQUESTregistrarOperacionConvenioNoEstandar">
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cb4</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoRegistrarOperConvenioNoEstandarIn"/>
                                <con1:param name="tipoOperacion">
                                  <con1:path>"2"</con1:path>
                                </con1:param>
                                <con1:param name="pagoRecaudo1">
                                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                                </con1:param>
                                <con1:param name="requestHeader1">
                                  <con1:path>$header/aut:RequestHeader</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform>
                          <con2:assign varName="successIndicatorRegistrarOperacionConvenioNoEstandar">
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cb3</con1:id>
                            <con2:expr>
                              <con1:xqueryText>fn:string($RESPONSEregistrarOperacionConvenioNoEstandar/int:ERROR_CODE/text())</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cb2</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>upper-case($successIndicatorRegistrarOperacionConvenioNoEstandar) != "SUCCESS"</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:assign varName="validationMessage">
                                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cb1</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>fn:string($RESPONSEregistrarOperacionConvenioNoEstandar/int:ERROR_MESSAGE/text())</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                              </con2:actions>
                            </con2:case>
                            <con2:default>
                              <con2:assign varName="idSolicitud">
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cb0</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>fn:string($RESPONSEregistrarOperacionConvenioNoEstandar/int:ID_SOLICITUD/text())</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                            </con2:default>
                          </con2:ifThenElse>
                        </con2:responseTransform>
                      </con2:wsCallout>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con2:assign varName="idSolicitud">
                      <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cae</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($body/pag:pagoRecaudo/DEBTOR_CODE/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:default>
                </con2:ifThenElse>
                <con2:ifThenElse>
                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cad</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$validationMessage = ""</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:wsCallout>
                        <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ca7</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/recaudos/Resources/ConsultarRelacionOperacionRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>consultarRelacionOperacionRecaudo</con2:operation>
                        <con2:request>
                          <con2:body wrapped="false">$REQUESTconsultarRelacionOperacionRecaudo</con2:body>
                          <con2:header/>
                        </con2:request>
                        <con2:response>
                          <con2:body wrapped="false">RESPONSEconsultarRelacionOperacionRecaudo</con2:body>
                          <con2:header/>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQUESTconsultarRelacionOperacionRecaudo">
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cac</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoConsultaRelacionOperIn"/>
                                <con1:param name="pagoRecaudo">
                                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7cab</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>fn:string($RESPONSEconsultarRelacionOperacionRecaudo/osb:CODIGO_ERROR/text()) != "SUCCESS"</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:assign varName="validationMessage">
                                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7caa</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>fn:string($RESPONSEconsultarRelacionOperacionRecaudo/osb:MENSAJE_ERROR/text())</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                                <con1:skip>
                                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ca9</con1:id>
                                </con1:skip>
                              </con2:actions>
                            </con2:case>
                            <con2:default>
                              <con2:replace varName="body" contents-only="true">
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ca8</con1:id>
                                <con2:location>
                                  <con1:xpathText>./pag:pagoRecaudo/DEBTOR_CODE</con1:xpathText>
                                </con2:location>
                                <con2:expr>
                                  <con1:xqueryText>$idSolicitud</con1:xqueryText>
                                </con2:expr>
                              </con2:replace>
                            </con2:default>
                          </con2:ifThenElse>
                        </con2:responseTransform>
                      </con2:wsCallout>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con1:skip>
                      <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ca6</con1:id>
                    </con1:skip>
                  </con2:default>
                </con2:ifThenElse>
                <con2:assign varName="cantidadFacturas">
                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ca5</con1:id>
                  <con2:expr>
                    <con1:xqueryText>count($RESPONSEconsultarRelacionOperacionRecaudo/osb:CODIGO_FACTURA/osb:ITEM)</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:ifThenElse>
                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ca4</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>number($cantidadFacturas) > 1</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:assign varName="validationMessage">
                        <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ca3</con1:id>
                        <con2:expr>
                          <con1:xqueryText>"MULTI BILL PAYMENTS FOR ONLINE COLLECTIONS ARE NOT AVAILABLE"</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con1:skip>
                        <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ca2</con1:id>
                      </con1:skip>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con2:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
                      <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ca1</con1:id>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$validationMessage != ""</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con1:skip>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7ca0</con1:id>
                          </con1:skip>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "CASH"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c9e</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineaefec</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUEST</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSE</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c9f</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoEnLineaEfectivoIn"/>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "ACCT_DEBIT"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c9c</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineadbcta</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUEST</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSE</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c9d</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoEnLineaDebitoCuentaIn"/>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "OWN_CHEQUE"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c9a</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineachqpr</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUEST</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSE</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c9b</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoEnLineaChequePropioIn"/>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "OTHER_BANK_CHEQUE"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c98</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineachqob</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUEST</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSE</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c99</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoEnLineaChequeOtroBancoIn"/>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "CREDIT_CARD"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:replace varName="proxyTrace" contents-only="false">
                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-79e9</con1:id>
                            <con2:expr>
                              <con1:xqueryText>"prePagoRecaudoLineaTC"</con1:xqueryText>
                            </con2:expr>
                          </con2:replace>
                          <con2:assign varName="debitAcctParamHNL">
                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-79e7</con1:id>
                            <con2:expr>
                              <con1:xqueryText>"T24T113.HNLDEBITAACCTNO"</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="debitAcctParamUSD">
                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-79e5</con1:id>
                            <con2:expr>
                              <con1:xqueryText>"T24T113.USDDEBITACCTNO"</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="paymentType">
                            <con1:id>_ActionId-25933579928035449--7f91dd1e.17a8222adbd.-7f91</con1:id>
                            <con2:expr>
                              <con1:xqueryText>'FICBCO0067.PAYMENT.SERVICE'</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:wsCallout>
                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-79dd</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>obtenerParametrizacion</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQobtenerParametrizacion</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RSPobtenerParametrizacion</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQobtenerParametrizacion">
                                <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-79e0</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                                    <con1:param name="nombreParametros">
                                      <con1:path>fn:concat($debitAcctParamHNL,"||",$debitAcctParamUSD,"||",$paymentType)</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform>
                              <con2:assign varName="statusParametrizacion">
                                <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-79df</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb4:ERROR_CODE/text())</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                              <con2:assign varName="debitAccount">
                                <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-79de</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>if ( fn:string($body/pag:pagoRecaudo/PAYMENT_INFORMATION/PAYMENT_CURRENCY/text()) = "HNL") then ( fn:string($RSPobtenerParametrizacion/osb4:CONFIGURACIONES/osb4:CONFIGURACIONES_ITEM[osb4:NAME=$debitAcctParamHNL]/osb4:VALUE/text())
) else ( fn:string($RSPobtenerParametrizacion/osb4:CONFIGURACIONES/osb4:CONFIGURACIONES_ITEM[osb4:NAME=$debitAcctParamUSD]/osb4:VALUE/text())
)</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                              <con2:assign varName="paymentTypeValue">
                                <con1:id>_ActionId-25933579928035449--7f91dd1e.17a8222adbd.-7da0</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb4:CONFIGURACIONES/osb4:CONFIGURACIONES_ITEM[osb4:NAME=$paymentType]/osb4:VALUE/text())</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                              <con2:assign varName="validationMessage">
                                <con1:id>_ActionId-2009442431897224083--18b76099.1811b19b131.-7f21</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb4:ERROR_MESSAGE/text())</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                            </con2:responseTransform>
                          </con2:wsCallout>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-767d</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>$statusParametrizacion = "SUCCESS"</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:wsCallout>
                                  <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7677</con1:id>
                                  <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/RegistraPagoTC" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                  <con2:operation>RegistraPagoTC</con2:operation>
                                  <con2:request>
                                    <con2:body wrapped="false">$REQRegistraPago</con2:body>
                                    <con2:header>$REQHeaderRegistraPago</con2:header>
                                  </con2:request>
                                  <con2:response>
                                    <con2:body wrapped="false">RESRegistraPago</con2:body>
                                    <con2:header>RESHeaderRegistraPago</con2:header>
                                  </con2:response>
                                  <con2:requestTransform>
                                    <con2:assign varName="transactionType">
                                      <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-767c</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>'AUTHORIZATION'</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                    <con2:assign varName="REQHeaderRegistraPago">
                                      <con1:id>_ActionId-3430351506787836732--5c5b1738.17acf4b69e6.-7e6c</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>$header</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                    <con2:assign varName="userName">
                                      <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-767b</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>fn:data($header/aut:RequestHeader/Authentication/UserName)</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                    <con2:assign varName="REQRegistraPago">
                                      <con1:id>_ActionId-25933579928035449--7f91dd1e.17a8222adbd.-7d4a</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/Tx_PagoRecaudo_To_RegistraPagoTC"/>
                                          <con1:param name="paymentTypeValue">
                                            <con1:path>$paymentTypeValue</con1:path>
                                          </con1:param>
                                          <con1:param name="transactionType">
                                            <con1:path>$transactionType</con1:path>
                                          </con1:param>
                                          <con1:param name="pagoRecaudo1">
                                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="userName">
                                            <con1:path>$userName</con1:path>
                                          </con1:param>
                                          <con1:param name="ORG">
                                            <con1:path>''</con1:path>
                                          </con1:param>
                                          <con1:param name="contractName">
                                            <con1:path>$contractName</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:requestTransform>
                                  <con2:responseTransform>
                                    <con2:assign varName="org">
                                      <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7679</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>data($RESRegistraPago/ORG)</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                    <con2:assign varName="authorizationCode">
                                      <con1:id>_ActionId-6331445151607000639-35f7b016.17b30d90a1a.-7f74</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>data($RESRegistraPago/AUTHORIZATION_CODE)</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                    <con2:assign varName="SEQ">
                                      <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7678</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>data($RESRegistraPago/SECUENCIAL_NUMBER)</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                    <con2:assign varName="errorCodeRP">
                                      <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7624</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>fn:data($RESHeaderRegistraPago/aut:ResponseHeader/successIndicator)</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                    <con2:assign varName="validationMessage">
                                      <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-75ec</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>if($errorCodeRP= 'SUCCESS') then
('')
else(fn:data($RESHeaderRegistraPago/aut:ResponseHeader/messages))</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:responseTransform>
                                </con2:wsCallout>
                              </con2:actions>
                            </con2:case>
                            <con2:default/>
                          </con2:ifThenElse>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-78a4</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>$validationMessage =''</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:wsCallout>
                                  <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-78a2</con1:id>
                                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                  <con2:operation>Pagoderecaudoreferenciadodbcta</con2:operation>
                                  <con2:request>
                                    <con2:body wrapped="false">$REQUEST</con2:body>
                                    <con2:header/>
                                  </con2:request>
                                  <con2:response>
                                    <con2:body wrapped="false">RESPONSE</con2:body>
                                    <con2:header/>
                                  </con2:response>
                                  <con2:requestTransform>
                                    <con2:assign varName="REQUEST">
                                      <con1:id>_ActionId-1935454175644208791--1ed8087c.17af4f1e7e8.-7fc8</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoLocalDbCtaIn"/>
                                          <con1:param name="pagoRecaudo1">
                                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="debitAcount">
                                            <con1:path>$debitAccount</con1:path>
                                          </con1:param>
                                          <con1:param name="requestHeader1">
                                            <con1:path>$header/aut:RequestHeader</con1:path>
                                          </con1:param>
                                          <con1:param name="uuid">
                                            <con1:path>fn:string($uuid)</con1:path>
                                          </con1:param>
                                          <con1:param name="outputParameters1">
                                            <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:requestTransform>
                                  <con2:responseTransform/>
                                </con2:wsCallout>
                                <con2:ifThenElse>
                                  <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71d7</con1:id>
                                  <con2:case>
                                    <con2:condition>
                                      <con1:xqueryText>fn:upper-case(data($RESPONSE/Status/successIndicator)) != 'SUCCESS'</con1:xqueryText>
                                    </con2:condition>
                                    <con2:actions>
                                      <con2:wsCallout>
                                        <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71d1</con1:id>
                                        <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/RegistraPagoTC" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                        <con2:operation>RegistraPagoTC</con2:operation>
                                        <con2:request>
                                          <con2:body wrapped="false">$REQRegistraPago</con2:body>
                                          <con2:header>$REQHeaderRegistraPago</con2:header>
                                        </con2:request>
                                        <con2:response>
                                          <con2:body wrapped="false">RESRegistraPago</con2:body>
                                          <con2:header>RESHeaderRegistraPago</con2:header>
                                        </con2:response>
                                        <con2:requestTransform>
                                          <con2:assign varName="transactionType">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71d6</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>'REVERSION'</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                          <con2:assign varName="REQHeaderRegistraPago">
                                            <con1:id>_ActionId-3430351506787836732--5c5b1738.17acf4b69e6.-7e33</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>$header</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                          <con2:assign varName="userName">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71d5</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>fn:data($header/aut:RequestHeader/Authentication/UserName)</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                          <con2:assign varName="REQRegistraPago">
                                            <con1:id>_ActionId-25933579928035449--7f91dd1e.17a8222adbd.-7cd9</con1:id>
                                            <con2:expr>
                                              <con:xqueryTransform xmlns:con="http://www.bea.com/wli/sb/stages/config">
                                                <con:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/Tx_PagoRecaudo_To_RegistraPagoTCReversion"/>
                                                <con:param name="transactionType">
                                                  <con:path>$transactionType</con:path>
                                                </con:param>
                                                <con:param name="paymentTypeValue">
                                                  <con:path>$paymentTypeValue</con:path>
                                                </con:param>
                                                <con:param name="pagoRecaudo1">
                                                  <con:path>$body/pag:pagoRecaudo</con:path>
                                                </con:param>
                                                <con:param name="SEQ">
                                                  <con:path>$SEQ</con:path>
                                                </con:param>
                                                <con:param name="userName">
                                                  <con:path>$userName</con:path>
                                                </con:param>
                                                <con:param name="contractName">
                                                  <con:path>$contractName</con:path>
                                                </con:param>
                                                <con:param name="ORG">
                                                  <con:path>$org</con:path>
                                                </con:param>
                                              </con:xqueryTransform>
                                            </con2:expr>
                                          </con2:assign>
                                        </con2:requestTransform>
                                        <con2:responseTransform>
                                          <con2:assign varName="errorCodeRP">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71d3</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>fn:data($RESHeaderRegistraPago/aut:ResponseHeader/successIndicator)</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                          <con2:assign varName="validationMessage">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71d2</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>if($errorCodeRP= 'SUCCESS') then
('')
else(fn:data($RESHeaderRegistraPago/aut:ResponseHeader/messages))</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                        </con2:responseTransform>
                                      </con2:wsCallout>
                                      <con2:ifThenElse>
                                        <con1:comment>$statusReversionConsumo != '00'</con1:comment>
                                        <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71d0</con1:id>
                                        <con2:case>
                                          <con2:condition>
                                            <con1:xqueryText>$validationMessage !=''</con1:xqueryText>
                                          </con2:condition>
                                          <con2:actions>
                                            <con2:assign varName="validationMessage">
                                              <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71cf</con1:id>
                                              <con2:expr>
                                                <con1:xqueryText>"UNHANDLED PAYMENT FAILURE"</con1:xqueryText>
                                              </con2:expr>
                                            </con2:assign>
                                          </con2:actions>
                                        </con2:case>
                                        <con2:default>
                                          <con2:assign varName="validationMessage">
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71ce</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>""</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                        </con2:default>
                                      </con2:ifThenElse>
                                    </con2:actions>
                                  </con2:case>
                                  <con2:default/>
                                </con2:ifThenElse>
                              </con2:actions>
                            </con2:case>
                            <con2:default/>
                          </con2:ifThenElse>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "INTL_CHQ_US"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c95</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineachqin</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUEST</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSE</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c96</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoEnLineaChequeInternacionalUSIn"/>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "INTL_CHQ_NON_US"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:assign varName="validationMessage">
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c94</con1:id>
                            <con2:expr>
                              <con1:xqueryText>"NOT YET IMPLEMENTED"</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                        </con2:actions>
                      </con2:case>
                      <con2:default/>
                    </con2:ifThenElse>
                  </con2:default>
                </con2:ifThenElse>
              </con2:actions>
            </con2:case>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$type = ("REFERENCED", "REFERENCED_LOCAL", "REFERENCED_ONLINE")</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:ifThenElse>
                  <con1:id>_ActionId-5827784682574284337-5f734a9b.1560de11231.-7da7</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$type = "REFERENCED_LOCAL"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:assign varName="validationMessage">
                        <con1:id>_ActionId-5827784682574284337-5f734a9b.1560de11231.-7cc8</con1:id>
                        <con2:expr>
                          <con1:xqueryTransform>
                            <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoCobranzasValidate"/>
                            <con1:param name="pagoRecaudo">
                              <con1:path>$body/pag:pagoRecaudo</con1:path>
                            </con1:param>
                          </con1:xqueryTransform>
                        </con2:expr>
                      </con2:assign>
                      <con2:ifThenElse>
                        <con1:id>_ActionId-5827784682574284337-5f734a9b.1560de11231.-7c90</con1:id>
                        <con2:case>
                          <con2:condition>
                            <con1:xqueryText>$validationMessage != ""</con1:xqueryText>
                          </con2:condition>
                          <con2:actions>
                            <con1:skip>
                              <con1:id>_ActionId-2152864461021708203--1fd188f3.1567f549ec4.-7e37</con1:id>
                            </con1:skip>
                          </con2:actions>
                        </con2:case>
                        <con2:default/>
                      </con2:ifThenElse>
                    </con2:actions>
                  </con2:case>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$type = "REFERENCED_ONLINE"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:wsCallout>
                        <con1:id>_ActionId-2152864461021708203--1fd188f3.1567f549ec4.-7df5</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/recaudos/Resources/ConsultarRelacionOperacionRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>consultarRelacionOperacionRecaudo</con2:operation>
                        <con2:request>
                          <con2:body wrapped="false">$REQUESTconsultarRelacionOperacionRecaudo</con2:body>
                          <con2:header/>
                        </con2:request>
                        <con2:response>
                          <con2:body wrapped="false">RESPONSEconsultarRelacionOperacionRecaudo</con2:body>
                          <con2:header/>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQUESTconsultarRelacionOperacionRecaudo">
                            <con1:id>_ActionId-2152864461021708203--1fd188f3.1567f549ec4.-7dfa</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoConsultaRelacionOperIn"/>
                                <con1:param name="pagoRecaudo">
                                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-2152864461021708203--1fd188f3.1567f549ec4.-7df9</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>fn:string($RESPONSEconsultarRelacionOperacionRecaudo/osb:CODIGO_ERROR/text()) != "SUCCESS"</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:assign varName="validationMessage">
                                  <con1:id>_ActionId-2152864461021708203--1fd188f3.1567f549ec4.-7df8</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>fn:string($RESPONSEconsultarRelacionOperacionRecaudo/osb:MENSAJE_ERROR/text())</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                                <con1:skip>
                                  <con1:id>_ActionId-2152864461021708203--1fd188f3.1567f549ec4.-7df7</con1:id>
                                </con1:skip>
                              </con2:actions>
                            </con2:case>
                            <con2:default>
                              <con2:assign varName="cantidadFacturas">
                                <con1:id>_ActionId-2152864461021708203--1fd188f3.1567f549ec4.-7df6</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>count($RESPONSEconsultarRelacionOperacionRecaudo/osb:CODIGO_FACTURA/osb:ITEM)</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                            </con2:default>
                          </con2:ifThenElse>
                        </con2:responseTransform>
                      </con2:wsCallout>
                    </con2:actions>
                  </con2:case>
                  <con2:default/>
                </con2:ifThenElse>
                <con2:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c86</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$type = "REFERENCED_ONLINE" and $cantidadFacturas > "1"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:assign varName="validationMessage" xmlns:con3="http://www.bea.com/wli/sb/stages/logging/config">
                        <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c85</con1:id>
                        <con2:expr>
                          <con1:xqueryText>"MULTI BILL PAYMENTS FOR ONLINE COLLECTIONS ARE NOT AVAILABLE"</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con1:skip>
                        <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c84</con1:id>
                      </con1:skip>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con2:ifThenElse>
                      <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c83</con1:id>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$validationMessage != ""</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con1:skip>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c82</con1:id>
                          </con1:skip>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "CASH"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c7e</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudoreferenciadoefec</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUEST</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSE</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:ifThenElse>
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c81</con1:id>
                                <con2:case>
                                  <con2:condition>
                                    <con1:xqueryText>fn:string($type) = "REFERENCED_ONLINE"</con1:xqueryText>
                                  </con2:condition>
                                  <con2:actions>
                                    <con2:assign varName="REQUEST">
                                      <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c80</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoRefEnLineaEfectivoIn"/>
                                          <con1:param name="requestHeader">
                                            <con1:path>$header/aut:RequestHeader</con1:path>
                                          </con1:param>
                                          <con1:param name="pagoRecaudo">
                                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="outputParameters">
                                            <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="uuid">
                                            <con1:path>fn:string($uuid)</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:actions>
                                </con2:case>
                                <con2:case>
                                  <con2:condition>
                                    <con1:xqueryText>fn:string($type) = "REFERENCED_LOCAL"</con1:xqueryText>
                                  </con2:condition>
                                  <con2:actions>
                                    <con2:assign varName="REQUEST">
                                      <con1:id>_ActionId-5827784682574284337-5f734a9b.1560de11231.-7ad7</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoRefEfecIn"/>
                                          <con1:param name="pagoRecaudo">
                                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="uuid">
                                            <con1:path>$uuid</con1:path>
                                          </con1:param>
                                          <con1:param name="requestHeader">
                                            <con1:path>$header/aut:RequestHeader</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:actions>
                                </con2:case>
                                <con2:default>
                                  <con2:assign varName="REQUEST">
                                    <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c7f</con1:id>
                                    <con2:expr>
                                      <con1:xqueryTransform>
                                        <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoReferenciadoEfectivoIn"/>
                                        <con1:param name="requestHeader">
                                          <con1:path>$header/aut:RequestHeader</con1:path>
                                        </con1:param>
                                        <con1:param name="pagoRecaudo">
                                          <con1:path>$body/pag:pagoRecaudo</con1:path>
                                        </con1:param>
                                        <con1:param name="uuid">
                                          <con1:path>fn:string($uuid)</con1:path>
                                        </con1:param>
                                      </con1:xqueryTransform>
                                    </con2:expr>
                                  </con2:assign>
                                </con2:default>
                              </con2:ifThenElse>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "ACCT_DEBIT"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c7a</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudoreferenciadodbcta</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUEST</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSE</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:ifThenElse>
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c7d</con1:id>
                                <con2:case>
                                  <con2:condition>
                                    <con1:xqueryText>fn:string($type) = "REFERENCED_ONLINE"</con1:xqueryText>
                                  </con2:condition>
                                  <con2:actions>
                                    <con2:assign varName="REQUEST">
                                      <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c7c</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoRefEnLineaDebitoCuentaIn"/>
                                          <con1:param name="pagoRecaudo">
                                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="uuid">
                                            <con1:path>fn:string($uuid)</con1:path>
                                          </con1:param>
                                          <con1:param name="outputParameters">
                                            <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="requestHeader">
                                            <con1:path>$header/aut:RequestHeader</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:actions>
                                </con2:case>
                                <con2:case>
                                  <con2:condition>
                                    <con1:xqueryText>fn:string($type) = "REFERENCED_LOCAL"</con1:xqueryText>
                                  </con2:condition>
                                  <con2:actions>
                                    <con2:assign varName="REQUEST">
                                      <con1:id>_ActionId-5827784682574284337-5f734a9b.1560de11231.-7a83</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoRefDbCtaIn"/>
                                          <con1:param name="pagoRecaudo">
                                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="uuid">
                                            <con1:path>$uuid</con1:path>
                                          </con1:param>
                                          <con1:param name="requestHeader">
                                            <con1:path>$header/aut:RequestHeader</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:actions>
                                </con2:case>
                                <con2:default>
                                  <con2:assign varName="REQUEST">
                                    <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c7b</con1:id>
                                    <con2:expr>
                                      <con1:xqueryTransform>
                                        <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoReferenciadoDebitoCuentaIn"/>
                                        <con1:param name="requestHeader">
                                          <con1:path>$header/aut:RequestHeader</con1:path>
                                        </con1:param>
                                        <con1:param name="pagoRecaudo">
                                          <con1:path>$body/pag:pagoRecaudo</con1:path>
                                        </con1:param>
                                        <con1:param name="uuid">
                                          <con1:path>fn:string($uuid)</con1:path>
                                        </con1:param>
                                      </con1:xqueryTransform>
                                    </con2:expr>
                                  </con2:assign>
                                </con2:default>
                              </con2:ifThenElse>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "OWN_CHEQUE"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c76</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagorecaudoreferenciadoficochq</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUEST</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSE</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:ifThenElse>
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c79</con1:id>
                                <con2:case>
                                  <con2:condition>
                                    <con1:xqueryText>fn:string($type) = "REFERENCED_ONLINE"</con1:xqueryText>
                                  </con2:condition>
                                  <con2:actions>
                                    <con2:assign varName="REQUEST">
                                      <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c78</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoRefEnLineaChequePropioIn"/>
                                          <con1:param name="requestHeader">
                                            <con1:path>$header/aut:RequestHeader</con1:path>
                                          </con1:param>
                                          <con1:param name="pagoRecaudo">
                                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="outputParameters">
                                            <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="uuid">
                                            <con1:path>fn:string($uuid)</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:actions>
                                </con2:case>
                                <con2:case>
                                  <con2:condition>
                                    <con1:xqueryText>fn:string($type) = "REFERENCED_LOCAL"</con1:xqueryText>
                                  </con2:condition>
                                  <con2:actions>
                                    <con2:assign varName="REQUEST">
                                      <con1:id>_ActionId-5827784682574284337-5f734a9b.1560de11231.-7a14</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoRefFicoChqIn"/>
                                          <con1:param name="pagoRecaudo">
                                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="uuid">
                                            <con1:path>$uuid</con1:path>
                                          </con1:param>
                                          <con1:param name="requestHeader">
                                            <con1:path>$header/aut:RequestHeader</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:actions>
                                </con2:case>
                                <con2:default>
                                  <con2:assign varName="REQUEST">
                                    <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c77</con1:id>
                                    <con2:expr>
                                      <con1:xqueryTransform>
                                        <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoReferenciadoChequePropioIn"/>
                                        <con1:param name="requestHeader">
                                          <con1:path>$header/aut:RequestHeader</con1:path>
                                        </con1:param>
                                        <con1:param name="pagoRecaudo">
                                          <con1:path>$body/pag:pagoRecaudo</con1:path>
                                        </con1:param>
                                        <con1:param name="uuid">
                                          <con1:path>fn:string($uuid)</con1:path>
                                        </con1:param>
                                      </con1:xqueryTransform>
                                    </con2:expr>
                                  </con2:assign>
                                </con2:default>
                              </con2:ifThenElse>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "OTHER_BANK_CHEQUE"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c72</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagorecaudoreferenciadochqotrbco</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUEST</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSE</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:ifThenElse>
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c75</con1:id>
                                <con2:case>
                                  <con2:condition>
                                    <con1:xqueryText>fn:string($type) = "REFERENCED_ONLINE"</con1:xqueryText>
                                  </con2:condition>
                                  <con2:actions>
                                    <con2:assign varName="REQUEST">
                                      <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c74</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoRefEnLineaChequeOtroBancoIn"/>
                                          <con1:param name="requestHeader">
                                            <con1:path>$header/aut:RequestHeader</con1:path>
                                          </con1:param>
                                          <con1:param name="pagoRecaudo">
                                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="outputParameters">
                                            <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="uuid">
                                            <con1:path>fn:string($uuid)</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:actions>
                                </con2:case>
                                <con2:case>
                                  <con2:condition>
                                    <con1:xqueryText>fn:string($type) = "REFERENCED_LOCAL"</con1:xqueryText>
                                  </con2:condition>
                                  <con2:actions>
                                    <con2:assign varName="REQUEST">
                                      <con1:id>_ActionId-5827784682574284337-5f734a9b.1560de11231.-79db</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoRefOBChqIn"/>
                                          <con1:param name="pagoRecaudo">
                                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="uuid">
                                            <con1:path>$uuid</con1:path>
                                          </con1:param>
                                          <con1:param name="requestHeader">
                                            <con1:path>$header/aut:RequestHeader</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:actions>
                                </con2:case>
                                <con2:default>
                                  <con2:assign varName="REQUEST">
                                    <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c73</con1:id>
                                    <con2:expr>
                                      <con1:xqueryTransform>
                                        <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoReferenciadoChequeOtroBancoIn"/>
                                        <con1:param name="requestHeader">
                                          <con1:path>$header/aut:RequestHeader</con1:path>
                                        </con1:param>
                                        <con1:param name="pagoRecaudo">
                                          <con1:path>$body/pag:pagoRecaudo</con1:path>
                                        </con1:param>
                                        <con1:param name="uuid">
                                          <con1:path>fn:string($uuid)</con1:path>
                                        </con1:param>
                                      </con1:xqueryTransform>
                                    </con2:expr>
                                  </con2:assign>
                                </con2:default>
                              </con2:ifThenElse>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "CREDIT_CARD"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-5827784682574284337-5f734a9b.1560de11231.-796c</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>fn:string($type) = "REFERENCED_LOCAL"</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:assign varName="validationMessage">
                                  <con1:id>_ActionId-5827784682574284337-5f734a9b.1560de11231.-7934</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>"PAYMENT METHOD NOT AVAILABLE"</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                                <con1:skip>
                                  <con1:id>_ActionId-5827784682574284337-5f734a9b.1560de11231.-7917</con1:id>
                                </con1:skip>
                              </con2:actions>
                            </con2:case>
                            <con2:default>
                              <con2:assign varName="paymentType">
                                <con1:id>_ActionId-25933579928035449--7f91dd1e.17a8222adbd.-7e2c</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>'FICBCO0067.PAYMENT.SERVICE'</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                              <con2:assign varName="debitAcctParamHNL">
                                <con1:id>_ActionId-1935454175644208791--1ed8087c.17af4f1e7e8.-7eae</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>"T24T113.HNLDEBITAACCTNO"</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                              <con2:assign varName="debitAcctParamUSD">
                                <con1:id>_ActionId-1935454175644208791--1ed8087c.17af4f1e7e8.-7e75</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>"T24T113.USDDEBITACCTNO"</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                              <con2:wsCallout>
                                <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7368</con1:id>
                                <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                <con2:operation>obtenerParametrizacion</con2:operation>
                                <con2:request>
                                  <con2:body wrapped="false">$REQobtenerParametrizacion</con2:body>
                                  <con2:header/>
                                </con2:request>
                                <con2:response>
                                  <con2:body wrapped="false">RSPobtenerParametrizacion</con2:body>
                                  <con2:header/>
                                </con2:response>
                                <con2:requestTransform>
                                  <con2:assign varName="REQobtenerParametrizacion">
                                    <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-736b</con1:id>
                                    <con2:expr>
                                      <con1:xqueryTransform>
                                        <con1:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                                        <con1:param name="nombreParametros">
                                          <con1:path>fn:concat($debitAcctParamHNL,"||",$debitAcctParamUSD,"||",$paymentType)</con1:path>
                                        </con1:param>
                                      </con1:xqueryTransform>
                                    </con2:expr>
                                  </con2:assign>
                                </con2:requestTransform>
                                <con2:responseTransform>
                                  <con2:assign varName="statusParametrizacion">
                                    <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-736a</con1:id>
                                    <con2:expr>
                                      <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb4:ERROR_CODE/text())</con1:xqueryText>
                                    </con2:expr>
                                  </con2:assign>
                                  <con2:assign varName="debitAccount">
                                    <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7369</con1:id>
                                    <con2:expr>
                                      <con1:xqueryText>if ( fn:string($body/pag:pagoRecaudo/PAYMENT_INFORMATION/PAYMENT_CURRENCY/text()) = "HNL") then ( fn:string($RSPobtenerParametrizacion/osb4:CONFIGURACIONES/osb4:CONFIGURACIONES_ITEM[osb4:NAME=$debitAcctParamHNL]/osb4:VALUE/text())
) else ( fn:string($RSPobtenerParametrizacion/osb4:CONFIGURACIONES/osb4:CONFIGURACIONES_ITEM[osb4:NAME=$debitAcctParamUSD]/osb4:VALUE/text())
)</con1:xqueryText>
                                    </con2:expr>
                                  </con2:assign>
                                  <con2:assign varName="paymentTypeValue">
                                    <con1:id>_ActionId-25933579928035449--7f91dd1e.17a8222adbd.-7d83</con1:id>
                                    <con2:expr>
                                      <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb4:CONFIGURACIONES/osb4:CONFIGURACIONES_ITEM[osb4:NAME=$paymentType]/osb4:VALUE/text())</con1:xqueryText>
                                    </con2:expr>
                                  </con2:assign>
                                  <con2:assign varName="validationMessage">
                                    <con1:id>_ActionId-2009442431897224083--18b76099.1811b19b131.-7f04</con1:id>
                                    <con2:expr>
                                      <con1:xqueryText>fn:string($RSPobtenerParametrizacion/osb4:ERROR_MESSAGE/text())</con1:xqueryText>
                                    </con2:expr>
                                  </con2:assign>
                                </con2:responseTransform>
                              </con2:wsCallout>
                              <con2:ifThenElse>
                                <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7330</con1:id>
                                <con2:case>
                                  <con2:condition>
                                    <con1:xqueryText>$statusParametrizacion = "SUCCESS"</con1:xqueryText>
                                  </con2:condition>
                                  <con2:actions>
                                    <con2:wsCallout>
                                      <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7324</con1:id>
                                      <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/RegistraPagoTC" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                      <con2:operation>RegistraPagoTC</con2:operation>
                                      <con2:request>
                                        <con2:body wrapped="false">$REQRegistraPago</con2:body>
                                        <con2:header>$REQHeaderRegistraPago</con2:header>
                                      </con2:request>
                                      <con2:response>
                                        <con2:body wrapped="false">RESRegistraPago</con2:body>
                                        <con2:header>RESHeaderRegistraPago</con2:header>
                                      </con2:response>
                                      <con2:requestTransform>
                                        <con2:assign varName="transactionType">
                                          <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7329</con1:id>
                                          <con2:expr>
                                            <con1:xqueryText>'AUTHORIZATION'</con1:xqueryText>
                                          </con2:expr>
                                        </con2:assign>
                                        <con2:assign varName="REQHeaderRegistraPago">
                                          <con1:id>_ActionId-3430351506787836732--5c5b1738.17acf4b69e6.-7dfa</con1:id>
                                          <con2:expr>
                                            <con1:xqueryText>$header</con1:xqueryText>
                                          </con2:expr>
                                        </con2:assign>
                                        <con2:assign varName="userName">
                                          <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7328</con1:id>
                                          <con2:expr>
                                            <con1:xqueryText>fn:data($header/aut:RequestHeader/Authentication/UserName)</con1:xqueryText>
                                          </con2:expr>
                                        </con2:assign>
                                        <con2:assign varName="REQRegistraPago">
                                          <con1:id>_ActionId-25933579928035449--7f91dd1e.17a8222adbd.-7c83</con1:id>
                                          <con2:expr>
                                            <con1:xqueryTransform>
                                              <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/Tx_PagoRecaudo_To_RegistraPagoTC"/>
                                              <con1:param name="paymentTypeValue">
                                                <con1:path>$paymentTypeValue</con1:path>
                                              </con1:param>
                                              <con1:param name="transactionType">
                                                <con1:path>$transactionType</con1:path>
                                              </con1:param>
                                              <con1:param name="pagoRecaudo1">
                                                <con1:path>$body/pag:pagoRecaudo</con1:path>
                                              </con1:param>
                                              <con1:param name="userName">
                                                <con1:path>$userName</con1:path>
                                              </con1:param>
                                              <con1:param name="ORG">
                                                <con1:path>''</con1:path>
                                              </con1:param>
                                              <con1:param name="contractName">
                                                <con1:path>$contractName</con1:path>
                                              </con1:param>
                                            </con1:xqueryTransform>
                                          </con2:expr>
                                        </con2:assign>
                                      </con2:requestTransform>
                                      <con2:responseTransform>
                                        <con2:assign varName="org">
                                          <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7326</con1:id>
                                          <con2:expr>
                                            <con1:xqueryText>data($RESRegistraPago/ORG)</con1:xqueryText>
                                          </con2:expr>
                                        </con2:assign>
                                        <con2:assign varName="authorizationCode">
                                          <con1:id>_ActionId-6331445151607000639-35f7b016.17b30d90a1a.-7f57</con1:id>
                                          <con2:expr>
                                            <con1:xqueryText>data($RESRegistraPago/AUTHORIZATION_CODE)</con1:xqueryText>
                                          </con2:expr>
                                        </con2:assign>
                                        <con2:assign varName="SEQ">
                                          <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-7325</con1:id>
                                          <con2:expr>
                                            <con1:xqueryText>data($RESRegistraPago/SECUENCIAL_NUMBER)</con1:xqueryText>
                                          </con2:expr>
                                        </con2:assign>
                                        <con2:assign varName="errorCodeRP">
                                          <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-72eb</con1:id>
                                          <con2:expr>
                                            <con1:xqueryText>fn:data($RESHeaderRegistraPago/aut:ResponseHeader/successIndicator)</con1:xqueryText>
                                          </con2:expr>
                                        </con2:assign>
                                        <con2:assign varName="validationMessage">
                                          <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-72b2</con1:id>
                                          <con2:expr>
                                            <con1:xqueryText>if($errorCodeRP= 'SUCCESS') then
('')
else(fn:data($RESHeaderRegistraPago/aut:ResponseHeader/messages))</con1:xqueryText>
                                          </con2:expr>
                                        </con2:assign>
                                      </con2:responseTransform>
                                    </con2:wsCallout>
                                  </con2:actions>
                                </con2:case>
                                <con2:default/>
                              </con2:ifThenElse>
                              <con2:assign varName="debitAcctParamHNL">
                                <con1:id>_ActionId-2009442431897224083--18b76099.1811b19b131.-7f02</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>"T24T113.HNLDEBITAACCTNO"</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                              <con2:assign varName="debitAcctParamUSD">
                                <con1:id>_ActionId-2009442431897224083--18b76099.1811b19b131.-7f00</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>"T24T113.USDDEBITACCTNO"</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                              <con2:ifThenElse>
                                <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-76fa</con1:id>
                                <con2:case>
                                  <con2:condition>
                                    <con1:xqueryText>$validationMessage =''</con1:xqueryText>
                                  </con2:condition>
                                  <con2:actions>
                                    <con2:wsCallout>
                                      <con1:id>_ActionId-2145422934307179792-181de55b.17a632d347e.-76f8</con1:id>
                                      <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                      <con2:operation>Pagoderecaudolocalylineadbcta</con2:operation>
                                      <con2:request>
                                        <con2:body wrapped="false">$REQUEST</con2:body>
                                        <con2:header/>
                                      </con2:request>
                                      <con2:response>
                                        <con2:body wrapped="false">RESPONSE</con2:body>
                                        <con2:header/>
                                      </con2:response>
                                      <con2:requestTransform>
                                        <con2:assign varName="REQUEST">
                                          <con1:id>_ActionId-1935454175644208791--1ed8087c.17af4f1e7e8.-7fab</con1:id>
                                          <con2:expr>
                                            <con1:xqueryTransform>
                                              <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoLocalDbCtaIn"/>
                                              <con1:param name="pagoRecaudo1">
                                                <con1:path>$body/pag:pagoRecaudo</con1:path>
                                              </con1:param>
                                              <con1:param name="debitAcount">
                                                <con1:path>$debitAccount</con1:path>
                                              </con1:param>
                                              <con1:param name="requestHeader1">
                                                <con1:path>$header/aut:RequestHeader</con1:path>
                                              </con1:param>
                                              <con1:param name="uuid">
                                                <con1:path>fn:string($uuid)</con1:path>
                                              </con1:param>
                                              <con1:param name="outputParameters1">
                                                <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                              </con1:param>
                                            </con1:xqueryTransform>
                                          </con2:expr>
                                        </con2:assign>
                                      </con2:requestTransform>
                                      <con2:responseTransform/>
                                    </con2:wsCallout>
                                    <con2:ifThenElse>
                                      <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71c4</con1:id>
                                      <con2:case>
                                        <con2:condition>
                                          <con1:xqueryText>fn:upper-case(data($RESPONSE/Status/successIndicator)) != 'SUCCESS'</con1:xqueryText>
                                        </con2:condition>
                                        <con2:actions>
                                          <con2:wsCallout>
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71be</con1:id>
                                            <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/RegistraPagoTC" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                            <con2:operation>RegistraPagoTC</con2:operation>
                                            <con2:request>
                                              <con2:body wrapped="false">$REQRegistraPago</con2:body>
                                              <con2:header>$REQHeaderRegistraPago</con2:header>
                                            </con2:request>
                                            <con2:response>
                                              <con2:body wrapped="false">RESRegistraPago</con2:body>
                                              <con2:header>RESHeaderRegistraPago</con2:header>
                                            </con2:response>
                                            <con2:requestTransform>
                                              <con2:assign varName="transactionType">
                                                <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71c3</con1:id>
                                                <con2:expr>
                                                  <con1:xqueryText>'REVERSION'</con1:xqueryText>
                                                </con2:expr>
                                              </con2:assign>
                                              <con2:assign varName="REQHeaderRegistraPago">
                                                <con1:id>_ActionId-3430351506787836732--5c5b1738.17acf4b69e6.-7dc1</con1:id>
                                                <con2:expr>
                                                  <con1:xqueryText>$header</con1:xqueryText>
                                                </con2:expr>
                                              </con2:assign>
                                              <con2:assign varName="userName">
                                                <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71c2</con1:id>
                                                <con2:expr>
                                                  <con1:xqueryText>fn:data($header/aut:RequestHeader/Authentication/UserName)</con1:xqueryText>
                                                </con2:expr>
                                              </con2:assign>
                                              <con2:assign varName="REQRegistraPago">
                                                <con1:id>_ActionId-25933579928035449--7f91dd1e.17a8222adbd.-7cbc</con1:id>
                                                <con2:expr>
                                                  <con:xqueryTransform xmlns:con="http://www.bea.com/wli/sb/stages/config">
                                                    <con:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/Tx_PagoRecaudo_To_RegistraPagoTCReversion"/>
                                                    <con:param name="transactionType">
                                                      <con:path>$transactionType</con:path>
                                                    </con:param>
                                                    <con:param name="paymentTypeValue">
                                                      <con:path>$paymentTypeValue</con:path>
                                                    </con:param>
                                                    <con:param name="pagoRecaudo1">
                                                      <con:path>$body/pag:pagoRecaudo</con:path>
                                                    </con:param>
                                                    <con:param name="SEQ">
                                                      <con:path>$SEQ</con:path>
                                                    </con:param>
                                                    <con:param name="userName">
                                                      <con:path>$userName</con:path>
                                                    </con:param>
                                                    <con:param name="contractName">
                                                      <con:path>$contractName</con:path>
                                                    </con:param>
                                                    <con:param name="ORG">
                                                      <con:path>$org</con:path>
                                                    </con:param>
                                                  </con:xqueryTransform>
                                                </con2:expr>
                                              </con2:assign>
                                            </con2:requestTransform>
                                            <con2:responseTransform>
                                              <con2:assign varName="errorCodeRP">
                                                <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71c0</con1:id>
                                                <con2:expr>
                                                  <con1:xqueryText>fn:data($RESHeaderRegistraPago/aut:ResponseHeader/successIndicator)</con1:xqueryText>
                                                </con2:expr>
                                              </con2:assign>
                                              <con2:assign varName="validationMessage">
                                                <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71bf</con1:id>
                                                <con2:expr>
                                                  <con1:xqueryText>if($errorCodeRP= 'SUCCESS') then
('')
else(fn:data($RESHeaderRegistraPago/aut:ResponseHeader/messages))</con1:xqueryText>
                                                </con2:expr>
                                              </con2:assign>
                                            </con2:responseTransform>
                                          </con2:wsCallout>
                                          <con2:ifThenElse>
                                            <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71bd</con1:id>
                                            <con2:case>
                                              <con2:condition>
                                                <con1:xqueryText>$validationMessage !=''</con1:xqueryText>
                                              </con2:condition>
                                              <con2:actions>
                                                <con2:assign varName="validationMessage">
                                                  <con1:id>_ActionId-8739358222406205252--7cdbf89c.17a7c84fe6d.-71bc</con1:id>
                                                  <con2:expr>
                                                    <con1:xqueryText>"UNHANDLED PAYMENT FAILURE"</con1:xqueryText>
                                                  </con2:expr>
                                                </con2:assign>
                                              </con2:actions>
                                            </con2:case>
                                            <con2:default/>
                                          </con2:ifThenElse>
                                        </con2:actions>
                                      </con2:case>
                                      <con2:default/>
                                    </con2:ifThenElse>
                                  </con2:actions>
                                </con2:case>
                                <con2:default/>
                              </con2:ifThenElse>
                            </con2:default>
                          </con2:ifThenElse>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "INTL_CHQ_US"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:assign varName="validationMessage">
                            <con1:id>_ActionId-5827784682574284337-5f734a9b.1560de11231.-7831</con1:id>
                            <con2:expr>
                              <con1:xqueryText>"NOT YET IMPLEMENTED"</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con1:skip>
                            <con1:id>_ActionId-5827784682574284337-5f734a9b.1560de11231.-7833</con1:id>
                          </con1:skip>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "INTL_CHQ_NON_US"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:assign varName="validationMessage">
                            <con1:id>_ActionId-5827784682574284337-5f734a9b.1560de11231.-77c1</con1:id>
                            <con2:expr>
                              <con1:xqueryText>"NOT YET IMPLEMENTED"</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con1:skip>
                            <con1:id>_ActionId-5827784682574284337-5f734a9b.1560de11231.-77a4</con1:id>
                          </con1:skip>
                        </con2:actions>
                      </con2:case>
                      <con2:default/>
                    </con2:ifThenElse>
                  </con2:default>
                </con2:ifThenElse>
                <con2:ifThenElse>
                  <con1:comment>Si el registro del pago de cobranza fue exitoso (Success) y el tipo de recaudo es "REFERENCED_ONLINE" ó "REFERENCED_LOCAL", se procede a consultar el servicio de parámetros core para obtener información necesaria para el registro del pago en abanks</con1:comment>
                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c6b</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>fn:upper-case(fn:string($RESPONSE/Status/successIndicator/text())) = "SUCCESS" and fn:string($type) = ("REFERENCED_ONLINE", "REFERENCED_LOCAL")</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:wsCallout>
                        <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c69</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/Core/Resources/CoreBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>Consultadeparametroscore</con2:operation>
                        <con2:request>
                          <con2:body wrapped="false">$REQUESTConsultadeparametroscore</con2:body>
                          <con2:header/>
                        </con2:request>
                        <con2:response>
                          <con2:body wrapped="false">RESPONSEConsultadeparametroscore</con2:body>
                          <con2:header/>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQUESTConsultadeparametroscore">
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c6a</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/consultaParametrosCoreIn"/>
                                <con1:param name="pagoRecaudo">
                                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                                </con1:param>
                                <con1:param name="RequestHeader">
                                  <con1:path>$header/aut:RequestHeader</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform/>
                      </con2:wsCallout>
                      <con2:ifThenElse>
                        <con1:comment/>
                        <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7fc9</con1:id>
                        <con2:case>
                          <con2:condition>
                            <con1:xqueryText>fn:string($type) = "REFERENCED_LOCAL"</con1:xqueryText>
                          </con2:condition>
                          <con2:actions>
                            <con2:ifThenElse>
                              <con1:comment>Si la consulta de parámetros core es exitosa y el tipo de recaudo es "REFERENCED_LOCAL", se procede al pago de la cobranza en abanks</con1:comment>
                              <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7f7d</con1:id>
                              <con2:case>
                                <con2:condition>
                                  <con1:xqueryText>fn:upper-case($RESPONSEConsultadeparametroscore/Status/successIndicator/text()) = "SUCCESS"</con1:xqueryText>
                                </con2:condition>
                                <con2:actions>
                                  <con2:wsCallout>
                                    <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7f0b</con1:id>
                                    <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABK/pagoRecaudoAbanks/biz/pagoRecaudoAbanks_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con2:operation>pagoRecaudoAbanks</con2:operation>
                                    <con2:request>
                                      <con2:body wrapped="false">$REQPagoRecAbanks</con2:body>
                                      <con2:header/>
                                    </con2:request>
                                    <con2:response>
                                      <con2:body wrapped="false">RSPPagoRecAbanks</con2:body>
                                      <con2:header/>
                                    </con2:response>
                                    <con2:requestTransform>
                                      <con2:assign varName="REQPagoRecAbanks">
                                        <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7ec3</con1:id>
                                        <con2:expr>
                                          <con1:xqueryTransform>
                                            <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoPagoAbanksIn"/>
                                            <con1:param name="string1">
                                              <con1:path>fn:string($RESPONSE/Status/transactionId/text())</con1:path>
                                            </con1:param>
                                            <con1:param name="pagoRecaudo">
                                              <con1:path>$body/pag:pagoRecaudo</con1:path>
                                            </con1:param>
                                            <con1:param name="consultadeparametroscoreResponse">
                                              <con1:path>$RESPONSEConsultadeparametroscore</con1:path>
                                            </con1:param>
                                          </con1:xqueryTransform>
                                        </con2:expr>
                                      </con2:assign>
                                    </con2:requestTransform>
                                    <con2:responseTransform>
                                      <con2:assign varName="successIndicatorAbanks">
                                        <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7e8b</con1:id>
                                        <con2:expr>
                                          <con1:xqueryText>fn:string($RSPPagoRecAbanks/pag1:PV_CODIGO_ERROR/text())</con1:xqueryText>
                                        </con2:expr>
                                      </con2:assign>
                                    </con2:responseTransform>
                                  </con2:wsCallout>
                                  <con2:ifThenElse>
                                    <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c5a</con1:id>
                                    <con2:case>
                                      <con2:condition>
                                        <con1:xqueryText>$successIndicatorAbanks = "0"</con1:xqueryText>
                                      </con2:condition>
                                      <con2:actions>
                                        <con2:ifThenElse>
                                          <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7bea</con1:id>
                                          <con2:case>
                                            <con2:condition>
                                              <con1:xqueryText>$paymentMethod = "CASH"</con1:xqueryText>
                                            </con2:condition>
                                            <con2:actions>
                                              <con2:wsCallout>
                                                <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7b25</con1:id>
                                                <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con2:operation>Autorizacionpagorecaudorefefec</con2:operation>
                                                <con2:request>
                                                  <con2:body wrapped="false">$REQUESTAutorizacion</con2:body>
                                                  <con2:header/>
                                                </con2:request>
                                                <con2:response>
                                                  <con2:body wrapped="false">RESPONSEAutorizacon</con2:body>
                                                  <con2:header/>
                                                </con2:response>
                                                <con2:requestTransform>
                                                  <con2:assign varName="REQUESTAutorizacion">
                                                    <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-79a1</con1:id>
                                                    <con2:expr>
                                                      <con1:xqueryTransform>
                                                        <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/autorizaPagoRecaudoRefEfectivoIn"/>
                                                        <con1:param name="pagoderecaudoreferenciadoefecResponse">
                                                          <con1:path>$RESPONSE</con1:path>
                                                        </con1:param>
                                                      </con1:xqueryTransform>
                                                    </con2:expr>
                                                  </con2:assign>
                                                </con2:requestTransform>
                                                <con2:responseTransform/>
                                              </con2:wsCallout>
                                            </con2:actions>
                                          </con2:case>
                                          <con2:case>
                                            <con2:condition>
                                              <con1:xqueryText>$paymentMethod = "ACCT_DEBIT"</con1:xqueryText>
                                            </con2:condition>
                                            <con2:actions>
                                              <con2:wsCallout>
                                                <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7ab7</con1:id>
                                                <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con2:operation>Autorizacionpagorecaudorefdbcta</con2:operation>
                                                <con2:request>
                                                  <con2:body wrapped="false">$REQUESTAutorizacion</con2:body>
                                                  <con2:header/>
                                                </con2:request>
                                                <con2:response>
                                                  <con2:body wrapped="false">RESPONSEAutorizacon</con2:body>
                                                  <con2:header/>
                                                </con2:response>
                                                <con2:requestTransform>
                                                  <con2:assign varName="REQUESTAutorizacion">
                                                    <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7969</con1:id>
                                                    <con2:expr>
                                                      <con1:xqueryTransform>
                                                        <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/autorizaPagoRecaudoRefDebitoCuentaIn"/>
                                                        <con1:param name="pagoderecaudoreferenciadodbctaResponse">
                                                          <con1:path>$RESPONSE</con1:path>
                                                        </con1:param>
                                                      </con1:xqueryTransform>
                                                    </con2:expr>
                                                  </con2:assign>
                                                </con2:requestTransform>
                                                <con2:responseTransform/>
                                              </con2:wsCallout>
                                            </con2:actions>
                                          </con2:case>
                                          <con2:case>
                                            <con2:condition>
                                              <con1:xqueryText>$paymentMethod = "OWN_CHEQUE"</con1:xqueryText>
                                            </con2:condition>
                                            <con2:actions>
                                              <con2:wsCallout>
                                                <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7a7f</con1:id>
                                                <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con2:operation>Autorizacionpagorecaudorefobchq</con2:operation>
                                                <con2:request>
                                                  <con2:body wrapped="false">$REQUESTAutorizacion</con2:body>
                                                  <con2:header/>
                                                </con2:request>
                                                <con2:response>
                                                  <con2:body wrapped="false">RESPONSEAutorizacon</con2:body>
                                                  <con2:header/>
                                                </con2:response>
                                                <con2:requestTransform>
                                                  <con2:assign varName="REQUESTAutorizacion">
                                                    <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7931</con1:id>
                                                    <con2:expr>
                                                      <con1:xqueryTransform>
                                                        <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/autorizaPagoRecaudoRefChequePropioIn"/>
                                                        <con1:param name="pagorecaudoreferenciadoficochqResponse">
                                                          <con1:path>$RESPONSE</con1:path>
                                                        </con1:param>
                                                      </con1:xqueryTransform>
                                                    </con2:expr>
                                                  </con2:assign>
                                                </con2:requestTransform>
                                                <con2:responseTransform/>
                                              </con2:wsCallout>
                                            </con2:actions>
                                          </con2:case>
                                          <con2:case>
                                            <con2:condition>
                                              <con1:xqueryText>$paymentMethod = "OTHER_BANK_CHEQUE"</con1:xqueryText>
                                            </con2:condition>
                                            <con2:actions>
                                              <con2:wsCallout>
                                                <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7a47</con1:id>
                                                <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con2:operation>Autorizacionpagorecaudorefobchq</con2:operation>
                                                <con2:request>
                                                  <con2:body wrapped="false">$REQUESTAutorizacion</con2:body>
                                                  <con2:header/>
                                                </con2:request>
                                                <con2:response>
                                                  <con2:body wrapped="false">RESPONSEAutorizacon</con2:body>
                                                  <con2:header/>
                                                </con2:response>
                                                <con2:requestTransform>
                                                  <con2:assign varName="REQUESTAutorizacion">
                                                    <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-78f9</con1:id>
                                                    <con2:expr>
                                                      <con1:xqueryTransform>
                                                        <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/autorizaPagoRecaudoRefChequeOtroBancoIn"/>
                                                        <con1:param name="pagorecaudoreferenciadochqotrbcoResponse">
                                                          <con1:path>$RESPONSE</con1:path>
                                                        </con1:param>
                                                      </con1:xqueryTransform>
                                                    </con2:expr>
                                                  </con2:assign>
                                                </con2:requestTransform>
                                                <con2:responseTransform/>
                                              </con2:wsCallout>
                                            </con2:actions>
                                          </con2:case>
                                        </con2:ifThenElse>
                                        <con2:assign varName="validationMessage">
                                          <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7b7a</con1:id>
                                          <con2:expr>
                                            <con1:xqueryText>if (fn:upper-case($RESPONSEAutorizacon/Status/successIndicator) = "SUCCESS") then (
	""
) else (
	fn:concat("ERROR AUTORIZANDO: ", fn:string-join($RESPONSEAutorizacon/Status/messages, "."))
)</con1:xqueryText>
                                          </con2:expr>
                                        </con2:assign>
                                        <con1:skip>
                                          <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7b5d</con1:id>
                                        </con1:skip>
                                      </con2:actions>
                                    </con2:case>
                                    <con2:default>
                                      <con2:assign varName="validationMessage">
                                        <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7bb2</con1:id>
                                        <con2:expr>
                                          <con1:xqueryText>fn:concat("ERROR COBRANZA: ", fn:string($RSPPagoRecAbanks/pag1:PV_MENSAJE_ERROR/text()))</con1:xqueryText>
                                        </con2:expr>
                                      </con2:assign>
                                    </con2:default>
                                  </con2:ifThenElse>
                                </con2:actions>
                              </con2:case>
                              <con2:default>
                                <con2:assign varName="validationMessage">
                                  <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7f43</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>fn:string($RESPONSEConsultadeparametroscore/Status/messages/text())</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                              </con2:default>
                            </con2:ifThenElse>
                          </con2:actions>
                        </con2:case>
                        <con2:default>
                          <con2:wsCallout>
                            <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7e80</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/armarMensajeRecaudo/biz/armarMensajeRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>armarMensajeRecaudo</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUESTarmarMensajeRecaudoREQ</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSEarmarMensajeRecaudoREQ</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:ifThenElse>
                                <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7e84</con1:id>
                                <con2:case>
                                  <con2:condition>
                                    <con1:xqueryText>count($RESPONSE/TELLERType) > 0</con1:xqueryText>
                                  </con2:condition>
                                  <con2:actions>
                                    <con2:assign varName="REQUESTarmarMensajeRecaudoREQ">
                                      <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7e83</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/armarMensajeRequestTTIn"/>
                                          <con1:param name="status">
                                            <con1:path>$RESPONSE/Status</con1:path>
                                          </con1:param>
                                          <con1:param name="consultadeparametroscoreResponse">
                                            <con1:path>$RESPONSEconsultadeparametroscore</con1:path>
                                          </con1:param>
                                          <con1:param name="pagoRecaudo">
                                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="relacionOperacionRecaudo">
                                            <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                          </con1:param>
                                          <con1:param name="consultaDetalleContratoRecaudosResponse">
                                            <con1:path>$RSPConsultaDetalleContratoRecaudos</con1:path>
                                          </con1:param>
                                          <con1:param name="requestHeader">
                                            <con1:path>$header/aut:RequestHeader</con1:path>
                                          </con1:param>
                                          <con1:param name="tELLERType">
                                            <con1:path>$RESPONSE/TELLERType</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:actions>
                                </con2:case>
                                <con2:default>
                                  <con2:assign varName="REQUESTarmarMensajeRecaudoREQ">
                                    <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7e82</con1:id>
                                    <con2:expr>
                                      <con1:xqueryTransform>
                                        <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/armarMensajeRequestFTIn"/>
                                        <con1:param name="status">
                                          <con1:path>$RESPONSE/Status</con1:path>
                                        </con1:param>
                                        <con1:param name="relacionOperacionRecaudo">
                                          <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                        </con1:param>
                                        <con1:param name="consultadeparametroscoreResponse">
                                          <con1:path>$RESPONSEConsultadeparametroscore</con1:path>
                                        </con1:param>
                                        <con1:param name="pagoRecaudo">
                                          <con1:path>$body/pag:pagoRecaudo</con1:path>
                                        </con1:param>
                                        <con1:param name="consultaDetalleContratoRecaudosResponse">
                                          <con1:path>$RSPConsultaDetalleContratoRecaudos</con1:path>
                                        </con1:param>
                                        <con1:param name="RequestHeader">
                                          <con1:path>$header/aut:RequestHeader</con1:path>
                                        </con1:param>
                                        <con1:param name="fUNDSTRANSFERType">
                                          <con1:path>$RESPONSE/FUNDSTRANSFERType</con1:path>
                                        </con1:param>
                                      </con1:xqueryTransform>
                                    </con2:expr>
                                  </con2:assign>
                                </con2:default>
                              </con2:ifThenElse>
                            </con2:requestTransform>
                            <con2:responseTransform>
                              <con2:assign varName="successIndicatoArmarMensajeRecaudoREQ">
                                <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7e81</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>fn:string($RESPONSEarmarMensajeRecaudoREQ/osb3:CODIGO_RESPUESTA/text())</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                            </con2:responseTransform>
                          </con2:wsCallout>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7cad</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>fn:upper-case($successIndicatoArmarMensajeRecaudoREQ) = "SUCCESS"</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:wsCallout>
                                  <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7ca9</con1:id>
                                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/enrutadorConvenios/biz/enrutadorConvenios" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                  <con2:operation>invoke</con2:operation>
                                  <con2:request>
                                    <con2:param>
                                      <con2:name>serviceRequest</con2:name>
                                      <con2:variable>$RequestDataREQ</con2:variable>
                                    </con2:param>
                                    <con2:header/>
                                  </con2:request>
                                  <con2:response>
                                    <con2:param>
                                      <con2:name>serviceResponse</con2:name>
                                      <con2:variable>ServiceResponseREQ</con2:variable>
                                    </con2:param>
                                    <con2:header/>
                                  </con2:response>
                                  <con2:requestTransform>
                                    <con2:assign varName="RequestDataREQ">
                                      <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7cac</con1:id>
                                      <con2:expr>
                                        <con1:xqueryTransform>
                                          <con1:resource ref="Middleware/v2/Resources/ConsultaRecaudo/xq/enrutadorConveniosIn"/>
                                          <con1:param name="outputParameters">
                                            <con1:path>$RESPONSEarmarMensajeRecaudoREQ</con1:path>
                                          </con1:param>
                                        </con1:xqueryTransform>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:requestTransform>
                                  <con2:responseTransform>
                                    <con2:assign varName="responseData">
                                      <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7cab</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>fn-bea:inlinedXML($ServiceResponseREQ/responseData)</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                    <con2:assign varName="successIndicatorEnrutador">
                                      <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7caa</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>fn:string($responseData//errorCode/text())</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:responseTransform>
                                </con2:wsCallout>
                                <con2:ifThenElse>
                                  <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7ca8</con1:id>
                                  <con2:case>
                                    <con2:condition>
                                      <con1:xqueryText>$successIndicatorEnrutador = "0"</con1:xqueryText>
                                    </con2:condition>
                                    <con2:actions>
                                      <con2:ifThenElse xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
                                        <con1:comment>Autorizacion de transaccion en T24 según medio de pago</con1:comment>
                                        <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7ca7</con1:id>
                                        <con2:case>
                                          <con2:condition>
                                            <con1:xqueryText>$paymentMethod = "CASH"</con1:xqueryText>
                                          </con2:condition>
                                          <con2:actions>
                                            <con2:wsCallout>
                                              <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7ca5</con1:id>
                                              <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                              <con2:operation>Autorizacionpagorecaudorefefec</con2:operation>
                                              <con2:request>
                                                <con2:body wrapped="false">$REQUESTAutorizacion</con2:body>
                                                <con2:header/>
                                              </con2:request>
                                              <con2:response>
                                                <con2:body wrapped="false">RESPONSEAutorizacion</con2:body>
                                                <con2:header/>
                                              </con2:response>
                                              <con2:requestTransform>
                                                <con2:assign varName="REQUESTAutorizacion">
                                                  <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7ca6</con1:id>
                                                  <con2:expr>
                                                    <con1:xqueryTransform>
                                                      <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/autorizaPagoRecaudoRefEfectivoIn"/>
                                                      <con1:param name="pagoderecaudoreferenciadoefecResponse">
                                                        <con1:path>$RESPONSE</con1:path>
                                                      </con1:param>
                                                    </con1:xqueryTransform>
                                                  </con2:expr>
                                                </con2:assign>
                                              </con2:requestTransform>
                                              <con2:responseTransform/>
                                            </con2:wsCallout>
                                          </con2:actions>
                                        </con2:case>
                                        <con2:case>
                                          <con2:condition>
                                            <con1:xqueryText>$paymentMethod = "ACCT_DEBIT"</con1:xqueryText>
                                          </con2:condition>
                                          <con2:actions>
                                            <con2:wsCallout>
                                              <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7ca3</con1:id>
                                              <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                              <con2:operation>Autorizacionpagorecaudorefdbcta</con2:operation>
                                              <con2:request>
                                                <con2:body wrapped="false">$REQUESTAutorizacion</con2:body>
                                                <con2:header/>
                                              </con2:request>
                                              <con2:response>
                                                <con2:body wrapped="false">RESPONSEAutorizacion</con2:body>
                                                <con2:header/>
                                              </con2:response>
                                              <con2:requestTransform>
                                                <con2:assign varName="REQUESTAutorizacion">
                                                  <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7ca4</con1:id>
                                                  <con2:expr>
                                                    <con1:xqueryTransform>
                                                      <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/autorizaPagoRecaudoRefDebitoCuentaIn"/>
                                                      <con1:param name="pagoderecaudoreferenciadodbctaResponse">
                                                        <con1:path>$RESPONSE</con1:path>
                                                      </con1:param>
                                                    </con1:xqueryTransform>
                                                  </con2:expr>
                                                </con2:assign>
                                              </con2:requestTransform>
                                              <con2:responseTransform/>
                                            </con2:wsCallout>
                                          </con2:actions>
                                        </con2:case>
                                        <con2:case>
                                          <con2:condition>
                                            <con1:xqueryText>$paymentMethod = "OWN_CHEQUE"</con1:xqueryText>
                                          </con2:condition>
                                          <con2:actions>
                                            <con2:wsCallout>
                                              <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7ca1</con1:id>
                                              <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                              <con2:operation>Autorizacionpagorecaudoreffichq</con2:operation>
                                              <con2:request>
                                                <con2:body wrapped="false">$REQUESTAutorizacion</con2:body>
                                                <con2:header/>
                                              </con2:request>
                                              <con2:response>
                                                <con2:body wrapped="false">RESPONSEAutorizacion</con2:body>
                                                <con2:header/>
                                              </con2:response>
                                              <con2:requestTransform>
                                                <con2:assign varName="REQUESTAutorizacion">
                                                  <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7ca2</con1:id>
                                                  <con2:expr>
                                                    <con1:xqueryTransform>
                                                      <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/autorizaPagoRecaudoRefChequePropioIn"/>
                                                      <con1:param name="pagorecaudoreferenciadoficochqResponse">
                                                        <con1:path>$RESPONSE</con1:path>
                                                      </con1:param>
                                                    </con1:xqueryTransform>
                                                  </con2:expr>
                                                </con2:assign>
                                              </con2:requestTransform>
                                              <con2:responseTransform/>
                                            </con2:wsCallout>
                                          </con2:actions>
                                        </con2:case>
                                        <con2:case>
                                          <con2:condition>
                                            <con1:xqueryText>$paymentMethod = "OTHER_BANK_CHEQUE"</con1:xqueryText>
                                          </con2:condition>
                                          <con2:actions>
                                            <con2:wsCallout>
                                              <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c9f</con1:id>
                                              <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                              <con2:operation>Autorizacionpagorecaudorefobchq</con2:operation>
                                              <con2:request>
                                                <con2:body wrapped="false">$REQUESTAutorizacion</con2:body>
                                                <con2:header/>
                                              </con2:request>
                                              <con2:response>
                                                <con2:body wrapped="false">RESPONSEAutorizacion</con2:body>
                                                <con2:header/>
                                              </con2:response>
                                              <con2:requestTransform>
                                                <con2:assign varName="REQUESTAutorizacion">
                                                  <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7ca0</con1:id>
                                                  <con2:expr>
                                                    <con1:xqueryTransform>
                                                      <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/autorizaPagoRecaudoRefChequeOtroBancoIn"/>
                                                      <con1:param name="pagorecaudoreferenciadochqotrbcoResponse">
                                                        <con1:path>$RESPONSE</con1:path>
                                                      </con1:param>
                                                    </con1:xqueryTransform>
                                                  </con2:expr>
                                                </con2:assign>
                                              </con2:requestTransform>
                                              <con2:responseTransform/>
                                            </con2:wsCallout>
                                          </con2:actions>
                                        </con2:case>
                                        <con2:case>
                                          <con2:condition>
                                            <con1:xqueryText>$paymentMethod = "CREDIT_CARD"</con1:xqueryText>
                                          </con2:condition>
                                          <con2:actions>
                                            <con2:wsCallout>
                                              <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c9d</con1:id>
                                              <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                              <con2:operation>Autorizacionpagorecaudorefdbcta</con2:operation>
                                              <con2:request>
                                                <con2:body wrapped="false">$REQUESTAutorizacion</con2:body>
                                                <con2:header/>
                                              </con2:request>
                                              <con2:response>
                                                <con2:body wrapped="false">RESPONSEAutorizacion</con2:body>
                                                <con2:header/>
                                              </con2:response>
                                              <con2:requestTransform>
                                                <con2:assign varName="REQUESTAutorizacion">
                                                  <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c9e</con1:id>
                                                  <con2:expr>
                                                    <con1:xqueryTransform>
                                                      <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/autorizaPagoRecaudoRefDebitoCuentaIn"/>
                                                      <con1:param name="pagoderecaudoreferenciadodbctaResponse">
                                                        <con1:path>$RESPONSE</con1:path>
                                                      </con1:param>
                                                    </con1:xqueryTransform>
                                                  </con2:expr>
                                                </con2:assign>
                                              </con2:requestTransform>
                                              <con2:responseTransform/>
                                            </con2:wsCallout>
                                          </con2:actions>
                                        </con2:case>
                                      </con2:ifThenElse>
                                      <con2:assign varName="validationMessage">
                                        <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c9c</con1:id>
                                        <con2:expr>
                                          <con1:xqueryText>if (fn:upper-case($RESPONSEAutorizacion/Status/successIndicator) = "SUCCESS") then (
	""
) else (
	fn:concat("ERROR AUTORIZANDO: ", fn:string-join($RESPONSEAutorizacion/Status/messages, "."))
)</con1:xqueryText>
                                        </con2:expr>
                                      </con2:assign>
                                      <con2:ifThenElse>
                                        <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c9b</con1:id>
                                        <con2:case>
                                          <con2:condition>
                                            <con1:xqueryText>$validationMessage = ""</con1:xqueryText>
                                          </con2:condition>
                                          <con2:actions>
                                            <con2:assign varName="manejaConceptos">
                                              <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c9a</con1:id>
                                              <con2:expr>
                                                <con1:xqueryText>'N'</con1:xqueryText>
                                              </con2:expr>
                                            </con2:assign>
                                            <con2:ifThenElse>
                                              <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c99</con1:id>
                                              <con2:case>
                                                <con2:condition>
                                                  <con1:xqueryText>fn:string($manejaConceptos) = "S"</con1:xqueryText>
                                                </con2:condition>
                                                <con2:actions>
                                                  <con2:assign varName="idTransaccion">
                                                    <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c98</con1:id>
                                                    <con2:expr>
                                                      <con1:xqueryText>fn:string($RESPONSEAutorizacion/Status/transactionId/text())</con1:xqueryText>
                                                    </con2:expr>
                                                  </con2:assign>
                                                  <con4:route>
                                                    <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c97</con1:id>
                                                    <con4:service ref="Middleware/v2/BusinessServices/distribucionConceptosRecaudos/biz/distribucionConceptosRecaudos" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                    <con4:operation>distribuirConceptosRecaudos</con4:operation>
                                                    <con4:outboundTransform>
                                                      <con2:replace varName="body" contents-only="true">
                                                        <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c96</con1:id>
                                                        <con2:expr>
                                                          <con1:xqueryTransform>
                                                            <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/distribuirConceptosRecaudosIn"/>
                                                            <con1:param name="pagoRecaudo">
                                                              <con1:path>$body/pag:pagoRecaudo</con1:path>
                                                            </con1:param>
                                                            <con1:param name="consultadeparametroscoreResponse">
                                                              <con1:path>$RESPONSEConsultadeparametroscore</con1:path>
                                                            </con1:param>
                                                            <con1:param name="transactionId">
                                                              <con1:path>fn:string($idTransaccion)</con1:path>
                                                            </con1:param>
                                                            <con1:param name="serviceResponse">
                                                              <con1:path>$ServiceResponseREQ</con1:path>
                                                            </con1:param>
                                                          </con1:xqueryTransform>
                                                        </con2:expr>
                                                      </con2:replace>
                                                    </con4:outboundTransform>
                                                  </con4:route>
                                                </con2:actions>
                                              </con2:case>
                                              <con2:default/>
                                            </con2:ifThenElse>
                                          </con2:actions>
                                        </con2:case>
                                        <con2:default>
                                          <con2:assign varName="validationMessage">
                                            <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c95</con1:id>
                                            <con2:expr>
                                              <con1:xqueryText>fn:concat("ERROR AUTORIZANDO: ", fn:string-join($RESPONSEAutorizacion/Status/messages, "."))</con1:xqueryText>
                                            </con2:expr>
                                          </con2:assign>
                                        </con2:default>
                                      </con2:ifThenElse>
                                      <con1:skip>
                                        <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c94</con1:id>
                                      </con1:skip>
                                    </con2:actions>
                                  </con2:case>
                                  <con2:default>
                                    <con2:assign varName="validationMessage">
                                      <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c93</con1:id>
                                      <con2:expr>
                                        <con1:xqueryText>fn:concat("ERROR ENRUTADOR: ", fn:string($responseData//errorMessage/text()))</con1:xqueryText>
                                      </con2:expr>
                                    </con2:assign>
                                  </con2:default>
                                </con2:ifThenElse>
                              </con2:actions>
                            </con2:case>
                            <con2:default>
                              <con2:assign varName="validationMessage">
                                <con1:id>_ActionId-829280512358631514--e461ab4.1560fb85b97.-7c92</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>fn:string($RESPONSEarmarMensajeRecaudoREQ/osb3:MENSAJE_RESPUESTA/text())</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                            </con2:default>
                          </con2:ifThenElse>
                        </con2:default>
                      </con2:ifThenElse>
                      <con2:ifThenElse>
                        <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c49</con1:id>
                        <con2:case>
                          <con2:condition>
                            <con1:xqueryText>count($RESPONSE/TELLERType) > 0</con1:xqueryText>
                          </con2:condition>
                          <con2:actions>
                            <con2:wsCallout>
                              <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c47</con1:id>
                              <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con2:operation>EliminacionpagorecaudorefTT</con2:operation>
                              <con2:request>
                                <con2:body wrapped="false">$REQUESTEliminacion</con2:body>
                                <con2:header/>
                              </con2:request>
                              <con2:response>
                                <con2:body wrapped="false">RESPONSEEliminacion</con2:body>
                                <con2:header/>
                              </con2:response>
                              <con2:requestTransform>
                                <con2:assign varName="REQUESTEliminacion">
                                  <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c48</con1:id>
                                  <con2:expr>
                                    <con1:xqueryTransform>
                                      <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/eliminaPagoRecaudoRefTTIn"/>
                                      <con1:param name="requestHeader">
                                        <con1:path>$header/aut:RequestHeader</con1:path>
                                      </con1:param>
                                      <con1:param name="status">
                                        <con1:path>$RESPONSE/Status</con1:path>
                                      </con1:param>
                                    </con1:xqueryTransform>
                                  </con2:expr>
                                </con2:assign>
                              </con2:requestTransform>
                              <con2:responseTransform/>
                            </con2:wsCallout>
                          </con2:actions>
                        </con2:case>
                        <con2:default>
                          <con2:wsCallout>
                            <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c45</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>EliminacionpagorecaudorefFT</con2:operation>
                            <con2:request>
                              <con2:body wrapped="false">$REQUESTEliminacion</con2:body>
                              <con2:header/>
                            </con2:request>
                            <con2:response>
                              <con2:body wrapped="false">RESPONSEEliminacion</con2:body>
                              <con2:header/>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUESTEliminacion">
                                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c46</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/eliminaPagoRecaudoRefFTIn"/>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                    <con1:param name="status">
                                      <con1:path>$RESPONSE/Status</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:default>
                      </con2:ifThenElse>
                      <con2:assign varName="validationMessage">
                        <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c44</con1:id>
                        <con2:expr>
                          <con1:xqueryText>if (fn:upper-case($RESPONSEEliminacion/Status/successIndicator) = "SUCCESS") then (
	$validationMessage
) else (
	fn:concat($validationMessage, ". ERROR ELIMINANDO TRX: ", fn:string-join($RESPONSEEliminacion/Status/messages, "."))
)</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con1:skip>
                      <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c43</con1:id>
                    </con1:skip>
                  </con2:default>
                </con2:ifThenElse>
              </con2:actions>
            </con2:case>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$type = "MOBILE_RECHARGE"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:ifThenElse>
                  <con1:id>_ActionId-9014052120823392757--26aa29da.156add2b8d4.-7981</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$paymentMethod = "ACCT_DEBIT"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:wsCallout>
                        <con1:id>_ActionId-9014052120823392757--26aa29da.156add2b8d4.-797e</con1:id>
                        <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/CompraRecarga" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>compraRecarga</con2:operation>
                        <con2:request>
                          <con2:body wrapped="false">$REQCompraRecarga</con2:body>
                          <con2:header>$REQHeaderCompraRecarga</con2:header>
                        </con2:request>
                        <con2:response>
                          <con2:body wrapped="false">RSPCompraRecarga</con2:body>
                          <con2:header>RSPHeaderCompraRecarga</con2:header>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQHeaderCompraRecarga">
                            <con1:id>_ActionId-9014052120823392757--26aa29da.156add2b8d4.-7980</con1:id>
                            <con2:expr>
                              <con1:xqueryText>$header</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:assign varName="REQCompraRecarga">
                            <con1:id>_ActionId-9014052120823392757--26aa29da.156add2b8d4.-797f</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoCompraRecargaIn"/>
                                <con1:param name="pagoRecaudo">
                                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform/>
                      </con2:wsCallout>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con2:assign varName="validationMessage">
                      <con1:id>_ActionId-9014052120823392757--26aa29da.156add2b8d4.-797d</con1:id>
                      <con2:expr>
                        <con1:xqueryText>"NOT YET IMPLEMENTED"</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con1:skip>
                      <con1:id>_ActionId-9014052120823392757--26aa29da.156add2b8d4.-797c</con1:id>
                    </con1:skip>
                  </con2:default>
                </con2:ifThenElse>
              </con2:actions>
            </con2:case>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$type = "MOBILE_PACKAGE"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:ifThenElse>
                  <con1:id>_ActionId-8227885015690214939-6c56e388.16b2456afa6.-7eed</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$paymentMethod = "ACCT_DEBIT"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:assign varName="phoneCarrierParam">
                        <con1:id>_ActionId-5296419917846190249-73e015ec.16ccaa7f36e.-7be0</con1:id>
                        <con2:expr>
                          <con1:xqueryText>fn:concat("FICBCO0067",".",
			data($header/aut:RequestHeader/Region/SourceBank/text()),".",
			"PHONE.CARRIER", ".",
			data($body/pag:pagoRecaudo/CONTRACT_ID/text()))</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con2:wsCallout>
                        <con1:id>_ActionId-5296419917846190249-73e015ec.16ccaa7f36e.-7c3c</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>obtenerParametrizacion</con2:operation>
                        <con2:request>
                          <con2:body wrapped="false">$REQObtenerParams</con2:body>
                          <con2:header/>
                        </con2:request>
                        <con2:response>
                          <con2:body wrapped="false">RSPObtenerParams</con2:body>
                          <con2:header/>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQObtenerParams">
                            <con1:id>_ActionId-5296419917846190249-73e015ec.16ccaa7f36e.-7ba8</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                                <con1:param name="nombreParametros">
                                  <con1:path>$phoneCarrierParam</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform>
                          <con2:assign varName="phoneCarrier">
                            <con1:id>_ActionId-5296419917846190249-73e015ec.16ccaa7f36e.-7ac8</con1:id>
                            <con2:expr>
                              <con1:xqueryText>let $phoneCarrier := fn:string($RSPObtenerParams/osb4:CONFIGURACIONES/osb4:CONFIGURACIONES_ITEM[osb4:NAME=$phoneCarrierParam]/osb4:VALUE/text())
return
	if ($phoneCarrier != "") then (
		$phoneCarrier
	) else (
		"NO_RECORD"
	)</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-5296419917846190249-73e015ec.16ccaa7f36e.-7aca</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>$phoneCarrier = "NO_RECORD"</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:assign varName="validationMessage">
                                  <con1:id>_ActionId-5296419917846190249-73e015ec.16ccaa7f36e.-7a90</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>fn:string("No se encontro parametrización de Operador Telefonico. ")</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                              </con2:actions>
                            </con2:case>
                            <con2:default/>
                          </con2:ifThenElse>
                        </con2:responseTransform>
                      </con2:wsCallout>
                      <con2:ifThenElse>
                        <con1:id>_ActionId-8551071218074353105-7964eedc.16cce773444.-7fac</con1:id>
                        <con2:case>
                          <con2:condition>
                            <con1:xqueryText>$validationMessage = ""</con1:xqueryText>
                          </con2:condition>
                          <con2:actions>
                            <con2:wsCallout>
                              <con1:id>_ActionId-8551071218074353105-7964eedc.16cce773444.-7fa4</con1:id>
                              <con2:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/CompraPaquetes" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con2:operation>compraPaquete</con2:operation>
                              <con2:request>
                                <con2:body wrapped="false">$REQCompraPaquetes</con2:body>
                                <con2:header>$REQHdrCompraPaquetes</con2:header>
                              </con2:request>
                              <con2:response>
                                <con2:body wrapped="false">RSPCompraPaquetes</con2:body>
                                <con2:header>RSPHdrCompraPaquetes</con2:header>
                              </con2:response>
                              <con2:requestTransform>
                                <con2:replace contents-only="true" varName="body">
                                  <con1:id>_ActionId-8551071218074353105-7964eedc.16cce773444.-7fa7</con1:id>
                                  <con2:location>
                                    <con1:xpathText>./pag:pagoRecaudo/CONTRACT_ID</con1:xpathText>
                                  </con2:location>
                                  <con2:expr>
                                    <con1:xqueryText>$phoneCarrier</con1:xqueryText>
                                  </con2:expr>
                                </con2:replace>
                                <con2:assign varName="REQHdrCompraPaquetes">
                                  <con1:id>_ActionId-8551071218074353105-7964eedc.16cce773444.-7fa6</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>$header</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                                <con2:assign varName="REQCompraPaquetes">
                                  <con1:id>_ActionId-8551071218074353105-7964eedc.16cce773444.-7fa5</con1:id>
                                  <con2:expr>
                                    <con1:xqueryTransform>
                                      <con1:resource ref="Middleware/v2/Resources/PagoRecaudo/xq/pagoRecaudoCompraPaqueteIn"/>
                                      <con1:param name="pagoRecaudo">
                                        <con1:path>$body/pag:pagoRecaudo</con1:path>
                                      </con1:param>
                                    </con1:xqueryTransform>
                                  </con2:expr>
                                </con2:assign>
                              </con2:requestTransform>
                              <con2:responseTransform/>
                            </con2:wsCallout>
                          </con2:actions>
                        </con2:case>
                        <con2:default/>
                      </con2:ifThenElse>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con2:assign varName="validationMessage">
                      <con1:id>_ActionId-9124541888682138008--355a5d1c.16c73b3130d.-64c5</con1:id>
                      <con2:expr>
                        <con1:xqueryText>"NOT YET IMPLEMENTED"</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con1:skip>
                      <con1:id>_ActionId-9124541888682138008--355a5d1c.16c73b3130d.-63e4</con1:id>
                    </con1:skip>
                  </con2:default>
                </con2:ifThenElse>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con1:skip>
                <con1:id>_ActionId-4904921500967250622--63dc3ab6.150ab5ca812.-7c42</con1:id>
              </con1:skip>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="Default_PagoRecaudo_request">
      <con:stage name="FlujoEntrada">
        <con:context/>
      </con:stage>
    </con:pipeline>
    <con:flow>
      <con:pipeline-node name="ValidacionesGenerales1">
        <con:request>ValidacionesGenerales1_request</con:request>
        <con:response>ValidacionesGenerales1_response</con:response>
      </con:pipeline-node>
      <con:branch-node type="condition" name="RegionalizacionPaisEmpresa">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:branch-table variable="header">
          <con:xpath>
            <con1:xpathText>./aut:RequestHeader/Region/SourceBank</con1:xpathText>
          </con:xpath>
          <con:branch name="HNBanco">
            <con:operator>equals</con:operator>
            <con:value>'HN01'</con:value>
            <con:flow>
              <con:pipeline-node name="HNBanco_PagoRecaudo">
                <con:request>HNBanco_PagoRecaudo_request</con:request>
                <con:response>HNBanco_PagoRecaudo_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:branch>
          <con:branch name="GTBanco">
            <con:operator>equals</con:operator>
            <con:value>'GT01'</con:value>
            <con:flow>
              <con:route-node name="GTBanco_PagoRecaudo">
                <con:context/>
                <con:actions>
                  <con6:route>
                    <con1:id>_ActionId-1123303592919748654-4603c7bd.17021558470.-7c9e</con1:id>
                    <con6:service ref="Middleware/v2/ProxyServices/PagoRecaudoGT" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                    <con6:operation>pagoRecaudo</con6:operation>
                    <con6:outboundTransform>
                      <con2:transport-headers copy-all="true">
                        <con1:id>_ActionId-1123303592919748654-4603c7bd.17021558470.-7c2e</con1:id>
                        <con2:header-set>outbound-request</con2:header-set>
                      </con2:transport-headers>
                    </con6:outboundTransform>
                    <con6:responseTransform/>
                  </con6:route>
                </con:actions>
              </con:route-node>
            </con:flow>
          </con:branch>
          <con:branch name="PABanco">
            <con:operator>equals</con:operator>
            <con:value>'PA01'</con:value>
            <con:flow>
              <con:route-node name="PABanco_PagoRecaudo">
                <con:context/>
                <con:actions>
                  <con6:route>
                    <con1:id>_ActionId-3310449379602453625-41ea4e84.1660bef0ff3.-7fa5</con1:id>
                    <con6:service ref="Middleware/v2/ProxyServices/PagoRecaudoPA" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                    <con6:outboundTransform>
                      <con2:transport-headers copy-all="true">
                        <con1:id>_ActionId-3310449379602453625-41ea4e84.1660bef0ff3.-7f37</con1:id>
                        <con2:header-set>outbound-request</con2:header-set>
                      </con2:transport-headers>
                    </con6:outboundTransform>
                    <con6:responseTransform/>
                  </con6:route>
                </con:actions>
              </con:route-node>
            </con:flow>
          </con:branch>
          <con:branch name="NIBanco">
            <con:operator>equals</con:operator>
            <con:value>'NI01'</con:value>
            <con:flow>
              <con:route-node name="NIBanco_PagoRecaudo">
                <con:context/>
                <con:actions>
                  <con6:route>
                    <con1:id>_ActionId-797014891366926464-7c4b5170.1729b2030d3.-7e72</con1:id>
                    <con6:service ref="Middleware/v2/ProxyServices/PagoRecaudoNI" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                    <con6:outboundTransform>
                      <con2:transport-headers copy-all="true">
                        <con1:id>_ActionId-797014891366926464-7c4b5170.1729b2030d3.-7e71</con1:id>
                        <con2:header-set>outbound-request</con2:header-set>
                      </con2:transport-headers>
                    </con6:outboundTransform>
                    <con6:responseTransform/>
                  </con6:route>
                </con:actions>
              </con:route-node>
            </con:flow>
          </con:branch>
          <con:default-branch>
            <con:flow>
              <con:pipeline-node name="Default_PagoRecaudo">
                <con:request>Default_PagoRecaudo_request</con:request>
                <con:response>Default_PagoRecaudo_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:default-branch>
        </con:branch-table>
      </con:branch-node>
    </con:flow>
  </ser:router>
</xml-fragment>