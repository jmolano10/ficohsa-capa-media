<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:con="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config">
  <ser:coreEntry isProxy="true" isEnabled="true" isTracingEnabled="false">
    <ser:binding type="SOAP" isSoap12="false" xsi:type="con3:SoapBindingType" xmlns:con3="http://www.bea.com/wli/sb/services/bindings/config">
      <con3:wsdl ref="Middleware/v3/Resources/CreacionClienteTarjetaCredito/wsdl/creacionClienteTarjetaCreditoPS"/>
      <con3:port>
        <con3:name>creacionClienteTarjetaCreditoPSSOAP</con3:name>
        <con3:namespace>http://www.ficohsa.com.hn/middleware.services/creacionClienteTarjetaCreditoPS/</con3:namespace>
      </con3:port>
      <con3:selector type="SOAP body"/>
      <con3:WSI-compliant>false</con3:WSI-compliant>
    </ser:binding>
    <ser:monitoring isEnabled="false">
      <ser:aggregationInterval>10</ser:aggregationInterval>
      <ser:pipelineMonitoringLevel>Pipeline</ser:pipelineMonitoringLevel>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
  </ser:coreEntry>
  <ser:endpointConfig>
    <tran:provider-id>local</tran:provider-id>
    <tran:inbound>true</tran:inbound>
    <tran:inbound-properties/>
    <tran:all-headers>true</tran:all-headers>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-1342865507756168585-7910ce22.16fa9b84915.-7d67">
    <con:pipeline type="request" name="CreacionClienteTarjetaCredito_request" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="VariablesDeDescripción">
        <con:comment>Se obtienes las descripciones de la peticioón necesarias para consultar el servcio de Catalogo</con:comment>
        <con:context>
          <con3:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/creacionClienteTarjetaCreditoTypes" prefix="cre" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con2:assign varName="countryIssueDocument">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7cf8</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($body/cre:creacionClienteTarjetaCredito/COUNTRY_OF_ISSUE_DOCUMENT/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="customerInfo">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7d1d</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$body/cre:creacionClienteTarjetaCredito/cre:CUSTOMER_INFO</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="maritalStatus">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7eb2</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($customerInfo/MARITAL_STATUS/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="countryId">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7cfc</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($customerInfo/COUNTRY_ID/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="leaglIdType">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7cf2</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($customerInfo/IDENTIFICATION_TYPE/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="gender">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7cf6</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($customerInfo/GENDER/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="profesion">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7cb6</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($customerInfo/PROFESSION_CODE/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="educationLevel">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7c99</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($customerInfo/EDUCATION_LEVEL/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="customerType">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7c7c</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($customerInfo/CUSTOMER_TYPE/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="economicActivityId">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7c5f</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($customerInfo/ECONOMIC_ACTIVITY_ID/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="codeOcupation">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7c42</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($customerInfo/CODE_OCUPACION/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="companyType">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7c25</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($customerInfo/COMPANY_TYPE/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="relationshipType">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7b2b</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($customerInfo/PEP_RELATIONSHIP_TYPE/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="locationCatalogue">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7ab9</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">""</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:foreach>
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7b0e</con3:id>
            <con2:variable>body</con2:variable>
            <con2:expression>
              <con3:xpathText xmlns:con3="http://www.bea.com/wli/sb/stages/config">./cre:creacionClienteTarjetaCredito/cre:CUSTOMER_ADDRESSES/cre:CUSTOMER_ADDRESS</con3:xpathText>
            </con2:expression>
            <con2:value-variable>customerAddress</con2:value-variable>
            <con2:actions>
              <con2:assign varName="locationCatalogue">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7ad6</con3:id>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">concat(
	$locationCatalogue, '||',
    29, ';', fn:string($customerAddress/RATE_RISK/text()), ';', 'ABANKSGT', '||',
    25, ';',fn:string($customerAddress/ADDRESS_CODE/text()), ';', 'ABANKSGT','||', 
    25, ';', fn:string($customerAddress/ADDRESS_TYPE_CODE/text()), ';', 'ABANKSGT','||',
    14, ';',fn:string($customerAddress/SECTOR_CODE/text()), ';', 'ABANKSGT','||', 
    8, ';', fn:string($customerAddress/DEPARMENT_CODE/text()), ';', 'ABANKSGT','||',
    8, ';', fn:string($customerAddress/DEPARMENT_CODE/text()), ';', 'VISION+GT','||',     
    7, ';', fn:string($customerAddress/MUNICIPALITY_CODE/text()), ';', 'ABANKSGT', '||', 
    7, ';', fn:string($customerAddress/MUNICIPALITY_CODE/text()), ';', 'VISION+GT','||', 
    7, ';', fn:string($customerAddress/MUNICIPALITY_OF_ISSUE_DOCUMENT/text()), ';', 'ABANKSGT','||'                    
)</con3:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:actions>
          </con2:foreach>
          <con2:assign varName="countryCode">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-5653787485255769354--76bd33f7.18a8b4d0bb1.-7f2b</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($body/cre:creacionClienteTarjetaCredito/cre:CUSTOMER_ADDRESSES/cre:CUSTOMER_ADDRESS[1]/COUNTRY_CODE/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="otherNationality">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-5653787485255769354--76bd33f7.18a8b4d0bb1.-7f67</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($body/cre:creacionClienteTarjetaCredito/cre:CUSTOMER_ADDRESSES/cre:CUSTOMER_ADDRESS[1]/OTHER_NATIONALITY/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="deparmentIssueDoc">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-5653787485255769354--76bd33f7.18a8b4d0bb1.-7f4a</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($body/cre:creacionClienteTarjetaCredito/cre:CUSTOMER_ADDRESSES/cre:CUSTOMER_ADDRESS[1]/DEPARMENT_OF_ISSUE_DOCUMENT/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="nationalityCEP">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7b9f</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($body/cre:creacionClienteTarjetaCredito/cre:CUSTOMER_CEP/NATIONALITY_CEP/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="relationshipCode">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7b65</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($body/cre:creacionClienteTarjetaCredito/cre:CUSTOMER_PEP/RELATIONSHIP_CODE/text())</con3:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="positionCatalogue">
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-79d4</con3:id>
            <con2:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">for $CUSTOMER_TYPE_OF_EMPLOYMENT in $body/cre:creacionClienteTarjetaCredito/cre:CUSTOMER_TYPE_OF_EMPLOYMENTS/cre:CUSTOMER_TYPE_OF_EMPLOYMENT
return(
	concat('', '||', 11, ';', fn:string($CUSTOMER_TYPE_OF_EMPLOYMENT/POSITION/text()), ';', 'ABANKSGT', '||', 
		   11, ';', fn:string($CUSTOMER_TYPE_OF_EMPLOYMENT/POSITION/text()), ';', 'VISION+'
	)
	
)</con3:xqueryText>
            </con2:expr>
          </con2:assign>
        </con:actions>
      </con:stage>
      <con:stage name="ConsultaEquivalenciasCatalogosV2">
        <con:context>
          <con3:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/consultaEquivalenciasCatalogos_v2" prefix="con" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con2:wsCallout>
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-78fa</con3:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/MDW/consultaEquivalenciasCatalogos_v2/biz/consultaEquivalenciasCatalogos_v2_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>consultaEquivalenciasCatalogos_v2</con2:operation>
            <con2:request>
              <con2:body>$REQconsultaEquivalenciasCatalogos</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>RSPconsultaEquivalenciasCatalogos</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="REQconsultaEquivalenciasCatalogos">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-78c2</con3:id>
                <con2:expr>
                  <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                    <con3:resource ref="Middleware/v2/Resources/Generales/xq/consultaEquivalenciasCatalogos_v2In"/>
                    <con3:param name="criteriosConsulta">
                      <con3:path>concat(
        28,';',$relationshipType,';','ABANKSGT','||',
        28,';',$relationshipCode,';','ABANKSGT','||',
        26,';',$nationalityCEP,';','ABANKSGT','||',
        24,';',$companyType,';','ABANKSGT','||',
        23,';',$codeOcupation,';','ABANKSGT','||',
        22,';',$economicActivityId,';','ABANKSGT','||',
        21,';',$customerType,';','ABANKSGT',$positionCatalogue,'||',
        10,';',$educationLevel,';','ABANKSGT','||',
        9,';',$countryCode,';','ABANKSGT','||',
        9,';',$countryCode,';','VISION+GT','||',
        9,';',$countryId,';','ABANKSGT','||',
        9,';',$countryIssueDocument,';','ABANKSGT','||',
        9,';',$otherNationality,';','ABANKSGT','||', 
        8,';',$deparmentIssueDoc, ';','ABANKSGT',$locationCatalogue,'||',        
        4,';',$leaglIdType,';','ABANKSGT','||',
        3,';',$profesion,';','ABANKSGT','||',
        2,';',$maritalStatus,';','ABANKSGT','||',
        1,';',$gender,';','ABANKSGT','||',        
        4,';',$leaglIdType,';','VISION+GT','||',
        3,';',$profesion,';','VISION+GT','||',
        2,';',$maritalStatus,';','VISION+GT','||',
        1,';',$gender,';','VISION+GT'
)</con3:path>
                    </con3:param>
                    <con3:param name="tipoProceso">
                      <con3:path>"1"</con3:path>
                    </con3:param>
                  </con3:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:assign varName="errorCode">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-788a</con3:id>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($RSPconsultaEquivalenciasCatalogos/con:PV_CODIGOMENSAJE/text())</con3:xqueryText>
                </con2:expr>
              </con2:assign>
              <con2:assign varName="validationMessage">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-786d</con3:id>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($RSPconsultaEquivalenciasCatalogos/con:PV_DESCRIPCIONMENSAJE/text())</con3:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:responseTransform>
          </con2:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="CrearPerfilCliente">
        <con:context>
          <con3:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/creacionClienteTarjetaCreditoTypes" prefix="cre" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
          <con3:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/perfilCliente" prefix="per" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-77c9</con3:id>
            <con2:case>
              <con2:condition>
                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$validationMessage = ''</con3:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:wsCallout>
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-77bf</con3:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABKGT/perfilCliente/biz/perfilCliente_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>perfilCliente</con2:operation>
                  <con2:request>
                    <con2:body>$REQperfilCliente</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPperfilCliente</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQperfilCliente">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-77c3</con3:id>
                      <con2:expr>
                        <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                          <con3:resource ref="Middleware/v3/Resources/CreacionClienteTarjetaCredito/xq/perfilClienteGTIn"/>
                          <con3:param name="codPais">
                            <con3:path>"320"</con3:path>
                          </con3:param>
                          <con3:param name="consultaEquivalenciaCatalogo">
                            <con3:path>$RSPconsultaEquivalenciasCatalogos</con3:path>
                          </con3:param>
                          <con3:param name="creacionClienteTarjetaCredito1">
                            <con3:path>$body/cre:creacionClienteTarjetaCredito</con3:path>
                          </con3:param>
                        </con3:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:assign varName="errorCode">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-77c2</con3:id>
                      <con2:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">string($RSPperfilCliente/per:PV_CODIGOERROR/text())</con3:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="validationMessage">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-77a1</con3:id>
                      <con2:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">if($errorCode != 'SUCCESS')then(
	string($RSPperfilCliente/per:PV_DESCRIPCIONERROR/text())
)else(
	''
)</con3:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="codigoCliente">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7234524368044857694-3218511d.18a84d94361.-7784</con3:id>
                      <con2:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">string($RSPperfilCliente/per:PN_CODIGO_CLIENTE/text())</con3:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="CrearCliente">
        <con:context>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/consultaEquivalenciasCatalogos" prefix="con" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/creacionClienteTarjetaCreditoTypes" prefix="cre" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.procesa.com/fdcs" prefix="fdcs" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con3:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/perfilCliente" prefix="per" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1342865507756168585-7910ce22.16fa9b84915.-7f46</con2:id>
            <con1:case>
              <con1:condition>
                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$validationMessage = ''</con3:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1342865507756168585-7910ce22.16fa9b84915.-7f1c</con2:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/VisionPlus/visionPlus/biz/visionPlus" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>CustomerAddL8V2</con1:operation>
                  <con1:request>
                    <con1:body>$REQCustomerAddL8V2</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPCustomerAddL8V2</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQCustomerAddL8V2">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1342865507756168585-7910ce22.16fa9b84915.-7ee0</con2:id>
                      <con1:expr>
                        <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                          <con3:resource ref="Middleware/v3/Resources/CreacionClienteTarjetaCredito/xq/customerAddL8V2GTIn"/>
                          <con3:param name="codigoCliente">
                            <con3:path>$codigoCliente</con3:path>
                          </con3:param>
                          <con3:param name="creacionClienteTarjetaCredito1">
                            <con3:path>$body/cre:creacionClienteTarjetaCredito</con3:path>
                          </con3:param>
                          <con3:param name="consultaEquivalenciasCatalogos">
                            <con3:path>$RSPconsultaEquivalenciasCatalogos</con3:path>
                          </con3:param>
                        </con3:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                    <con1:validate>
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1342865507756168585-7910ce22.16fa9b84915.-7ebb</con2:id>
                      <con1:schema ref="Middleware/v2/BusinessServices/VisionPlus/visionPlus/xsd/XMLSchema_769155616"/>
                      <con1:schemaElement xmlns:fdcs="http://www.procesa.com/fdcs">fdcs:CustomerAddL8V2Request</con1:schemaElement>
                      <con1:varName>REQCustomerAddL8V2</con1:varName>
                    </con1:validate>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:assign varName="errorCode">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1342865507756168585-7910ce22.16fa9b84915.-7ea1</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">string($RSPCustomerAddL8V2/ServiceReturnCode/text())</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con1:assign varName="validationMessage">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1342865507756168585-7910ce22.16fa9b84915.-7e84</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">let $code := string($RSPCustomerAddL8V2/fdcs:ReturnCodes/RC[1]/Code/text())
return
if($errorCode != 'P' and $code != 'VPL5SNA24S') then(
 string($RSPCustomerAddL8V2/fdcs:ReturnCodes/RC[1]/Desc/text())
)else('')</con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="CreacionClienteTarjetaCredito_response" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Flujosalida">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/creacionClienteTarjetaCreditoTypes" prefix="cre" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1342865507756168585-7910ce22.16fa9b84915.-7e71</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$validationMessage = ''</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:replace contents-only="true" varName="header">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1342865507756168585-7910ce22.16fa9b84915.-7e45</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;aut:ResponseHeader>
	&lt;successIndicator>Success&lt;/successIndicator>
&lt;/aut:ResponseHeader></con2:xqueryText>
                  </con1:expr>
                </con1:replace>
                <con1:replace contents-only="true" varName="body">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1342865507756168585-7910ce22.16fa9b84915.-7e15</con2:id>
                  <con1:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">&lt;cre:creacionClienteTarjetaCreditoResponse>
	&lt;CUSTOMER_ID>{ $codigoCliente }&lt;/CUSTOMER_ID>
&lt;/cre:creacionClienteTarjetaCreditoResponse></con3:xqueryText>
                  </con1:expr>
                </con1:replace>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:replace contents-only="true" varName="header">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1342865507756168585-7910ce22.16fa9b84915.-7e2c</con2:id>
                <con1:expr>
                  <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<aut:ResponseHeader>
<successIndicator>{ $errorCode }</successIndicator>
<messages>{ $validationMessage }</messages>
</aut:ResponseHeader>]]></con2:xqueryText>
                </con1:expr>
              </con1:replace>
              <con1:replace contents-only="true" varName="body">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1342865507756168585-7910ce22.16fa9b84915.-7e05</con2:id>
                <con1:expr>
                  <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;cre:creacionClienteTarjetaCreditoResponse/></con2:xqueryText>
                </con1:expr>
              </con1:replace>
            </con1:default>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con1:pipeline type="error" name="_onErrorHandler-1342865507756168585-7910ce22.16fa9b84915.-7d67">
      <con1:stage name="ManejoError">
        <con1:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/creacionClienteTarjetaCreditoTypes" prefix="cre"/>
        </con1:context>
        <con1:actions>
          <con2:replace varName="header" contents-only="true">
            <con:id>_ActionId-1342865507756168585-7910ce22.16fa9b84915.-7d55</con:id>
            <con2:expr>
              <con:xqueryText><![CDATA[<aut:ResponseHeader>
	<successIndicator>{ string($fault/ctx:errorCode/text()) }</successIndicator>
	<messages>{ string($fault/ctx:reason/text()) }</messages>
</aut:ResponseHeader>]]></con:xqueryText>
            </con2:expr>
          </con2:replace>
          <con2:replace contents-only="true" varName="body">
            <con:id>_ActionId-1342865507756168585-7910ce22.16fa9b84915.-7d40</con:id>
            <con2:expr>
              <con:xqueryText>&lt;cre:creacionClienteTarjetaCreditoResponse/></con:xqueryText>
            </con2:expr>
          </con2:replace>
          <con:reply>
            <con:id>_ActionId-1342865507756168585-7910ce22.16fa9b84915.-7d30</con:id>
          </con:reply>
        </con1:actions>
      </con1:stage>
    </con1:pipeline>
    <con:flow xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:pipeline-node name="CreacionClienteTarjetaCredito">
        <con:request>CreacionClienteTarjetaCredito_request</con:request>
        <con:response>CreacionClienteTarjetaCredito_response</con:response>
      </con:pipeline-node>
    </con:flow>
  </ser:router>
</xml-fragment>