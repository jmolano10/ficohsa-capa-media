<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con3="http://www.bea.com/wli/sb/services/security/config">
  <ser:coreEntry isProxy="true" isEnabled="true" isAutoPublish="false" isTracingEnabled="false">
    <ser:security>
      <con3:custom-token-authentication>
        <con3:username-password>
          <con3:username-selector>
            <con3:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:RequestHeader/Authentication/UserName/text()</con3:xpath>
            <con3:variable>header</con3:variable>
          </con3:username-selector>
          <con3:password-selector>
            <con3:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:RequestHeader/Authentication/Password/text()</con3:xpath>
            <con3:variable>header</con3:variable>
          </con3:password-selector>
        </con3:username-password>
      </con3:custom-token-authentication>
    </ser:security>
    <ser:binding type="SOAP" isSoap12="false" xsi:type="con4:SoapBindingType" xmlns:con4="http://www.bea.com/wli/sb/services/bindings/config">
      <con4:wsdl ref="Middleware/v3/Resources/PagoRecaudo/wsdl/pagoRecaudoPS"/>
      <con4:port>
        <con4:name>pagoRecaudoPSSOAP</con4:name>
        <con4:namespace>http://www.ficohsa.com.hn/middleware.services/pagoRecaudo/</con4:namespace>
      </con4:port>
      <con4:selector type="SOAP body"/>
      <con4:WSI-compliant>false</con4:WSI-compliant>
    </ser:binding>
    <ser:monitoring isEnabled="false">
      <ser:aggregationInterval>10</ser:aggregationInterval>
      <ser:pipelineMonitoringLevel>Pipeline</ser:pipelineMonitoringLevel>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
    <ser:throttling enabled="false">
      <ser:capacity>0</ser:capacity>
      <ser:maxQueueLength>0</ser:maxQueueLength>
      <ser:timeToLive>0</ser:timeToLive>
    </ser:throttling>
    <ser:messageTracing enabled="false">
      <ser:detailsLevel>Terse</ser:detailsLevel>
      <ser:maxSize>8192</ser:maxSize>
    </ser:messageTracing>
  </ser:coreEntry>
  <ser:endpointConfig>
    <tran:provider-id>http</tran:provider-id>
    <tran:inbound>true</tran:inbound>
    <tran:URI>
      <env:value>/Middleware/OperationsAndExecution/Payments/PagoRecaudo_v3</env:value>
    </tran:URI>
    <tran:inbound-properties/>
    <tran:all-headers>false</tran:all-headers>
    <tran:provider-specific>
      <http:inbound-properties/>
    </tran:provider-specific>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-8848777042473091319--23eafd38.13c2a05c9f3.-6605">
    <con:pipeline type="error" name="_onErrorHandler-8848777042473091319--23eafd38.13c2a05c9f3.-6605">
      <con:stage name="ManejoError">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaFICOPENTypes" prefix="con"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
        </con:context>
        <con:actions>
          <con2:replace contents-only="true" varName="header">
            <con1:id>_ActionId-8848777042473091319--23eafd38.13c2a05c9f3.-65cb</con1:id>
            <con2:expr>
              <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{ concat(fn:string($fault/ctx:errorCode/text()), ": ", fn:string($fault/ctx:reason/text())) }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
            </con2:expr>
          </con2:replace>
          <con2:replace contents-only="true" varName="body">
            <con1:id>_ActionId-8848777042473091319--23eafd38.13c2a05c9f3.-65ca</con1:id>
            <con2:expr>
              <con1:xqueryText>&lt;pag:pagoRecaudoResponse/></con1:xqueryText>
            </con2:expr>
          </con2:replace>
          <con2:ifThenElse>
            <con1:comment>Condici칩n para guardar en bit치cora la respuesta del core. Esto depende del parametro T24C001.LOGENABLED de la tabla parametrizacion_middleware.</con1:comment>
            <con1:id>_ActionId-7708640245266169760-49b60068.145295445de.-7fcd</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$logEnabled = "TRUE"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:assign varName="errUuidBitacora">
                  <con1:id>_ActionId-7708640245266169760-49b60068.145295445de.-7f95</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="errTimeStamp">
                  <con1:id>_ActionId-7708640245266169760-49b60068.145295445de.-7f79</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/Business_Resources/general/TimeStamp/obtenerTimestamp"/>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:assign>
                <con2:wsCallout>
                  <con1:id>_ActionId-7708640245266169760-49b60068.145295445de.-7f56</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/recaudos/Resources/registrarRspRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>registrarRspRecaudo</con2:operation>
                  <con2:request>
                    <con2:body>$REQregRspRecaudoErr</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPregRspRecaudoErr</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQregRspRecaudoErr">
                      <con1:id>_ActionId-7708640245266169760-49b60068.145295445de.-7f39</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoRegistrarRsp"/>
                          <con1:param name="string3">
                            <con1:path>$reqUuidBitacora</con1:path>
                          </con1:param>
                          <con1:param name="responseHeader1">
                            <con1:path>$header/aut:ResponseHeader</con1:path>
                          </con1:param>
                          <con1:param name="string5">
                            <con1:path>$proxyTrace</con1:path>
                          </con1:param>
                          <con1:param name="string4">
                            <con1:path>$reqParams</con1:path>
                          </con1:param>
                          <con1:param name="pagoRecaudoResponse1">
                            <con1:path>$body/pag:pagoRecaudoResponse</con1:path>
                          </con1:param>
                          <con1:param name="string1">
                            <con1:path>$errUuidBitacora</con1:path>
                          </con1:param>
                          <con1:param name="string2">
                            <con1:path>$errTimeStamp</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform/>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
          <con1:reply>
            <con1:id>_ActionId-8848777042473091319--23eafd38.13c2a05c9f3.-65c9</con1:id>
          </con1:reply>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="ValidacionesGenerales_request">
      <con:stage name="ValidacionXSD">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
        </con:context>
        <con:actions>
          <con2:validate>
            <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-795c</con1:id>
            <con2:schema ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoTypes"/>
            <con2:schemaElement xmlns:pag="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes">pag:pagoRecaudo</con2:schemaElement>
            <con2:varName>body</con2:varName>
            <con2:location>
              <con1:xpathText>./pag:pagoRecaudo</con1:xpathText>
            </con2:location>
          </con2:validate>
        </con:actions>
      </con:stage>
      <con:stage name="ValidacionServicioRegional">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/ValidaServicioRegional" prefix="val"/>
        </con:context>
        <con:actions>
          <con2:wsCallout>
            <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7924</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ValidaServicioRegional/biz/ValidaServicioRegional_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>ValidaServicioRegional</con2:operation>
            <con2:request>
              <con2:body>$reqValidaServicioRegional</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>respValidaServicioRegional</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="reqValidaServicioRegional">
                <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-78ec</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v2/Resources/Generales/xq/validaServicioRegionalIn"/>
                    <con1:param name="requestHeader1">
                      <con1:path>$header/aut:RequestHeader</con1:path>
                    </con1:param>
                    <con1:param name="serviceId">
                      <con1:path>"FICBCO0067"</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:ifThenElse>
                <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-78b4</con1:id>
                <con2:case>
                  <con2:condition>
                    <con1:xqueryText>fn:string($respValidaServicioRegional/val:PV_CODIGO_ERROR/text()) != 'SUCCESS'</con1:xqueryText>
                  </con2:condition>
                  <con2:actions>
                    <con2:replace contents-only="true" varName="header">
                      <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-787c</con1:id>
                      <con2:expr>
                        <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{fn:string($respValidaServicioRegional/val:PV_MENSAJE_ERROR/text())}</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                      </con2:expr>
                    </con2:replace>
                    <con2:replace contents-only="true" varName="body">
                      <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-785f</con1:id>
                      <con2:expr>
                        <con1:xqueryText>&lt;pag:pagoRecaudoResponse/></con1:xqueryText>
                      </con2:expr>
                    </con2:replace>
                    <con1:reply>
                      <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-7842</con1:id>
                    </con1:reply>
                  </con2:actions>
                </con2:case>
                <con2:default>
                  <con2:replace contents-only="true" varName="header">
                    <con1:id>_ActionId-2430554070944225318--7d5d0aa9.14d9adee133.-780a</con1:id>
                    <con2:expr>
                      <con1:xqueryTransform>
                        <con1:resource ref="Middleware/v2/Resources/Generales/xq/aplicarValoresPorDefectoRegion"/>
                        <con1:param name="requestHeader">
                          <con1:path>$header/aut:RequestHeader</con1:path>
                        </con1:param>
                      </con1:xqueryTransform>
                    </con2:expr>
                  </con2:replace>
                  <con2:assign varName="areSameSourceAndDestination">
                    <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5981</con1:id>
                    <con2:expr>
                      <con1:xqueryTransform>
                        <con1:resource ref="Middleware/v2/Resources/Generales/xq/validarCrucePaisEmpresa"/>
                        <con1:param name="requestHeader">
                          <con1:path>$header/aut:RequestHeader</con1:path>
                        </con1:param>
                      </con1:xqueryTransform>
                    </con2:expr>
                  </con2:assign>
                </con2:default>
              </con2:ifThenElse>
            </con2:responseTransform>
          </con2:wsCallout>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="ValidacionesGenerales_response"/>
    <con:pipeline type="request" name="RegionalizacionPaisEmpresa_ConCruce_request">
      <con:stage name="OperacionEnOrigen_PagoRecaudo">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:Error>
            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5698</con1:id>
            <con2:errCode>MW-0008</con2:errCode>
            <con2:message>SERVICE NOT IMPLEMENTED YET FOR THIS COUNTRY/COMPANY</con2:message>
          </con2:Error>
          <con2:ifThenElse>
            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5697</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>(:HNBanco:)
fn:string($header/aut:RequestHeader/Region/SourceBank/text()) = 'HN01'</con1:xqueryText>
              </con2:condition>
              <con2:actions/>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="OperacionEnDestino_PagoRecaudo">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-5696</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>(:HNBanco:)
fn:string($header/aut:RequestHeader/Region/DestinationBank/text()) = 'HN01'</con1:xqueryText>
              </con2:condition>
              <con2:actions/>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="RegionalizacionPaisEmpresa_ConCruce_response"/>
    <con:pipeline type="request" name="Default_PagoRecaudo_request">
      <con:stage name="FlujoEntrada">
        <con:context/>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="Default_PagoRecaudo_response">
      <con:stage name="FlujoSalida">
        <con:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/emisionChequesGerenciaTypes" prefix="emis"/>
        </con:context>
        <con:actions>
          <con2:Error>
            <con1:id>_ActionId-2681369310853666711--5bcd27aa.14daf0d55d0.-53b1</con1:id>
            <con2:errCode>MW-0008</con2:errCode>
            <con2:message>SERVICE NOT IMPLEMENTED YET FOR THIS COUNTRY/COMPANY</con2:message>
          </con2:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="HNBanco_PagoRecaudo_request">
      <con:stage name="FlujoEntrada">
        <con:context>
          <con1:userNsDecl namespace="http://tempuri.org/" prefix="tns"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
          <con1:varNsDecl namespace="T24WebServicesImpl" prefix="t24"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/FLINK/OSB_CONSULTAR_OPER_RECAUDO/" prefix="osb"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/FLINK/INT_K_CONVENIOS_NO_ESTANDAR/INT_CV_REGISTRAR_INFO_OPER/" prefix="int"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaTasaCambioTypes" prefix="con"/>
          <con1:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb1"/>
        </con:context>
        <con:actions>
          <con2:assign varName="validationMessage">
            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dff</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoValidate"/>
                <con1:param name="pagoRecaudo">
                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                </con1:param>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="paymentMethod">
            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dfe</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($body/pag:pagoRecaudo/PAYMENT_INFORMATION/PAYMENT_METHOD/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="reqParams">
            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dfd</con1:id>
            <con2:expr>
              <con1:xqueryText>concat(
fn:string($header/aut:RequestHeader/Authentication/UserName/text()),"|",
fn:string($body/pag:pagoRecaudo/CONTRACT_ID/text()),"|",
fn:string($body/pag:pagoRecaudo/DEBTOR_CODE/text())
)</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:assign varName="proxyTrace">
            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dfc</con1:id>
            <con2:expr>
              <con1:xqueryText>"preObtieneParametrizacion"</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:wsCallout>
            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7df9</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>obtenerParametrizacion</con2:operation>
            <con2:request>
              <con2:body>$REQObtenerParam</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>RSPObtenerParam</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="REQObtenerParam">
                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dfb</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                    <con1:param name="nombreParametros">
                      <con1:path>"T24C001.LOGENABLED"</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con2:assign varName="statusParametrizacion">
                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dfa</con1:id>
                <con2:expr>
                  <con1:xqueryText>fn:string($RSPObtenerParam/osb1:ERROR_CODE/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:responseTransform>
          </con2:wsCallout>
          <con2:assign varName="logEnabled">
            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7df8</con1:id>
            <con2:expr>
              <con1:xqueryText>fn:string($RSPObtenerParam/osb1:CONFIGURACIONES/osb1:CONFIGURACIONES_ITEM[osb1:NAME="T24C001.LOGENABLED"]/osb1:VALUE/text())</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:ifThenElse>
            <con1:comment>Esta condici칩n es para determinar si se debe grabar en bit치cora o no. Esto depende del parametro T24C001.LOGENABLED de la tabla parametrizacion_middleware.</con1:comment>
            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7df7</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$statusParametrizacion = "SUCCESS" and
$logEnabled = "TRUE"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:assign varName="reqUuidBitacora">
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7df6</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="reqTimeStamp">
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7df5</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/Business_Resources/general/TimeStamp/obtenerTimestamp"/>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:assign>
                <con2:replace varName="proxyTrace">
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7df4</con1:id>
                  <con2:expr>
                    <con1:xqueryText>"preRegistrarReqBitacora"</con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:wsCallout>
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7df2</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/recaudos/Resources/registrarReqConsultaRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>registrarReqConsultaRecaudo</con2:operation>
                  <con2:request>
                    <con2:body>$REQregReqRecaudo</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPregReqRecaudo</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQregReqRecaudo">
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7df3</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoRegistrarReq"/>
                          <con1:param name="pagoRecaudo">
                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                          </con1:param>
                          <con1:param name="string1">
                            <con1:path>$reqUuidBitacora</con1:path>
                          </con1:param>
                          <con1:param name="string2">
                            <con1:path>$reqTimeStamp</con1:path>
                          </con1:param>
                          <con1:param name="requestHeader">
                            <con1:path>$header/aut:RequestHeader</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform/>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
          <con2:ifThenElse>
            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7df1</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage = ""</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace varName="proxyTrace">
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7df0</con1:id>
                  <con2:expr>
                    <con1:xqueryText>"preConsultaDetContrato"</con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:wsCallout>
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dec</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/contratosConvenios/Resources/ContratosConvenios" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>Consultadetallecontratorecaudo</con2:operation>
                  <con2:request>
                    <con2:body>$REQUESTConsultadetallecontratorecaudo</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RESPONSEConsultadetallecontratorecaudo</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQUESTConsultadetallecontratorecaudo">
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7def</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoConsultaContratoIn"/>
                          <con1:param name="pagoRecaudo">
                            <con1:path>$body/pag:pagoRecaudo</con1:path>
                          </con1:param>
                          <con1:param name="requestHeader">
                            <con1:path>$header/aut:RequestHeader</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform>
                    <con2:assign varName="type">
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dee</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($RESPONSEConsultadetallecontratorecaudo/WSCOLLECTIONCONDSType/gWSCOLLECTIONCONDSDetailType/mWSCOLLECTIONCONDSDetailType/INFOEXCHANGETYPE/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                    <con2:assign varName="contractName">
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7ded</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($RESPONSEConsultadetallecontratorecaudo/WSCOLLECTIONCONDSType[1]/gWSCOLLECTIONCONDSDetailType/mWSCOLLECTIONCONDSDetailType[1]/DESCRIPTION/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:responseTransform>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con1:skip>
                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7deb</con1:id>
              </con1:skip>
            </con2:default>
          </con2:ifThenElse>
          <con2:assign varName="uuid">
            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dea</con1:id>
            <con2:expr>
              <con1:xqueryTransform>
                <con1:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
              </con1:xqueryTransform>
            </con2:expr>
          </con2:assign>
          <con2:ifThenElse>
            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7de9</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$type = ""</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:assign varName="validationMessage">
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7de8</con1:id>
                  <con2:expr>
                    <con1:xqueryText>"ERROR LOOKING COLLECTION TYPE"</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con1:skip>
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7de7</con1:id>
                </con1:skip>
              </con2:actions>
            </con2:case>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$type = "LOCAL"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:ifThenElse>
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7de6</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$validationMessage = ""</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:replace varName="proxyTrace">
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7de5</con1:id>
                        <con2:expr>
                          <con1:xqueryText>"preObtieneDatosConsultaLocal"</con1:xqueryText>
                        </con2:expr>
                      </con2:replace>
                      <con2:wsCallout>
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7de0</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/recaudos/Resources/ConsultarRelacionOperacionRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>consultarRelacionOperacionRecaudo</con2:operation>
                        <con2:request>
                          <con2:body>$REQUESTconsultarRelacionOperacionRecaudo</con2:body>
                        </con2:request>
                        <con2:response>
                          <con2:body>RESPONSEconsultarRelacionOperacionRecaudo</con2:body>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQUESTconsultarRelacionOperacionRecaudo">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7de4</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoConsultaRelacionOperIn"/>
                                <con1:param name="pagoRecaudo">
                                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7de3</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>fn:string($RESPONSEconsultarRelacionOperacionRecaudo/osb:CODIGO_ERROR/text()) != "SUCCESS"</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:assign varName="validationMessage">
                                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7de2</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>fn:string($RESPONSEconsultarRelacionOperacionRecaudo/osb:MENSAJE_ERROR/text())</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                                <con1:skip>
                                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7de1</con1:id>
                                </con1:skip>
                              </con2:actions>
                            </con2:case>
                            <con2:default/>
                          </con2:ifThenElse>
                        </con2:responseTransform>
                      </con2:wsCallout>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con1:skip>
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7ddf</con1:id>
                    </con1:skip>
                  </con2:default>
                </con2:ifThenElse>
                <con2:assign varName="cantidadFacturas">
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dde</con1:id>
                  <con2:expr>
                    <con1:xqueryText>count($RESPONSEconsultarRelacionOperacionRecaudo/osb:CODIGO_FACTURA/osb:ITEM)</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:ifThenElse>
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7ddd</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>number($cantidadFacturas) > 1</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:assign varName="validationMessage">
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7ddc</con1:id>
                        <con2:expr>
                          <con1:xqueryText>"MULTI BILL PAYMENTS FOR LOCAL COLLECTIONS ARE NOT AVAILABLE"</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con1:skip>
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7ddb</con1:id>
                      </con1:skip>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con2:ifThenElse>
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dda</con1:id>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$validationMessage != ""</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con1:skip>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dd9</con1:id>
                          </con1:skip>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "CASH"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dd7</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineaefec</con2:operation>
                            <con2:request>
                              <con2:body>$REQUEST</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RESPONSE</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dd8</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoLocalEfectivoIn"/>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "ACCT_DEBIT"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:replace varName="proxyTrace">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dd6</con1:id>
                            <con2:expr>
                              <con1:xqueryText>"prePagoRecaudoLocalDbCta"</con1:xqueryText>
                            </con2:expr>
                          </con2:replace>
                          <con2:wsCallout>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dd4</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineadbcta</con2:operation>
                            <con2:request>
                              <con2:body>$REQUEST</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RESPONSE</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dd5</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoLocalDebitoCuentaIn"/>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "OWN_CHEQUE"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dd2</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineachqpr</con2:operation>
                            <con2:request>
                              <con2:body>$REQUEST</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RESPONSE</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dd3</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoLocalChequePropioIn"/>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "OTHER_BANK_CHEQUE"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dd0</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineachqob</con2:operation>
                            <con2:request>
                              <con2:body>$REQUEST</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RESPONSE</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dd1</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoLocalChequeOtroBancoIn"/>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "CREDIT_CARD"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:assign varName="validationMessage">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dcf</con1:id>
                            <con2:expr>
                              <con1:xqueryText>"NOT YET IMPLEMENTED"</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "INTL_CHQ_US"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dcd</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineachqin</con2:operation>
                            <con2:request>
                              <con2:body>$REQUEST</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RESPONSE</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dce</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoLocalChequeInternacionalUSIn"/>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "INTL_CHQ_NON_US"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:assign varName="validationMessage">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dcc</con1:id>
                            <con2:expr>
                              <con1:xqueryText>"NOT YET IMPLEMENTED"</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                        </con2:actions>
                      </con2:case>
                    </con2:ifThenElse>
                  </con2:default>
                </con2:ifThenElse>
              </con2:actions>
            </con2:case>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$type = "ONLINE"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:assign varName="isExtended">
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dcb</con1:id>
                  <con2:expr>
                    <con1:xqueryText>fn:string($body/pag:pagoRecaudo/EXTENDED_COLLECTION_YES_NO/text())</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:ifThenElse>
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dca</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$isExtended = "YES"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:replace varName="proxyTrace">
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dc9</con1:id>
                        <con2:expr>
                          <con1:xqueryText>"preRegOperNoEstandar"</con1:xqueryText>
                        </con2:expr>
                      </con2:replace>
                      <con2:wsCallout>
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dc3</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/recaudos/Resources/RegistrarOperacionConvenioNoEstandar_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>registrarOperacionConvenioNoEstandar</con2:operation>
                        <con2:request>
                          <con2:body>$REQUESTregistrarOperacionConvenioNoEstandar</con2:body>
                        </con2:request>
                        <con2:response>
                          <con2:body>RESPONSEregistrarOperacionConvenioNoEstandar</con2:body>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQUESTregistrarOperacionConvenioNoEstandar">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dc8</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoRegistrarOperConvenioNoEstandarIn"/>
                                <con1:param name="pagoRecaudo">
                                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                                </con1:param>
                                <con1:param name="requestHeader">
                                  <con1:path>$header/aut:RequestHeader</con1:path>
                                </con1:param>
                                <con1:param name="tipoOperacion">
                                  <con1:path>"2"</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform>
                          <con2:assign varName="successIndicatorRegistrarOperacionConvenioNoEstandar">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dc7</con1:id>
                            <con2:expr>
                              <con1:xqueryText>fn:string($RESPONSEregistrarOperacionConvenioNoEstandar/int:ERROR_CODE/text())</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dc6</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>upper-case($successIndicatorRegistrarOperacionConvenioNoEstandar) != "SUCCESS"</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:assign varName="validationMessage">
                                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dc5</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>fn:string($RESPONSEregistrarOperacionConvenioNoEstandar/int:ERROR_MESSAGE/text())</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                              </con2:actions>
                            </con2:case>
                            <con2:default>
                              <con2:assign varName="idSolicitud">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dc4</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>fn:string($RESPONSEregistrarOperacionConvenioNoEstandar/int:ID_SOLICITUD/text())</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                            </con2:default>
                          </con2:ifThenElse>
                        </con2:responseTransform>
                      </con2:wsCallout>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con2:assign varName="idSolicitud">
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dc2</con1:id>
                      <con2:expr>
                        <con1:xqueryText>fn:string($body/pag:pagoRecaudo/DEBTOR_CODE/text())</con1:xqueryText>
                      </con2:expr>
                    </con2:assign>
                  </con2:default>
                </con2:ifThenElse>
                <con2:ifThenElse>
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dc1</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$validationMessage = ""</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:replace varName="proxyTrace">
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dc0</con1:id>
                        <con2:expr>
                          <con1:xqueryText>"preObtieneDatosConsultaLinea"</con1:xqueryText>
                        </con2:expr>
                      </con2:replace>
                      <con2:wsCallout>
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dba</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/recaudos/Resources/ConsultarRelacionOperacionRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>consultarRelacionOperacionRecaudo</con2:operation>
                        <con2:request>
                          <con2:body>$REQUESTconsultarRelacionOperacionRecaudo</con2:body>
                        </con2:request>
                        <con2:response>
                          <con2:body>RESPONSEconsultarRelacionOperacionRecaudo</con2:body>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQUESTconsultarRelacionOperacionRecaudo">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dbf</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoConsultaRelacionOperIn"/>
                                <con1:param name="pagoRecaudo">
                                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform>
                          <con2:ifThenElse>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dbe</con1:id>
                            <con2:case>
                              <con2:condition>
                                <con1:xqueryText>fn:string($RESPONSEconsultarRelacionOperacionRecaudo/osb:CODIGO_ERROR/text()) != "SUCCESS"</con1:xqueryText>
                              </con2:condition>
                              <con2:actions>
                                <con2:assign varName="validationMessage">
                                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dbd</con1:id>
                                  <con2:expr>
                                    <con1:xqueryText>fn:string($RESPONSEconsultarRelacionOperacionRecaudo/osb:MENSAJE_ERROR/text())</con1:xqueryText>
                                  </con2:expr>
                                </con2:assign>
                                <con1:skip>
                                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dbc</con1:id>
                                </con1:skip>
                              </con2:actions>
                            </con2:case>
                            <con2:default>
                              <con2:replace varName="body" contents-only="true">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dbb</con1:id>
                                <con2:location>
                                  <con1:xpathText>./pag:pagoRecaudo/DEBTOR_CODE</con1:xpathText>
                                </con2:location>
                                <con2:expr>
                                  <con1:xqueryText>$idSolicitud</con1:xqueryText>
                                </con2:expr>
                              </con2:replace>
                            </con2:default>
                          </con2:ifThenElse>
                        </con2:responseTransform>
                      </con2:wsCallout>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con1:skip>
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7db9</con1:id>
                    </con1:skip>
                  </con2:default>
                </con2:ifThenElse>
                <con2:assign varName="cantidadFacturas">
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7db8</con1:id>
                  <con2:expr>
                    <con1:xqueryText>count($RESPONSEconsultarRelacionOperacionRecaudo/osb:CODIGO_FACTURA/osb:ITEM)</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
                <con2:ifThenElse>
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7db7</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>number($cantidadFacturas) > 1</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:assign varName="validationMessage">
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7db6</con1:id>
                        <con2:expr>
                          <con1:xqueryText>"MULTI BILL PAYMENTS FOR ONLINE COLLECTIONS ARE NOT AVAILABLE"</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con1:skip>
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7db5</con1:id>
                      </con1:skip>
                    </con2:actions>
                  </con2:case>
                  <con2:default>
                    <con2:ifThenElse>
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7db4</con1:id>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$validationMessage != ""</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con1:skip>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7db3</con1:id>
                          </con1:skip>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "CASH"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7db1</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineaefec</con2:operation>
                            <con2:request>
                              <con2:body>$REQUEST</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RESPONSE</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7db2</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoEnLineaEfectivoIn"/>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "ACCT_DEBIT"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:replace varName="proxyTrace">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7db0</con1:id>
                            <con2:expr>
                              <con1:xqueryText>"prePagoRecaudoLineaDbCta"</con1:xqueryText>
                            </con2:expr>
                          </con2:replace>
                          <con2:wsCallout>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dae</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineadbcta</con2:operation>
                            <con2:request>
                              <con2:body>$REQUEST</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RESPONSE</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7daf</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoEnLineaDebitoCuentaIn"/>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "OWN_CHEQUE"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dac</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineachqpr</con2:operation>
                            <con2:request>
                              <con2:body>$REQUEST</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RESPONSE</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dad</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoEnLineaChequePropioIn"/>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "OTHER_BANK_CHEQUE"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7daa</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineachqob</con2:operation>
                            <con2:request>
                              <con2:body>$REQUEST</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RESPONSE</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7dab</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoEnLineaChequeOtroBancoIn"/>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "CREDIT_CARD"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7da7</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/transaccionesAlcance/biz/transaccionesAlcance" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>registrarConsumo</con2:operation>
                            <con2:request>
                              <con2:body>$REQRegistraConsumo</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RSPRegistraConsumo</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQRegistraConsumo">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7da9</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoRegistroConsumoTC"/>
                                    <con1:param name="purchaseRefNumber">
                                      <con1:path>"1505000002"</con1:path>
                                    </con1:param>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="purchaseDescription">
                                      <con1:path>$contractName</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform>
                              <con2:assign varName="confAlcance">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7da8</con1:id>
                                <con2:expr>
                                  <con1:xqueryText>fn:string($RSPRegistraConsumo/tns:ConsumoNORResult/tns:estatusConfirmacion/text())</con1:xqueryText>
                                </con2:expr>
                              </con2:assign>
                            </con2:responseTransform>
                          </con2:wsCallout>
                          <con2:replace varName="proxyTrace">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7da6</con1:id>
                            <con2:expr>
                              <con1:xqueryText>"prePagoRecaudoLineaTC"</con1:xqueryText>
                            </con2:expr>
                          </con2:replace>
                          <con2:wsCallout>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7da4</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineatc</con2:operation>
                            <con2:request>
                              <con2:body>$REQUEST</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RESPONSE</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7da5</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoEnLineaDebitoCuentaIn"/>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "INTL_CHQ_US"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:wsCallout>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7da2</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Pagoderecaudolocalylineachqin</con2:operation>
                            <con2:request>
                              <con2:body>$REQUEST</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RESPONSE</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUEST">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7da3</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoEnLineaChequeInternacionalUSIn"/>
                                    <con1:param name="pagoRecaudo">
                                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="uuid">
                                      <con1:path>fn:string($uuid)</con1:path>
                                    </con1:param>
                                    <con1:param name="outputParameters">
                                      <con1:path>$RESPONSEconsultarRelacionOperacionRecaudo</con1:path>
                                    </con1:param>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform/>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>$paymentMethod = "INTL_CHQ_NON_US"</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:assign varName="validationMessage">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7da1</con1:id>
                            <con2:expr>
                              <con1:xqueryText>"NOT YET IMPLEMENTED"</con1:xqueryText>
                            </con2:expr>
                          </con2:assign>
                        </con2:actions>
                      </con2:case>
                    </con2:ifThenElse>
                  </con2:default>
                </con2:ifThenElse>
              </con2:actions>
            </con2:case>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$type = "REFERENCED"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:ifThenElse>
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7da0</con1:id>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$paymentMethod = "CASH"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:wsCallout>
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d9e</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>Pagoderecaudoreferenciadoefec</con2:operation>
                        <con2:request>
                          <con2:body>$REQUEST</con2:body>
                        </con2:request>
                        <con2:response>
                          <con2:body>RESPONSE</con2:body>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQUEST">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d9f</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoReferenciadoEfectivoIn"/>
                                <con1:param name="pagoRecaudo">
                                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                                </con1:param>
                                <con1:param name="uuid">
                                  <con1:path>fn:string($uuid)</con1:path>
                                </con1:param>
                                <con1:param name="requestHeader">
                                  <con1:path>$header/aut:RequestHeader</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform/>
                      </con2:wsCallout>
                    </con2:actions>
                  </con2:case>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$paymentMethod = "ACCT_DEBIT"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:replace varName="proxyTrace">
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d9d</con1:id>
                        <con2:expr>
                          <con1:xqueryText>"prePagoRecaudoRefDbCta"</con1:xqueryText>
                        </con2:expr>
                      </con2:replace>
                      <con2:wsCallout>
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d9b</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>Pagoderecaudoreferenciadodbcta</con2:operation>
                        <con2:request>
                          <con2:body>$REQUEST</con2:body>
                        </con2:request>
                        <con2:response>
                          <con2:body>RESPONSE</con2:body>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQUEST">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d9c</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoReferenciadoDebitoCuentaIn"/>
                                <con1:param name="pagoRecaudo">
                                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                                </con1:param>
                                <con1:param name="uuid">
                                  <con1:path>fn:string($uuid)</con1:path>
                                </con1:param>
                                <con1:param name="requestHeader">
                                  <con1:path>$header/aut:RequestHeader</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform/>
                      </con2:wsCallout>
                    </con2:actions>
                  </con2:case>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$paymentMethod = "OWN_CHEQUE"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:wsCallout>
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d99</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>Pagorecaudoreferenciadoficochq</con2:operation>
                        <con2:request>
                          <con2:body>$REQUEST</con2:body>
                        </con2:request>
                        <con2:response>
                          <con2:body>RESPONSE</con2:body>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQUEST">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d9a</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoReferenciadoChequePropioIn"/>
                                <con1:param name="pagoRecaudo">
                                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                                </con1:param>
                                <con1:param name="uuid">
                                  <con1:path>fn:string($uuid)</con1:path>
                                </con1:param>
                                <con1:param name="requestHeader">
                                  <con1:path>$header/aut:RequestHeader</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform/>
                      </con2:wsCallout>
                    </con2:actions>
                  </con2:case>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$paymentMethod = "OTHER_BANK_CHEQUE"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:wsCallout>
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d97</con1:id>
                        <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoRecaudos/Resources/PagoRecaudos" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>Pagorecaudoreferenciadochqotrbco</con2:operation>
                        <con2:request>
                          <con2:body>$REQUEST</con2:body>
                        </con2:request>
                        <con2:response>
                          <con2:body>RESPONSE</con2:body>
                        </con2:response>
                        <con2:requestTransform>
                          <con2:assign varName="REQUEST">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d98</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoReferenciadoChequeOtroBancoIn"/>
                                <con1:param name="pagoRecaudo">
                                  <con1:path>$body/pag:pagoRecaudo</con1:path>
                                </con1:param>
                                <con1:param name="uuid">
                                  <con1:path>fn:string($uuid)</con1:path>
                                </con1:param>
                                <con1:param name="requestHeader">
                                  <con1:path>$header/aut:RequestHeader</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:assign>
                        </con2:requestTransform>
                        <con2:responseTransform/>
                      </con2:wsCallout>
                    </con2:actions>
                  </con2:case>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$paymentMethod = "CREDIT_CARD"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:assign varName="validationMessage">
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d96</con1:id>
                        <con2:expr>
                          <con1:xqueryText>"NOT YET IMPLEMENTED"</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con1:skip>
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d95</con1:id>
                      </con1:skip>
                    </con2:actions>
                  </con2:case>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$paymentMethod = "INTL_CHQ_US"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:assign varName="validationMessage">
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d94</con1:id>
                        <con2:expr>
                          <con1:xqueryText>"NOT YET IMPLEMENTED"</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con1:skip>
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d93</con1:id>
                      </con1:skip>
                    </con2:actions>
                  </con2:case>
                  <con2:case>
                    <con2:condition>
                      <con1:xqueryText>$paymentMethod = "INTL_CHQ_NON_US"</con1:xqueryText>
                    </con2:condition>
                    <con2:actions>
                      <con2:assign varName="validationMessage">
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d92</con1:id>
                        <con2:expr>
                          <con1:xqueryText>"NOT YET IMPLEMENTED"</con1:xqueryText>
                        </con2:expr>
                      </con2:assign>
                      <con1:skip>
                        <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d91</con1:id>
                      </con1:skip>
                    </con2:actions>
                  </con2:case>
                </con2:ifThenElse>
                <con2:assign varName="validationMessage">
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d90</con1:id>
                  <con2:expr>
                    <con1:xqueryText>fn:string-join($RESPONSE/Status/messages/text(),'')</con1:xqueryText>
                  </con2:expr>
                </con2:assign>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con1:skip>
                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d8f</con1:id>
              </con1:skip>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="HNBanco_PagoRecaudo_response">
      <con:stage name="FlujoSalida">
        <con:context>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/FLINK/OSB_K_RECAUDOS_REF_ONLINE/OSB_ARMAR_MENSAJE/" prefix="osb"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:varNsDecl namespace="T24WebServicesImpl" prefix="t24"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:comment>Condicion para formar respuesta dependiendo de que el request ven칤a completo o no (REQUIRED FIELDS NOT SUPPLIED).</con1:comment>
            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d8e</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$validationMessage != ""</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace contents-only="true" varName="header">
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d8d</con1:id>
                  <con2:expr>
                    <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{ fn:string($validationMessage) }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                  </con2:expr>
                </con2:replace>
                <con2:replace contents-only="true" varName="body">
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d8c</con1:id>
                  <con2:expr>
                    <con1:xqueryText>&lt;pag:pagoRecaudoResponse/></con1:xqueryText>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:ifThenElse>
                <con1:comment>Condicion para formar respuesta dependiendo de si la respuesta del core fue exitosa o no</con1:comment>
                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d8b</con1:id>
                <con2:case>
                  <con2:condition>
                    <con1:xqueryText>fn:string($RESPONSE/Status/successIndicator/text()) = "Success"</con1:xqueryText>
                  </con2:condition>
                  <con2:actions>
                    <con2:replace varName="proxyTrace">
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d8a</con1:id>
                      <con2:expr>
                        <con1:xqueryText>"preRegistraRelPago"</con1:xqueryText>
                      </con2:expr>
                    </con2:replace>
                    <con2:wsCallout>
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d88</con1:id>
                      <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/recaudos/Resources/ActualizarEstadoRelacionOperacionRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                      <con2:operation>actualizarEstadoRelacionOperacionRecaudo</con2:operation>
                      <con2:request>
                        <con2:body>$REQUESTactualizarEstadoRelacionOperacionRecaudo</con2:body>
                      </con2:request>
                      <con2:response>
                        <con2:body>RESPONSEactualizarEstadoRelacionOperacionRecaudo</con2:body>
                      </con2:response>
                      <con2:requestTransform>
                        <con2:assign varName="REQUESTactualizarEstadoRelacionOperacionRecaudo">
                          <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d89</con1:id>
                          <con2:expr>
                            <con1:xqueryTransform>
                              <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoActualizarEstadoRelacionOperRecaudoIn"/>
                              <con1:param name="codigoDeudor">
                                <con1:path>fn:string($body/pag:pagoRecaudo/DEBTOR_CODE/text())</con1:path>
                              </con1:param>
                              <con1:param name="codigoContrato">
                                <con1:path>fn:string($body/pag:pagoRecaudo/CONTRACT_ID/text())</con1:path>
                              </con1:param>
                              <con1:param name="estadoNuevo">
                                <con1:path>"2"</con1:path>
                              </con1:param>
                              <con1:param name="estadoAnterior">
                                <con1:path>"1"</con1:path>
                              </con1:param>
                              <con1:param name="codigoFactura">
                                <con1:path>fn:string($body/pag:pagoRecaudo/BILL_INFORMATION/BILL_NUMBER/text())</con1:path>
                              </con1:param>
                            </con1:xqueryTransform>
                          </con2:expr>
                        </con2:assign>
                      </con2:requestTransform>
                      <con2:responseTransform/>
                    </con2:wsCallout>
                    <con2:replace varName="proxyTrace">
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d87</con1:id>
                      <con2:expr>
                        <con1:xqueryText>"preConsultaUsuario"</con1:xqueryText>
                      </con2:expr>
                    </con2:replace>
                    <con2:wsCallout>
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d82</con1:id>
                      <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/Core/Resources/CoreBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                      <con2:operation>Consultadeusuariosdelsistema</con2:operation>
                      <con2:request>
                        <con2:body>$REQUESTConsultadeusuariosdelsistema</con2:body>
                      </con2:request>
                      <con2:response>
                        <con2:body>RESPONSEConsultadeusuariosdelsistema</con2:body>
                      </con2:response>
                      <con2:requestTransform>
                        <con2:ifThenElse>
                          <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d86</con1:id>
                          <con2:case>
                            <con2:condition>
                              <con1:xqueryText>count($RESPONSE/TELLERType) > 0</con1:xqueryText>
                            </con2:condition>
                            <con2:actions>
                              <con2:assign varName="REQUESTConsultadeusuariosdelsistema">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d85</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoConsultaUsuarioTellerIn"/>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                    <con1:param name="tELLERType">
                                      <con1:path>$RESPONSE/TELLERType</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:actions>
                          </con2:case>
                          <con2:default>
                            <con2:assign varName="REQUESTConsultadeusuariosdelsistema">
                              <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d84</con1:id>
                              <con2:expr>
                                <con1:xqueryTransform>
                                  <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoConsultaUsuarioTransferIn"/>
                                  <con1:param name="requestHeader">
                                    <con1:path>$header/aut:RequestHeader</con1:path>
                                  </con1:param>
                                  <con1:param name="fUNDSTRANSFERType">
                                    <con1:path>$RESPONSE/FUNDSTRANSFERType</con1:path>
                                  </con1:param>
                                </con1:xqueryTransform>
                              </con2:expr>
                            </con2:assign>
                            <con2:assign varName="cuentaTemp">
                              <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d83</con1:id>
                              <con2:expr>
                                <con1:xqueryText>fn:string($RESPONSE/FUNDSTRANSFERType/DEBITACCTNO/text())</con1:xqueryText>
                              </con2:expr>
                            </con2:assign>
                          </con2:default>
                        </con2:ifThenElse>
                      </con2:requestTransform>
                      <con2:responseTransform>
                        <con2:assign varName="branchName">
                          <con1:id>_ActionId-7672529145385635607-1a772dc3.151b25149df.-7f2f</con1:id>
                          <con2:expr>
                            <con1:xqueryText>fn:string($RESPONSEConsultadeusuariosdelsistema/WSUSERType/gWSUSERDetailType/mWSUSERDetailType[1]/BRANCHNAME/text())</con1:xqueryText>
                          </con2:expr>
                        </con2:assign>
                      </con2:responseTransform>
                    </con2:wsCallout>
                    <con2:ifThenElse>
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d81</con1:id>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>fn:string($cuentaTemp) != ""</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:replace varName="proxyTrace">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d80</con1:id>
                            <con2:expr>
                              <con1:xqueryText>"preConsultaDetalleCuenta"</con1:xqueryText>
                            </con2:expr>
                          </con2:replace>
                          <con2:wsCallout>
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d7d</con1:id>
                            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/ConsultasCuenta/Resources/consultaCuentasBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                            <con2:operation>Consultadedetallesdelacuenta</con2:operation>
                            <con2:request>
                              <con2:body>$REQUESTConsultadedetallesdelacuenta</con2:body>
                            </con2:request>
                            <con2:response>
                              <con2:body>RESPONSEConsultadedetallesdelacuenta</con2:body>
                            </con2:response>
                            <con2:requestTransform>
                              <con2:assign varName="REQUESTConsultadedetallesdelacuenta">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d7f</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoConsultaDetalleCuentaIn"/>
                                    <con1:param name="requestHeader">
                                      <con1:path>$header/aut:RequestHeader</con1:path>
                                    </con1:param>
                                    <con1:param name="cuentaTemp">
                                      <con1:path>fn:string($cuentaTemp)</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:requestTransform>
                            <con2:responseTransform>
                              <con2:assign varName="cuenta">
                                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d7e</con1:id>
                                <con2:expr>
                                  <con1:xqueryTransform>
                                    <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoConsultaDetalleCuentaOut"/>
                                    <con1:param name="consultadedetallesdelacuentaResponse">
                                      <con1:path>$RESPONSEConsultadedetallesdelacuenta</con1:path>
                                    </con1:param>
                                  </con1:xqueryTransform>
                                </con2:expr>
                              </con2:assign>
                            </con2:responseTransform>
                          </con2:wsCallout>
                        </con2:actions>
                      </con2:case>
                      <con2:default>
                        <con2:assign varName="cuenta">
                          <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d7c</con1:id>
                          <con2:expr>
                            <con1:xqueryText>""</con1:xqueryText>
                          </con2:expr>
                        </con2:assign>
                      </con2:default>
                    </con2:ifThenElse>
                    <con2:ifThenElse>
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d7b</con1:id>
                      <con2:case>
                        <con2:condition>
                          <con1:xqueryText>count($RESPONSE/TELLERType) > 0</con1:xqueryText>
                        </con2:condition>
                        <con2:actions>
                          <con2:replace varName="header" contents-only="true">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d7a</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoTellerHeaderOut"/>
                                <con1:param name="status">
                                  <con1:path>$RESPONSE/Status</con1:path>
                                </con1:param>
                                <con1:param name="tELLERType">
                                  <con1:path>$RESPONSE/TELLERType</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:replace>
                          <con2:replace contents-only="true" varName="body">
                            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d79</con1:id>
                            <con2:expr>
                              <con1:xqueryTransform>
                                <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoTellerOut"/>
                                <con1:param name="consultadeusuariosdelsistemaResponse">
                                  <con1:path>$RESPONSEConsultadeusuariosdelsistema</con1:path>
                                </con1:param>
                                <con1:param name="tELLERType">
                                  <con1:path>$RESPONSE/TELLERType</con1:path>
                                </con1:param>
                                <con1:param name="consultadetallecontratorecaudoResponse">
                                  <con1:path>$RESPONSEConsultadetallecontratorecaudo</con1:path>
                                </con1:param>
                              </con1:xqueryTransform>
                            </con2:expr>
                          </con2:replace>
                        </con2:actions>
                      </con2:case>
                      <con2:default>
                        <con2:replace contents-only="true" varName="header">
                          <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d78</con1:id>
                          <con2:expr>
                            <con1:xqueryTransform>
                              <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoTransferHeaderOut"/>
                              <con1:param name="fUNDSTRANSFERType">
                                <con1:path>$RESPONSE/FUNDSTRANSFERType</con1:path>
                              </con1:param>
                              <con1:param name="status">
                                <con1:path>$RESPONSE/Status</con1:path>
                              </con1:param>
                            </con1:xqueryTransform>
                          </con2:expr>
                        </con2:replace>
                        <con2:replace varName="body" contents-only="true">
                          <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d77</con1:id>
                          <con2:expr>
                            <con1:xqueryTransform>
                              <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoTransferOut"/>
                              <con1:param name="consultadetallecontratorecaudoResponse">
                                <con1:path>$RESPONSEConsultadetallecontratorecaudo</con1:path>
                              </con1:param>
                              <con1:param name="cuenta">
                                <con1:path>fn:string($cuenta)</con1:path>
                              </con1:param>
                              <con1:param name="fUNDSTRANSFERType">
                                <con1:path>$RESPONSE/FUNDSTRANSFERType</con1:path>
                              </con1:param>
                              <con1:param name="branchName">
                                <con1:path>$branchName</con1:path>
                              </con1:param>
                            </con1:xqueryTransform>
                          </con2:expr>
                        </con2:replace>
                      </con2:default>
                    </con2:ifThenElse>
                  </con2:actions>
                </con2:case>
                <con2:default>
                  <con2:replace contents-only="true" varName="header">
                    <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d76</con1:id>
                    <con2:expr>
                      <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>{ fn:string($RESPONSE/Status/successIndicator/text()) }</successIndicator>
      <messages>{ fn:string-join($RESPONSE/Status/messages/text()," ") }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                    </con2:expr>
                  </con2:replace>
                  <con2:replace contents-only="true" varName="body">
                    <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d75</con1:id>
                    <con2:expr>
                      <con1:xqueryText>&lt;pag:pagoRecaudoResponse/></con1:xqueryText>
                    </con2:expr>
                  </con2:replace>
                </con2:default>
              </con2:ifThenElse>
            </con2:default>
          </con2:ifThenElse>
          <con2:ifThenElse>
            <con1:comment>Condici칩n para guardar en bit치cora la respuesta del core. Esto depende del parametro T24C001.LOGENABLED de la tabla parametrizacion_middleware.</con1:comment>
            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d74</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>$logEnabled = "TRUE"</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:assign varName="rspUuidBitacora">
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d73</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:assign>
                <con2:assign varName="rspTimeStamp">
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d72</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/Business_Resources/general/TimeStamp/obtenerTimestamp"/>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:assign>
                <con2:wsCallout>
                  <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d70</con1:id>
                  <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/recaudos/Resources/registrarRspRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con2:operation>registrarRspRecaudo</con2:operation>
                  <con2:request>
                    <con2:body>$REQregRspRecaudo</con2:body>
                  </con2:request>
                  <con2:response>
                    <con2:body>RSPregRspRecaudo</con2:body>
                  </con2:response>
                  <con2:requestTransform>
                    <con2:assign varName="REQregRspRecaudo">
                      <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7d71</con1:id>
                      <con2:expr>
                        <con1:xqueryTransform>
                          <con1:resource ref="Middleware/Business_Resources/pagoRecaudos/PagoRecaudo/pagoRecaudoRegistrarRsp"/>
                          <con1:param name="string3">
                            <con1:path>$reqUuidBitacora</con1:path>
                          </con1:param>
                          <con1:param name="responseHeader1">
                            <con1:path>$header/aut:ResponseHeader</con1:path>
                          </con1:param>
                          <con1:param name="string5">
                            <con1:path>$proxyTrace</con1:path>
                          </con1:param>
                          <con1:param name="string4">
                            <con1:path>$reqParams</con1:path>
                          </con1:param>
                          <con1:param name="pagoRecaudoResponse1">
                            <con1:path>$body/pag:pagoRecaudoResponse</con1:path>
                          </con1:param>
                          <con1:param name="string1">
                            <con1:path>$rspUuidBitacora</con1:path>
                          </con1:param>
                          <con1:param name="string2">
                            <con1:path>$rspTimeStamp</con1:path>
                          </con1:param>
                        </con1:xqueryTransform>
                      </con2:expr>
                    </con2:assign>
                  </con2:requestTransform>
                  <con2:responseTransform/>
                </con2:wsCallout>
              </con2:actions>
            </con2:case>
            <con2:default/>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="GTBanco_PagoRecaudo_request">
      <con:stage name="FlujoEntrada">
        <con:context>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/PagoRecaudo" prefix="pgr"/>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/ObtenerInfomacionConvenio" prefix="ns0"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
        </con:context>
        <con:actions>
          <con1:wsCallout xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-6884045808838587795-4efc118f.157fd2912e3.-77a1</con5:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v3/BusinessServices/MDW/obtenerInformacionConvenio/biz/ObtenerInfomacionConvenio_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>ObtenerInfomacionConvenio</con1:operation>
            <con1:request>
              <con1:body>$REQObtenerInfomacionConvenio</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>RSPObtenerInfomacionConvenio</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="REQObtenerInfomacionConvenio">
                <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-6884045808838587795-4efc118f.157fd2912e3.-77a9</con5:id>
                <con1:expr>
                  <con5:xqueryTransform xmlns:con5="http://www.bea.com/wli/sb/stages/config">
                    <con5:resource ref="Middleware/v3/Resources/ConsultaRecaudo/xq/obtenerInformacionConvenioIN"/>
                    <con5:param name="codPais">
                      <con5:path>fn:string($header/aut:RequestHeader/Region/SourceBank/text())</con5:path>
                    </con5:param>
                    <con5:param name="codContrato">
                      <con5:path>fn:string($body/pag:pagoRecaudo/CONTRACT_ID/text())</con5:path>
                    </con5:param>
                  </con5:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con1:requestTransform>
            <con1:responseTransform>
              <con1:ifThenElse>
                <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-6884045808838587795-4efc118f.157fd2912e3.-7769</con5:id>
                <con1:case>
                  <con1:condition>
                    <con5:xqueryText xmlns:con5="http://www.bea.com/wli/sb/stages/config">fn:upper-case($RSPObtenerInfomacionConvenio/ns0:PV_ERRORCODE/text()) = "SUCCESS"</con5:xqueryText>
                  </con1:condition>
                  <con1:actions>
                    <con1:assign varName="codContrato">
                      <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-6884045808838587795-4efc118f.157fd2912e3.-7633</con5:id>
                      <con1:expr>
                        <con5:xqueryText xmlns:con5="http://www.bea.com/wli/sb/stages/config">$RSPObtenerInfomacionConvenio/ns0:PV_CODIGOSERVICIO/text()</con5:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:actions>
                </con1:case>
                <con1:default>
                  <con3:wsCallout xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config">
                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-6884045808838587795-4efc118f.157fd2912e3.-766b</con6:id>
                    <con3:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                    <con3:operation>mapeoErrores</con3:operation>
                    <con3:request>
                      <con3:body>$reqMapeoErrores</con3:body>
                    </con3:request>
                    <con3:response>
                      <con3:body>respMapeoErrores</con3:body>
                    </con3:response>
                    <con3:requestTransform>
                      <con3:assign varName="reqMapeoErrores">
                        <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-6884045808838587795-4efc118f.157fd2912e3.-766d</con6:id>
                        <con3:expr>
                          <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                            <con6:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                            <con6:param name="MENSAJE_ERROR">
                              <con6:path>fn:upper-case($RSPObtenerInfomacionConvenio/ns0:PV_MESSAGE/text())</con6:path>
                            </con6:param>
                            <con6:param name="CODIGO_ERROR">
                              <con6:path>fn:upper-case($RSPObtenerInfomacionConvenio/ns0:PV_ERRORCODE/text())</con6:path>
                            </con6:param>
                          </con6:xqueryTransform>
                        </con3:expr>
                      </con3:assign>
                    </con3:requestTransform>
                    <con3:responseTransform>
                      <con3:replace contents-only="true" varName="header">
                        <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-6884045808838587795-4efc118f.157fd2912e3.-766c</con6:id>
                        <con3:expr>
                          <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                            <con6:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                            <con6:param name="mapeoErroresResponse1">
                              <con6:path>$respMapeoErrores</con6:path>
                            </con6:param>
                            <con6:param name="successIndicator">
                              <con6:path>fn:concat("FICBCO0010","$#$",fn:string-join(fn:upper-case($RSPObtenerInfomacionConvenio/ns0:PV_ERRORCODE/text()), '||'))</con6:path>
                            </con6:param>
                          </con6:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:responseTransform>
                  </con3:wsCallout>
                  <con3:replace varName="body" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config">
                    <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-6884045808838587795-4efc118f.157fd2912e3.-7631</con5:id>
                    <con3:expr>
                      <con5:xqueryText xmlns:con5="http://www.bea.com/wli/sb/stages/config">&lt;pag:pagoRecaudoResponse/></con5:xqueryText>
                    </con3:expr>
                  </con3:replace>
                  <con5:reply xmlns:con5="http://www.bea.com/wli/sb/stages/config">
                    <con5:id>_ActionId-6884045808838587795-4efc118f.157fd2912e3.-762f</con5:id>
                  </con5:reply>
                </con1:default>
              </con1:ifThenElse>
            </con1:responseTransform>
          </con1:wsCallout>
          <con2:wsCallout>
            <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7cb1</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v3/BusinessServices/ABKGT/PagoRecaudo/biz/PagoRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>PagoRecaudo</con2:operation>
            <con2:request>
              <con2:body>$REQPagoRecaudo</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>RSPPagoRecaudo</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="REQPagoRecaudo">
                <con1:id>_ActionId-751993108107673932--127f999d.1500641f93b.-7bf7</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoGTIn"/>
                    <con1:param name="usuarioCanal">
                      <con1:path>fn:string($header/aut:RequestHeader/Authentication/UserName)</con1:path>
                    </con1:param>
                    <con1:param name="pagoRecaudo1">
                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                    </con1:param>
                    <con1:param name="Contrato">
                      <con1:path>$codContrato</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform>
              <con1:ifThenElse xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-3994051797024279398-2310af48.15806c29065.-7f7f</con5:id>
                <con1:case>
                  <con1:condition>
                    <con5:xqueryText xmlns:con5="http://www.bea.com/wli/sb/stages/config">fn:upper-case($RSPPagoRecaudo/pgr:PV_SUCCESSINDICATOR/text()) = "SUCCESS"</con5:xqueryText>
                  </con1:condition>
                  <con1:actions>
                    <con1:assign varName="codContrato">
                      <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-3994051797024279398-2310af48.15806c29065.-7f7e</con5:id>
                      <con1:expr>
                        <con5:xqueryText xmlns:con5="http://www.bea.com/wli/sb/stages/config">$RSPObtenerInfomacionConvenio/ns0:PV_CODIGOSERVICIO/text()</con5:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:actions>
                </con1:case>
                <con1:default>
                  <con3:wsCallout xmlns:con5="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config">
                    <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-3994051797024279398-2310af48.15806c29065.-7f7b</con6:id>
                    <con3:service xsi:type="ref:ProxyRef" ref="Middleware/v2/ProxyServices/MapeoErrores" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                    <con3:operation>mapeoErrores</con3:operation>
                    <con3:request>
                      <con3:body>$reqMapeoErrores</con3:body>
                    </con3:request>
                    <con3:response>
                      <con3:body>respMapeoErrores</con3:body>
                    </con3:response>
                    <con3:requestTransform>
                      <con3:assign varName="reqMapeoErrores">
                        <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-3994051797024279398-2310af48.15806c29065.-7f7d</con6:id>
                        <con3:expr>
                          <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                            <con6:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageIn"/>
                            <con6:param name="MENSAJE_ERROR">
                              <con6:path>fn:upper-case($RSPPagoRecaudo/pgr:PV_MESSAGES/text())</con6:path>
                            </con6:param>
                            <con6:param name="CODIGO_ERROR">
                              <con6:path>fn:upper-case($RSPPagoRecaudo/pgr:PV_SUCCESSINDICATOR/text())</con6:path>
                            </con6:param>
                          </con6:xqueryTransform>
                        </con3:expr>
                      </con3:assign>
                    </con3:requestTransform>
                    <con3:responseTransform>
                      <con3:replace contents-only="true" varName="header">
                        <con6:id xmlns:con6="http://www.bea.com/wli/sb/stages/config">_ActionId-3994051797024279398-2310af48.15806c29065.-7f7c</con6:id>
                        <con3:expr>
                          <con6:xqueryTransform xmlns:con6="http://www.bea.com/wli/sb/stages/config">
                            <con6:resource ref="Middleware/v2/Resources/MapeoErrores/xq/mapeoErroresUsageOut"/>
                            <con6:param name="mapeoErroresResponse1">
                              <con6:path>$respMapeoErrores</con6:path>
                            </con6:param>
                            <con6:param name="successIndicator">
                              <con6:path>fn:concat("FICBCO0010","$#$",fn:string-join(fn:upper-case($RSPPagoRecaudo/pgr:PV_SUCCESSINDICATOR/text()), '||'))</con6:path>
                            </con6:param>
                          </con6:xqueryTransform>
                        </con3:expr>
                      </con3:replace>
                    </con3:responseTransform>
                  </con3:wsCallout>
                  <con3:replace varName="body" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config">
                    <con5:id xmlns:con5="http://www.bea.com/wli/sb/stages/config">_ActionId-3994051797024279398-2310af48.15806c29065.-7f7a</con5:id>
                    <con3:expr>
                      <con5:xqueryText xmlns:con5="http://www.bea.com/wli/sb/stages/config">&lt;pag:pagoRecaudoResponse/></con5:xqueryText>
                    </con3:expr>
                  </con3:replace>
                  <con5:reply xmlns:con5="http://www.bea.com/wli/sb/stages/config">
                    <con5:id>_ActionId-3994051797024279398-2310af48.15806c29065.-7f79</con5:id>
                  </con5:reply>
                </con1:default>
              </con1:ifThenElse>
              <con2:assign varName="successIndPagoRecaudo">
                <con1:id>_ActionId-4083939321493571957--47904af6.15014def613.-7fc9</con1:id>
                <con2:expr>
                  <con1:xqueryText>data($RSPPagoRecaudo/pgr:PV_SUCCESSINDICATOR/text())</con1:xqueryText>
                </con2:expr>
              </con2:assign>
            </con2:responseTransform>
          </con2:wsCallout>
          <con2:assign varName="paymentMethod">
            <con1:id>_ActionId-2330040238039588501-7a2e3c95.1501a67091e.-7ed3</con1:id>
            <con2:expr>
              <con1:xqueryText>data($body/pag:pagoRecaudo/PAYMENT_INFORMATION/PAYMENT_METHOD)</con1:xqueryText>
            </con2:expr>
          </con2:assign>
          <con2:wsCallout>
            <con1:id>_ActionId-7554178350208762933-d0abe6f.15020b65696.-7f49</con1:id>
            <con2:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v3/BusinessServices/ABKGT/ConsultarRelacionOpRecaudo/biz/consultarRelacionOperacionRecaudo_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con2:operation>consultarRelacionOperacionRecaudo</con2:operation>
            <con2:request>
              <con2:body>$REQRelConPagoRecaudo</con2:body>
            </con2:request>
            <con2:response>
              <con2:body>RSPRelConPagoRecaudo</con2:body>
            </con2:response>
            <con2:requestTransform>
              <con2:assign varName="REQRelConPagoRecaudo">
                <con1:id>_ActionId-7554178350208762933-d0abe6f.15020b65696.-7f11</con1:id>
                <con2:expr>
                  <con1:xqueryTransform>
                    <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoGTConsRelaPagIn"/>
                    <con1:param name="factura">
                      <con1:path>"1"</con1:path>
                    </con1:param>
                    <con1:param name="pagoRecaudo1">
                      <con1:path>$body/pag:pagoRecaudo</con1:path>
                    </con1:param>
                  </con1:xqueryTransform>
                </con2:expr>
              </con2:assign>
            </con2:requestTransform>
            <con2:responseTransform/>
          </con2:wsCallout>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="GTBanco_PagoRecaudo_response">
      <con:stage name="FlujoSalida">
        <con:context>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con1:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoRecaudoTypes" prefix="pag"/>
          <con1:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/PagoRecaudo" prefix="pgr"/>
        </con:context>
        <con:actions>
          <con2:ifThenElse>
            <con1:id>_ActionId-4083939321493571957--47904af6.15014def613.-7dda</con1:id>
            <con2:case>
              <con2:condition>
                <con1:xqueryText>fn:upper-case($successIndPagoRecaudo) = 'SUCCESS'</con1:xqueryText>
              </con2:condition>
              <con2:actions>
                <con2:replace contents-only="true" varName="body">
                  <con1:id>_ActionId-4083939321493571957--47904af6.15014def613.-7cf8</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudosGTOut"/>
                      <con1:param name="PaymentMethod">
                        <con1:path>$paymentMethod</con1:path>
                      </con1:param>
                      <con1:param name="outputParameters1">
                        <con1:path>$RSPPagoRecaudo</con1:path>
                      </con1:param>
                      <con1:param name="outputParameters2">
                        <con1:path>$RSPRelConPagoRecaudo</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
                <con2:replace varName="header" contents-only="true">
                  <con1:id>_ActionId-4083939321493571957--47904af6.15014def613.-7da2</con1:id>
                  <con2:expr>
                    <con1:xqueryTransform>
                      <con1:resource ref="Middleware/v3/Resources/PagoRecaudo/xq/pagoRecaudoGTHeaderOut"/>
                      <con1:param name="outputParameters1">
                        <con1:path>$RSPPagoRecaudo</con1:path>
                      </con1:param>
                    </con1:xqueryTransform>
                  </con2:expr>
                </con2:replace>
              </con2:actions>
            </con2:case>
            <con2:default>
              <con2:replace varName="body" contents-only="true">
                <con1:id>_ActionId-4083939321493571957--47904af6.15014def613.-7c88</con1:id>
                <con2:expr>
                  <con1:xqueryText>&lt;pag:pagoRecaudoResponse/></con1:xqueryText>
                </con2:expr>
              </con2:replace>
              <con2:replace varName="header" contents-only="true">
                <con1:id>_ActionId-4083939321493571957--47904af6.15014def613.-7cc0</con1:id>
                <con2:expr>
                  <con1:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>{ $successIndPagoRecaudo }</successIndicator>
      <messages>{ fn:string($RSPPagoRecaudo/pgr:PV_MESSAGES/text()) }</messages>
</aut:ResponseHeader>]]></con1:xqueryText>
                </con2:expr>
              </con2:replace>
            </con2:default>
          </con2:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:flow>
      <con:pipeline-node name="ValidacionesGenerales">
        <con:request>ValidacionesGenerales_request</con:request>
        <con:response>ValidacionesGenerales_response</con:response>
      </con:pipeline-node>
      <con:branch-node type="condition" name="ValidacionCrucePaisEmpresa">
        <con:context/>
        <con:branch-table variable="areSameSourceAndDestination">
          <con:branch name="SameOriginAndDestination">
            <con:operator>equals</con:operator>
            <con:value>'YES'</con:value>
            <con:flow>
              <con:branch-node type="condition" name="RegionalizacionPaisEmpresa">
                <con:context>
                  <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
                </con:context>
                <con:branch-table variable="header">
                  <con:xpath>
                    <con1:xpathText>./aut:RequestHeader/Region/SourceBank</con1:xpathText>
                  </con:xpath>
                  <con:branch name="HNBanco">
                    <con:operator>equals</con:operator>
                    <con:value>'HN01'</con:value>
                    <con:flow>
                      <con:pipeline-node name="HNBanco_PagoRecaudo">
                        <con:request>HNBanco_PagoRecaudo_request</con:request>
                        <con:response>HNBanco_PagoRecaudo_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:branch name="GTBanco">
                    <con:operator>equals</con:operator>
                    <con:value>'GT01'</con:value>
                    <con:flow>
                      <con:pipeline-node name="GTBanco_PagoRecaudo">
                        <con:request>GTBanco_PagoRecaudo_request</con:request>
                        <con:response>GTBanco_PagoRecaudo_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:branch>
                  <con:default-branch>
                    <con:flow>
                      <con:pipeline-node name="Default_PagoRecaudo">
                        <con:request>Default_PagoRecaudo_request</con:request>
                        <con:response>Default_PagoRecaudo_response</con:response>
                      </con:pipeline-node>
                    </con:flow>
                  </con:default-branch>
                </con:branch-table>
              </con:branch-node>
            </con:flow>
          </con:branch>
          <con:default-branch>
            <con:flow>
              <con:pipeline-node name="RegionalizacionPaisEmpresa_ConCruce">
                <con:request>RegionalizacionPaisEmpresa_ConCruce_request</con:request>
                <con:response>RegionalizacionPaisEmpresa_ConCruce_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:default-branch>
        </con:branch-table>
      </con:branch-node>
    </con:flow>
  </ser:router>
</xml-fragment>