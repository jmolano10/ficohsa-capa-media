<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment xmlns:ser="http://www.bea.com/wli/sb/services" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:con="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con2="http://www.bea.com/wli/sb/services/security/config" xmlns:con3="http://www.bea.com/wli/sb/pipeline/config">
  <ser:coreEntry isProxy="true" isEnabled="true" isTracingEnabled="false" isAutoPublish="false">
    <ser:security>
      <con2:custom-token-authentication>
        <con2:username-password>
          <con2:username-selector>
            <con2:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:AutenticacionRequestHeader/UserName/text()</con2:xpath>
            <con2:variable>header</con2:variable>
          </con2:username-selector>
          <con2:password-selector>
            <con2:xpath>declare namespace aut='http://www.ficohsa.com.hn/middleware.services/autType';
./aut:AutenticacionRequestHeader/Password/text()</con2:xpath>
            <con2:variable>header</con2:variable>
          </con2:password-selector>
        </con2:username-password>
      </con2:custom-token-authentication>
    </ser:security>
    <ser:binding type="SOAP" isSoap12="false" xsi:type="con4:SoapBindingType" xmlns:con4="http://www.bea.com/wli/sb/services/bindings/config">
      <con4:wsdl ref="Middleware/Business_Resources/pagoPrestamo/pagoPrestamoPS"/>
      <con4:port>
        <con4:name>pagoPrestamoPSSOAP</con4:name>
        <con4:namespace>http://www.ficohsa.com.hn/middleware.services/pagoPrestamoPS/</con4:namespace>
      </con4:port>
      <con4:selector type="SOAP body"/>
      <con4:WSI-compliant>false</con4:WSI-compliant>
    </ser:binding>
    <ser:monitoring isEnabled="true">
      <ser:aggregationInterval>180</ser:aggregationInterval>
      <ser:pipelineMonitoringLevel>Pipeline</ser:pipelineMonitoringLevel>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
    <ser:throttling enabled="false">
      <ser:capacity>0</ser:capacity>
      <ser:maxQueueLength>0</ser:maxQueueLength>
      <ser:timeToLive>0</ser:timeToLive>
    </ser:throttling>
    <ser:messageTracing enabled="false">
      <ser:detailsLevel>Terse</ser:detailsLevel>
      <ser:maxSize>8192</ser:maxSize>
    </ser:messageTracing>
  </ser:coreEntry>
  <ser:endpointConfig>
    <tran:provider-id>http</tran:provider-id>
    <tran:inbound>true</tran:inbound>
    <tran:URI>
      <env:value>/Middleware/OperationsAndExecution/Payments/PagoPrestamo</env:value>
    </tran:URI>
    <tran:inbound-properties/>
    <tran:all-headers>false</tran:all-headers>
    <tran:provider-specific>
      <http:inbound-properties/>
    </tran:provider-specific>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-8848777042473091319--23eafd38.13c2a05c9f3.-6642">
    <con3:pipeline type="error" name="_onErrorHandler-8848777042473091319--23eafd38.13c2a05c9f3.-6642">
      <con3:stage name="proxyFault">
        <con4:context xmlns:con3="http://www.bea.com/wli/sb/services/security/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/consultaFICOPENTypes" prefix="con"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
        </con4:context>
        <con4:actions xmlns:con3="http://www.bea.com/wli/sb/services/security/config" xmlns:con4="http://www.bea.com/wli/sb/pipeline/config">
          <con1:replace contents-only="true" varName="header">
            <con:id>_ActionId-8848777042473091319--23eafd38.13c2a05c9f3.-6608</con:id>
            <con1:expr>
              <con:xqueryText><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{ concat(fn:string($fault/ctx:errorCode/text()), ": ", fn:string($fault/ctx:reason/text())) }</messages>
</aut:ResponseHeader>]]></con:xqueryText>
            </con1:expr>
          </con1:replace>
          <con1:replace contents-only="true" varName="body">
            <con:id>_ActionId-8848777042473091319--23eafd38.13c2a05c9f3.-6607</con:id>
            <con1:expr>
              <con:xqueryText>&lt;pag:pagoPrestamoResponse/></con:xqueryText>
            </con1:expr>
          </con1:replace>
          <con:reply>
            <con:id>_ActionId-8848777042473091319--23eafd38.13c2a05c9f3.-6606</con:id>
          </con:reply>
        </con4:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="VALIDATION_request">
      <con3:stage name="Valid_proxyRequest" errorHandler="_onErrorHandler-2771357923723315984-3a468d12.14fd756875e.-7ea0">
        <con3:context>
          <con:userNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/sp/consultarPtmoMigrado" prefix="con2"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
        </con3:context>
        <con3:actions>
          <con1:wsCallout>
            <con:id>_ActionId-2771357923723315984-3a468d12.14fd756875e.-7ede</con:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/v2/BusinessServices/ABK/consultarPtmoMigrado/biz/consultarPtmoMigrado_db" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>consultarPtmoMigrado</con1:operation>
            <con1:request>
              <con1:body>$REQConsPtmoMig</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>RSPConsPtmoMig</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="REQConsPtmoMig">
                <con:id>_ActionId-2771357923723315984-3a468d12.14fd756875e.-7ebd</con:id>
                <con1:expr>
                  <con:xqueryTransform>
                    <con:resource ref="Middleware/Business_Resources/consultaGeneralPrestamo/consultaPtmoMigradoIn"/>
                    <con:param name="loanNumber">
                      <con:path>fn:string($body/pag:pagoPrestamo/LOAN_NUMBER/text())</con:path>
                    </con:param>
                  </con:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con1:requestTransform>
            <con1:responseTransform>
              <con1:replace varName="body" contents-only="true">
                <con:id>_ActionId-2771357923723315984-3a468d12.14fd756875e.-7ea1</con:id>
                <con1:location>
                  <con:xpathText>./pag:pagoPrestamo/LOAN_NUMBER</con:xpathText>
                </con1:location>
                <con1:expr>
                  <con:xqueryText>fn:string($RSPConsPtmoMig/con2:PV_NUMERO_PRESTAMO_VALIDO/text())</con:xqueryText>
                </con1:expr>
              </con1:replace>
              <con1:assign varName="responseLoanNumber">
                <con:id>_ActionId-2955661912422161236-14bac7d5.15416d182bf.-7f96</con:id>
                <con1:expr>
                  <con:xqueryText>fn:string($RSPConsPtmoMig/con2:PV_VALOR_RECIBO/text())</con:xqueryText>
                </con1:expr>
              </con1:assign>
            </con1:responseTransform>
          </con1:wsCallout>
          <con1:assign varName="loanType">
            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7fd9</con:id>
            <con1:expr>
              <con:xqueryTransform>
                <con:resource ref="Middleware/Business_Resources/pagoPrestamo/consultaGeneralPrestamo/validarTipoPrestamo"/>
                <con:param name="NumeroPrestamo">
                  <con:path>fn:string($body/pag:pagoPrestamo/LOAN_NUMBER/text())</con:path>
                </con:param>
              </con:xqueryTransform>
            </con1:expr>
          </con1:assign>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="VALIDATION_response"/>
    <con3:pipeline type="request" name="ABANKS_request">
      <con3:stage name="Abanks_proxyRequest">
        <con3:context>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con3:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_CON_GENERAL_PRESTAMO/" prefix="osb" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
          <con3:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_PAG_PRESTAMO_T24/" prefix="osb1" xmlns:con3="http://www.bea.com/wli/sb/stages/config"/>
          <con4:varNsDecl namespace="http://xmlns.oracle.com/pcbpel/adapter/db/ORA_BANK/OSB_GET_CONFIG/" prefix="osb2" xmlns:con4="http://www.bea.com/wli/sb/stages/config"/>
        </con3:context>
        <con3:actions>
          <con1:assign varName="paymentAmount">
            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e79</con:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/PAYMENT_AMOUNT/text()</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="loanNumber">
            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e78</con:id>
            <con1:expr>
              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/LOAN_NUMBER/text()</con3:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="PaymentType">
            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e77</con:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/PAYMENT_TYPE/text()</con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:ifThenElse>
            <con4:comment xmlns:con4="http://www.bea.com/wli/sb/stages/config">IfThen Inicial</con4:comment>
            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e76</con:id>
            <con1:case>
              <con1:condition>
                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($PaymentType) != "" and
fn:string($loanNumber) != "" and
fn:string($paymentAmount) != ""</con3:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:ifThenElse>
                  <con4:comment xmlns:con4="http://www.bea.com/wli/sb/stages/config">IfThen PaymentType</con4:comment>
                  <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e75</con:id>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($PaymentType)) = "ACCOUNT_DEBIT"</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="debitAccount">
                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e74</con:id>
                        <con1:expr>
                          <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/DEBIT_ACCOUNT/text()</con2:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:ifThenElse>
                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e73</con:id>
                        <con1:case>
                          <con1:condition>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string($debitAccount) != ""</con2:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e71</con:id>
                              <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/consultaGeneralPrestamo/Resources/consultaGeneralPrestamoBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultaGeneralPrestamo</con1:operation>
                              <con1:request>
                                <con1:body>$REQUESTCONPRES</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>RESPONSECONPRES</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="REQUESTCONPRES">
                                  <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e72</con:id>
                                  <con1:expr>
                                    <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                      <con2:resource ref="Middleware/Business_Resources/pagoPrestamo/consultaGeneralPrestamo/consultaGeneralPrestamoIn"/>
                                      <con2:param name="pagoPrestamo">
                                        <con2:path>$body/pag:pagoPrestamo</con2:path>
                                      </con2:param>
                                    </con2:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform/>
                            </con1:wsCallout>
                            <con1:assign varName="successIndicatorPrestamo">
                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e70</con:id>
                              <con1:expr>
                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:ERROR_CODE/text()</con3:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:assign varName="currencyPrestamo">
                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e6f</con:id>
                              <con1:expr>
                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:CURRENCY/text()</con3:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:ifThenElse>
                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e6e</con:id>
                              <con1:case>
                                <con1:condition>
                                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicatorPrestamo)) = "SUCCESS"</con3:xqueryText>
                                </con1:condition>
                                <con1:actions>
                                  <con1:wsCallout>
                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e6c</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/ConsultasCuenta/Resources/consultaCuentasBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>Consultadedetallesdelacuenta</con1:operation>
                                    <con1:request>
                                      <con1:body>$REQUESTCONCLIE</con1:body>
                                    </con1:request>
                                    <con1:response>
                                      <con1:body>RESPONSECONCLIE</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                      <con1:assign varName="REQUESTCONCLIE">
                                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e6d</con:id>
                                        <con1:expr>
                                          <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                            <con2:resource ref="Middleware/Business_Resources/pagoPrestamo/consultaDetalleCuenta/consultaDetalleCuentaIn"/>
                                            <con2:param name="autenticacionRequestHeader1">
                                              <con2:path>$header/aut:AutenticacionRequestHeader</con2:path>
                                            </con2:param>
                                            <con2:param name="pagoPrestamo">
                                              <con2:path>$body/pag:pagoPrestamo</con2:path>
                                            </con2:param>
                                          </con2:xqueryTransform>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform/>
                                  </con1:wsCallout>
                                  <con1:assign varName="currencyCuenta">
                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e6b</con:id>
                                    <con1:expr>
                                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONCLIE/WSACCOUNTLISTType/gWSACCOUNTLISTDetailType/mWSACCOUNTLISTDetailType/CURRENCY/text()</con3:xqueryText>
                                    </con1:expr>
                                  </con1:assign>
                                  <con1:ifThenElse>
                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e6a</con:id>
                                    <con1:case>
                                      <con1:condition>
                                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($currencyCuenta) != ""</con3:xqueryText>
                                      </con1:condition>
                                      <con1:actions>
                                        <con1:ifThenElse>
                                          <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e69</con:id>
                                          <con1:case>
                                            <con1:condition>
                                              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($currencyPrestamo)) =
fn:upper-case(fn:string($currencyCuenta))</con2:xqueryText>
                                            </con1:condition>
                                            <con1:actions>
                                              <con1:wsCallout>
                                                <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e66</con:id>
                                                <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con1:operation>obtenerParametrizacion</con1:operation>
                                                <con1:request>
                                                  <con1:body>$REQobtenerParametrizacion</con1:body>
                                                </con1:request>
                                                <con1:response>
                                                  <con1:body>RESobtenerParametrizacion</con1:body>
                                                </con1:response>
                                                <con1:requestTransform>
                                                  <con1:assign varName="REQobtenerParametrizacion">
                                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e68</con:id>
                                                    <con1:expr>
                                                      <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                                        <con4:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                                                        <con4:param name="nombreParametros">
                                                          <con4:path>"T24T134.HNLCREDITACCTNO||T24T134.USDCREDITACCTNO||T24T133.TXNTYPELOANPYMT"</con4:path>
                                                        </con4:param>
                                                      </con4:xqueryTransform>
                                                    </con1:expr>
                                                  </con1:assign>
                                                </con1:requestTransform>
                                                <con1:responseTransform>
                                                  <con1:assign varName="statusParametrizacion">
                                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e67</con:id>
                                                    <con1:expr>
                                                      <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESobtenerParametrizacion/osb2:ERROR_CODE/text())</con4:xqueryText>
                                                    </con1:expr>
                                                  </con1:assign>
                                                </con1:responseTransform>
                                              </con1:wsCallout>
                                              <con1:ifThenElse>
                                                <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e65</con:id>
                                                <con1:case>
                                                  <con1:condition>
                                                    <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">$statusParametrizacion = "SUCCESS"</con4:xqueryText>
                                                  </con1:condition>
                                                  <con1:actions>
                                                    <con1:ifThenElse>
                                                      <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e64</con:id>
                                                      <con1:case>
                                                        <con1:condition>
                                                          <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($currencyPrestamo)) = "HNL"</con3:xqueryText>
                                                        </con1:condition>
                                                        <con1:actions>
                                                          <con1:assign varName="creditAccount">
                                                            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e63</con:id>
                                                            <con1:expr>
                                                              <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESobtenerParametrizacion/osb2:CONFIGURACIONES/osb2:CONFIGURACIONES_ITEM[osb2:NAME="T24T134.HNLCREDITACCTNO"]/osb2:VALUE/text())</con4:xqueryText>
                                                            </con1:expr>
                                                          </con1:assign>
                                                        </con1:actions>
                                                      </con1:case>
                                                      <con1:case>
                                                        <con1:condition>
                                                          <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($currencyPrestamo)) = "USD"</con3:xqueryText>
                                                        </con1:condition>
                                                        <con1:actions>
                                                          <con1:assign varName="creditAccount">
                                                            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e62</con:id>
                                                            <con1:expr>
                                                              <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESobtenerParametrizacion/osb2:CONFIGURACIONES/osb2:CONFIGURACIONES_ITEM[osb2:NAME="T24T134.USDCREDITACCTNO"]/osb2:VALUE/text())</con4:xqueryText>
                                                            </con1:expr>
                                                          </con1:assign>
                                                        </con1:actions>
                                                      </con1:case>
                                                    </con1:ifThenElse>
                                                    <con1:assign varName="uuid">
                                                      <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e61</con:id>
                                                      <con1:expr>
                                                        <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                                          <con4:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                                                        </con4:xqueryTransform>
                                                      </con1:expr>
                                                    </con1:assign>
                                                    <con1:wsCallout>
                                                      <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e5e</con:id>
                                                      <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/Transferencias/Resources/transferenciasBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con1:operation>Transfmodelbankentrecuentas</con1:operation>
                                                      <con1:request>
                                                        <con1:body>$REQUESTTRAN</con1:body>
                                                      </con1:request>
                                                      <con1:response>
                                                        <con1:body>RESPONSETRAN</con1:body>
                                                      </con1:response>
                                                      <con1:requestTransform>
                                                        <con1:assign varName="trxType">
                                                          <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e60</con:id>
                                                          <con1:expr>
                                                            <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESobtenerParametrizacion/osb2:CONFIGURACIONES/osb2:CONFIGURACIONES_ITEM[osb2:NAME="T24T133.TXNTYPELOANPYMT"]/osb2:VALUE/text())</con4:xqueryText>
                                                          </con1:expr>
                                                        </con1:assign>
                                                        <con1:assign varName="REQUESTTRAN">
                                                          <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e5f</con:id>
                                                          <con1:expr>
                                                            <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                                              <con4:resource ref="Middleware/Business_Resources/pagoPrestamo/debitoPrestamoCuenta/debitoPrestamoCuentaIn"/>
                                                              <con4:param name="transactionType">
                                                                <con4:path>$trxType</con4:path>
                                                              </con4:param>
                                                              <con4:param name="autenticacionRequestHeader">
                                                                <con4:path>$header/aut:AutenticacionRequestHeader</con4:path>
                                                              </con4:param>
                                                              <con4:param name="accountCurrency">
                                                                <con4:path>$currencyCuenta</con4:path>
                                                              </con4:param>
                                                              <con4:param name="creditAccount">
                                                                <con4:path>$creditAccount</con4:path>
                                                              </con4:param>
                                                              <con4:param name="uuid">
                                                                <con4:path>fn:string($uuid)</con4:path>
                                                              </con4:param>
                                                              <con4:param name="pagoPrestamo">
                                                                <con4:path>$body/pag:pagoPrestamo</con4:path>
                                                              </con4:param>
                                                            </con4:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:requestTransform>
                                                      <con1:responseTransform/>
                                                    </con1:wsCallout>
                                                    <con1:assign varName="successIndicator">
                                                      <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e5d</con:id>
                                                      <con1:expr>
                                                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/successIndicator/text()</con3:xqueryText>
                                                      </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="transactionId">
                                                      <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e5c</con:id>
                                                      <con1:expr>
                                                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/transactionId/text()</con3:xqueryText>
                                                      </con1:expr>
                                                    </con1:assign>
                                                    <con1:assign varName="valueDate">
                                                      <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e5b</con:id>
                                                      <con1:expr>
                                                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/FUNDSTRANSFERType/DEBITVALUEDATE/text()</con3:xqueryText>
                                                      </con1:expr>
                                                    </con1:assign>
                                                  </con1:actions>
                                                </con1:case>
                                                <con1:default>
                                                  <con1:assign varName="message">
                                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e5a</con:id>
                                                    <con1:expr>
                                                      <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESobtenerParametrizacion/osb2:ERROR_MESSAGE/text())</con4:xqueryText>
                                                    </con1:expr>
                                                  </con1:assign>
                                                  <con4:skip xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                                    <con4:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e59</con4:id>
                                                  </con4:skip>
                                                </con1:default>
                                              </con1:ifThenElse>
                                              <con1:ifThenElse>
                                                <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e58</con:id>
                                                <con1:case>
                                                  <con1:condition>
                                                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($currencyPrestamo)) = "HNL" or
fn:upper-case(fn:string($currencyPrestamo)) = "USD"</con3:xqueryText>
                                                  </con1:condition>
                                                  <con1:actions>
                                                    <con1:ifThenElse>
                                                      <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e57</con:id>
                                                      <con1:case>
                                                        <con1:condition>
                                                          <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicator)) = "SUCCESS"</con3:xqueryText>
                                                        </con1:condition>
                                                        <con1:actions>
                                                          <con1:wsCallout>
                                                            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e55</con:id>
                                                            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoPrestamo/Resources/pagoPrestamoT24BS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con1:operation>pagoPrestamoT24</con1:operation>
                                                            <con1:request>
                                                              <con1:body>$REQUESTABANKS</con1:body>
                                                            </con1:request>
                                                            <con1:response>
                                                              <con1:body>RESPONSEABANKS</con1:body>
                                                            </con1:response>
                                                            <con1:requestTransform>
                                                              <con1:assign varName="REQUESTABANKS">
                                                                <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e56</con:id>
                                                                <con1:expr>
                                                                  <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                                                    <con4:resource ref="Middleware/Business_Resources/pagoPrestamo/pagoPrestamo/pagoPrestamoIn"/>
                                                                    <con4:param name="autenticacionRequestHeader">
                                                                      <con4:path>$header/aut:AutenticacionRequestHeader</con4:path>
                                                                    </con4:param>
                                                                    <con4:param name="transactionID">
                                                                      <con4:path>fn:string($transactionId)</con4:path>
                                                                    </con4:param>
                                                                    <con4:param name="pagoPrestamo">
                                                                      <con4:path>$body/pag:pagoPrestamo</con4:path>
                                                                    </con4:param>
                                                                  </con4:xqueryTransform>
                                                                </con1:expr>
                                                              </con1:assign>
                                                            </con1:requestTransform>
                                                            <con1:responseTransform/>
                                                          </con1:wsCallout>
                                                          <con1:assign varName="successIndicatorAbanks">
                                                            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e54</con:id>
                                                            <con1:expr>
                                                              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSEABANKS/osb1:ERROR_CODE/text()</con3:xqueryText>
                                                            </con1:expr>
                                                          </con1:assign>
                                                          <con1:ifThenElse>
                                                            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e53</con:id>
                                                            <con1:case>
                                                              <con1:condition>
                                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicatorAbanks)) != "SUCCESS"</con2:xqueryText>
                                                              </con1:condition>
                                                              <con1:actions>
                                                                <con1:wsCallout>
                                                                  <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e50</con:id>
                                                                  <con1:service xsi:type="ref:ProxyRef" ref="Middleware/OperationsAndExecution/CustomerDeposits/ReversarTransaccion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                  <con1:operation>reversarTransaccion</con1:operation>
                                                                  <con1:request>
                                                                    <con1:body>$REQUESTREVTRAN</con1:body>
                                                                    <con1:header>$REQUESTHEADER</con1:header>
                                                                  </con1:request>
                                                                  <con1:response>
                                                                    <con1:body>RESPONSEREVTRAN</con1:body>
                                                                    <con1:header>RESPONSEHEADER</con1:header>
                                                                  </con1:response>
                                                                  <con1:requestTransform>
                                                                    <con1:assign varName="REQUESTREVTRAN">
                                                                      <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e52</con:id>
                                                                      <con1:expr>
                                                                        <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                                                          <con2:resource ref="Middleware/Business_Resources/pagoPrestamo/reversarTransaccion/reversarTransaccionIn"/>
                                                                          <con2:param name="transactionId">
                                                                            <con2:path>$transactionId</con2:path>
                                                                          </con2:param>
                                                                        </con2:xqueryTransform>
                                                                      </con1:expr>
                                                                    </con1:assign>
                                                                    <con1:assign varName="REQUESTHEADER">
                                                                      <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e51</con:id>
                                                                      <con1:expr>
                                                                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$header</con3:xqueryText>
                                                                      </con1:expr>
                                                                    </con1:assign>
                                                                  </con1:requestTransform>
                                                                  <con1:responseTransform/>
                                                                </con1:wsCallout>
                                                                <con1:assign varName="message">
                                                                  <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e4f</con:id>
                                                                  <con1:expr>
                                                                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSEABANKS/osb1:ERROR_MESSAGE/text()</con3:xqueryText>
                                                                  </con1:expr>
                                                                </con1:assign>
                                                              </con1:actions>
                                                            </con1:case>
                                                            <con1:default/>
                                                          </con1:ifThenElse>
                                                        </con1:actions>
                                                      </con1:case>
                                                      <con1:default>
                                                        <con1:assign varName="message">
                                                          <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e4e</con:id>
                                                          <con1:expr>
                                                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/messages/text()</con3:xqueryText>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:default>
                                                    </con1:ifThenElse>
                                                  </con1:actions>
                                                </con1:case>
                                                <con1:default/>
                                              </con1:ifThenElse>
                                            </con1:actions>
                                          </con1:case>
                                          <con1:default>
                                            <con1:assign varName="message">
                                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e4d</con:id>
                                              <con1:expr>
                                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">"CURRENCY ACCOUNTS DIFFERENTS"</con3:xqueryText>
                                              </con1:expr>
                                            </con1:assign>
                                          </con1:default>
                                        </con1:ifThenElse>
                                      </con1:actions>
                                    </con1:case>
                                    <con1:default>
                                      <con1:assign varName="message">
                                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e4c</con:id>
                                        <con1:expr>
                                          <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">"DEBIT ACCOUNT DOES NOT EXISTS"</con3:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:default>
                                  </con1:ifThenElse>
                                </con1:actions>
                              </con1:case>
                              <con1:default>
                                <con1:assign varName="message">
                                  <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e4b</con:id>
                                  <con1:expr>
                                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:ERROR_MESSAGE/text()</con3:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:default>
                            </con1:ifThenElse>
                          </con1:actions>
                        </con1:case>
                        <con1:default>
                          <con1:assign varName="message">
                            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e4a</con:id>
                            <con1:expr>
                              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">"REQUIRED FIELDS NOT SUPPLIED"</con3:xqueryText>
                            </con1:expr>
                          </con1:assign>
                        </con1:default>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($PaymentType)) = "CASH"</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:wsCallout>
                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e48</con:id>
                        <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/consultaGeneralPrestamo/Resources/consultaGeneralPrestamoBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con1:operation>consultaGeneralPrestamo</con1:operation>
                        <con1:request>
                          <con1:body>$REQUESTCONPRES</con1:body>
                        </con1:request>
                        <con1:response>
                          <con1:body>RESPONSECONPRES</con1:body>
                        </con1:response>
                        <con1:requestTransform>
                          <con1:assign varName="REQUESTCONPRES">
                            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e49</con:id>
                            <con1:expr>
                              <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                                <con3:resource ref="Middleware/Business_Resources/pagoPrestamo/consultaGeneralPrestamo/consultaGeneralPrestamoIn"/>
                                <con3:param name="pagoPrestamo">
                                  <con3:path>$body/pag:pagoPrestamo</con3:path>
                                </con3:param>
                              </con3:xqueryTransform>
                            </con1:expr>
                          </con1:assign>
                        </con1:requestTransform>
                        <con1:responseTransform/>
                      </con1:wsCallout>
                      <con1:assign varName="successIndicatorPrestamo">
                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e47</con:id>
                        <con1:expr>
                          <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:ERROR_CODE/text()</con3:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:assign varName="currencyPrestamo">
                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e46</con:id>
                        <con1:expr>
                          <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:CURRENCY/text()</con3:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:ifThenElse>
                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e45</con:id>
                        <con1:case>
                          <con1:condition>
                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicatorPrestamo)) = "SUCCESS"</con3:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:assign varName="uuid">
                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e44</con:id>
                              <con1:expr>
                                <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                  <con4:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                                </con4:xqueryTransform>
                              </con1:expr>
                            </con1:assign>
                            <con1:ifThenElse>
                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e43</con:id>
                              <con1:case>
                                <con1:condition>
                                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($currencyPrestamo)) = "HNL"</con3:xqueryText>
                                </con1:condition>
                                <con1:actions>
                                  <con1:wsCallout>
                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e41</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoPrestamo/Resources/DebitoPrestamo/debitoPrestamoBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>Depositoenefectivofase11</con1:operation>
                                    <con1:request>
                                      <con1:body>$REQUESTLOCAL</con1:body>
                                    </con1:request>
                                    <con1:response>
                                      <con1:body>RESPONSETRAN</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                      <con1:assign varName="REQUESTLOCAL">
                                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e42</con:id>
                                        <con1:expr>
                                          <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                                            <con3:resource ref="Middleware/Business_Resources/pagoPrestamo/depositoPrestamoEfectivoLocal/depositoPrestamoEfectivoLocalIn"/>
                                            <con3:param name="autenticacionRequestHeader">
                                              <con3:path>$header/aut:AutenticacionRequestHeader</con3:path>
                                            </con3:param>
                                            <con3:param name="pagoPrestamo">
                                              <con3:path>$body/pag:pagoPrestamo</con3:path>
                                            </con3:param>
                                            <con3:param name="uuid">
                                              <con3:path>fn:string($uuid)</con3:path>
                                            </con3:param>
                                          </con3:xqueryTransform>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform/>
                                  </con1:wsCallout>
                                </con1:actions>
                              </con1:case>
                              <con1:case>
                                <con1:condition>
                                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($currencyPrestamo)) = "USD"</con3:xqueryText>
                                </con1:condition>
                                <con1:actions>
                                  <con1:wsCallout>
                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e3f</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoPrestamo/Resources/DebitoPrestamo/debitoPrestamoBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>Depositoenefectivofase12</con1:operation>
                                    <con1:request>
                                      <con1:body>$REQUESTEXTRANJERA</con1:body>
                                    </con1:request>
                                    <con1:response>
                                      <con1:body>RESPONSETRAN</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                      <con1:assign varName="REQUESTEXTRANJERA">
                                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e40</con:id>
                                        <con1:expr>
                                          <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                                            <con3:resource ref="Middleware/Business_Resources/pagoPrestamo/depositoPrestamoEfectivoExtranjera/depositoPrestamoEfectivoExtranjeraIn"/>
                                            <con3:param name="autenticacionRequestHeader">
                                              <con3:path>$header/aut:AutenticacionRequestHeader</con3:path>
                                            </con3:param>
                                            <con3:param name="pagoPrestamo">
                                              <con3:path>$body/pag:pagoPrestamo</con3:path>
                                            </con3:param>
                                            <con3:param name="uuid">
                                              <con3:path>fn:string($uuid)</con3:path>
                                            </con3:param>
                                          </con3:xqueryTransform>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform/>
                                  </con1:wsCallout>
                                </con1:actions>
                              </con1:case>
                            </con1:ifThenElse>
                            <con1:assign varName="successIndicator">
                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e3e</con:id>
                              <con1:expr>
                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/successIndicator/text()</con3:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:assign varName="transactionId">
                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e3d</con:id>
                              <con1:expr>
                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/transactionId/text()</con3:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:assign varName="valueDate">
                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e3c</con:id>
                              <con1:expr>
                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/TELLERType/VALUEDATE2/text()</con3:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:ifThenElse>
                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e3b</con:id>
                              <con1:case>
                                <con1:condition>
                                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicator)) = "SUCCESS"</con3:xqueryText>
                                </con1:condition>
                                <con1:actions>
                                  <con1:wsCallout>
                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e39</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoPrestamo/Resources/pagoPrestamoT24BS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>pagoPrestamoT24</con1:operation>
                                    <con1:request>
                                      <con1:body>$REQUESTABANKS</con1:body>
                                    </con1:request>
                                    <con1:response>
                                      <con1:body>RESPONSEABANKS</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                      <con1:assign varName="REQUESTABANKS">
                                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e3a</con:id>
                                        <con1:expr>
                                          <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                            <con4:resource ref="Middleware/Business_Resources/pagoPrestamo/pagoPrestamo/pagoPrestamoIn"/>
                                            <con4:param name="autenticacionRequestHeader">
                                              <con4:path>$header/aut:AutenticacionRequestHeader</con4:path>
                                            </con4:param>
                                            <con4:param name="transactionID">
                                              <con4:path>fn:string($transactionId)</con4:path>
                                            </con4:param>
                                            <con4:param name="pagoPrestamo">
                                              <con4:path>$body/pag:pagoPrestamo</con4:path>
                                            </con4:param>
                                          </con4:xqueryTransform>
                                        </con1:expr>
                                      </con1:assign>
                                    </con1:requestTransform>
                                    <con1:responseTransform/>
                                  </con1:wsCallout>
                                  <con1:assign varName="successIndicatorAbanks">
                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e38</con:id>
                                    <con1:expr>
                                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSEABANKS/osb1:ERROR_CODE/text()</con3:xqueryText>
                                    </con1:expr>
                                  </con1:assign>
                                  <con1:ifThenElse>
                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e37</con:id>
                                    <con1:case>
                                      <con1:condition>
                                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicatorAbanks)) != "SUCCESS"</con3:xqueryText>
                                      </con1:condition>
                                      <con1:actions>
                                        <con1:wsCallout>
                                          <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e34</con:id>
                                          <con1:service xsi:type="ref:ProxyRef" ref="Middleware/OperationsAndExecution/CustomerDeposits/ReversarTransaccion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                          <con1:operation>reversarTransaccion</con1:operation>
                                          <con1:request>
                                            <con1:body>$REQUESTREVTRAN</con1:body>
                                            <con1:header>$REQUESTHEADER</con1:header>
                                          </con1:request>
                                          <con1:response>
                                            <con1:body>RESPONSEREVTRAN</con1:body>
                                            <con1:header>RESPONSEHEADER</con1:header>
                                          </con1:response>
                                          <con1:requestTransform>
                                            <con1:assign varName="REQUESTREVTRAN">
                                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e36</con:id>
                                              <con1:expr>
                                                <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                                                  <con3:resource ref="Middleware/Business_Resources/pagoPrestamo/reversarTransaccion/reversarTransaccionIn"/>
                                                  <con3:param name="transactionId">
                                                    <con3:path>$transactionId</con3:path>
                                                  </con3:param>
                                                </con3:xqueryTransform>
                                              </con1:expr>
                                            </con1:assign>
                                            <con1:assign varName="REQUESTHEADER">
                                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e35</con:id>
                                              <con1:expr>
                                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$header</con3:xqueryText>
                                              </con1:expr>
                                            </con1:assign>
                                          </con1:requestTransform>
                                          <con1:responseTransform/>
                                        </con1:wsCallout>
                                        <con1:assign varName="message">
                                          <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e33</con:id>
                                          <con1:expr>
                                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSEABANKS/osb1:ERROR_MESSAGE/text()</con3:xqueryText>
                                          </con1:expr>
                                        </con1:assign>
                                      </con1:actions>
                                    </con1:case>
                                    <con1:default/>
                                  </con1:ifThenElse>
                                </con1:actions>
                              </con1:case>
                              <con1:default>
                                <con1:assign varName="message">
                                  <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e32</con:id>
                                  <con1:expr>
                                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/messages/text()</con3:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:default>
                            </con1:ifThenElse>
                          </con1:actions>
                        </con1:case>
                        <con1:default>
                          <con1:assign varName="message">
                            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e31</con:id>
                            <con1:expr>
                              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:ERROR_MESSAGE/text()</con3:xqueryText>
                            </con1:expr>
                          </con1:assign>
                        </con1:default>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($PaymentType)) = "OWN_CHEQUE"</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="message">
                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e30</con:id>
                        <con1:expr>
                          <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">"PAYMENT TYPE NOT AVAILABLE"</con3:xqueryText>
                        </con1:expr>
                      </con1:assign>
                    </con1:actions>
                  </con1:case>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($PaymentType)) = "OTHER_BANK_CHEQUE"</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:assign varName="chequeNumber">
                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e2f</con:id>
                        <con1:expr>
                          <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/CHEQUE_NUMBER/text()</con2:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:assign varName="bankCode">
                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e2e</con:id>
                        <con1:expr>
                          <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/pag:pagoPrestamo/BANK_CODE/text()</con2:xqueryText>
                        </con1:expr>
                      </con1:assign>
                      <con1:ifThenElse>
                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e2d</con:id>
                        <con1:case>
                          <con1:condition>
                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($chequeNumber) != "" and
fn:string($bankCode) != ""</con3:xqueryText>
                          </con1:condition>
                          <con1:actions>
                            <con1:wsCallout>
                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e2b</con:id>
                              <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/consultaGeneralPrestamo/Resources/consultaGeneralPrestamoBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                              <con1:operation>consultaGeneralPrestamo</con1:operation>
                              <con1:request>
                                <con1:body>$REQUESTCONPRES</con1:body>
                              </con1:request>
                              <con1:response>
                                <con1:body>RESPONSECONPRES</con1:body>
                              </con1:response>
                              <con1:requestTransform>
                                <con1:assign varName="REQUESTCONPRES">
                                  <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e2c</con:id>
                                  <con1:expr>
                                    <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                                      <con3:resource ref="Middleware/Business_Resources/pagoPrestamo/consultaGeneralPrestamo/consultaGeneralPrestamoIn"/>
                                      <con3:param name="pagoPrestamo">
                                        <con3:path>$body/pag:pagoPrestamo</con3:path>
                                      </con3:param>
                                    </con3:xqueryTransform>
                                  </con1:expr>
                                </con1:assign>
                              </con1:requestTransform>
                              <con1:responseTransform/>
                            </con1:wsCallout>
                            <con1:assign varName="successIndicatorPrestamo">
                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e2a</con:id>
                              <con1:expr>
                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:ERROR_CODE/text()</con3:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:assign varName="currencyPrestamo">
                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e29</con:id>
                              <con1:expr>
                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:CURRENCY/text()</con3:xqueryText>
                              </con1:expr>
                            </con1:assign>
                            <con1:ifThenElse>
                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e28</con:id>
                              <con1:case>
                                <con1:condition>
                                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicatorPrestamo)) = "SUCCESS"</con3:xqueryText>
                                </con1:condition>
                                <con1:actions>
                                  <con4:wsCallout xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con="http://www.bea.com/wli/sb/services/security/config" xmlns:con2="http://www.bea.com/wli/sb/stages/config" xmlns:con1="http://www.bea.com/wli/sb/pipeline/config" xmlns:con4="http://www.bea.com/wli/sb/stages/transform/config">
                                    <con2:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e25</con2:id>
                                    <con4:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/general/Resources/ObtenerParametrizacion/ObtenerParametrizacion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con4:operation>obtenerParametrizacion</con4:operation>
                                    <con4:request>
                                      <con4:body>$REQUESTobtenerParametrizacion</con4:body>
                                    </con4:request>
                                    <con4:response>
                                      <con4:body>RESPONSEobtenerParametrizacion</con4:body>
                                    </con4:response>
                                    <con4:requestTransform>
                                      <con4:assign varName="REQUESTobtenerParametrizacion">
                                        <con2:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e27</con2:id>
                                        <con4:expr>
                                          <con2:xqueryTransform>
                                            <con2:resource ref="Middleware/Business_Resources/general/Parametrizacion/obtenerParametrizacionIn"/>
                                            <con2:param name="nombreParametros">
                                              <con2:path>"T24T032.HNLOBCHQACCTNO||T24T032.USDOBCHQACCTNO"</con2:path>
                                            </con2:param>
                                          </con2:xqueryTransform>
                                        </con4:expr>
                                      </con4:assign>
                                    </con4:requestTransform>
                                    <con4:responseTransform>
                                      <con4:assign varName="statusParametrizacion">
                                        <con2:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e26</con2:id>
                                        <con4:expr>
                                          <con2:xqueryText>fn:string($RESPONSEobtenerParametrizacion/osb2:ERROR_CODE/text())</con2:xqueryText>
                                        </con4:expr>
                                      </con4:assign>
                                    </con4:responseTransform>
                                  </con4:wsCallout>
                                  <con1:ifThenElse>
                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e24</con:id>
                                    <con1:case>
                                      <con1:condition>
                                        <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">$statusParametrizacion = "SUCCESS"</con4:xqueryText>
                                      </con1:condition>
                                      <con1:actions/>
                                    </con1:case>
                                    <con1:default>
                                      <con1:assign varName="message">
                                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e23</con:id>
                                        <con1:expr>
                                          <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESPONSEobtenerParametrizacion/osb2:ERROR_MESSAGE/text())</con4:xqueryText>
                                        </con1:expr>
                                      </con1:assign>
                                      <con4:skip xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                        <con4:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e22</con4:id>
                                      </con4:skip>
                                    </con1:default>
                                  </con1:ifThenElse>
                                  <con1:wsCallout>
                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e1b</con:id>
                                    <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoPrestamo/Resources/DepositoCombinado/depositoCombinadoBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:operation>Depositocombinado</con1:operation>
                                    <con1:request>
                                      <con1:body>$REQUESTOTHERCHEQUE</con1:body>
                                    </con1:request>
                                    <con1:response>
                                      <con1:body>RESPONSETRAN</con1:body>
                                    </con1:response>
                                    <con1:requestTransform>
                                      <con1:assign varName="uuid">
                                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e21</con:id>
                                        <con1:expr>
                                          <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                            <con4:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
                                          </con4:xqueryTransform>
                                        </con1:expr>
                                      </con1:assign>
                                      <con1:ifThenElse>
                                        <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e20</con:id>
                                        <con1:case>
                                          <con1:condition>
                                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($currencyPrestamo)) = "HNL"</con3:xqueryText>
                                          </con1:condition>
                                          <con1:actions>
                                            <con1:assign varName="depositAccount">
                                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e1f</con:id>
                                              <con1:expr>
                                                <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESPONSEobtenerParametrizacion/osb2:CONFIGURACIONES/osb2:CONFIGURACIONES_ITEM[osb2:NAME="T24T032.HNLOBCHQACCTNO"]/osb2:VALUE/text())</con4:xqueryText>
                                              </con1:expr>
                                            </con1:assign>
                                            <con1:assign varName="REQUESTOTHERCHEQUE">
                                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e1e</con:id>
                                              <con1:expr>
                                                <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                                  <con4:resource ref="Middleware/Business_Resources/pagoPrestamo/debitoPrestamoChequeLocal/debitoPrestamoChequeLocalIn"/>
                                                  <con4:param name="autenticacionRequestHeader">
                                                    <con4:path>$header/aut:AutenticacionRequestHeader</con4:path>
                                                  </con4:param>
                                                  <con4:param name="depositAccount">
                                                    <con4:path>$depositAccount</con4:path>
                                                  </con4:param>
                                                  <con4:param name="pagoPrestamo">
                                                    <con4:path>$body/pag:pagoPrestamo</con4:path>
                                                  </con4:param>
                                                  <con4:param name="uuid">
                                                    <con4:path>fn:string($uuid)</con4:path>
                                                  </con4:param>
                                                </con4:xqueryTransform>
                                              </con1:expr>
                                            </con1:assign>
                                          </con1:actions>
                                        </con1:case>
                                        <con1:case>
                                          <con1:condition>
                                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($currencyPrestamo)) = "USD"</con3:xqueryText>
                                          </con1:condition>
                                          <con1:actions>
                                            <con1:assign varName="depositAccount">
                                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e1d</con:id>
                                              <con1:expr>
                                                <con4:xqueryText xmlns:con4="http://www.bea.com/wli/sb/stages/config">fn:string($RESPONSEobtenerParametrizacion/osb2:CONFIGURACIONES/osb2:CONFIGURACIONES_ITEM[osb2:NAME="T24T032.USDOBCHQACCTNO"]/osb2:VALUE/text())</con4:xqueryText>
                                              </con1:expr>
                                            </con1:assign>
                                            <con1:assign varName="REQUESTOTHERCHEQUE">
                                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e1c</con:id>
                                              <con1:expr>
                                                <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                                  <con4:resource ref="Middleware/Business_Resources/pagoPrestamo/debitoPrestamoChequeExtranjera/debitoPrestamoChequeExtranjeraIn"/>
                                                  <con4:param name="autenticacionRequestHeader">
                                                    <con4:path>$header/aut:AutenticacionRequestHeader</con4:path>
                                                  </con4:param>
                                                  <con4:param name="depositAccount">
                                                    <con4:path>$depositAccount</con4:path>
                                                  </con4:param>
                                                  <con4:param name="pagoPrestamo">
                                                    <con4:path>$body/pag:pagoPrestamo</con4:path>
                                                  </con4:param>
                                                  <con4:param name="uuid">
                                                    <con4:path>fn:string($uuid)</con4:path>
                                                  </con4:param>
                                                </con4:xqueryTransform>
                                              </con1:expr>
                                            </con1:assign>
                                          </con1:actions>
                                        </con1:case>
                                      </con1:ifThenElse>
                                    </con1:requestTransform>
                                    <con1:responseTransform/>
                                  </con1:wsCallout>
                                  <con1:assign varName="successIndicator">
                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e1a</con:id>
                                    <con1:expr>
                                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/successIndicator/text()</con3:xqueryText>
                                    </con1:expr>
                                  </con1:assign>
                                  <con1:assign varName="transactionId">
                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e19</con:id>
                                    <con1:expr>
                                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/transactionId/text()</con3:xqueryText>
                                    </con1:expr>
                                  </con1:assign>
                                  <con1:assign varName="valueDate">
                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e18</con:id>
                                    <con1:expr>
                                      <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/TELLERFINANCIALSERVICESType/gTRANSACTION/mTRANSACTION/DRVALUEDATE/text()</con3:xqueryText>
                                    </con1:expr>
                                  </con1:assign>
                                  <con1:ifThenElse>
                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e17</con:id>
                                    <con1:case>
                                      <con1:condition>
                                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($currencyPrestamo)) = "HNL" or
fn:upper-case(fn:string($currencyPrestamo)) = "USD"</con3:xqueryText>
                                      </con1:condition>
                                      <con1:actions>
                                        <con1:ifThenElse>
                                          <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e16</con:id>
                                          <con1:case>
                                            <con1:condition>
                                              <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicator)) = "SUCCESS"</con3:xqueryText>
                                            </con1:condition>
                                            <con1:actions>
                                              <con1:wsCallout>
                                                <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e14</con:id>
                                                <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/pagoPrestamo/Resources/pagoPrestamoT24BS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con1:operation>pagoPrestamoT24</con1:operation>
                                                <con1:request>
                                                  <con1:body>$REQUESTABANKS</con1:body>
                                                </con1:request>
                                                <con1:response>
                                                  <con1:body>RESPONSEABANKS</con1:body>
                                                </con1:response>
                                                <con1:requestTransform>
                                                  <con1:assign varName="REQUESTABANKS">
                                                    <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e15</con:id>
                                                    <con1:expr>
                                                      <con4:xqueryTransform xmlns:con4="http://www.bea.com/wli/sb/stages/config">
                                                        <con4:resource ref="Middleware/Business_Resources/pagoPrestamo/pagoPrestamo/pagoPrestamoIn"/>
                                                        <con4:param name="autenticacionRequestHeader">
                                                          <con4:path>$header/aut:AutenticacionRequestHeader</con4:path>
                                                        </con4:param>
                                                        <con4:param name="transactionID">
                                                          <con4:path>fn:string($transactionId)</con4:path>
                                                        </con4:param>
                                                        <con4:param name="pagoPrestamo">
                                                          <con4:path>$body/pag:pagoPrestamo</con4:path>
                                                        </con4:param>
                                                      </con4:xqueryTransform>
                                                    </con1:expr>
                                                  </con1:assign>
                                                </con1:requestTransform>
                                                <con1:responseTransform/>
                                              </con1:wsCallout>
                                              <con1:assign varName="successIndicatorAbanks">
                                                <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e13</con:id>
                                                <con1:expr>
                                                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSEABANKS/osb1:ERROR_CODE/text()</con3:xqueryText>
                                                </con1:expr>
                                              </con1:assign>
                                              <con1:ifThenElse>
                                                <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e12</con:id>
                                                <con1:case>
                                                  <con1:condition>
                                                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:upper-case(fn:string($successIndicatorAbanks)) != "SUCCESS"</con3:xqueryText>
                                                  </con1:condition>
                                                  <con1:actions>
                                                    <con1:wsCallout>
                                                      <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e0f</con:id>
                                                      <con1:service xsi:type="ref:ProxyRef" ref="Middleware/OperationsAndExecution/CustomerDeposits/ReversarTransaccion" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                      <con1:operation>reversarTransaccion</con1:operation>
                                                      <con1:request>
                                                        <con1:body>$REQUESTREVTRAN</con1:body>
                                                        <con1:header>$REQUESTHEADER</con1:header>
                                                      </con1:request>
                                                      <con1:response>
                                                        <con1:body>RESPONSEREVTRAN</con1:body>
                                                        <con1:header>RESPONSEHEADER</con1:header>
                                                      </con1:response>
                                                      <con1:requestTransform>
                                                        <con1:assign varName="REQUESTREVTRAN">
                                                          <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e11</con:id>
                                                          <con1:expr>
                                                            <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                                                              <con3:resource ref="Middleware/Business_Resources/pagoPrestamo/reversarTransaccion/reversarTransaccionIn"/>
                                                              <con3:param name="transactionId">
                                                                <con3:path>$transactionId</con3:path>
                                                              </con3:param>
                                                            </con3:xqueryTransform>
                                                          </con1:expr>
                                                        </con1:assign>
                                                        <con1:assign varName="REQUESTHEADER">
                                                          <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e10</con:id>
                                                          <con1:expr>
                                                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$header</con3:xqueryText>
                                                          </con1:expr>
                                                        </con1:assign>
                                                      </con1:requestTransform>
                                                      <con1:responseTransform/>
                                                    </con1:wsCallout>
                                                    <con1:assign varName="message">
                                                      <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e0e</con:id>
                                                      <con1:expr>
                                                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSEABANKS/osb1:ERROR_MESSAGE/text()</con3:xqueryText>
                                                      </con1:expr>
                                                    </con1:assign>
                                                  </con1:actions>
                                                </con1:case>
                                                <con1:default/>
                                              </con1:ifThenElse>
                                            </con1:actions>
                                          </con1:case>
                                          <con1:default>
                                            <con1:assign varName="message">
                                              <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e0d</con:id>
                                              <con1:expr>
                                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSETRAN/Status/messages/text()</con3:xqueryText>
                                              </con1:expr>
                                            </con1:assign>
                                          </con1:default>
                                        </con1:ifThenElse>
                                      </con1:actions>
                                    </con1:case>
                                    <con1:default/>
                                  </con1:ifThenElse>
                                </con1:actions>
                              </con1:case>
                              <con1:default>
                                <con1:assign varName="message">
                                  <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e0c</con:id>
                                  <con1:expr>
                                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$RESPONSECONPRES/osb:ERROR_MESSAGE/text()</con3:xqueryText>
                                  </con1:expr>
                                </con1:assign>
                              </con1:default>
                            </con1:ifThenElse>
                          </con1:actions>
                        </con1:case>
                        <con1:default/>
                      </con1:ifThenElse>
                    </con1:actions>
                  </con1:case>
                  <con1:default>
                    <con1:assign varName="message">
                      <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e0b</con:id>
                      <con1:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">"PAYMENT TYPE NOT SUPPORTED"</con3:xqueryText>
                      </con1:expr>
                    </con1:assign>
                  </con1:default>
                </con1:ifThenElse>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:assign varName="message">
                <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e0a</con:id>
                <con1:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">"REQUIRED FIELDS NOT SUPPLIED"</con3:xqueryText>
                </con1:expr>
              </con1:assign>
            </con1:default>
          </con1:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="ABANKS_response">
      <con3:stage name="Abanks_proxyResponse">
        <con3:context>
          <con2:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
          <con2:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag" xmlns:con2="http://www.bea.com/wli/sb/stages/config"/>
        </con3:context>
        <con3:actions>
          <con1:ifThenElse>
            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e09</con:id>
            <con1:case>
              <con1:condition>
                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:string($message) != ""</con3:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:replace contents-only="true" varName="header">
                  <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e08</con:id>
                  <con1:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config"><![CDATA[<aut:ResponseHeader>
      <successIndicator>ERROR</successIndicator>
      <messages>{$message}</messages>
</aut:ResponseHeader>]]></con3:xqueryText>
                  </con1:expr>
                </con1:replace>
                <con1:replace contents-only="true" varName="body">
                  <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e07</con:id>
                  <con1:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">&lt;pag:pagoPrestamoResponse/></con3:xqueryText>
                  </con1:expr>
                </con1:replace>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con1:replace contents-only="true" varName="header">
                <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e06</con:id>
                <con1:expr>
                  <con3:xqueryTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                    <con3:resource ref="Middleware/Business_Resources/pagoPrestamo/pagoPrestamo/pagoPrestamoHeaderOut"/>
                    <con3:param name="valueDate">
                      <con3:path>$valueDate</con3:path>
                    </con3:param>
                    <con3:param name="outputParameters">
                      <con3:path>$RESPONSEABANKS</con3:path>
                    </con3:param>
                    <con3:param name="transactionId">
                      <con3:path>$transactionId</con3:path>
                    </con3:param>
                  </con3:xqueryTransform>
                </con1:expr>
              </con1:replace>
              <con1:replace contents-only="true" varName="body">
                <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7e05</con:id>
                <con1:expr>
                  <con:xqueryTransform>
                    <con:resource ref="Middleware/Business_Resources/pagoPrestamo/pagoPrestamo/pagoPrestamoOut"/>
                    <con:param name="outputParameters">
                      <con:path>$RESPONSEABANKS</con:path>
                    </con:param>
                    <con:param name="responseLoanNumber">
                      <con:path>$responseLoanNumber</con:path>
                    </con:param>
                  </con:xqueryTransform>
                </con1:expr>
              </con1:replace>
            </con1:default>
          </con1:ifThenElse>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="request" name="ERROR_request">
      <con3:stage name="ERROR_proxyRequest">
        <con3:context/>
        <con3:actions>
          <con1:Error>
            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7de3</con:id>
            <con1:errCode>MW-0002</con1:errCode>
            <con1:message>INVALID REQUEST</con1:message>
          </con1:Error>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="ERROR_response"/>
    <con3:pipeline type="request" name="T24_request">
      <con3:stage name="T24_proxyRequest">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
        </con3:context>
        <con3:actions>
          <con1:assign varName="uuid">
            <con:id>_ActionId-3669932689554374836--268044f.14d5373caba.-7be5</con:id>
            <con1:expr>
              <con:xqueryTransform>
                <con:resource ref="Middleware/Business_Resources/general/UUID/obtenerUUID"/>
              </con:xqueryTransform>
            </con1:expr>
          </con1:assign>
          <con1:wsCallout>
            <con:id>_ActionId-4731110751785338129--25cce304.14e268cd3f2.-7fea</con:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/ConsultasCuenta/Resources/consultaCuentasBS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>Consultadedetallesdelacuenta</con1:operation>
            <con1:request>
              <con1:body>$REQConsCuenta</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>RSPConsCuenta</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="REQConsCuenta">
                <con:id>_ActionId-4731110751785338129--25cce304.14e268cd3f2.-7fd0</con:id>
                <con1:expr>
                  <con:xqueryTransform>
                    <con:resource ref="Middleware/Business_Resources/pagoPrestamo/pagoPrestamo/consultaCuentaIn"/>
                    <con:param name="autenticacionRequestHeader1">
                      <con:path>$header/aut:AutenticacionRequestHeader</con:path>
                    </con:param>
                    <con:param name="pagoPrestamo1">
                      <con:path>$body/pag:pagoPrestamo</con:path>
                    </con:param>
                  </con:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con1:requestTransform>
            <con1:responseTransform>
              <con1:assign varName="t24Account">
                <con:id>_ActionId-4731110751785338129--25cce304.14e268cd3f2.-7fb9</con:id>
                <con1:expr>
                  <con:xqueryText>fn:string($RSPConsCuenta/WSACCOUNTLISTType/gWSACCOUNTLISTDetailType/mWSACCOUNTLISTDetailType/ID/text())</con:xqueryText>
                </con1:expr>
              </con1:assign>
            </con1:responseTransform>
          </con1:wsCallout>
          <con1:wsCallout>
            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7dc5</con:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/consultaGeneralPrestamo/Resources/PrestamosT24BS" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
            <con1:operation>PagoaprestamoAAFT</con1:operation>
            <con1:request>
              <con1:body>$REQPagoPtmoT24</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>RSPPagoPtmoT24</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="REQPagoPtmoT24">
                <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7d8b</con:id>
                <con1:expr>
                  <con:xqueryTransform>
                    <con:resource ref="Middleware/Business_Resources/pagoPrestamo/pagoPrestamo/pagoPrestamoT24In"/>
                    <con:param name="t24DebitAccount">
                      <con:path>$t24Account</con:path>
                    </con:param>
                    <con:param name="uuid">
                      <con:path>$uuid</con:path>
                    </con:param>
                    <con:param name="autenticacionRequestHeader1">
                      <con:path>$header/aut:AutenticacionRequestHeader</con:path>
                    </con:param>
                    <con:param name="pagoPrestamo1">
                      <con:path>$body/pag:pagoPrestamo</con:path>
                    </con:param>
                  </con:xqueryTransform>
                </con1:expr>
              </con1:assign>
            </con1:requestTransform>
            <con1:responseTransform>
              <con1:assign varName="successIndicator">
                <con:id>_ActionId-4731110751785338129--25cce304.14e268cd3f2.-7f9c</con:id>
                <con1:expr>
                  <con:xqueryText>fn:string($RSPPagoPtmoT24/Status/successIndicator/text())</con:xqueryText>
                </con1:expr>
              </con1:assign>
            </con1:responseTransform>
          </con1:wsCallout>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="response" name="T24_response">
      <con3:stage name="T24_proxyResponse">
        <con3:context>
          <con:userNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/sjConsultaPrestamoTypes" prefix="cons"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/autType" prefix="aut"/>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
        </con3:context>
        <con3:actions>
          <con1:ifThenElse>
            <con:comment>Condicin para determinar si operacin de dbito fue exitosa. En tal caso, se procede a confirmar el pago del prstamo. Las posibles respuestas son:

1) Prstamo no fue pagado
2) Prstamo si fue pagado</con:comment>
            <con:id>_ActionId-7119297384952391353-5ab1857.14d8c907025.-740b</con:id>
            <con1:case>
              <con1:condition>
                <con:xqueryText>$successIndicator = "Success"</con:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:wsCallout>
                  <con:id>_ActionId-7119297384952391353-5ab1857.14d8c907025.-73df</con:id>
                  <con1:service xsi:type="ref:BusinessServiceRef" ref="Middleware/Business_Resources/detalleMovimientosT24/consultarPagoPtmoAA/biz/sjConsultaPrestamo" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                  <con1:operation>sjConsultaPrestamo</con1:operation>
                  <con1:request>
                    <con1:body>$REQConsPagoPtmo</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>RSPConsPagoPtmo</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="REQConsPagoPtmo">
                      <con:id>_ActionId-7119297384952391353-5ab1857.14d8c907025.-73bc</con:id>
                      <con1:expr>
                        <con:xqueryTransform>
                          <con:resource ref="Middleware/Business_Resources/pagoPrestamo/pagoPrestamo/consultaPagoPtmoT24In"/>
                          <con:param name="autenticacionRequestHeader1">
                            <con:path>$header/aut:AutenticacionRequestHeader</con:path>
                          </con:param>
                          <con:param name="transactionId">
                            <con:path>fn:string($RSPPagoPtmoT24/Status/transactionId/text())</con:path>
                          </con:param>
                          <con:param name="pagoPrestamo1">
                            <con:path>$body/pag:pagoPrestamo</con:path>
                          </con:param>
                        </con:xqueryTransform>
                      </con1:expr>
                    </con1:assign>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con1:replace varName="successIndicator" contents-only="false">
                      <con:id>_ActionId-4731110751785338129--25cce304.14e268cd3f2.-7f7a</con:id>
                      <con1:expr>
                        <con:xqueryText>fn:string($RSPConsPagoPtmo/cons:sjConsultaPrestamoResponseType/cons:consultaAplicaPagoPrestamo/SUCCESS_INDICATOR/text())</con:xqueryText>
                      </con1:expr>
                    </con1:replace>
                  </con1:responseTransform>
                </con1:wsCallout>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
          <con1:replace varName="body" contents-only="true">
            <con:id>_ActionId-3669932689554374836--268044f.14d5373caba.-7c89</con:id>
            <con1:expr>
              <con:xqueryTransform>
                <con:resource ref="Middleware/Business_Resources/pagoPrestamo/pagoPrestamo/pagoPrestamoT24Out"/>
                <con:param name="pagoaprestamoAAFTResponse1">
                  <con:path>$RSPPagoPtmoT24</con:path>
                </con:param>
                <con:param name="successIndicatorQry2">
                  <con:path>$successIndicator</con:path>
                </con:param>
              </con:xqueryTransform>
            </con1:expr>
          </con1:replace>
          <con1:replace varName="header" contents-only="true">
            <con:id>_ActionId-831901157828439466-25ca8791.14b6f054456.-7c1c</con:id>
            <con1:expr>
              <con:xqueryTransform>
                <con:resource ref="Middleware/Business_Resources/pagoPrestamo/pagoPrestamo/pagoPrestamoT24HeaderOut"/>
                <con:param name="pagoaprestamoAAFTResponse1">
                  <con:path>$RSPPagoPtmoT24</con:path>
                </con:param>
                <con:param name="successIndicatorQry2">
                  <con:path>$successIndicator</con:path>
                </con:param>
              </con:xqueryTransform>
            </con1:expr>
          </con1:replace>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con3:pipeline type="error" name="_onErrorHandler-2771357923723315984-3a468d12.14fd756875e.-7ea0">
      <con3:stage name="valid_proxyFault">
        <con3:context>
          <con:varNsDecl namespace="http://www.ficohsa.com.hn/middleware.services/pagoPrestamoTypes" prefix="pag"/>
        </con3:context>
        <con3:actions>
          <con1:assign varName="loanType">
            <con:id>_ActionId-2771357923723315984-3a468d12.14fd756875e.-7e8d</con:id>
            <con1:expr>
              <con:xqueryTransform>
                <con:resource ref="Middleware/Business_Resources/pagoPrestamo/consultaGeneralPrestamo/validarTipoPrestamo"/>
                <con:param name="NumeroPrestamo">
                  <con:path>fn:string($body/pag:pagoPrestamo/LOAN_NUMBER/text())</con:path>
                </con:param>
              </con:xqueryTransform>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="responseLoanNumber">
            <con:id>_ActionId-2955661912422161236-14bac7d5.15416d182bf.-7f80</con:id>
            <con1:expr>
              <con:xqueryText>fn:string($body/pag:pagoPrestamo/LOAN_NUMBER/text())</con:xqueryText>
            </con1:expr>
          </con1:assign>
        </con3:actions>
      </con3:stage>
    </con3:pipeline>
    <con:flow xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:pipeline-node name="VALIDATION">
        <con:request>VALIDATION_request</con:request>
        <con:response>VALIDATION_response</con:response>
      </con:pipeline-node>
      <con:branch-node type="condition" name="LOAN_PAYMENT">
        <con:context/>
        <con:branch-table variable="loanType">
          <con:branch name="Abanks">
            <con:operator>equals</con:operator>
            <con:value>"ABANKS"</con:value>
            <con:flow>
              <con:pipeline-node name="ABANKS">
                <con:request>ABANKS_request</con:request>
                <con:response>ABANKS_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:branch>
          <con:branch name="T24">
            <con:operator>equals</con:operator>
            <con:value>"T24"</con:value>
            <con:flow>
              <con:pipeline-node name="T24">
                <con:request>T24_request</con:request>
                <con:response>T24_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:branch>
          <con:default-branch>
            <con:flow>
              <con:pipeline-node name="ERROR">
                <con:request>ERROR_request</con:request>
                <con:response>ERROR_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:default-branch>
        </con:branch-table>
      </con:branch-node>
    </con:flow>
  </ser:router>
</xml-fragment>