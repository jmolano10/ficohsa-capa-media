<?xml version="1.0" encoding="UTF-8"?>
<con:templateEntry xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config" xmlns:con4="http://www.bea.com/wli/sb/stages/logging/config">
    <con:coreEntry>
        <con:binding type="SOAP" xsi:type="con:AnyWsdlSoapBindingType"/>
    </con:coreEntry>
    <con:router errorHandler="error-N3f57febe.554e3982.0.18887fcde33.N7fe8">
        <con:pipeline type="request" name="request-N3f57febe.554e3982.0.18887fcde33.N7fec">
            <con:stage id="_StageId-N53e8f51d.35e251e5.0.188ba5d7581.N7fdd" name="StageAssigment">
                <con:context/>
                <con:actions>
                    <con3:assign varName="service">
                        <con1:id>_ActionId-N53e8f51a.726ae5a9.0.188e8c2827c.N7fef</con1:id>
                        <con3:expr>
                            <con1:xqueryText>''</con1:xqueryText>
                        </con3:expr>
                    </con3:assign>
                    <con3:assign varName="version">
                        <con1:id>_ActionId-N53e8f51a.726ae5a9.0.188e8c2827c.N7fec</con1:id>
                        <con3:expr>
                            <con1:xqueryText>''</con1:xqueryText>
                        </con3:expr>
                    </con3:assign>
                    <con3:assign varName="key">
                        <con1:id>_ActionId-N53e8f51a.726ae5a9.0.188e8c2827c.N7fe9</con1:id>
                        <con3:expr>
                            <con1:xqueryText>''</con1:xqueryText>
                        </con3:expr>
                    </con3:assign>
                    <con3:assign varName="value">
                        <con1:id>_ActionId-N53e8f51a.726ae5a9.0.188e8c2827c.N7fe6</con1:id>
                        <con3:expr>
                            <con1:xqueryText>''</con1:xqueryText>
                        </con3:expr>
                    </con3:assign>
                    <con3:assign varName="method">
                        <con1:id>_ActionId-N53e8f51a.726ae5a9.0.188e8c2827c.N7fdf</con1:id>
                        <con3:expr>
                            <con1:xqueryText>''</con1:xqueryText>
                        </con3:expr>
                    </con3:assign>
                    <con3:assign varName="operationTargetSystem">
                        <con1:id>_ActionId-N53e8019e.N7510cf7d.0.188f86e3e52.N7ff1</con1:id>
                        <con3:expr>
                            <con1:xqueryText>''</con1:xqueryText>
                        </con3:expr>
                    </con3:assign>
                    <con3:assign varName="targetSystem">
                        <con1:id>_ActionId-N53e8f51a.726ae5a9.0.188e8c2827c.N7fe2</con1:id>
                        <con3:expr>
                            <con1:xqueryText>''</con1:xqueryText>
                        </con3:expr>
                    </con3:assign>
                    <con3:assign varName="security">
                        <con1:id>_ActionId-N53e8f53c.4899850f.0.18903e482a7.N7fcb</con1:id>
                        <con3:expr>
                            <con1:xqueryText>'Y'</con1:xqueryText>
                        </con3:expr>
                    </con3:assign>
                    <con3:assign varName="originalBody">
                        <con1:id>_ActionId-N53e8f51d.35e251e5.0.188ba5d7581.N7fda</con1:id>
                        <con3:expr>
                            <con1:xqueryText>$body</con1:xqueryText>
                        </con3:expr>
                    </con3:assign>
                    <con3:assign varName="user">
                        <con1:id>_ActionId-N53e8f51a.726ae5a9.0.188e8c2827c.N7f6e</con1:id>
                        <con3:expr>
                            <con1:xqueryText>data($body//GeneralInfo/ApplicationId)</con1:xqueryText>
                        </con3:expr>
                    </con3:assign>
                </con:actions>
            </con:stage>
            <con:placeholder-node id="PlaceholderID_N53e8b9bd.6a339f49.0.18f997fe7b3.N7d86" name="GetSecurity"/>
            <con:placeholder-node id="PlaceholderID_N53e8b9bd.6a339f49.0.18f997fe7b3.N7eb0" name="StageEnrichInput"/>
            <con:placeholder-node id="PlaceholderID_N3f57febe.554e3982.0.18887fcde33.N7fe6" name="TransformRegionalToTargetSystem"/>
            <con:stage id="_StageId-N3f57febe.554e3982.0.18887fcde33.N7fea" name="StageLogginInput">
                <con:context/>
                <con:actions>
                    <con3:assign varName="requestServiceOri">
                        <con1:id>_ActionId-N53e8f51d.32e1e599.0.188bb9fcd51.N7fe8</con1:id>
                        <con3:expr>
                            <con1:xqueryText>$requestService</con1:xqueryText>
                        </con3:expr>
                    </con3:assign>
                    <con3:ifThenElse>
                        <con1:id>_ActionId-N53e8f53c.4899850f.0.18903e482a7.N7fd4</con1:id>
                        <con3:case id="_BranchId-N53e8f53c.4899850f.0.18903e482a7.N7fd3">
                            <con3:condition>
                                <con1:xqueryText>$security= 'Y'</con1:xqueryText>
                            </con3:condition>
                            <con3:actions>
                                <con3:replace varName="requestServiceOri" contents-only="true">
                                    <con1:id>_ActionId-N53e8f51d.32e1e599.0.188bb9fcd51.N7fe5</con1:id>
                                    <con3:location>
                                        <con1:xpathText>.//WebRequestCommon/password</con1:xpathText>
                                    </con3:location>
                                    <con3:expr>
                                        <con1:xqueryText>''</con1:xqueryText>
                                    </con3:expr>
                                </con3:replace>
                            </con3:actions>
                        </con3:case>
                        <con3:default/>
                    </con3:ifThenElse>
                    <con2:route>
                        <con1:id>_ActionId-N53e8007b.N5582fe2b.0.188b51b3f1c.N7f4b</con1:id>
                        <con2:service ref="SBRG_MassivePayment_Commons/BS/LoggingRegionalRestBS" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>SaveLogInFileSystem</con2:operation>
                        <con2:outboundTransform>
                            <con3:replace varName="body" contents-only="true">
                                <con1:id>_ActionId-N53e8f51a.726ae5a9.0.188e8c2827c.N7fdc</con1:id>
                                <con3:expr>
                                    <con1:xqueryTransform>
                                        <con1:resource ref="SBRG_MassivePayment_Commons/Transformations/ServiceToLog"/>
                                        <con1:param name="destinationBank">
                                            <con1:path>data($body//GeneralInfo/DestinationBank)</con1:path>
                                        </con1:param>
                                        <con1:param name="method">
                                            <con1:path>$method</con1:path>
                                        </con1:param>
                                        <con1:param name="errorFlowName">
                                            <con1:path>''</con1:path>
                                        </con1:param>
                                        <con1:param name="channel">
                                            <con1:path>$user</con1:path>
                                        </con1:param>
                                        <con1:param name="messageError">
                                            <con1:path>''</con1:path>
                                        </con1:param>
                                        <con1:param name="body">
                                            <con1:path>$requestServiceOri</con1:path>
                                        </con1:param>
                                        <con1:param name="version">
                                            <con1:path>$version</con1:path>
                                        </con1:param>
                                        <con1:param name="targetSystem">
                                            <con1:path>$targetSystem</con1:path>
                                        </con1:param>
                                        <con1:param name="GlobalId">
                                            <con1:path>data($body//GeneralInfo/GlobalId)</con1:path>
                                        </con1:param>
                                        <con1:param name="sourceBank">
                                            <con1:path>data($body//GeneralInfo/SourceBank)</con1:path>
                                        </con1:param>
                                        <con1:param name="endpoint">
                                            <con1:path>$inbound/ctx:transport/ctx:uri/text()</con1:path>
                                        </con1:param>
                                        <con1:param name="messageType">
                                            <con1:path>'REQUEST'</con1:path>
                                        </con1:param>
                                        <con1:param name="service">
                                            <con1:path>$service</con1:path>
                                        </con1:param>
                                        <con1:param name="codeError">
                                            <con1:path>''</con1:path>
                                        </con1:param>
                                        <con1:param name="state">
                                            <con1:path>''</con1:path>
                                        </con1:param>
                                        <con1:param name="operation">
                                            <con1:path>$operationTargetSystem</con1:path>
                                        </con1:param>
                                        <con1:param name="value">
                                            <con1:path>$value</con1:path>
                                        </con1:param>
                                        <con1:param name="user">
                                            <con1:path>$user</con1:path>
                                        </con1:param>
                                        <con1:param name="parameters">
                                            <con1:path>''</con1:path>
                                        </con1:param>
                                        <con1:param name="key">
                                            <con1:path>$key</con1:path>
                                        </con1:param>
                                        <con1:param name="errorDetails">
                                            <con1:path>''</con1:path>
                                        </con1:param>
                                    </con1:xqueryTransform>
                                </con3:expr>
                            </con3:replace>
                        </con2:outboundTransform>
                    </con2:route>
                </con:actions>
            </con:stage>
            <con:placeholder-node id="PlaceholderID_N3f57febe.554e3982.0.18887fcde33.N7fe5" name="InvokeTargetSystem"/>
            <con:stage id="_StageId-N3f57febe.554e3982.0.18887fcde33.N7fe9" name="StageLoggingOutput">
                <con:context/>
                <con:actions>
                    <con2:route>
                        <con1:id>_ActionId-N53e8007b.N5582fe2b.0.188b51b3f1c.N7f48</con1:id>
                        <con2:service ref="SBRG_MassivePayment_Commons/BS/LoggingRegionalRestBS" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>SaveLogInFileSystem</con2:operation>
                        <con2:outboundTransform>
                            <con3:replace contents-only="true" varName="body">
                                <con1:id>_ActionId-N53e8f51a.726ae5a9.0.188e8c2827c.N7fd2</con1:id>
                                <con3:expr>
                                    <con1:xqueryTransform>
                                        <con1:resource ref="SBRG_MassivePayment_Commons/Transformations/ServiceToLog"/>
                                        <con1:param name="destinationBank">
                                            <con1:path>data($body//GeneralInfo/DestinationBank)</con1:path>
                                        </con1:param>
                                        <con1:param name="method">
                                            <con1:path>$method</con1:path>
                                        </con1:param>
                                        <con1:param name="errorFlowName">
                                            <con1:path>''</con1:path>
                                        </con1:param>
                                        <con1:param name="channel">
                                            <con1:path>$user</con1:path>
                                        </con1:param>
                                        <con1:param name="messageError">
                                            <con1:path>$messageErrorService</con1:path>
                                        </con1:param>
                                        <con1:param name="body">
                                            <con1:path>$responseService</con1:path>
                                        </con1:param>
                                        <con1:param name="version">
                                            <con1:path>$version</con1:path>
                                        </con1:param>
                                        <con1:param name="targetSystem">
                                            <con1:path>$targetSystem</con1:path>
                                        </con1:param>
                                        <con1:param name="GlobalId">
                                            <con1:path>data($body//GeneralInfo/GlobalId)</con1:path>
                                        </con1:param>
                                        <con1:param name="sourceBank">
                                            <con1:path>data($body//GeneralInfo/SourceBank)</con1:path>
                                        </con1:param>
                                        <con1:param name="endpoint">
                                            <con1:path>$inbound/ctx:transport/ctx:uri/text()</con1:path>
                                        </con1:param>
                                        <con1:param name="messageType">
                                            <con1:path>'RESPONSE'</con1:path>
                                        </con1:param>
                                        <con1:param name="service">
                                            <con1:path>$service</con1:path>
                                        </con1:param>
                                        <con1:param name="codeError">
                                            <con1:path>$codeErrorService</con1:path>
                                        </con1:param>
                                        <con1:param name="state">
                                            <con1:path>$statusService</con1:path>
                                        </con1:param>
                                        <con1:param name="operation">
                                            <con1:path>$operationTargetSystem</con1:path>
                                        </con1:param>
                                        <con1:param name="value">
                                            <con1:path>$value</con1:path>
                                        </con1:param>
                                        <con1:param name="user">
                                            <con1:path>$user</con1:path>
                                        </con1:param>
                                        <con1:param name="parameters">
                                            <con1:path>''</con1:path>
                                        </con1:param>
                                        <con1:param name="key">
                                            <con1:path>$key</con1:path>
                                        </con1:param>
                                        <con1:param name="errorDetails">
                                            <con1:path>''</con1:path>
                                        </con1:param>
                                    </con1:xqueryTransform>
                                </con3:expr>
                            </con3:replace>
                        </con2:outboundTransform>
                    </con2:route>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline type="response" name="response-N3f57febe.554e3982.0.18887fcde33.N7feb">
            <con:placeholder-node id="PlaceholderID_N53e8b9bd.6a339f49.0.18f997fe7b3.N7eaf" name="StageEnrichOutput"/>
            <con:placeholder-node id="PlaceholderID_N3f57febe.554e3982.0.18887fcde33.N7fdd" name="TransformTargetSystemToRegional"/>
        </con:pipeline>
        <con:pipeline type="error" name="error-N3f57febe.554e3982.0.18887fcde33.N7fe8">
            <con:stage id="_StageId-N3f57febe.554e3982.0.18887fcde33.N7fe7" name="StageIT">
                <con:context/>
                <con:actions>
                    <con4:report>
                        <con1:id>_ActionId-N53e8007b.N5582fe2b.0.188b51b3f1c.N7f35</con1:id>
                        <con4:expr>
                            <con1:xqueryText>$body</con1:xqueryText>
                        </con4:expr>
                        <con4:labels>
                            <con4:key>code</con4:key>
                            <con4:varName>fault</con4:varName>
                            <con4:value>
                                <con1:xpathText>./ctx:errorCode</con1:xpathText>
                            </con4:value>
                        </con4:labels>
                        <con4:labels>
                            <con4:key>reason</con4:key>
                            <con4:varName>fault</con4:varName>
                            <con4:value>
                                <con1:xpathText>./ctx:reason</con1:xpathText>
                            </con4:value>
                        </con4:labels>
                        <con4:labels>
                            <con4:key>uuid</con4:key>
                            <con4:varName>body</con4:varName>
                            <con4:value>
                                <con1:xpathText>.//GeneralInfo/GlobalId</con1:xpathText>
                            </con4:value>
                        </con4:labels>
                    </con4:report>
                    <con4:report>
                        <con1:id>_ActionId-N53e8007b.N5582fe2b.0.188b51b3f1c.N7f32</con1:id>
                        <con4:expr>
                            <con1:xqueryText>$fault</con1:xqueryText>
                        </con4:expr>
                        <con4:labels>
                            <con4:key>code</con4:key>
                            <con4:varName>fault</con4:varName>
                            <con4:value>
                                <con1:xpathText>./ctx:errorCode</con1:xpathText>
                            </con4:value>
                        </con4:labels>
                        <con4:labels>
                            <con4:key>reason</con4:key>
                            <con4:varName>fault</con4:varName>
                            <con4:value>
                                <con1:xpathText>./ctx:reason</con1:xpathText>
                            </con4:value>
                        </con4:labels>
                        <con4:labels>
                            <con4:key>uuid</con4:key>
                            <con4:varName>body</con4:varName>
                            <con4:value>
                                <con1:xpathText>.//GeneralInfo/GlobalId</con1:xpathText>
                            </con4:value>
                        </con4:labels>
                    </con4:report>
                </con:actions>
            </con:stage>
            <con:stage id="_StageId-N3f57febe.554e3982.0.18887fcde33.N7fe3" name="StageMappingErrors">
                <con:context/>
                <con:actions>
                    <con3:wsCallout>
                        <con1:id>_ActionId-N53e8007b.N5582fe2b.0.188b51b3f1c.N7f2e</con1:id>
                        <con3:service ref="SBRG_MassivePayment_Commons/BS/GetCustomErrorByStackTraceRegionalRestBS" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con3:operation>process</con3:operation>
                        <con3:request>
                            <con3:body wrapped="false">requestError</con3:body>
                        </con3:request>
                        <con3:response>
                            <con3:body wrapped="false">responseError</con3:body>
                        </con3:response>
                        <con3:requestTransform>
                            <con3:replace contents-only="false" varName="requestError">
                                <con1:id>_ActionId-N53e8f51a.726ae5a9.0.188e8c2827c.N7fce</con1:id>
                                <con3:expr>
                                    <con1:xqueryTransform>
                                        <con1:resource ref="SBRG_MassivePayment_Commons/Transformations/ServicesToError"/>
                                        <con1:param name="systemApplication">
                                            <con1:path>'OSB'</con1:path>
                                        </con1:param>
                                        <con1:param name="service">
                                            <con1:path>$service</con1:path>
                                        </con1:param>
                                        <con1:param name="errorMessage">
                                            <con1:path>$fault/ctx:reason/text()</con1:path>
                                        </con1:param>
                                        <con1:param name="errorCode">
                                            <con1:path>$fault/ctx:errorCode/text()</con1:path>
                                        </con1:param>
                                        <con1:param name="language">
                                            <con1:path>data($body//GeneralInfo/Language)</con1:path>
                                        </con1:param>
                                    </con1:xqueryTransform>
                                </con3:expr>
                            </con3:replace>
                        </con3:requestTransform>
                        <con3:responseTransform/>
                    </con3:wsCallout>
                </con:actions>
            </con:stage>
            <con:placeholder-node id="PlaceholderID_N3f57febe.554e3982.0.18887fcde33.N7fe2" name="TransformResponse"/>
            <con:stage id="_StageId-N53e80115.N3e1c0fc9.0.188fd483d85.N7fcc" name="StageLoggingOutputError">
                <con:context/>
                <con:actions>
                    <con2:route>
                        <con1:id>_ActionId-N53e80115.N3e1c0fc9.0.188fd483d85.N7fc9</con1:id>
                        <con2:service ref="SBRG_MassivePayment_Commons/BS/LoggingRegionalRestBS" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:operation>SaveLogInFileSystem</con2:operation>
                        <con2:outboundTransform>
                            <con3:replace contents-only="true" varName="body">
                                <con1:id>_ActionId-N53e80115.N3e1c0fc9.0.188fd483d85.N7fc6</con1:id>
                                <con3:expr>
                                    <con1:xqueryTransform>
                                        <con1:resource ref="SBRG_MassivePayment_Commons/Transformations/ServiceToLog"/>
                                        <con1:param name="destinationBank">
                                            <con1:path>data($originalBody//GeneralInfo/DestinationBank)</con1:path>
                                        </con1:param>
                                        <con1:param name="method">
                                            <con1:path>$method</con1:path>
                                        </con1:param>
                                        <con1:param name="errorFlowName">
                                            <con1:path>$fault/ctx:location/ctx:stage/text()</con1:path>
                                        </con1:param>
                                        <con1:param name="channel">
                                            <con1:path>$user</con1:path>
                                        </con1:param>
                                        <con1:param name="messageError">
                                            <con1:path>$fault/ctx:reason/text()</con1:path>
                                        </con1:param>
                                        <con1:param name="body">
                                            <con1:path>$body</con1:path>
                                        </con1:param>
                                        <con1:param name="version">
                                            <con1:path>$version</con1:path>
                                        </con1:param>
                                        <con1:param name="targetSystem">
                                            <con1:path>$targetSystem</con1:path>
                                        </con1:param>
                                        <con1:param name="GlobalId">
                                            <con1:path>data($originalBody//GeneralInfo/GlobalId)</con1:path>
                                        </con1:param>
                                        <con1:param name="sourceBank">
                                            <con1:path>data($originalBody//GeneralInfo/SourceBank)</con1:path>
                                        </con1:param>
                                        <con1:param name="endpoint">
                                            <con1:path>data($inbound/ctx:transport/ctx:uri/text())</con1:path>
                                        </con1:param>
                                        <con1:param name="messageType">
                                            <con1:path>'RESPONSE'</con1:path>
                                        </con1:param>
                                        <con1:param name="service">
                                            <con1:path>$service</con1:path>
                                        </con1:param>
                                        <con1:param name="codeError">
                                            <con1:path>$fault/ctx:errorCode/text()</con1:path>
                                        </con1:param>
                                        <con1:param name="state">
                                            <con1:path>'Error'</con1:path>
                                        </con1:param>
                                        <con1:param name="operation">
                                            <con1:path>$operationTargetSystem</con1:path>
                                        </con1:param>
                                        <con1:param name="value">
                                            <con1:path>$value</con1:path>
                                        </con1:param>
                                        <con1:param name="user">
                                            <con1:path>$user</con1:path>
                                        </con1:param>
                                        <con1:param name="parameters">
                                            <con1:path>''</con1:path>
                                        </con1:param>
                                        <con1:param name="key">
                                            <con1:path>$key</con1:path>
                                        </con1:param>
                                        <con1:param name="errorDetails">
                                            <con1:path>fn-bea:serialize($fault)</con1:path>
                                        </con1:param>
                                    </con1:xqueryTransform>
                                </con3:expr>
                            </con3:replace>
                        </con2:outboundTransform>
                    </con2:route>
                </con:actions>
            </con:stage>
            <con:stage id="_StageId-N3f57febe.554e3982.0.18887fcde33.N7fe1" name="StageReply">
                <con:context/>
                <con:actions>
                    <con1:reply>
                        <con1:id>_ActionId-N3f57febe.554e3982.0.18887fcde33.N7fde</con1:id>
                    </con1:reply>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:flow>
            <con:pipeline-node name="Pipeline Pair Node">
                <con:request>request-N3f57febe.554e3982.0.18887fcde33.N7fec</con:request>
                <con:response>response-N3f57febe.554e3982.0.18887fcde33.N7feb</con:response>
            </con:pipeline-node>
        </con:flow>
        <con:shared-variables>
            <con:variable>requestError</con:variable>
            <con:variable>responseError</con:variable>
            <con:variable>requestService</con:variable>
            <con:variable>responseService</con:variable>
            <con:variable>responseUserLogin</con:variable>
            <con:variable>originalBody</con:variable>
            <con:variable>requestServiceOri</con:variable>
            <con:variable>service</con:variable>
            <con:variable>version</con:variable>
            <con:variable>key</con:variable>
            <con:variable>value</con:variable>
            <con:variable>method</con:variable>
            <con:variable>statusService</con:variable>
            <con:variable>codeErrorService</con:variable>
            <con:variable>messageErrorService</con:variable>
            <con:variable>user</con:variable>
            <con:variable>operationTargetSystem</con:variable>
            <con:variable>targetSystem</con:variable>
            <con:variable>security</con:variable>
        </con:shared-variables>
    </con:router>
</con:templateEntry>